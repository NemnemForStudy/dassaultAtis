define("DS/DELWebComponentManager/XSOManager",["UWA/Core","UWA/Class","DS/Selection/XSO"],function(e,t,n){"use strict";var i=n.singleton({init:function(e){e={eventChannel:"DELOER/CSO"},this._parent(e)}}),o=n.singleton({init:function(e){e={eventChannel:"DELOER/HSO"},this._parent(e)}}),r=n.singleton({init:function(e){e={eventChannel:"DELOER/PSO"},this._parent(e)}});return t.singleton({init:function(e){this._parent(e)},getCSO:function(){return i},getHSO:function(){return o},getPSO:function(){return r}})}),define("DS/DELWebComponentManager/DELWebComponentManager",["DS/Logger/Logger","text!DS/DELWebComponentManager/assets/json/StandardComponents.json"],function(e,t){"use strict";const n=JSON.parse(t);var i;return i||(i=new function(){var t={},i=e.getLogger("DELWebComponentManager"),o=function(e){return 0===Object.keys(e).length},r={create:async function(e={}){let i=function(e){return new UWA.Promise((t,n)=>{let i=[],s=[];if(!0===o(e))return n("No Components are defined");for(let t in e)Object.hasOwnProperty.call(e,t)&&(i.push(e[t].code),s.push(t));require(i,function(...n){n.forEach((t,n)=>{let i=s[n],o=new t(i,e[i].options||{});r.register(i,o)}),t()})})};await Promise.all([async function(){let e=[],s={};Object.keys(n).forEach(e=>{t[e]||(s[e]=n[e])}),!1===o(s)&&(await i(s),Object.keys(s).forEach(t=>{e.push(r.initialize(t))}),await Promise.all(e))}(),i(e.Components)])},initialize:function(e,t){return e?r.getComponent(e).initialize(t).then(()=>{r.setInitialized(e,!0)}):UWA.Promise.reject("input is not valid, component name is not provided")},unInitialize:function(e){return e?r.getComponent(e).clean().then(()=>{r.setInitialized(e,!1)}):UWA.Promise.reject("input is not valid, component name is not provided")},remove:async function(e){await r.getComponent(e).destroy(),r.unregister(e)},register:function(e,n,o=!1){t[e]&&i.warn("component is already registered, old component will be replaced"),t[e]={instance:n,initialized:o}},setInitialized:function(e,n){UWA.is(t[e])&&UWA.is(n,"boolean")?t[e].initialized=n:i.warn(`component ${e} is not registered`)},getComponent:function(e){return t[e]?t[e].instance:null},isInitialized:function(e){return!!t[e]&&t[e].initialized},unregister:function(e){t[e]?delete t[e]:i.warn(`component ${e} is not registered`)},dispose:function(){t={}}};return r}),i}),define("DS/DELWebComponentManager/DELWebComponent",["UWA/Core"],function(e){"use strict";var t=function(e,t){this.name=e,this.options=t};return t.prototype.initialize=function(){return e.Promise.resolve()},t.prototype.clean=function(){return e.Promise.resolve()},t.prototype.destroy=function(){return e.Promise.resolve()},t}),define("DS/DELWebComponentManager/DELWebTypesUtil",["DS/DELWebComponentManager/DELWebComponentManager","DS/Logger/Logger"],function(e,t){"use strict";const n=Object.freeze({PROCESS:"PROCESS",RESOURCE:"RESOURCE",PRODUCT:"PRODUCT",MBOM:"MBOM"}),i=Object.freeze({DELLmiPPRSystemReference:n.PROCESS,DELFmiFunctionReference:n.MBOM,"interfaces/Resource":n.RESOURCE,VPMReference:n.PRODUCT,DELLmiHeaderWorkPlanReference:n.PROCESS}),o=["DELWkiInstructionReference","DELWkiSignOffReference","DELWkiAlertReference","DELWkiDataCollectPlanReference","DELWkiDataCollectChecklistReference","DELWkiDataCollectReference"];return{PPRTYPES:n,getPPRType:function(e){var t;if(e){e=UWA.is(e,"array")?e.join("/"):e;for(const n of Object.keys(i))if(e.contains(n)){t=i[n];break}}return t},getTaxonomies:function(n){return e.getComponent("Utils").getAttributeForIds(n,["taxonomies"]).then(function(e){var t={};if(e)for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]&&UWA.is(e[n].taxonomies,"array")?e[n].taxonomies.join("/"):e[n].taxonomies);return t}).fail(function(e){t.debug(e),t.error("Error occurred while fetching taxonomies for id ",n)})},isWKIType:function(e){return o.indexOf(e)>-1}}}),define("DS/DELWebComponentManager/DELWebModel",["UWA/Class/Model","DS/Logger/Logger","DS/DELWebComponentManager/DELWebComponent","DS/DELWebComponentManager/DELWebComponentManager"],function(e,t,n,i){"use strict";let o=e.extend({validate:function(){}});function r(e,i){n.call(this,e,i),this.logger=t.getLogger("DS/DELWebComponentManager/DELWebModel")}return r.prototype=Object.create(n.prototype),r.prototype.initialize=async function(){this._model=new o,this._modelEvents=i.getComponent("ModelEvents"),this._model.addEvent("onChange",e=>{let t=e.changedAttributes();Object.keys(t).forEach(e=>{let n=`onModelChange:${e}`,i={data:t[e],origin:this.name};this.logger.log(`publish event ${n} with params`,i),this._modelEvents.publish({event:n,data:i})}),this.logger.log("publish onModelChange for attributes ",t),this._modelEvents.publish({event:"onModelChange",data:{data:t,origin:this.name}})})},r.prototype.set=function(...e){return this._model.set.apply(this._model,e)},r.prototype.get=function(e){return this._model.get(e)},r.prototype.clean=async function(){this._model.clear(),this._model.removeEvent("onChange")},r.prototype.destroy=async function(){this.clear(),this._model=null},r}),define("DS/DELWebComponentManager/DELWebLinkManager",["DS/Logger/Logger","DS/ENOXInterWdgCom/LinkManager","DS/DELWebComponentManager/DELWebComponentManager"],function(e,t,n){"use strict";const i="link",o="unlink",r="onAppReady",s="onWidgetLinked",a="onWidgetUnlinked";function g(){this._logger=e.getLogger("DS/DELWebComponentManager/DELWebLinkManager"),this._widgetLink=null,this._attemptedCustomSubscriptions=new Map,this._eventsConfig,this._matchingFeatures=[],this._widgetsToUnlink=[],this._appReady=!1}return g.prototype.initializeWidgetLink=function(s,a,g){const u=parent.require;return this._eventsConfig=g,new Promise(g=>{window.__karma__?(e.warn("We are in karma test environment, thus preventing the use of WidgetLink."),g()):u(["DS/WidgetLink/WidgetLink"],e=>{this._widgetLink=e.get(s),s&&(this._widgetLink.setLinkability(a),this._setMatchingFeatures(this._widgetLink.getLinked()),this._widgetLink=e.get(s),s.link=this._widgetLink),this._appReady=!1,n.getComponent("ModelEvents").subscribe({event:r},()=>{this._appReady=!0,this._notifyUnLink(),this._notifyLink()}),this._widgetLink.addEventListener(i,this._onLink.bind(this)),this._widgetLink.addEventListener(o,this._onUnLink.bind(this)),this._setUpLinkEvents(),t.initializeWidgetLink(s,a).then(g).catch(e=>{this._logger.warn("Error occured while linking ENOPAD Viewer"),this._logger.debug(e),g()})})})},g.prototype._setUpLinkEvents=function(){var e,t=this,i=t._eventsConfig.eventsPrefix,o=t._eventsConfig.eventsToSubscribe,r=t._eventsConfig.eventsToPublish,s=e=>{let t;return e&&(t=e.charAt(0).toLowerCase()+e.slice(1)),t};e=n.getComponent("ModelEvents");for(let n in o)Object.prototype.hasOwnProperty.call(o,n)&&t.subscribe(i+n,r=>{t._logger.log(`Widget Link Event ${i+n} invoked with params`,r);let a=o[n].internalEvent?o[n].internalEvent:s(n);e.publish({event:a,data:{data:r,origin:this.name}})});for(let n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.subscribe({event:n},function(e){if(e&&e.origin!==t.name){let s=r[n].externalEvent?o[n].externalEvent:n;t._logger.log(`Widget Link Event ${i+n} published with params`,e.data),t.publish(i+s,e.data)}})},g.prototype._getFeature=function(e,t){let n,i,o;return t&&(o=e[i=(n=t.split("/"))[n.length-1]].feature),o},g.prototype._setMatchingFeatures=function(e){let t=[];e&&e.forEach(e=>{t=[...t,...e.matchLinkability().matchingFeatures]}),this._logger.debug(`Widget Linked with matching features ${t}`),this._matchingFeatures=t},g.prototype._notify=function(e,t){let i=n.getComponent("ModelEvents");!0===this._appReady&&e.forEach(e=>{i.publish({event:t,data:{data:e,origin:this.name}})})},g.prototype._notifyLink=function(){this._notify(this._widgetLink.getLinked(),s)},g.prototype._notifyUnLink=function(){this._notify(this._widgetsToUnlink,a),this._widgetsToUnlink=[]},g.prototype._onLink=function(e){this._logger.debug("Widget Linked - ",e.link.id,e.link.appId,e.link.isLinked()),this._setMatchingFeatures(this._widgetLink.getLinked()),this._subscribeAfterLink(),this._notifyLink()},g.prototype._onUnLink=function(e){let t=e.link;this._logger.debug("Widget Linked - ",e.link.id,e.link.appId,e.link.isLinked()),t&&(this._setMatchingFeatures(this._widgetLink.getLinked()),this._subscribeAfterLink(),this._widgetsToUnlink.push(t),this._notifyUnLink())},g.prototype._subscribeAfterLink=function(){for(const[e,t]of this._attemptedCustomSubscriptions)this.unsubscribe(e),this.subscribe(e,t)},g.prototype.subscribe=function(e,t){if(this._widgetLink){let n=this._getFeature(this._eventsConfig.eventsToSubscribe,e);if(this._attemptedCustomSubscriptions.set(e,t),this._matchingFeatures.includes(n))return this._logger.debug(`Subscribe Widget Link ${e} of feature ${n} in widget ${widget.id}`),this._widgetLink.subscribe(e,t)}},g.prototype.unsubscribe=function(e){if(this._widgetLink)return this._widgetLink.unsubscribe(e)},g.prototype.publish=function(e,t){if(this._widgetLink&&this._widgetLink.getLinked().length>0){let n=this._getFeature(this._eventsConfig.eventsToPublish,e);this._matchingFeatures.includes(n)&&(this._logger.debug(`Publish Widget Link ${e} of feature ${n} in widget ${widget.id}`),this._widgetLink.publish(e,t))}},g});