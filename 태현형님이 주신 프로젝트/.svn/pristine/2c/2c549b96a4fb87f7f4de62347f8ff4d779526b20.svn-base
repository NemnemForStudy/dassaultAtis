define("DS/ENOProjectMgmtCommonComponents/views/CalendarsView",["UWA/Core","DS/Controls/Calendar"],function(e,t){"use strict";return t.extend({_uwaClassName:"CalendarsView",_parentView:void 0,init:function(e,t){this._parentView=e,this._parent(t)},_redrawCalendar:function(){this._parent.apply(this),this._parentView.repaintCalendarDates()}})}),define("DS/ENOProjectMgmtCommonComponents/config/DefaultGridConfig",[],function(){"use strict";return{_uwaClassName:"DefaultGridConfig",height:"200px",defaultColumnDef:{width:"auto",typeRepresentation:"string"},showRowIndexFlag:!1,showAlternateBackgroundFlag:!0,showSelectionCheckBoxesFlag:!0,rowSelection:"multiple",cellSelection:"none",cellPreselectionFeedback:"row",selectionStyle:"",cellActivationFeedback:"row",showModelChangesFlag:!1,columnsHeader:!0,rowHeader:!1,showOutlineFlag:!1,focusNextEditableCellOnTabFlag:!0,selectionBehavior:{selectNodeModelOnCellSelection:!0},showBackgroundFlag:!0,columnDragEnabledFlag:!1,showRowHeaderBackgroundFlag:!1,showContextualMenuColumnFlag:!0,layoutOptions:{columnsHeader:!0,rowsHeader:!0},sortModel:[{dataIndex:"modified",sort:"desc"}]}}),define("DS/ENOProjectMgmtCommonComponents/constants/Constants",[],function(){"use strict";return{COLLABSPACE:"collabspace",X_PREF_CREDENTIAL:"xPref_CREDENTIAL",COLLABSTORAGE:"collabstorage",X3D_PLATFORMID:"x3dPlatformId",TENANT:"tenant",CTX_PREFIX:"ctx::",SPACE_SOURCE:"3DSpace",DEFAULT:"DEFAULT",DEFAULT_OPPORTUNITY:"DEFAULT_OPPORTUNITY"}}),define("DS/ENOProjectMgmtCommonComponents/config/KanbanViewConfig",["UWA/Core","UWA/Class"],function(e,t){}),define("DS/ENOProjectMgmtCommonComponents/utils/Constants",["DS/WebappsUtils/WebappsUtils"],function(e){"use strict";return{BASE_URL:e.getWebappsBaseUrl()+"ENOProjectMgmtCommonComponents/assets/",PERSON:"Person",ADD_NODE:"Add Node",REMOVE:"Remove",SET_FOCUS:"Set Focus",SUCCESS:"Success",CREATE:"Created",CLASSIFICATION_BASE_URL:"resources/v1/modeler/dslib",LIBRARY_BASE_URL:"resources/v1/modeler/dslib/dslib:Library",LIBRARY_SEARCH_URL:"resources/v1/modeler/dslib/dslib:Library/search",CLASSIFIED_ITEM_URL:"resources/v1/modeler/dslib/dslib:ClassifiedItem",EDIT:"edit",ASSIGN_TO_SELF:"assignToSelf",REMOVE_ASSIGN_TO_SELF:"removeSelfassign",COMPLETE:"complete",RE_OPEN:"re-open",DELETE:"delete",LINK:"link",RELATIONS:"relations",REMOVE_ASSIGNEE:"removeAssignee",ASSIGNEE_ATTR:"assignees",CONTEXT_ATTR:"context",MATRIX_CONFIG_ATTR:"matrixConfiguration",COMPLETE_STATE:"Complete",IN_WORK_STATE:"Active",DEFAULT_SOURCE:"3dspace",XPLAN_SOURCE:"3dplan",XPLAN_APP_ID:"ENXPLAN_AP",XPLAN_RESOURCE_SHARING_API:"invoke/dsxplan:getResourceSharing",XPLAN_MODIFY_DATA:"dsaccess:Operation.Shareable.Modify",PROJECT:"Project",XPROJECT:"dsplan:xProject",STATE_ATTR:"state",RELATIONS_WIDGET_APP_ID:"ENORIPE_AP",COMPLETED_PREFERENCE:"completedPreference",MATURITY:"maturity",DUPLICATE:"duplicate",CHANGE_OWNER:"changeOwner"}}),define("DS/ENOProjectMgmtCommonComponents/config/MassUpdateToolbarConfig",[],function(){"use strict";return{fetchOptions:{fields:"name,modified,state,actualStartDate,actualFinishDate,owner,ownerInfo.name,ownerInfo.firstname,ownerInfo.lastname,modifyAccess,deleteAccess",includeFields:"ownerInfo"}}}),define("DS/ENOProjectMgmtCommonComponents/views/ToggleView",["UWA/Core","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/E6WCommonUI/Views/DetailsDisplaySharedView"],function(e,t,i,n){"use strict";return n.extend({_uwaClassName:"ToggleView",render:function(){let t=this,n=this._getData();this.container.empty(!0);let o=e.clone(this.options||{},!1),s=this._config.values,a="radio"===o.config.buttonType?"radio":"checkbox";this.container.toggleClassName("editable",Boolean(this._config.readWrite&&n.canEdit)),e.createElement("label",{text:this._config.label}).inject(this.container);let l=e.createElement("div",{class:"field-group"});l.inject(this.container);let r=e.createElement("div",{class:"input-group-wrapper"});r.inject(l);let c=e.createElement("div",{class:"input-group"});return c.inject(r),this.myButtonGroup=new i({type:a}),this.myButtonGroup.inject(c),s&&s.length&&s.forEach((e,i)=>{let n="string"==typeof t.model.get(t._config.name)?e.actualValue:e,s=!1;"object"==typeof n&&"checkbox"===a?t.model.get(t._config.name).includes(n)&&(s=!0):s=n===this.model.get(t._config.name);let l=this._createCheckBoxView(e,o,i,s);t.myButtonGroup.addChild(l)}),this.myButtonGroup.addEventListener("change",function(e){let i=t.myButtonGroup.value;t._config.defaultValue=t.myButtonGroup.value;let n=[];i.forEach(e=>{"radio"===o.config.buttonType?n=t._config.values[e]:n.push(t._config.values[e])}),t.model.set(t._config.name,n,t.options)}),this},_createCheckBoxView:function(e,i,n,o){let s={type:i.config.buttonType,label:e.displayValue,value:n,checkFlag:o};return new t(s)},destroy:function(){this.myButtonGroup&&this.myButtonGroup.destroy()}})}),define("DS/ENOProjectMgmtCommonComponents/config/CustomGridDefaultConfig",[],function(){"use strict";return{_uwaClassName:"CustomGridDefaultConfig",customViews:[{identifier:"projectMgmtCustomViewComfortable",layoutDensity:"comfortable",isDefault:!0}]}}),define("DS/ENOProjectMgmtCommonComponents/config/ConfigBase",["UWA/Core","UWA/Class/Model","DS/CollectionView/CollectionViewStatusBar","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Utils/FederatedSearch","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s){"use strict";let a=t.extend({_uwaClassName:"ConfigBase",setColumnInfo:function(){let e=this;this.values.forEach(function(t){"list"===e.type?e.columnInfo[t.dataIndex]=t:"tab"===e.type||"facet"===e.type?e.columnInfo[t.key]=t:e.columnInfo[t.dataIndex||t.name]=t,t.customContentId&&(e.customContentColumnInfo[t.dataIndex]=t)})},cloneConfig:function(){let t={values:[],columnInfo:{}};return this.values.forEach(i=>{t.values.push(e.clone(i)),t.columnInfo[i.dataIndex||i.name]=i}),t},getPersonSearchSource:function(){return n.get("3DSwym")?["swym"]:["3dspace"]},getPersonSearchSourceTypes:function(e){return"swym"===e.toString()?{swym:["pno:Person"]}:{"3dspace":["Person"]}},getObjectSearchSource:function(){return o.filterSearchSources(["3dspace","3dplan"])},getHomePanel:function(e){return e?this.leftPanel||this.mainPanel:n.getContextInfo()?this.mainPanel:this.leftPanel||this.mainPanel},getStatusBarOptions:function(){return[{type:i.STATUS.NB_SELECTED_ROWS},{position:"far",type:i.STATUS.NB_VISIBLE_ITEMS}]},addAdditionalValues:Function.prototype});return a.assigneesCustomButtons=[{id:"assignToSelf",iconClass:"fonticon-user-add",toolTip:s.ASSIGN_TO_SELF},{id:"removeSelfassign",iconClass:"fonticon-user-delete",toolTip:s.REMOVE_ASSIGN_TO_SELF}],a}),define("DS/ENOProjectMgmtCommonComponents/utils/CommonUtils",["UWA/Core","UWA/Promise","UWA/Utils/Client","DS/LifecycleControls/EditPropDialog","DS/i3DXCompassServices/i3DXCompassPubSub","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l){"use strict";let r={"3dspace":"3DSpace"},c={getAlertManager:function(){return window.widget.projectMgmtAlertManager},launchProperties:function(e,t){let i=t&&t.model;var o=i&&i.serviceId,l=s.get("tenant"),c=i&&i.physicalId||e;let d={model:{objectId:c,tenant:l,source:r[o]||o}};switch(o){case a.XPLAN_SOURCE:d.model.sourceName=o,d.model.source="fedsearch",d.model.objectId='uri:"<'+c+'>"',d.model["ds6w:type"]=i.get("type")||i.get("dsxplan:jsType")}return new n({ID:"propFor"+e}).launchProperties(d),!0},downloadFile:function(e,t){var i=document.createElement("a"),n=i.href=URL.createObjectURL(new Blob(["\ufeff"+e],{encoding:"UTF-8",type:"text/json;charset=UTF-8"}));i.setAttribute("download",t),document.body.appendChild(i),i.click(),setTimeout(function(){document.body.removeChild(i),URL.revokeObjectURL(n)},0)},getSpecialCharSepartedStringFromObjects:function(e,t){let i="";t=(t||",")+" ";let n=Object.keys(e);return n&&n.length&&n.forEach(n=>{let o=e[n],s=c.getSpecialCharSepartedStringFromArray(o,t);s&&(i+=n+' "'+s+'" ')}),i},getSpecialCharSepartedStringFromArray:function(e,t){return e.length&&e.join(t).replace(/,(?!.*,)/gim," "+l.AND+" ")||""},formatRangeValuesForSelectView:function(t,i,n,o){let s,a,l,r,d=[];if(t&&t.length){let h=e.is(i,"function")&&i,u=e.is(n,"function")&&n,m=c.pushEmptyRangeValue(o);m&&d.push(m);let g=c.pushNoneRangeValue(o);g&&d.push(g),t.forEach(e=>{r=e.get,s=e.name||e.title||r&&(e.get("name")||e.get("title")),a=h&&h(e)||e[i]||r&&e.get(i),l=u&&u(e)||e[n]||r&&e.get(n),d.push({name:s||"",actualValue:a,displayValue:l})})}return d},pushEmptyRangeValue:function(t){let i=e.clone(t||{},!1);if(i.blankRange){let e=i.blankRangeDisplayValue;return e&&(e=l.INVALID_ICON+" "+e),{actualValue:i.blankRangeActualValue||"",displayValue:e||l.NONE}}},pushNoneRangeValue:function(t){let i=e.clone(t||{},!1);if(i.noneRange)return{actualValue:i.noneRangeActualValue||"0",displayValue:i.noneRangeDisplayValue||l.NONE}},launchApp:function(t,i){let n;i&&!e.is(i,"array")&&(i=[i]),i&&i.length&&i.forEach(e=>{n=e.getTransferObject(n)}),o.publish("setX3DContent",n),o.publish("launchApp",{appId:t})},addOpenMenuItem:function(e,t,i){i||(i=(i=require("DS/ENOProjectMgmtCommonComponents/config/ViewConfigBase"))&&i.prototype);let n=i&&i.getOpenWithInfo();if(n&&n._appsList){n.set3DXContent(t.getTransferObject()).render(e),!n._getCompatibleApps().length&&t.isSpaceObject()&&e.addItem(c.getWebAppOpenMenuItem(t.id))}},getWebAppOpenMenuItem:function(e){let t=this;return{text:l.OPEN,fonticon:"open",handler:function(){window.open(t.getDPMAppURL(e))}}},getDPMAppURL:function(e){let t=s.get("3DSpace");var i=encodeURIComponent(s.get("tenant")),n=t+"/emxLogin.jsp?physicalId="+encodeURIComponent(e);return n+="&tenant="+i,n+="&x3dPlatformId="+i},getDashboardUrl:function(e){let t=s.get("appId");return s.get("3DDashboard")+"#app:"+t+"/content:ids="+encodeURIComponent(e)},getRelationsButton:function(t){let i,n=e.clone(t||{},!1).model;return i={text:l.RELATIONS_LABEL,name:"relationsButton",fonticon:"object-related",className:n&&n.isSpaceObject()?"":"disabled",handler:function(){n&&!n.isPersonType()&&c.launchApp(a.RELATIONS_WIDGET_APP_ID,n)}}},getPreviewButton:function(t){let i,n=e.clone(t||{},!1),o=n.model,s=n.handler;return i={text:l.PREVIEW,fonticon:"eye",name:"preview",className:o?"":" disabled",handler:s}},getCopyLinkURL:function(e){e&&c.copyTextToClipboard(c.getDashboardUrl(e.id))},getconcatenatedActualDisplayValue:function(e){return e.value+"-"+(e.nls[widget.lang]||e.name)}};return c}),define("DS/ENOProjectMgmtCommonComponents/config/ClassificationConfigForCreate",["DS/ENOProjectMgmtModels/Collections/SearchObjects","DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";let o=t.extend({_uwaClassName:"ClassificationConfigForCreate",columnInfo:{},setup:function(){this.setColumnInfo()},type:"classification",values:[{readWrite:"true",name:"classificationPaths",attributeToDisplay:"name",imageAttribute:"image",singleObjectOnly:!1,label:n.CLASSIFICATION_PATHS,type:"object",toggleAttributes:!0,typeAheadCallback:e.typeAheadCallback,linkCallback:i.launchProperties,placeHolder:n.SEARCH_PLACEHOLDER_TEXT,searchSource:["3dspace"],validateSameTenant:!0,searchSourceTypes:{"3dspace":["General Class","Document Family","Export Control Class","IP Control Class","Part Family","Security Control Class"]}}]});return o._instance=o._instance||new o,o._instance}),define("DS/ENOProjectMgmtCommonComponents/components/TriptychWrapper",["UWA/Class","UWA/Drivers/Alone","DS/ENOXTriptych/js/ENOXTriptych","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n){"use strict";return e.extend({_triptych:void 0,_isCollapsed:!1,_isMobile:void 0,parentView:void 0,init:function(e){this._left=t.createElement("div"),this._left.classList.add("triptych-wrapper-left"),this._main=t.createElement("div"),this._main.classList.add("triptych-wrapper-main"),this._right=t.createElement("div"),this._right.classList.add("triptych-wrapper-right"),this._triptych=new i;let n={left:{resizable:!1,originalState:"close",overMobile:!0},right:{resizable:!1,originalSize:435,originalState:"close",overMobile:!0,withClose:!1},borderRight:!0,borderLeft:!0,container:e,withtransition:!1};this._triptych.init(n,this._left,this._main,this._right),this.registerListeners()},build:function(e){this.parentView=e},_getTriptych:function(){return this._triptych},destroy:function(){this._triptych.destroy()},hideRightPanel:function(){this._triptych._hidePanel("right")},showRightPanel:function(){this._triptych._showPanel("right")},registerListeners:function(){this._isMobile=n.isMobile()}})}),define("DS/ENOProjectMgmtCommonComponents/config/ClassificationConfig",["DS/ENOProjectMgmtModels/Collections/SearchObjects","DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";let o=t.extend({_uwaClassName:"ClassificationConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"classification",values:[{readWrite:"true",name:"classificationPaths",attributeToDisplay:"name",imageAttribute:"image",singleObjectOnly:!1,label:n.CLASSIFICATION_PATHS,type:"object",toggleAttributes:!0,typeAheadCallback:e.typeAheadCallback,linkCallback:i.launchProperties,placeHolder:n.SEARCH_PLACEHOLDER_TEXT,searchSource:["3dspace"],validateSameTenant:!0,searchSourceTypes:{"3dspace":["General Class","Document Family","Export Control Class","IP Control Class","Part Family","Security Control Class"]}}]});return o._instance=o._instance||new o,o._instance}),define("DS/ENOProjectMgmtCommonComponents/config/AppConfig",["UWA/Core","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o){"use strict";return{_uwaClassName:"AppConfig",Highcharts:void 0,completedPreference:{values:[{label:o.NONE,value:"none",isDefault:!0},{label:o.LAST_TEN_DAYS,value:"10"},{label:o.LAST_THIRTY_DAYS,value:"30"},{label:o.LAST_SIXTY_DAYS,value:"60"},{label:o.ALL,value:"all"}],getDefault:function(){for(let e in this.values)if(this.values[e].isDefault)return this.values[e].value}},gridDropDownItems:{items:[{type:"PushItem",title:o.EDIT,icon:"pencil",name:"edit"},{type:"PushItem",title:o.DUPLICATE,icon:"duplicate",name:"duplicate"},{type:"PushItem",title:o.ASSIGN_TO_SELF,icon:"user-add",name:"assignToSelf"},{type:"PushItem",title:o.REMOVE_ASSIGN_TO_SELF,icon:"user-delete",name:"removeSelfassign"},{type:"SeparatorItem"},{type:"PushItem",title:o.RELATIONS_LABEL,icon:"object-related",name:"relations"},{type:"SeparatorItem"},{type:"PushItem",title:o.DELETE,icon:"trash",name:"delete"},{type:"PushItem",title:o.REMOVE,icon:"user-delete",name:"removeAssignee"}],dividerItem:{type:"SeparatorItem"},maturityStateMap:{Create:o.SAVE_AS_DRAFT,Assign:o.START,Active:o.BEGIN_WORK,Review:o.APPROVE,Complete:o.MARK_AS_COMPLETED},getMaturityStateConfig:function(e,t){let i=e.value,o=i.toLowerCase()+" "+(t?"promote":"demote");return{type:"PushItem",title:this.maturityStateMap[i],icon:"status-change object-maturity "+o,name:i,groupName:n.STATE_ATTR}},getMenuItemsConfigForModel:function(t){let n,o=e.clone(this.items,!1),s=[],a=t.getMaturityStates();if(a&&a.length){let e=t.state,o=i.findIndex(a,"value",e);a.forEach((e,t)=>{o!==t-1&&o!==t+1||(n=this.getMaturityStateConfig(e,t>o))&&s.push(n)})}return s.length&&o.splice(3,0,...s),o},getItems:function(t,s){let a=[],l=e.clone(s||{},!1),r=l.callback,c=l.assignModel,d=l.isSelectedNode,h=l.isAssignColumn,u=t.model,m=u.getActionsAttrsAccessMap(),g=m.canModify,p=m.canDelete,C=m.canToConnect,f=m.isComplete,D=i.isSelfAssigned(u),M=i.isLoggedInUserSelected(c);return this.getMenuItemsConfigForModel(u).forEach(t=>{let i,s;switch(delete t.className,t.name){case n.EDIT:i=!(s=g&&!d&&!f);break;case n.ASSIGN_TO_SELF:s=g&&C&&!D;break;case n.REMOVE_ASSIGN_TO_SELF:s=g&&(h?D&&M:D);break;case n.DELETE:i=!(s=p);break;case n.REMOVE_ASSIGNEE:(s=h&&g&&!M)&&(t.title=c?o.REMOVE+' "'+c.getFullName()+'"':o.REMOVE_ALL);break;default:s=!0,i=!1}if(s||i){t.state=i?"disabled":"";let n=e.clone(t,!1);n.action={callback:r,context:t},a.push(n)}}),a}},defaultSkeletonOptions:{rightContainerContent:void 0,centerContainerContent:void 0,leftContainerCollapsedFlag:!0,rightContainerCollapsedFlag:!0,leftContainerWidth:0,leftContainerMinWidth:0,leftContainerMaxWidth:0,rightContainerWidth:400,rightContainerMinWidth:200,rightContainerMaxWidth:500,navigationContainerVisibleFlag:!1,idCardContainerVisibleFlag:!1,statusContainerVisibleFlag:!1,identifier:"SkeletonLayout_projectMgmentHomeView"},ChartsColor:{WHITE_COLOR:"#FFFFFF",BLUE4_COLOR:"#005686",BLACK_COLOR:"#000000",GREY0_COLOR:"#F1F1F1",GREEN0_COLOR:"#6FBC4B",YELLOW0_COLOR:"#FEE000",RED1_COLOR:"#CC092F",BLUE2_COLOR:"#002596",BLUE3_COLOR:"#4EA8B7",ORANGE0_COLOR:"#FF8A2E"},ColorPalette:[{color:"#E2D5CC",UsedFlag:!1},{color:"#45299E",UsedFlag:!1},{color:"#0067D7",UsedFlag:!1},{color:"#D71F66",UsedFlag:!1},{color:"#C25400",UsedFlag:!1},{color:"#7F7F7F",UsedFlag:!1},{color:"#8DDEE4",UsedFlag:!1},{color:"#4EA8B7",UsedFlag:!1},{color:"#127277",UsedFlag:!1},{color:"#009DDB",UsedFlag:!1},{color:"#ADADAD",UsedFlag:!1},{color:"#9B2C98",UsedFlag:!1},{color:"#00AA86",UsedFlag:!1},{color:"#6D2815",UsedFlag:!1},{color:"#F564A3",UsedFlag:!1},{color:"#000000",UsedFlag:!1},{color:"#4D62BA",UsedFlag:!1},{color:"#007A4C",UsedFlag:!1},{color:"#70036b",UsedFlag:!1},{color:"#C6C68B",UsedFlag:!1},{color:"#6FBC4B",UsedFlag:!1},{color:"#FEE000",UsedFlag:!1},{color:"#CC092F",UsedFlag:!1},{color:"#002596",UsedFlag:!1},{color:"#FF8A2E",UsedFlag:!1}]}}),define("DS/ENOProjectMgmtCommonComponents/components/ProgressSpinner",["UWA/Core","DS/Controls/Loader","DS/Controls/ModalContainer","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils"],function(e,t,i,n,o){"use strict";let s={_isSpinnerVisible:!1,initializeProgressSpinner:function(e){this._rootContainer=e},showProgressSpinner:function(e,o){n.get("isComponent")?s.showLoadingMessage(e,o):(e=e||this._rootContainer)._isSpinnerVisible||(e._isSpinnerVisible=!0,this._progressSpinner=new t({text:o}),this._progressSpinner.on(),i.createModal(e,this._progressSpinner.elements.container))},hideProgressSpinner:function(e){n.get("isComponent")?s.hideLoadingMessage(e):(e=e||this._rootContainer)._isSpinnerVisible&&(i.removeModal(e),delete e._isSpinnerVisible)},showLoadingMessage:function(e,t){this.setSpinnerView(e),o.showLoadingMessage(e,t)},hideLoadingMessage:function(e){(e=e||s.getSpinnerView())&&o.hideLoadingMessage(e),this.setSpinnerView()},showRowLoadingMessage:function(e,t){this.setRoWSpinnerView(e),o.showLoadingMessage(e,t)},hideRowLoadingMessage:function(e){(e=e||s.getRowSpinnerView())&&o.hideLoadingMessage(e),this.setRoWSpinnerView()},setSpinnerView:function(e){this._spinnerView=e},getSpinnerView:function(){return this._spinnerView},setRoWSpinnerView:function(e){this._roWSpinnerView=e},getRowSpinnerView:function(){return this._roWSpinnerView}};return s}),define("DS/ENOProjectMgmtCommonComponents/components/CustomAlert",["UWA/Core","UWA/Class/Listener","DS/Windows/Dialog","DS/Controls/Button","DS/Windows/ImmersiveFrame","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/ProgressSpinner","DS/ENOProjectMgmtModels/Utils/DataUtils","DS/ENOProjectMgmtModels/Models/AppSettings","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h){"use strict";let u=0,m={init:function(){return this.adjustAlertMessagePosition(),a.setNotificationManager(s),this.listener=new t,this.listener.listenTo(widget,"onResize",this.adjustAlertMessagePosition.bind(this)),this.listener.listenTo(c,{showConfirmDialog:m.confirmDialog,showNotification:m.buildNotification}),s},getNotificationsManagerViewOnScreen:function(){return a},adjustAlertMessagePosition:function(){a.slide({top:0,right:widget.body.offsetWidth/2-120});let e=this.getDialogView();e&&e.setAbsolutePosition({y:1})},buildNotification:function(e,t){let i=d.get("isComponent"),n=l.getAlertManager(),o=m.getLastNotificationData(e);if(!o||!i&&o._data.message!==e.message){let o={sticky:!1,title:e.title,subtitle:e.subtitle,message:e.message,level:t||"success"};n&&n.addNotif(o),!i&&m.disposeNotification(e.hideDelay)}},disposeNotification:function(e){let t=m.getLastNotificationData();t&&!t._fadingTimeout&&setTimeout(function(){let i=t.getDiv(),n=setInterval(function(){i.style.opacity||(i.style.opacity=1),i.style.opacity>0?i.style.opacity-=.1:(clearInterval(n),m.clearNotificationMessages())},e&&e/10||100)},e||3e3)},getLastNotificationData:function(e){if(d.get("isComponent")){let t=widget.alerter&&widget.alerter.getMessages();return l.findObject(t,"textContent",e.message)}let t=m.getNotificationsManagerViewOnScreen();return t._notifications.find(e=>e._data===t._lastNotificationDisplayed)},clearNotificationMessages:function(){let e=m.getNotificationsManagerViewOnScreen();e&&e.removeNotifications("","")},confirmDialog:function(t,n){m.immersiveFrame&&m.close();let s=t.noLabel,a=t.yesLabel,l=t.isReload,r=Array.prototype.slice.call(arguments,1),c=t.yesEventFunc&&t.yesEventFunc.bind(void 0,...r),d=t.noEventFunc&&t.noEventFunc.bind(void 0,n);m.immersiveFrame=new o({}),m.dontResetModel=t.dontResetModel,m.setParentView(t.parentView);let h=m.getDialogView();if(!h||!h.isReload){if(!h){h=new i({immersiveFrame:m.immersiveFrame,identifier:"customAlert_"+u++,title:t.title,content:e.createElement("p",{html:t.message}),minHeight:150,minWidth:500,width:500,modalFlag:!0});let n=m.getParentView();m.immersiveFrame.inject(n&&n.container||widget.body),h.setAbsolutePosition({y:1}),m.setDialogView(h),m._registerEvents()}h.buttons=m.getFooterButtons({noLabel:s,yesLabel:a,noEventFunc:d,yesEventFunc:c}),h.buttons.Apply.getContent().addClassName("wux-ui-state-primary"),h.isReload=l}},_registerEvents:function(){let e=this.getDialogView();e.realClosefunc=e.close,e.close=this.close.bind(this)},getFooterButtons:function(e){return{Discard:new n({domId:"noBtn",label:e.noLabel,onClick:this.handleFooterButtonEvents.bind(this,e.noEventFunc)}),Apply:new n({domId:"yesBtn",label:e.yesLabel,onClick:this.handleFooterButtonEvents.bind(this,e.yesEventFunc)})}},handleFooterButtonEvents:function(e,t){let i=t.dsModel.value;this.dontResetModel||"Apply"!==i||this.getParentView().dispatchEvent("resetModel"),e&&e(),this.close()},close:function(){let e=this.getDialogView();e&&e.realClosefunc(),this.setDialogView(),this.setParentView(),this.immersiveFrame.destroy(),delete this.immersiveFrame},setDialogView:function(e){this._dialogView=e},getDialogView:function(){return this._dialogView},setParentView:function(e){this._parentView=e},getParentView:function(){return this._parentView},showSingleErrorMessageForDataObjects:function(e,t,i){if(t){let n=l.getSpecialCharSepartedStringFromObjects(e)+t+(i?' "'+i+'"':"");m.buildNotification({message:n},"error")}let n=r.getRowSpinnerView();n&&r.hideRowLoadingMessage(n)},displayMessage:function(e){let t={message:e.msg,hideDelay:e.hideDelay};m.buildNotification(t,e.msgType);let i=r.getRowSpinnerView();i&&r.hideRowLoadingMessage(i)}};return m}),define("DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel",["UWA/Core","DS/E6WCommonUI/Models/CloneModel","DS/DocumentManagement/DocumentManagement","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/CSRFDataModel","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r){"use strict";let c=t.extend({_uwaClassName:"ProjectMgmtCloneModel",init:function(){this.saving=!1,this.localRelatedItems={},this._parent.apply(this,arguments)},add:function(t,i,o){let s=i,a=e.clone(o||{},!1),l=a.config;if(!(l&&l.preValidate)||this.preProcessValidation.apply(this,arguments)){if(i&&(e.is(i,"array")||i instanceof FileList))s=this._addFile(i,a);else if(!e.is(i,"object")){if(t===n.CONTEXT_ATTR)return a.refresh=!0,a.rmcType=a.model.get("type"),void(s=this._addModel(t,i,a)).addEventOnce("onSync",this.handleContextOnSync.bind(this,{fieldName:t,contextOptions:a}));s=this._addModel(t,i,a)}let o=s&&s.length||s instanceof e.Class.Model;a.changed=o,o&&this.setRelatedItemData(t,s,a)}},setRelatedItemData:function(e,t,i){let n=this.modificationsPending,o=i.config,s=o.validate,a=!1,l=this.get(e);l||(a=!0,l=this.model.createRelatedDataItems([],{config:o})),o.singleObjectOnly&&l.length&&(l.reset(),l.resetOperationFlags()),l.add(t),a?this.set(e,l,{validate:s}):(this.validationError=s&&this.validate(this.toJSON(),i),this.validationError&&this.dispatchEvent("onValidationFailure"),this.dispatchEvent("onChange:"+e)),this.localRelatedItems[e]=l,this.modificationsPending=Boolean(i&&i.changed||n),this.dispatchEvent("onChange:modificationsPending",[this]),this.dispatchEvent("onChange",[this,i])},remove:function(e,t,i){let n=i.config,o=this.get(e);if(o&&o.length){let s=o.at(t)||o.get(t);n&&n.singleObjectOnly&&(o.reset(),o.resetOperationFlags()),o.remove(s),this.localRelatedItems[e]=o,this.modificationsPending=!0,this.dispatchEvent("onChange:"+e),this.dispatchEvent("onChange",[this,i]),this.dispatchEvent("onChange:modificationsPending",[this]),this.validationError=n&&n.validate&&this.validate(this.toJSON(),n),this.validationError&&this.dispatchEvent("onValidationFailure")}},set:function(t,i){if(!e.is(t,"object"))return this._parent.apply(this,arguments);{let e=this,i=t,n=Object.keys(t);n.length&&n.forEach(t=>{e.set(t,i[t])})}},_attributesGet:function(e,t){return e?e[t]:this.get(t)},_addFile:function(e,t){let i=[],n=t.config,s=e.length;for(let t=0;t<s;t++){let n=e[t],s={title:n.name,type:n.type,lastModified:n.lastModified,lastModifiedDate:n.lastModifiedDate,image:window.URL.createObjectURL(n),file:n};i.push(o.getObjectForAdding(s.id,{attrs:s,modelConstructor:this.model.getModelConstructorBasedOnType(s.type)}))}return n&&n.singleObjectOnly&&i.length?i[0]:i},_addModel:function(e,t,i){if(!this.validateSelfObject.apply(this,arguments))return;let a=this,l=[],c=i.config,d=i.errObjs||{},h=t.split(","),u=h.length,m=this.get(e);for(let s=0;s<u;s++){let r=h[s],u=o.alreadyHasObjectInRelatedData(m,r);if(u){let e=u.displayType||u.objectType;d[e]||(d[e]=[]),d[e].push(u.displayName);continue}i.detailedObject=o.getDetailedObject(r,i.detailedObjects);let g=o.getObjectDataFromDropSearchOrTypeAhead(i),p=g.id,C=i.refresh,f=i.config.fetchSource;f||g.serviceId!==n.XPLAN_SOURCE||(f="RiskContextInfo");let D=f&&i.sourceType+"CreateAccess";i.config.fields&&(D+=","+i.config.fields);let M=o.getObjectForAdding(p,{attrs:g,fetchOptions:{refresh:C,fetchSource:f||"ObjectInfo",fields:f&&D,include:i.config.include,rmcType:i.rmcType,onComplete:c.customButtons&&function(){a.dispatchEvent("onChange",[a,i])},onFailure:function(){a.rollbackChanges(e,t,i)}},modelConstructor:this.model.getModelConstructorBasedOnType(g.type)});l.push(M)}i.errObjs?i.errObjs=d:Object.keys(d).length&&s.showSingleErrorMessageForDataObjects(d,r.OBJECT_ALREADY_ASSOCIATED,this.get("title")||r.NEW_OBJECT);let g=l.length;return g?c&&c.singleObjectOnly&&g?l[0]:l:void 0},uploadFiles:function(e,t){for(let i=e.length-1;i>=0;i--){e[i].get("file")&&this.uploadFile(e[i],t)}},uploadFile:function(t,n){let o=this,s=e.clone(n||{},!1),c=t.get("title"),d=t.get("file"),h=s.callback,u=s.onFailure,m=c.lastIndexOf(".");if(-1!==m){let e=c.substring(m).toLowerCase();s.isImage=-1!==this.imageExtensions.indexOf(e)}if(!this.id&&!this.isNew)throw new Error(r.INVALID_OBJECT_CANNOT_UPLOAD_FILE);this._fileUploadCount=this._fileUploadCount?this._fileUploadCount+1:1,s.onComplete=function(e){o._fileUploadCount--;let i={},a=e;if(e&&e.data&&(a=e.data[0],i.id=a.id,i.hasfiles="TRUE",i.type=a.type,i.physicalId=a.id),s.isImage&&!t.FileName)i.image=window.URL.createObjectURL(d);else{let e=a.dataelements;e&&(i.image=e.image||e.typeicon)}t.set(i),h(o,n)},s.onFailure=function(e,i){o._fileUploadCount--,o.remove("references",t.id,n),u&&u(e,i,n)};let g={fileInfo:{file:d}},p={csrf:l.prototype.getCSRF(),securityContext:a.get("collabspace"),tenant:a.get("tenant"),tenantUrl:a.get("3DSpace")};if(this.isNew){let e=this.model.getCollabSpace();e&&(g.collabspace=e)}else p.deriveCollabspace=!0,g.relInfo={parentDirection:"From",parentId:this.id,parentRelName:"Reference Document"};e.merge(s,p),i.createDocument(g,s)},isUploadingFiles:function(){return Boolean(this._fileUploadCount)},imageExtensions:[".gif",".jpg",".png",".gif",".jpeg",".3dxml",".cgr",".pdf",".bpm",".psd",".ai"],dataForRendering:function(){let e=this._parent.apply(this,arguments),t=this.get("modified"),i=this.get("originated");return t&&(e.modified=o.getIntlDateFormat(t)),i&&(e.originated=o.getIntlDateFormat(i)),e},cancel:function(){if(this.saving=!1,this.localAttributes={},this.localRelatedItems={},this.modificationsPending){this.modificationsPending=!1,this.dispatchEvent("onChange:modificationsPending",[this]),this.dispatchEvent("onChange",[this]);let i=Object.keys(this.model._attributes);var t=i.length;for(let n=0;n<t;n++){let t=i[n],o=this.model.get(t);o instanceof e.Class.Collection&&this.resetRelatedObjectCollection(o),this.dispatchEvent("onChange:"+t)}}},resetRelatedObjectCollection:function(e){let t=e.relatedDataToAdd,i=e.relatedDataToDelete,n=t.length;for(let i=0;i<n;i++)e.remove(t[i],{silent:!0});let o=i.length;for(let t=0;t<o;t++)e.add(i[t],{silent:!0});e.resetOperationFlags()},clearLocalAttributes:function(t){t&&!e.is(t,"array")&&(t=[t]),t&&t.length&&t.forEach(e=>{delete this.localAttributes[e]})},validate:function(e){var t={fields:[],messages:{}};let i=this._attributesGet(e,"title"),n=i&&i.trim().length;return n||t.fields.push("title"),this.dispatchEvent("disableSaveButton",!n),n?void 0:t},handleAttrsUpdateForActions:function(t,i,o){switch(e.extend(o||{},{invokeSaveEvent:!0}),t){case n.STATE_ATTR:this.set(t,i),this.dispatchEvent("submitSave",[o])}},updateDetailsDisplay:function(e){e&&(this.validationError=this.validate(this.toJSON())),this.dispatchEvent("resetDetailsDisplay")},validateStartEndDates:function(t,i,n){let o=!0,s=e.clone(n||{},!1),a=s.startDateAttribute,l=s.endDateAttribute,r=this._attributesGet(t,a),c=this._attributesGet(t,l);return r=r&&new Date(r.actualValue||r.getTime&&r.getTime()).setHours(0,0,0,0),c=c&&new Date(c.actualValue||c.getTime&&c.getTime()).setHours(0,0,0,0),r&&c&&r>c&&(o=!1,i.fields.push(s.name)),o},getDateFieldValue:function(t,i){let n=this._attributesGet(i,t);return n&&e.is(n.actualValue,"string")&&(n=n.actualValue),n},getContextModel:function(){let e=this.get(n.CONTEXT_ATTR);return e&&e.length&&e.at(0)},validateSelfObject:function(){let e=!0,t=o.removeBracketLongURI(arguments[1]);return this.id===t&&(s.buildNotification({message:r.replace(r.SAME_OBJECT_ERROR,{title:this.get("title")})},"error"),e=!1),e},preProcessValidation:function(t,i,n){let a,l,c=this,d=!0,h=e.clone(n||{},!1).config,u=h&&h.preValidate;return u&&u.length&&u.forEach(e=>{d&&(a=e.nlsMsg,(l=c.get(e.name))&&l.length&&l._alreadyHasObjectInRelatedData(o.removeBracketLongURI(i))&&(a&&s.buildNotification({message:r.replace(a,{fieldLabel:e.label})},"error"),d=!1))}),d},handleContextOnSync:Function.prototype});return Object.defineProperty(c.prototype,"title",{get:function(){return this.get("title")||this.get("name")}}),Object.defineProperty(c.prototype,"isNew",{get:function(){return this.model.isNew()}}),c}),define("DS/ENOProjectMgmtCommonComponents/components/CustomDataGridView",["UWA/Core","UWA/Class","UWA/Drivers/Alone","DS/Utilities/Dom","DS/Windows/ImmersiveFrame","DS/DataGridView/DataGridView","DS/DataGridView/RowModelClientSide","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/config/CustomGridDefaultConfig"],function(e,t,i,n,o,s,a,l,r){"use strict";return s.extend({_uwaClassName:"CustomDataGridView",options:{},init:function(t){let i=e.clone(t||{},!1);this.config=i.config,this.options=i.gridOptions,this.container=i.container,this.gridConfig=this.config.gridConfig,this._parent({treeDocument:i.treeDocument,columns:this.config.values,defaultColumnDef:this.gridConfig.defaultColumnDef,showRowIndexFlag:this.gridConfig.showRowIndexFlag,showAlternateBackgroundFlag:this.gridConfig.showAlternateBackgroundFlag,showSelectionCheckBoxesFlag:this.gridConfig.showSelectionCheckBoxesFlag,rowSelection:this.gridConfig.rowSelection,cellPreselectionFeedback:this.gridConfig.cellPreselectionFeedback,cellSelection:this.gridConfig.cellSelection,selectionStyle:this.gridConfig.selectionStyle,cellActivationFeedback:this.gridConfig.cellActivationFeedback,showModelChangesFlag:this.gridConfig.showModelChangesFlag,showOutlineFlag:this.gridConfig.showOutlineFlag,identifier:this.gridConfig.identifier||"ENOProjectMgmtCustomDataGridId",cellDragEnabledFlag:this.gridConfig.cellDragEnabledFlag,focusNextEditableCellOnTabFlag:this.gridConfig.focusNextEditableCellOnTabFlag,layoutOptions:this.gridConfig.layoutOptions,selectionBehavior:this.gridConfig.selectionBehavior,showBackgroundFlag:this.gridConfig.showBackgroundFlag,columnDragEnabledFlag:this.gridConfig.columnDragEnabledFlag,showRowHeaderBackgroundFlag:this.gridConfig.showRowHeaderBackgroundFlag,virtuallyLoadAllModelItems:this.gridConfig.virtuallyLoadAllModelItems,showContextualMenuColumnFlag:this.gridConfig.showContextualMenuColumnFlag}),this.handleCustomDataGridViewContent(),this.immersiveFrame=new o,this.immersiveFrame.setContentInBackgroundLayer(this.getContent()),this.immersiveFrame.reactToPointerEventsFlag=!1,this.immersiveFrame.inject(this.container)},handleCustomDataGridViewContent:function(){let t=this;if(this.config){if(this.config.getCellTooltip&&(this.getCellTooltip=this.config.getCellTooltip),this.config.registerReusableCellContent){let i=this.config.registerReusableCellContent;e.is(i,"array")||(i=[i]),i.forEach(function(e){t.registerReusableCellContent(e)})}if(this.config.toolbarConfig){this.toolbar=i.createElement("div"),this.container.appendChild(this.toolbar),this.toolbar.className="divToolbar";let e=this.setToolbar(JSON.stringify(this.config.toolbarConfig));e.options=this.options,this.toolbar.appendChild(e.getContent())}}this.handleGridViewOptions(),this.initializeLazyLoadingEvents(),this.initializeDragAndDropEvents(),this.registerCustomViews(this.gridConfig.customViews?this.gridConfig:r)},initializeDragAndDropEvents:function(){this.onDropCell=this.handleCellDrop.bind(this),this.onDragStartCell=this.handleCellDrag.bind(this)},handleGridViewOptions:function(){let t=e.clone(this.options||{},!1);t.top&&(this.getContent().style.top=t.top),t.placeholder&&(this.placeholder=t.placeholder),t.onSortChange&&(this.onSortChange=t.onSortChange),t.lazyLoadingCallBack&&(this.lazyLoadingCallBack=t.lazyLoadingCallBack),this.onContextualEvent=t.onContextualEvent||[],this.gridConfig.sortModel&&(this.sortModel=this.gridConfig.sortModel),this.gridConfig.statusBarOptions&&this.buildStatusBar(this.gridConfig.statusBarOptions),t.edit&&(this.getContent().style.top="40px")},initializeLazyLoadingEvents:function(){let e=this,t=this.lazyLoadingCallBack;if(t){let i=this._getScroller(),o=function(){t(e.getLastRenderedNodeModels())};this.initializeEvents(o),n.onNodeRendered(i.getContent(),o)}},initializeEvents:function(e){let t=this,i=this._getScroller(),n=function(){t.clearDropdown(),e&&e.apply(t,arguments)};i.onScrollEnd(function(){this.getPosition().y>-1&&n.apply(this,arguments)}),this.getTreeDocument().getModelEvents().subscribe({event:"PRE_EXPAND_DONE"},n),this.addEventListener("sortModelChange",n),this._onEndResize(e),widget.addEvent("onResize",this.clearDropdown)},getLastRenderedNodeModels:function(){let e,t=[],i=this.getRowModel();if(i){let n=this.layout.getMinMaxVisibleRowIDs();for(let o=n.minRowID;o<=n.maxRowID;o++)(e=i.getVisibleNodeModel(o))&&!e.cached&&(e.cached=!0,t.push(e.model))}return t},getViewByRowID:function(e){let t=this.layout.getDisplayedColumnsIndexes(),i=this.layout.getCellIDFromCoordinates({rowID:e,columnID:t.length&&t[0]||0}),n=this._getViewAt(i);return n&&n.elements.container.parentElement},getGridStatusBar:function(){return this.elements.statusBar},getGridStatusBarContainer:function(){let e=this.getGridStatusBar();return e&&e.elements.container},registerCustomViews:function(e){let t=this,i=e.customViews,n=widget.getValue(this.identifier)||this.getGridDefaultViews(i);this.subscribeOnceToAllCellsRendered(function(){let e=l.findObject(n,"isDefault",!0),i=t.getCustomViewsManager();i.collectionView.rowGroupingEnabledFlag=!1,i.onCustomViewsSave=t.handleCustomViewSave.bind(t),e&&i.setCustomViews(n,e.identifier,!0),widget.setValue(t.identifier,n)})},getGridDefaultViews:function(t){let i={identifier:"Default View"};return t&&[i].concat(t)||[e.extend(i,{isDefault:!0})]},handleCustomViewSave:function(t,i){t.find(t=>{t.identifier===i?e.extend(t,{isDefault:!0,layoutDensity:t.layoutDensity||"comfortable"}):delete t.isDefault}),widget.setValue(this.identifier,t)},handleCellDrag:function(t,i){let n,o,s=i.nodeModel.options.data,a=s&&s.model;if(!a)return;let r=this.getColumnDataIndex(i);if("tree"===r)o=this.getSelectedNodesTransferObjects()||a.getTransferObject();else{let i=this.getDataIdFromEvent(t),n=a.get(r);if(n&&n instanceof e.Class.Collection){let e=i&&n.get(i);if(e){let i=this.getTarget(t),n=i.getBoundingClientRect(),s=t.clientX-n.left,a=t.clientY-n.top;t.dataTransfer.setDragImage(i,s,a),o=e.getTransferObject()}else o=a.getTransferObjectsForRelatedData(r)}}(n=o&&JSON.stringify(o))&&(t.dataTransfer.effectAllowed="copy",t.dataTransfer.setData(l.getDragDataKey(),n),t.dataTransfer.setData("text",n))},handleCellDrop:function(e,t){let i=t.nodeModel.options.data;if(!(i&&i.model))return;let n=t.nodeModel,o=this.getColumnDataIndex(t),s=this.getViewByRowID(t.rowID),a=l.getDataTransferJSON(e.dataTransfer);a&&this.dispatchEvent("onDrop:"+o,[a,o,n,s])},getSelectedNodesTransferObjects:function(){let e,t=this.getTreeDocument().getSelectedNodes();return t&&t.length&&t.forEach(t=>{e=t.options.data.model.getTransferObject(e)}),e},getColumnInfo:function(e){let t;switch(typeof e){case"string":case"number":t=this._getXSOElementFromCellID(e);break;case"object":t=(e.cellView&&e.cellView.collectionView||this).columns[e.columnID]}return t},getColumnDataIndex:function(e){let t=this.getColumnInfo(e);return t&&(t.dataIndex||t.columnDataIndex)},getSelectedColumnInfo:function(){return this._preselectedCellStableID},getTarget:function(e){return e&&e.target},getDataIdFromEvent:function(e){let t=this.getTarget(e);return t&&t.getAttribute&&t.getAttribute("data-id")},removeSelection:function(e){e&&e.isSelected()&&(this.getTreeDocument().getXSO().remove(e),e._isSelected=!1)},setPreselectedCell:function(e){return this._preselectedCellStableID=this._getXSOElementFromCellID(e),this._parent.apply(this,arguments)},cellShouldBeSelected:function(e){let t=event.target,i=this.getColumnInfo(e),n=i.columnDataIndex,o=i&&i.nodeModel;switch(this.removeSelection(o),n){case"ContextualMenuColumn":return!1;case"state":if(t&&t.getAttribute("has-badge"))return this.dispatchEvent("invokeMaturityUpdate",o),!1}return this._parent.apply(this,arguments)},getRowModel:function(){return this._rowModel},_applySortModel:function(){let e=this._parent,t=!1;if(this.onSortChange){let i=this.getSelectedColumnInfo(),n=i&&i.columnDataIndex;if(n&&"rowHeader"!==n){let i=this.treeDocument.getNonCachedModels(n);(t=i.length)&&this.onSortChange(n,i,e.bind(this,arguments))}}!t&&e.apply(this,arguments)},clearDropdown:function(){let t=e.extendElement(window.document).getElement(".wux-menu");t&&t.destroy()},destroy:function(){this.clearDropdown(),this.toolbar&&(this.toolbar.destroy(),delete this.toolbar),this.immersiveFrame&&(this.immersiveFrame.destroy(),delete this.immersiveFrame)}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtGridView",["UWA/Core","UWA/Class/View","DS/UIKIT/Scroller","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/components/ProgressSpinner","DS/ENOProjectMgmtCommonComponents/components/CustomDataGridView","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Models/AppSettings","text!DS/ENOProjectMgmtCommonComponents/assets/templates/GridViewTemplate.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r,c,d){"use strict";let h=[a.EDIT,a.DUPLICATE,a.RELATIONS];return t.extend({_uwaClassName:"ProjectMgmtGridView",init:function(e,t){this.parentApp=e,this._nlsTrend=t.nlsTrend,this._appConfig=t.appConfig,this._tabConfig=t.tabConfig,this._viewConfig=t.viewConfig,this._collection=t.collection,this._listConfig=t.listConfig,this._trendConfig=t.trendConfig,this._leftPanelOnly=t.leftPanelOnly,this._trendTemplate=t.trendTemplate,this._membersConfig=t.membersConfig,this._trendChartConfig=t.trendChartConfig,this._doNotApplyLazyLoading=t.doNotApplyLazyLoading,this._doNotShowContextualMenu=t.doNotShowContextualMenu,this._matrixConfigCollection=t.matrixConfigCollection,this._detailsAndRelationships=t.detailsAndRelationships},reset:function(){this.dataGrid&&(this.dataGrid.destroy(),delete this.dataGrid)},render:function(){return this.reset(),this._appContainer=e.createElement("div"),this._appContainer.setHTML(c),this._appContainer=this._appContainer.getElement(".grid-view"),this.gridViewContent=this._appContainer.getElement("#gridViewContent"),this.detailsAndRelationships=new this._detailsAndRelationships(this.parentApp.getRightPanelContainer(),{parentApp:this,collection:this._collection,matrixConfigCollection:this._matrixConfigCollection,trendConfig:this._trendConfig,trendChartConfig:this._trendChartConfig,trendTemplate:this._trendTemplate,viewConfig:this._viewConfig,nlsTrend:this._nlsTrend,appConfig:this._appConfig,tabConfig:this._tabConfig,isCreate:!1}),this.addScroller(),this._appContainer},addScroller:function(){let e=this.gridViewContent;if(this.getHeight()){e.setStyle("height",this.getHeight()+"px"),new i({element:e}).inject(this._appContainer.getElement("#gridViewContainer"))}},loadData:function(){this.reset(),this.treeDocument&&this.treeDocument.resetTreeDocumentEvents(),this.treeDocument=this._collection.getDocument(),this.treeDocument&&(this.updateImpactProbabiltyConfig(),this._ignoreCheckBoxSelection=this._listConfig.ignoreCheckBoxSelection,this.dataGrid=new s({container:this.gridViewContent,treeDocument:this.treeDocument,config:this._listConfig,gridOptions:{placeholder:d.NO_OBJECT_FOUND,onSortChange:this.fetchDataModelsForSorting.bind(this),lazyLoadingCallBack:!this._doNotApplyLazyLoading&&this.fetchLazyLoadingDataModels.bind(this),onContextualEvent:!this._doNotShowContextualMenu&&this.getGridContextualMenu.bind(this)}}),this.initializeEvents(),this.handlePropertyPanelSelection(),this.disableMassUpdateButton())},handlePropertyPanelSelection:function(){if(this.detailsAndRelationships.isPropertyPanelOpen()&&this._collection.getDataModelsCount()){let e=this.treeDocument.getPreviousSelectedNodeModel();this.treeDocument.clearPreviousSelectedNodeInfo(),e?(this.dataGrid.removeSelection(e),e.select()):this._collection.selectDataModel(0)}else this.showHideRightPanel(!1)},fetchLazyLoadingDataModels:function(e){this.fetchDataModels(e,{callback:this.onCompleteLazyLoadingDataModels.bind(this)})},fetchDataModelsForSorting:function(e,t,i){this.fetchDataModels(t,{callback:i,fetchColumnName:e})},fetchDataModels:function(t,i){if(t.length){let n=this.dataGrid.getGridStatusBarContainer(),o=this._collection.collection.clone(),s=e.clone(i||{},!1);e.extend(s,{collection:o,paramData:t,onComplete:function(){s.callback&&(s.fetchColumnName?s.callback():s.callback.apply(this,arguments)),this.hideSpinnerView(n)}.bind(this),onFailure:this.hideSpinnerView.bind(this,n)}),o&&o.length&&(this.showSpinnerView(n,d.LOADING),this._collection.fetchAdditionalDataForModels(s))}},onCompleteLazyLoadingDataModels:function(e){e&&e.length&&e.forEach(e=>e.fetched=!0)},initializeEvents:function(){let e=this;this.treeDocument.getModelEvents().subscribe({event:"select"},function(t){e.disableMassUpdateButton(),e.rowShouldBeSelected(t.data.virtualRowID)?l.validateModificationsPending({parentView:e.parentApp,yesEventFunc:e.selectItem.bind(e),noEventFunc:e.handleRollbackSelection.bind(e)},t):e.setTaggerProxy()}),this.treeDocument.getModelEvents().subscribe({event:"unselect"},l.validateModificationsPending.bind(void 0,{parentView:this.parentApp,yesEventFunc:this.unselectItem.bind(this),noEventFunc:this.handleRollbackSelection.bind(this)})),this.dataGrid.addEvent("onDrop:assignees",l.validateModificationsPending.bind(void 0,{parentView:this.parentApp,yesEventFunc:this.handleDropOnColumn.bind(this)})),this.dataGrid.addEvent("invokeMaturityUpdate",l.validateModificationsPending.bind(void 0,{parentView:this.parentApp,yesEventFunc:function(){e.parentApp.dispatchEvent("invokeMaturityUpdate",arguments)}}))},rowShouldBeSelected:function(t){if(!e.is(t,"number")||t<0)return!1;let i=this.dataGrid.getSelectedColumnInfo();if(i&&!isNaN(i.rowID)&&this._ignoreCheckBoxSelection&&"rowHeader"===i.columnDataIndex)return;let n=this.treeDocument.getPreviousSelectedNodeRowId(),o=this.detailsAndRelationships._isPropertyPanelOpen;return n!==t||!o},updateImpactProbabiltyConfig:function(){let e,t=r.get("context");if(t){let i=t.get("configuration");if(i&&1===i.length){let t=this._matrixConfigCollection.getMatrixConfigDefinition(i[0]);e=t&&t.get("matrix")}}this._listConfig.updateImpactProbabiltyConfig(e)},showHideRightPanel:function(e){this.detailsAndRelationships.reset(),this.detailsAndRelationships._isPropertyPanelOpen=e,this.parentApp.showHideRightPanel(e),this.setTaggerProxy()},setTaggerProxy:function(){let e=this.parentApp.getTaggerProxy();e&&e.handleUserTags(this.treeDocument.getSelectedNodes())},loadMassUpdate:function(){this.dataGrid.showModelMassUpdateDialog()},selectItem:function(e){if("select"===e.event){let t=e.data,i=t&&t.nodeModel;i&&(this._leftPanelOnly?this.parentApp.showHideLeftPanel(!1):this.handleRowSelection(i))}},handleRowSelection:function(e){let t=this.treeDocument.getSelectedNodes().length>1;t||(r.get("isComponent")&&this.parentApp.dispatchEvent("xppClosePropertyPanel"),this.detailsAndRelationships.render(),this.treeDocument.previousSelectedNodeInfo=e),this.showHideRightPanel(!t)},unselectItem:function(){this.dataGrid.setActiveCell(-1),this.showHideRightPanel(!1),this.disableMassUpdateButton()},disableMassUpdateButton:function(){let e=this.treeDocument.getSelectedNodes().length;this.parentApp.disableMassUpdateButton(!e)},handleRollbackSelection:function(){let e=this.treeDocument.getPreviousSelectedNodeModel();e&&(this._collection.unselect(),e.select())},destroy:function(){this.reset(),this._collection.destroy(),this._appContainer&&this._appContainer.destroy()},getHeight:function(){return this.height=this.height||this.parentApp.getHeight(),this.height},setHeight:function(e){if(this.height=e,this._appContainer){let e=this.gridViewContent;e&&e.setStyle("height",this.height+"px"),this.detailsAndRelationships.setHeight(this.parentApp.height)}},isHidden:function(){return this._appContainer&&this._appContainer.isHidden()},show:function(){this._appContainer&&this._appContainer.show()},hide:function(){this._appContainer&&this._appContainer.hide()},handleGridViewActions:function(t,i,n){let o=e.clone(n||{},!1),s=o.rowView,l=o.treeNodeModel,r=o.isSelectedNode,c=o.cloneModelToSave;if(i===a.DELETE)this.detailsAndRelationships.handleDeleteAction({isSelect:Boolean(r),treeNodeModel:l,callback:this.hideSpinnerView.bind(this,s)});else{let n={onComplete:this.hideSpinnerView.bind(this,s),onFailure:this.hideSpinnerView.bind(this,s)};c.handleAttrsUpdateForActions(i,t,n),r||c.hasEvent("submitSave")||(e.extend(n,{isSelect:Boolean(r),treeNodeModel:l}),this._collection.saveDataModel(c,n))}},getPersonObjectName:function(e){let t=e.objectId;return-1===t.indexOf("iam:")?e.displayName:t.substr(t.indexOf(":")+1)},processDropData:function(t,i,o){let s,a,r=this,c=e.clone(o||{},!1),h=t.data.items,u=h.length;if(u){let e=this.hideSpinnerView.bind(this,c.rowView);if(l.validateDroppedObjects(h,this._membersConfig.columnInfo.assignees,e))return}let m={},g=[],p=[],C=c.treeNodeModel.options.data.model,f=C.get(i);for(s=0;s<u;s++){let e=(a=h[s]).objectId,t=l.alreadyHasObjectInRelatedData(f,e);if(t){let e=t.displayType||t.objectType;m[e]||(m[e]=[]),m[e].push(t.displayName);continue}let i=this.getPersonObjectName(a),n=l.getPersonObjectInfo(i);n.getCESStamp()?g.push(n):p.push(n)}let D=g.length,M=p.length;if(M){p[M-1].addEventOnce("onSync",function(){r.handleGridViewActions(g.concat(p),i,c)})}else D&&this.handleGridViewActions(g,i,c);Object.keys(m).length&&(n.showSingleErrorMessageForDataObjects(m,d.OBJECT_ALREADY_ASSOCIATED,C.get("title")),this.hideSpinnerView(c.rowView))},handleDropOnColumn:function(e,t,i,o){let s=i.options.data;if(!s.model.canModify())return void n.buildNotification({message:d.NO_MODIFY_ACCESS},"error");this.showSpinnerView(o);let a=this.detailsAndRelationships.currentModel,l=a&&a.id===s.id?a:s;e&&this.processDropData(e,t,{rowView:o,treeNodeModel:i,cloneModelToSave:l})},getGridContextualMenu:function(e){this.treeDocument.getSelectedNodes().length>1&&this.dataGrid.unselectAll();let t=[],i=this;e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e));let n=e.cellInfos;if(n&&n.rowID>-1){let e,o,s,r=n.nodeModel,c=r.options.data,d=this.detailsAndRelationships.currentModel,u=d&&d.id===c.id,m=u?d:c;if(!c.model.fetched)return t;let g=this.dataGrid.getViewByRowID(n.rowID),p=this.dataGrid.getColumnDataIndex(n);if(p===a.ASSIGNEE_ATTR){let t=this.dataGrid.getDataIdFromEvent(event);(s=c.get(p))&&(e=s.length,o=t&&s.get(t))}let C=l.validateModificationsPending.bind(void 0,{parentView:this.parentApp,yesEventFunc:function(e){m&&m.cancel();let t=e.context;!h.includes(t.name)&&i.showSpinnerView(g),i._handleGridContextMenuActions(t,{rowView:g,personModel:o,treeNodeModel:r,isSelectedNode:u,cloneModelToSave:m})}});t=this._appConfig.gridDropDownItems.getItems(m,{callback:C,assignModel:o,isSelectedNode:u,isAssignColumn:e})}return t},_handleGridContextMenuActions:function(t,i){let n=this,o=e.clone(i||{},!1),s=o.personModel,c=o.treeNodeModel,d=t.groupName||t.name;switch(d){case a.EDIT:this.dataGrid.unselectAll(),c.select();break;case a.DUPLICATE:e.extend(o,{operation:d,isSelect:Boolean(o.isSelectedNode)}),this._collection.duplicateDataModels(o);break;case a.STATE_ATTR:this.handleGridViewActions(t.name,d,o);break;case a.ASSIGN_TO_SELF:this.handleAssignToSelfAction(function(e){n.handleGridViewActions(e,d,o)});break;case a.REMOVE_ASSIGN_TO_SELF:this.handleGridViewActions(r.get("user"),d,o);break;case a.RELATIONS:l.launchApp(a.RELATIONS_WIDGET_APP_ID,c.model);break;case a.DELETE:this.handleGridViewActions("",d,o);break;case a.REMOVE_ASSIGNEE:s?this.handleGridViewActions(s,d,o):this.handleRemoveAllAssigneesAction({title:c.options.data.title,callback:this.handleGridViewActions.bind(this,"",d,o)})}},handleRemoveAllAssigneesAction:function(t){let i=e.clone(t||{},!1),o=i.title,s=i.callback,a={dontResetModel:!0,parentView:this.parentApp,title:d.REMOVE_ALL,message:d.replace(d.DELETE_ASSIGNEE_CONFIRM_MSG,{title:o}),yesEventFunc:s,noEventFunc:this.hideSpinnerView,yesLabel:d.YES,noLabel:d.NO};n.confirmDialog(a)},handleAssignToSelfAction:function(e){let t=l.getPersonObjectInfo(r.get("user"));t.getCESStamp()?e(t):t.addEventOnce("onSync",e.bind(this,t))},showSpinnerView:function(e,t){e&&o.showRowLoadingMessage(e,t||" ")},hideSpinnerView:function(e){o.hideRowLoadingMessage(e)}})}),define("DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtHeatMapChartUtil",["UWA/Core","UWA/Class","DS/ENOProjectMgmtCommonComponents/config/AppConfig","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils"],function(e,t,i,n){"use strict";return t.extend({_uwaClassName:"ProjectMgmtHeatMapChartUtil",emptyHeatMapInfo:void 0,heatMapChartArray:void 0,resetChartData:function(){this.heatMapChartArray=e.clone(this.heatMapChartArray||{}),this.severity=e.clone(this.severity||{})},init:function(e){this.options=e||{},this.chartConfig=this.options.chartConfig||{},this.matrixConfig=this.options.matrixConfiguration,this.isMatrixSettingVeiw=this.options.matrixSettingVeiw,this.heatMapChartArray=this.getHeatmapInfo(this.matrixConfig),this.heatMapChartArray&&this.resetChartData(),this.heatMapChartArray&&this.processHeatmapChart()},getHeatmapInfo:function(t){let i=this,o=t instanceof e.Class.Model?t.get("matrix"):t.matrix||t,s=this.parseMatrixData(o);this.severity=s.severity;let a=s.cells,l=this.getHeatMapAxisValues(s.Xaxis),r=this.getHeatMapAxisValues(s.Yaxis);l=[""].concat(l),r=r.concat(""),this.chartConfig.xAxis.title.text=s.Xaxis.displayValue,this.chartConfig.xAxis.categories=l,this.chartConfig.yAxis.title.text=s.Yaxis.displayValue,this.chartConfig.yAxis.categories=r;let c=[];a&&a.forEach(function(e){let t=e.cellId||"",o=e.Xvalue,s=e.Yvalue,a=e.riskLevel,l=e.rpn,r=o+s,d=i.isMatrixSettingVeiw?l:" ",h=n.findObject(i.severity,"actualValue",a),u=h&&h.actualValue,m=h&&h.backgroundColor,g=h&&h.textColor;c.push({cellId:t,riskLevel:u,Xvalue:o,Yvalue:s,y:1,x:Number(o),color:m,cellCount:0,matrixXY:r,dataLabels:{color:g,format:d,useHTML:!1}})}),c.sort(function(e,t){return e.matrixXY-t.matrixXY});let d=[];return d.push({data:c}),d},getHeatMapAxisValues:function(e){let t=[],i=e.nodes;return i&&i.forEach(function(e){t.push(e.displayValue)}),t},processHeatmapChart:function(){this.chartConfig.series=this.heatMapChartArray},parseMatrixData:function(e){if(e&&!e.parsed){let t=e.Xaxis,i=e.Yaxis,n=e.severity,o=e.cells,s=this.getMatrixSeverityValues(n);return{cells:o,Xaxis:this.getMatrixAxisValues(t),Yaxis:this.getMatrixAxisValues(i),severity:s,parsed:!0}}return e},getMatrixSeverityValues:function(e){let t=[];return e&&e.length&&e.forEach((e,i)=>{e.severityIndex=i;let o=n.getSeverityItem(e);t.push(o)}),t},getMatrixAxisValues:function(e){return{actualValue:e.name,displayValue:e.nls[widget.lang]||e.name,nodes:n.formatRangeValuesForSelectView(e.nodes,"value",n.getconcatenatedActualDisplayValue)}}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtObjectCardView",["UWA/Core","DS/E6WCommonUI/Views/ObjectCardView","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a){"use strict";return t.extend({setDropdownMenu:function(){let e=this.options.homeView;e&&(e.dropdown=this.dropdownMenu)},createMenuButtons:function(t){let i=e.clone(t||{},!1);i.zIndex=1050;let n=this._parent(i);this.setDropdownMenu();let s=i.model;if(s&&!s.isPersonType()){let e=i.options.homeView,t=e&&e._viewConfig;o.addOpenMenuItem(this.dropdownMenu,s,t)}return n},getDropDownMenuItems:function(e,t){let i=this._parent(e,t),n=o.getRelationsButton(t);return n&&i&&i.length&&i.push(n),this.addHiddenClassNamesToMenuItems(i,t),i},addHiddenClassNamesToMenuItems:function(t,i){let n=this,o=e.clone(i||{},!1),s=o.model,a=o.options&&o.options.config;t.forEach(function(e){e.className=s||(n.model.isNew||n.model.modificationsPending)&&"propertiesButton"!==e.name?e.className||"":"disabled",e.className+=e.className&&e.className.contains("disabled")&&"propertiesButton"!==e.name||"remove-button"===e.name&&!a.showRemoveMenuItem&&a.singleObjectOnly?" hidden":""})},processDropData:function(){this._options.errObjs={},this._parent.apply(this,arguments);let e=this._options.errObjs;Object.keys(e).length&&s.showSingleErrorMessageForDataObjects(e,a.OBJECT_ALREADY_ASSOCIATED,this.model.get("title")||a.NEW_OBJECT),delete this._options.errObjs}})}),define("DS/ENOProjectMgmtCommonComponents/config/MembersConfig",["DS/ENOProjectMgmtModels/Collections/Persons","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtObjectCardView","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s){"use strict";return i.extend({_uwaClassName:"MembersConfig",columnInfo:{},type:"members",setup:function(){this.setColumnInfo()},values:[{readWrite:"true",name:"assignees",label:s.ASSIGNEES,attributeToDisplay:"fullName",imageAttribute:"image",type:"person",singleObjectOnly:!1,typeAheadCallback:e.typeAheadCallback,customView:n,linkCallback:o.launchProperties,placeHolder:s.SEARCH_PLACEHOLDER_TEXT,excludePendingUser:!0,validateSameTenant:!0},{readWrite:"true",name:"ownerInfo",label:s.OWNER,attributeToDisplay:"fullName",imageAttribute:"image",type:"person",singleObjectOnly:!0,typeAheadCallback:e.typeAheadCallback,customView:n,linkCallback:o.launchProperties,placeHolder:s.SEARCH_PLACEHOLDER_TEXT,excludePendingUser:!0,validateSameTenant:!0}],getAssigneesCustomButtons:function(){return i.assigneesCustomButtons}})}),define("DS/ENOProjectMgmtCommonComponents/components/PopupCommon",["UWA/Core","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Utilities/Dom","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a){"use strict";let l={_uwaClassName:"PopupCommon",_getDefaultAttributes:function(){return this.destroyImmersiveFrame(),this.immersiveFrame=new t({}),{immersiveFrame:this.immersiveFrame,minHeight:200,minWidth:500,modalFlag:!0,resizableFlag:!0,container:widget.body,height:widget.body.clientHeight,title:a.CREATE_TITLE}},handleFooterButtonEvents:function(e){let t=e.dsModel.value,i=this.getContentView();"Save"===t?i&&i.save():this.close()},close:function(t){let i=e.clone(t||{},!1),n=this.getContentView();n&&(n.destroy(),n.stopListening());let o=this.getDialogView();this.beforeCloseCallBack&&this.beforeCloseCallBack(),o.realClosefunc(),this.destroyImmersiveFrame(),!i.dontClearAlertMessages&&s.clearNotificationMessages()},destroyImmersiveFrame:function(){this.immersiveFrame&&(this.immersiveFrame.destroy(),delete this.immersiveFrame)},getContentView:function(){return this.getDialogView().contentView},_getDefaultFooterButtons:function(e){return e&&e.doNotshowDefaultButtons?{Close:new n({domId:"closeBtn",label:e&&e.closeButtonLabel||a.CLOSE,emphasize:"secondary",onClick:this.handleFooterButtonEvents.bind(this)})}:{Save:new n({domId:"saveBtn",label:e&&e.saveButtonLabel||a.CREATE,emphasize:"primary",onClick:this.handleFooterButtonEvents.bind(this),disabled:!0}),Cancel:new n({domId:"cancelBtn",label:a.CANCEL,emphasize:"secondary",onClick:this.handleFooterButtonEvents.bind(this)})}},createDialog:function(t){let n=e.clone(t||{},!1),o=this._getDefaultAttributes();e.extend(o,n);o.container;let s=o.contentView;this.immersiveFrame=o.immersiveFrame;let a=new i({height:o.height,immersiveFrame:this.immersiveFrame,width:o.minWidth,minWidth:o.minWidth,minHeight:o.minHeight,modalFlag:o.modalFlag,onContextualEvent:Function.prototype,activateButtonsIfActionPerformed:!1,resizableFlag:o.resizableFlag,title:n.title||o.title,content:o.content||s.render(),buttons:o.buttons||this._getDefaultFooterButtons(t)});return this.immersiveFrame.inject(o.container),a.contentView=s,this.setDialogView(a),this._registerEvents(),this.beforeCloseCallBack=n.beforeCloseCallBack,a},_registerEvents:function(){let e=this.getDialogView();e.realClosefunc=e.close,e.close=this.close.bind(this);let t=this.getContentView();t&&t.listenTo(widget,"onResize",function(){e.setAbsolutePosition({x:e.getAbsolutePosition().x,y:1}),e.height=widget.body.clientHeight})},setParentView:function(e){this._parentView=e},getParentView:function(){return this._parentView},setDialogView:function(e){this._dialogView=e},getDialogView:function(){return this._dialogView}},r=i.prototype.handleEvents;return i.prototype.handleEvents=function(){o.addEventOnElement(this,this.elements.container,"keyup",function(e){13===e.keyCode&&(e.actionPerformed=!0)}),r.apply(this,arguments)},l}),define("DS/ENOProjectMgmtCommonComponents/config/HeatMapChartConfig",["DS/ENOProjectMgmtCommonComponents/config/AppConfig","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t){"use strict";return{_uwaClassName:"HeatMapChartConfig",goalPatternPath:"M 0 0 L 10 10 M 9 -1 L 11 1 M -1 9 L 1 11",goalPatternStrokeWidth:"4",goalXAxisField:"impactGoal",goalYAxisField:"probabilityGoal",xAxisField:"impact",yAxisField:"probability",rpnIcon:"fonticon-check",goalIcon:"fonticon-status-empty",overlappingIcon:"fonticon-status-ok",goalPatternOpacityValue:"0.80",chart:{type:"column",spacingBottom:0,spacingTop:-15,spacingLeft:0,spacingRight:0,plotBackgroundColor:null},exporting:!1,credits:!1,title:!1,xAxis:{lineWidth:0,tickLength:0,categories:void 0,title:{text:t.IMPACT,style:{fontWeight:"bold",color:e.ChartsColor.BLUE4_COLOR}},labels:{y:0},tickMarkPlacement:"off"},yAxis:{gridLineColor:"#fff",categories:void 0,width:"50px",title:{text:t.PROBABILITY,style:{fontWeight:"bold",color:e.ChartsColor.BLUE4_COLOR}},labels:{y:-13,style:{width:"110px",overflow:"hidden",textOverflow:"ellipsis"}}},tooltip:{enabled:!1},plotOptions:{series:{animation:!1,showInLegend:!1,pointPadding:0,groupPadding:0},column:{stacking:"normal",cursor:"pointer",dataLabels:{enabled:!0,style:{fontFamily:"Arial",fontSize:"15px",textOutline:"none"}}}},series:void 0}}),define("DS/ENOProjectMgmtCommonComponents/utils/MassUpdateCloneModel",["UWA/Core","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel"],function(e,t,i){"use strict";return i.extend({_uwaClassName:"MassUpdateCloneModel",isMassUpdate:!0,validate:function(e,t){let i=!0,n={fields:[],messages:{}};return this.getDateFieldValue("effectiveDate",e)||(i=!1,n.fields.push("effectiveDate")),i=i&&this.validateStartEndDates(e,n,t),this.dispatchEvent("disableSaveButton",!i),i?this.dispatchEvent("onValidationSuccess")&&void 0:n},set:function(t,i,n){return"select"===e.clone(n||{},!1).type&&(i&&e.is(i,"object")&&(i=i.actualValue),arguments[1]=i),this._parent.apply(this,arguments)},get:function(e){let i=this._parent.apply(this,arguments);if(i)switch(e){case"effectiveDate":case"actualStartDate":case"actualFinishDate":case"estimatedStartDate":case"estimatedFinishDate":i=i&&t.getIntlDateFormat(i.actualValue||i)}return i}})}),define("DS/ENOProjectMgmtCommonComponents/components/TaggerProxy",["UWA/Core","UWA/Promise","UWA/Class/Events","UWA/Class/Listener","UWA/Class/Collection","DS/TagNavigatorProxy/TagNavigatorProxy","DS/ENOProjectMgmtModels/Collections/Tags","DS/ENOProjectMgmtModels/Models/Tag","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils"],function(e,t,i,n,o,s,a,l,r,c){"use strict";return i.extend(n,{_uwaClassName:"TaggerProxy",collection:void 0,tnProxy:void 0,tags:void 0,taggerData:void 0,init:function(t,i){let n=e.clone(i||{},!1);this.tnProxy=n.tnProxy,this.collection=t},getTagPostData:function(){let e,t=this.collection;return t&&t.length&&t.forEach(function(t){e?e+=","+t.get("id"):e=t.get("id")}),e},loadTagData:function(i){let n=this,o=e.clone(i||{},!1);return new t(function(e,t){n.tags=new a;let i=n.getTagPostData();if(!i||""===i)return n.setTNProxy(),e();n.tags.fetch({idList:i,onComplete:function(t){if(o.isSeverityExistsInTagger){let e=r.get("context");t&&t.forEach(function(t){let i=n.collection.get(t.id);i&&t.updateSeverityTag(i,e)})}n.setTNProxy(t),e()},onFailure:function(e,i){t(i)}})})},setTNProxy:function(e){this.register(),e&&e.length?this.drawTags(e):this.drawTags([])},drawTags:function(e){let t=this.buildTagObjectData(e);this.setTaggerData(t)},setTaggerData:function(e){this.tnProxy&&e&&(this.tnProxy.setSubjectsTags(e,"prjMgmtTagSubjects"),this.taggerData=e)},getItemId:function(e){return"pid://"+e.id},buildTagObjectData:function(e){let t={},i=this;return e.forEach(function(e){let n=i.buildItemData(e),o=i.getItemId(e);t[o]=n}),t},buildItemData:function(e){let t="_tag_implicit_".length,i="_tag__".length,n=[];try{e.keys().forEach(function(o){if("id"===o)return;let s,a="";-1===o.indexOf("_tag_implicit_")?s=i:(a="implicit",s=t);let l=e.get(o),r=o.substr(s),c=l.length;for(let e=0;e<c;e++){let t={object:l[e],dispValue:l[e],sixw:r,field:a};n.push(t)}})}catch(e){console.error("loadTagDataDone"+e)}return n},updateTagObject:function(e,i,n){let o=this,s=r.get("context");return new t(function(t,a){let r=o.tags.get(e.get("id"));if(i){if(r){o.tags.remove(r);let e=o.getItemId(r);delete o.taggerData[e],o.setTaggerData(o.taggerData)}t()}else r||((r=new l(r)).set("id",e.get("id")),o.tags.add(r)),r&&r.updateTagger(o,e,n,s),t()})},updateMappedTagObjects:function(e){let t=this,i={"_tag_implicit_ds6w:what/ds6w:heatMap":"mappedMatrixXY","_tag_implicit_ds6w:why/ds6w:fulfills/ds6w:severity":"mappedSeverity"};e&&e.length&&e.forEach(function(e){let n=e.options.data.model,o=t.tags.get(n.get("id"));o&&o.updateMatrixTag(n,i)}),this.drawTags(this.tags)},updateTagData:function(e){let t=this.buildItemData(e),i=this.getItemId(e);this.taggerData[i]=t,this.subjectChangedRequired=!1,this.setTaggerData(this.taggerData)},handleFocusOnSubjects:function(e){if(this.tnProxy)if(e&&e.length){let t=[],i={};e.forEach(e=>{t.push("pid://"+e),i[e]="3DSpace"}),this.focusOnSubjects(t,!0,i)}else this.unfocus()},focusOnSubjects:function(){this.tnProxy.focusOnSubjects.apply(this.tnProxy,arguments)},unfocus:function(){this.tnProxy.unfocus.apply(this.tnProxy,arguments)},set6WFilterOptions:function(e,t){if(this.tnProxy){let i={};i[e]=[{disptext:t,object:t,type:"string",field:["implicit"]}],this.setLocalFilter(i,!0)}},setLocalFilter:function(t,i){e.is(t,"object")&&this.tnProxy&&(this.subjectChangedRequired=!0,this.tnProxy.setLocalFilter(t,i))},subjectChanged:function(e){this.collection&&!e.dontCacheFilters&&this.dispatchEvent("onSubjectChanged",[e])},register:function(){let e=this;if(this.tnProxy)this.collection&&(this.tnProxy.removeEvent("onFilterSubjectsChange"),this.tnProxy.addEvent("onFilterSubjectsChange",this.subjectChanged.bind(this)));else if(!r.get("isComponent")){let t=r.get("widgetId"),i=r.get("tenant"),n={widgetId:t,contextId:t?void 0:"context1",tenant:"onpremise"===i?void 0:i,filteringMode:"WithFilteringServices",colorize:!0};this.tnProxy=s.createProxy(n),this.tnProxy.addEvent("onFilterSubjectsChange",this.subjectChanged.bind(this),this.collection),window.onunload=function(){e.tnProxy&&e.tnProxy.die()}}},handleUserTags:function(t){let i;t&&(i=e.is(t,"array")?t.length&&c.getAttributeValues(t,"id"):[t]),this.handleFocusOnSubjects(i)},destroy:function(){this.tnProxy&&(this.tnProxy.die(),this.tnProxy=null)}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtFileChooserCustomView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/Tweakers/TweakerBlob","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/ENOProjectMgmtModels/Models/MatrixConfiguration","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtModels/Models/AppSettings","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r){"use strict";return t.extend({supportedFormats:["json"],buttonGroup:void 0,toggle:void 0,setup:function(e){this.options=e,this.fieldConfig=e&&e.config,this.homeView=e&&e.homeView.parentApp,this._parent(e)},render:function(){this.container.empty(!0),this.container.addClassName("inline"),this.importLabel=new e.createElement("label",{text:this.fieldConfig.label}),this.container.appendChild(this.importLabel),this.buttonGroup=new o({type:"radio"});let t=!!this.model.get("id"),s=new n({type:"radio",label:r.CREATE_NEW_LABEL,value:0,checkFlag:!t}),a=new n({type:"radio",label:r.REPLACE_EXISTING,value:1,checkFlag:t});return this.buttonGroup.addChild(s),this.buttonGroup.addChild(a),s.addEventListener("change",this._parentView.options.homeView.handleButtonGroupValueChange.bind(this._parentView.options.homeView)),a.addEventListener("change",this._parentView.options.homeView.handleButtonGroupValueChange.bind(this._parentView.options.homeView)),this.buttonGroup.inject(this.container),this._enableDisableButtons(),this.fileUploader=new i({placeholder:r.SELECT_FILE}).inject(this.container),this.fileUploader.addEventListener("change",this._fileFieldChange.bind(this)),this},_enableDisableButtons:function(){let e=l.get("isComponent"),t=this.buttonGroup.getButton(0),i=this.buttonGroup.getButton(1);t.disabled=!(!e&&this._parentView.options.homeView._canCreate()),i.disabled=!(!e&&(this.model.model.isNew()||this.model.model.canModify()))},getButtonGroup:function(){return this.buttonGroup},_fileFieldChange:function(e){var t=this;delete t.files;var i=e.dsModel.blob;if(i)if(t.files=e.dsModel,t.fileName=t.files._blobName,t._isValidFormat(e.dsModel._blobName)){let e=new FileReader;e.addEventListener("load",function(){try{let i=JSON.parse(e.result);if(t.model.model.isNew()||t.model.compareCell(t.model.get("matrix"),i.matrix)){t.model.set("title",i.title),t.model.set("rmcType",t.homeView._rmcType),t.model.validateMatirx(i)&&t.model.set("matrix",i.matrix)}else a.buildNotification({message:r.MATRIX_CONFIGURATION_FIELD_CHANGE_ERROR},"error"),t.model.dispatchEvent("disableSaveButton",!0)}catch(e){t.jsonError(e),t.model.dispatchEvent("disableSaveButton",!0)}}),e.readAsText(i)}else a.buildNotification({message:r.INVALID_FILE_FORMAT},"error")},_isValidFormat:function(e){var t=e.lastIndexOf("."),i=(t<1?"":e.substr(t+1)).toLowerCase();return void 0===this.supportedFormats||-1!==this.supportedFormats.indexOf(i)},jsonError:function(e){e=e.name+" : "+e.message,a.buildNotification({title:r.MATRIX_CONFIGURATION_ERROR,message:e,hideDelay:5e3},"error")}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtHeatMapCustomView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/ENOProjectMgmtCommonComponents/config/HeatMapChartConfig","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtHeatMapChartUtil","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Utils/StorageDataUtil","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r){"use strict";return t.extend({_uwaClassName:"ProjectMgmtHeatMapCustomView",options:{},riskHeatMapDiv:void 0,chartConfig:void 0,Highcharts:void 0,seriesArray:void 0,setup:function(t){let n=e.clone(t||{},!1);this.options=n,this.model=n.model,this.homeView=n.homeView,this.fieldConfig=n.config,this.chartConfig=e.clone(i||{}),this.seriesArray=this.chartConfig.series,this.Highcharts=o.get("highcharts"),this._parent.apply(this,arguments)},render:function(){let t=this;this.container.empty(!0);let i=this.fieldConfig.isMatrixSettingView;if(this.heatmapLabel=new e.createElement("label",{text:this.fieldConfig.label}).inject(this.container),this.riskHeatMapDiv=e.createElement("div",{class:"heatmap-details-panel"}).inject(this.container),this.riskHeatMapDiv.addEvent("resize",function(){t.heatMapChart&&t.heatMapChart.reflow()}),this.chartConfig.chart.renderTo=this.riskHeatMapDiv,i){this.listenTo(this.model,"onChangeImportFile",this.handleMatrixImportFile);let e=this.chartConfig.plotOptions.series.point;e&&(e.events.click=void 0),this.chartConfig.plotOptions.column.cursor=void 0,this.chartConfig.plotOptions.column.dataLabels.style.fontSize="10px",this.renderMatrixHeatMapPreview(i)}else this.listenTo(this.model,"onChange:rpnValue",this.handleRPNHeatMap),this.listenTo(this.model,"onChange:rpnValueGoal",this.handleRPNHeatMap),this.chartConfig.xAxis.labels.enabled=!1,this.chartConfig.xAxis.title.enabled=!1,this.chartConfig.yAxis.labels.enabled=!1,this.chartConfig.yAxis.title.enabled=!1,this.initializeClickEvent(),this.renderMatrixHeatMapPreview(),this.handleRPNHeatMap();return this},renderMatrixHeatMapPreview:function(t){let i=this.model.get("rmcId"),o=i&&this.homeView._matrixConfigCollection.getMatrixConfigDefinition(i)||this.model.get("matrix");if(e.is(o,"object")){let e={chartConfig:this.chartConfig,matrixConfiguration:o,matrixSettingVeiw:t};this.heatMapChartUtil=new n(e),this.renderHeatMapChart()}else this.container.empty(!0)},initializeClickEvent:function(){let e=this;this.chartConfig.plotOptions.series.point={events:{click:function(){e.model.model.isComplete()||(e.updateFieldViewByName("impact",this.Xvalue,!0),e.updateFieldViewByName("probability",this.Yvalue))}}}},updateFieldViewByName:function(e,t,i){let n=this._parentView.getFieldViewByName(e);if(n)if(n._config.doNotResetRelatedAttrs=i,widget.useUIKitSelect){let e=n._select.elementsList,i=a.findIndex(e,"valueItem",t.toString()),o=n._select.selectedIndex!==i;n._select.selectedIndex=i,o||n._selectDataEntry()}else{let e=n.getElement("select");e.value=t,n._selectDataEntry({target:e})}},handleRPNHeatMap:function(){let e=this.chartConfig.series?this.chartConfig.series[0].data:[],t=this.chartConfig,i=t.goalPatternPath,n=t.goalPatternStrokeWidth,o=t.goalXAxisField,s=t.goalYAxisField,a=t.xAxisField,l=t.yAxisField,r=t.rpnIcon,c=t.goalIcon,d=t.overlappingIcon,h=t.goalPatternOpacityValue,u=this.model.get(a),m=this.model.get(l),g=this.model.get(o),p=this.model.get(s);u&&m&&e.forEach(function(e){let t=e.color.pattern&&e.color.pattern.color||e.color;e.Xvalue<=g&&e.Yvalue<=p?e.color={pattern:{backgroundColor:t,path:{d:i,strokeWidth:n,stroke:t},width:10,height:10,opacity:h,color:t}}:e.color=t,e.Xvalue===u&&e.Xvalue===g&&e.Yvalue===m&&e.Yvalue===p?(e.dataLabels.useHTML=!0,e.dataLabels.format='<i class="fonticon '+d+'"></i> '):e.Xvalue===u&&e.Yvalue===m?(e.dataLabels.useHTML=!0,e.dataLabels.format='<i class="fonticon '+r+'"></i> '):e.Xvalue===g&&e.Yvalue===p?(e.dataLabels.useHTML=!0,e.dataLabels.format='<i class="fonticon '+c+'"></i> '):e.dataLabels.format=" "}),this.renderHeatMapChart()},renderHeatMapChart:function(){let e=this;this.Highcharts&&setTimeout(function(){e.heatMapChart=new e.Highcharts.Chart(e.chartConfig)},150)},handleMatrixImportFile:function(e){let t=e.isValid,i=e.errorMessage;t?this.render():(this.container.empty(!0),s.buildNotification({title:r.MATRIX_CONFIGURATION_ERROR,message:i,hideDelay:1e4},"warning"))}})}),define("DS/ENOProjectMgmtCommonComponents/config/MatrixSettingsViewConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtObjectCardView","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtFileChooserCustomView","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtHeatMapCustomView","DS/ENOProjectMgmtModels/Collections/SearchObjects","DS/ENOProjectMgmtModels/Utils/FederatedSearch","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l){"use strict";let r=e.extend({_uwaClassName:"MatrixSettingsViewConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"basic",values:[{label:l.IMPORT,name:"import",type:"text",customView:i},{label:l.TITLE,name:"title",type:"text",fields:"title,name,owner",include:"matrix,configuredItems",numberOfDisplayLines:1,numberOfEditableLines:1,removeCarriageReturns:!0,maxLength:128,validate:!0},{label:l.HEAT_MAP,name:"matrix",customView:n,isMatrixSettingView:!0},{readWrite:"true",label:l.WHERE_USED,name:"configuredItems",attributeToDisplay:"title",imageAttribute:"image",singleObjectOnly:!1,type:"object",validate:!0,fetchSource:"RiskContextInfo",typeAheadCallback:o.typeAheadCallback,customView:t,excludeSearchTypes:{"3dspace":["Task","Task Management"]},linkCallback:a.launchProperties,placeHolder:l.OBJECT_PLACEHOLDER,validateSameTenant:!0,fields:"riskCreateAccess",include:"configuration"},{label:l.COLLABORATIVE_SPACE,name:"projectTitle",type:"text",group:l.MORE},{label:l.OWNER,name:"ownerInfo",type:"person",imageAttribute:"image",attributeToDisplay:"fullName",customView:t,singleObjectOnly:!0,linkCallback:a.launchProperties,validateSameTenant:!0,group:l.MORE},{name:"rmcType"}]});return r._instance=r._instance||new r,r._instance}),define("DS/ENOProjectMgmtCommonComponents/views/DetailsDisplayFooter",["UWA/Class","DS/Controls/Button","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";return e.extend({_uwaClassName:"DetailsDisplayFooter",parentView:void 0,closeButton:void 0,saveButton:void 0,cancelButton:void 0,init:function(e,i){this.container=e,this.parentView=i,this.saveButton=new t({domId:"saveButton",label:n.SAVE,visibleFlag:!1,emphasize:"primary"}).inject(this.container),this.cancelButton=new t({domId:"cancelButton",label:n.CANCEL,visibleFlag:!1,emphasize:"secondary"}).inject(this.container),this.closeButton=new t({domId:"closeButton",label:n.CLOSE,visibleFlag:!0,emphasize:"secondary"}).inject(this.container),this.initialiseSaveEventChangeListener(),this.initialiseCancelEventChangeListener(),this.initialiseCloseEventChangeListener()},initialiseSaveEventChangeListener:function(){let e=this;e.saveButton.removeEventListener("buttonclick"),e.saveButton.label=n.SAVE,e.saveButton.getContent().addEventListener("buttonclick",function(){e.parentView.save()})},initialiseCancelEventChangeListener:function(){this.cancelButton.removeEventListener("buttonclick"),this.cancelButton.label=n.CANCEL,this.cancelButton.getContent().addEventListener("buttonclick",i.validateModificationsPending.bind(void 0,{dontResetModel:!0,parentView:this.parentView.parentApp.parentApp,yesEventFunc:this.parentView.cancelCreateOrEdit.bind(this.parentView)}))},initialiseCloseEventChangeListener:function(){let e=this;e.closeButton.removeEventListener("buttonclick"),e.closeButton.label=n.CLOSE,e.closeButton.getContent().addEventListener("buttonclick",function(){e.parentView.hideRightPanel()})},showSaveCancelFooter:function(e){e?(this.closeButton.visibleFlag=!1,this.saveButton.visibleFlag=!0,this.cancelButton.visibleFlag=!0):(this.closeButton.visibleFlag=!0,this.saveButton.visibleFlag=!1,this.saveButton.disabled=!1,this.cancelButton.visibleFlag=!1)},destroy:function(){this.container.classList.add("footerContainer"),this.saveButton.destroy(),this.cancelButton.destroy(),this.closeButton.destroy()}})}),define("DS/ENOProjectMgmtCommonComponents/components/CommonTreeDocument",["UWA/Core","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils"],function(e,t,i,n){"use strict";let o,s=["select","unselect","modelUpdate"],a=["/WEBAPP/undefinedPOST_ADD/","/WEBAPP/undefinedPOST_REMOVE/"],l=t.extend({_uwaClassName:"CommonTreeDocument",init:function(t){let i=e.clone(t||{},!1);this.config=i.config,this.viewCollection=i.viewCollection,this._parent.apply(this,arguments),i.prepareUpdate&&this.prepareUpdate(),!i.doNotApplyNodeExpand&&this.initializeEvents()},handleExpandNodeModel:function(e){let t=this,i=e.data.nodeModel;if(i.hasChildrenFetched)e.target.preExpandDone();else{this.prepareUpdate();let n=i.model;n&&this.viewCollection.getDataModels({model:n,expandCall:!0,paramData:[n],collection:this.viewCollection.collection.clone(),onComplete:function(){t.pushUpdate(),e.target.preExpandDone(),i.hasChildrenFetched=!0,t.viewCollection.updateCacheAndTaggerData(n,{childrenTaggerUpdate:!0})}})}},initializeEvents:function(){this.onPreExpand(this.handleExpandNodeModel.bind(this))},getNodeModelsLength:function(){let e=this.getAllDescendants();return e&&e.length||0},getNodeModels:function(){return this.getNodeModelsLength()&&n.getAttributeValues(this.getAllDescendants(),"model")||[]},getNonCachedNodeModels:function(){return this.getNodeModelsLength()&&n.filterObjects(this.getAllDescendants(),"cached",void 0)||[]},getNonCachedModels:function(e){let t=this.getNonCachedNodeModels().map(e=>e.model);return t.length&&n.filterObjects(t,e,["",void 0,null])||[]},getSelectedNodeModels:function(){return this.getNodeModelsLength()&&n.getAttributeValues(this.getSelectedNodes(),"model")||[]},getNodeModelLabel:function(e,t){return(t=t||this.config).tree&&e.get(t.tree.key)||e.get("name")},createTreeNodeModel:function(t,n){let o,s=e.clone(n||{},!1),a=s.isExpand,l=s.parentNode||this;try{if(a)l.addChild({}),l.expand();else{let e=s.isNew,n=s.config,a=s.isSelect,r=s.attributes,c=t.model.hasChildren(),d=t.get("image")||t.get("typeicon");(o=new i({data:t,id:t.id,icons:[d],grid:r,label:this.getNodeModelLabel(t,n),children:c?[]:void 0})).cached=Boolean(e),o.model.fetched=Boolean(e),l.addChild(o,0),a&&o.select(),t.model.isExpanded&&o.expand()}}catch(t){e.log(t)}return o},copyChildNodes:function(e,t){let i,n,o=e.getChildren();o&&o.forEach(e=>{i=e.options,n=this.createTreeNodeModel(i.data,{isSelect:!1,config:this.config,parentNode:t,attributes:i.grid}),this.copyChildNodes(e,n)})},sort:function(){this._getRealTrueRoot().sortChildren(),this.getRoots().forEach(e=>{e.sortChildren()})},updateSortAndExpandAll:function(){this.pushUpdate(),this.sort(),this.expandAll()},getSelectedNode:function(e){let t=this.getSelectedNodes(),i=t.length;if(i)return t[e||i-1]},selectNodeByRowId:function(t){let i;if(e.is(t,"number")&&t>-1){let e=this.getAllDescendants();i=e&&e[t]}else i=this.getSelectedNode(t);i&&(i.isSelected()&&i.unselect(),i.select())},selectNodeById:function(e){let t=this.getTreeNodeModelById(e);t&&t.select()},getTreeNodeModelById:function(e){let t=this.getAllDescendants();return e&&t&&t.find(function(t){return t.id===e})},getPreviousSelectedNodeInfo:function(){return this.previousSelectedNodeInfo},getPreviousSelectedNodeId:function(){let e=this.getPreviousSelectedNodeInfo();return e&&e.id},getPreviousSelectedNodeRowId:function(){let e=this.getPreviousSelectedNodeInfo();return e&&e.rowID},getPreviousSelectedNodeModel:function(){let e=this.getPreviousSelectedNodeId();return e&&this.getTreeNodeModelById(e)},clearPreviousSelectedNodeInfo:function(){this.previousSelectedNodeInfo=!1},resetPreviousSelectionNodeModel:function(){let e=this.getTreeNodeModelById(this.getPreviousSelectedNodeId());e&&e._options.data.cancel()},resetTreeDocumentEvents:function(){let e=this.getModelEvents();e&&s.forEach(t=>{e.unsubscribeAll({event:t})});let t=this.getXSO(),i=t&&t._modelEvents;i&&a.forEach(e=>{let t=i._pubsub.topics[e],n=t.length;i._pubsub.topics[e]=t.slice(0,n-1)})}});return Object.defineProperty(i.prototype,"id",{get:function(){return this._options.id}}),Object.defineProperty(i.prototype,"model",{get:function(){return this._options.data.model}}),Object.defineProperty(i.prototype,"config",{get:function(){return this.getTreeDocument().config}}),Object.defineProperty(l.prototype,"previousSelectedNodeInfo",{get:function(){return o},set:function(e){o=e&&{id:e.options.id,rowID:e._rowID}}}),i.prototype.getNodeModelLabel=l.prototype.getNodeModelLabel,l}),define("DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection",["UWA/Core","UWA/Class/Model","UWA/Promise","UWA/Class/Collection","DS/ENOProjectMgmtModels/Models/SaveModels","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/RelatedDataItem","DS/ENOProjectMgmtModels/Models/FieldsDefinition","DS/ENOProjectMgmtModels/Utils/FederatedSearch","DS/ENOProjectMgmtModels/Utils/StorageDataUtil","DS/ENOProjectMgmtModels/Collections/RelatedDataItems","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/MassUpdateCloneModel","DS/ENOProjectMgmtCommonComponents/components/TaggerProxy","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/components/CommonTreeDocument","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g,p,C,f){"use strict";return t.extend({_uwaClassName:"ProjectMgmtViewCollection",treeDocuments:{},setup:function(e){this.DataModels=e.DataModels,this.DataModel=e.DataModel,this.AppConfig=e.AppConfig,this.PropertiesConfig=e.PropertiesConfig,this.TabConfig=e.TabConfig,this.TabConfigForCreate=e.TabConfigForCreate,this.ListConfig=e.ListConfig,this.CloneModel=e.CloneModel,this.governingType=e.governingType,this.governingTypeNLS=e.governingTypeNLS,this.NLS=e.NLS,this.tabConfigForMassUpdate=e.tabConfigForMassUpdate,this.massUpdateCloneModel=e.massUpdateCloneModel||m},getDocument:function(e,t){return e?(this.treeDocuments[e]&&!t||(this.treeDocuments[e]=new C({prepareUpdate:!0,viewCollection:this,config:this.ListConfig.columnInfo}),this.treeDocuments[e].copyChildNodes(this.treeDocument),this.treeDocuments[e].updateSortAndExpandAll()),this.treeDocuments[e]):this.treeDocument},resetCollection:function(e){this.treeDocument&&this.treeDocument.destroy(),this.collection&&this.collection.reset(),this.collection=e||new this.DataModels,this.treeDocument=this.createTreeDocumentForCollection(e)},resetTreeDocument:function(t){let i=this,n=e.clone(t||{},!1),o=n.view&&this.treeDocuments[n.view]||this.treeDocument;o&&o.empty(),n.collection&&(this.collection=n.collection),o=this.createTreeDocumentForCollection(this.collection),t&&t.addChild?(n.onComplete=function(e){t&&t.view?(i.treeDocuments[t.view]=e,t.onComplete(i.treeDocuments[t.view])):(i.treeDocument=e,t.onComplete(i.treeDocument))},this._fetchChildDetails(o,n)):n.view?i.treeDocuments[n.view]=o:i.treeDocument=o},getCurrentNode:function(e,t){let i=this.getDocument(t);return i&&i.getSelectedNode()},getCurrentDataModel:function(e,t){let i=this.getCurrentNode(e,t);return i&&i.options.data},getDataModelsCount:function(e){let t=this.getDocument(e);return t?t.getNodeModelsLength():this.collection?this.collection.length:0},getCollection:function(){return this.collection},getModelsCountWithInvalidConfig:function(){let e=this.treeDocument.getChildren(),t=e&&e.length&&e.filter(function(e){let t=e.options.data.model;return"FALSE"===(t.validConfiguration||t.get("validConfiguration"))});return t&&t.length},getModelsCountWithInvalidConfigForContext:function(){let e=this.treeDocument.getChildren(),t=e&&e.length&&e.filter(function(e){let t=e.options.data.model,i=t.contextValidConfiguration||t.get("contextValidConfiguration"),n=t.validConfiguration||t.get("validConfiguration");return"FALSE"===i&&"TRUE"===n});return t&&t.length},reselectCurrentDataModel:function(){if(!this.treeDocument)return;this.treeDocument.resetPreviousSelectionNodeModel();let e=this.getCurrentNode();e&&this.selectDataModel(void 0,e)},selectDataModel:function(e,t){t?(this.unselect(),t.select()):this.treeDocument.selectNodeByRowId(e)},getNewDataModel:function(t,i){let n=e.clone(i||{},!1),o=new this.DataModel;o.setTempId();let s={model:o,isMassUpdate:n.isMassUpdate,config:t&&t.columnInfo};return this.createClonedModel(s)},setFieldsFromConfig:function(e,t,i,n,o){let s=t.dataIndex&&"tree"===t.dataIndex?t.key:t.dataIndex||t.name;if(e.isNew()||void 0===e.get(s)||null===e.get(s))if(t.defaultValue)i?i[s]=t.defaultValue:e.set(s,t.defaultValue);else if(i&&t.readWrite)i[s]="";else{!e.get(s)&&e.set(s,"")}else if(n){let i=e.get(s),a=t.typeRepresentation;if(a&&(n[s]=this.getTypeRepresentationValue(a,i)),void 0===n[s])if(t.mapFromRangeValue){let e;if(e=o?l.getFieldServiceColumn(this.fieldDefinitionSource,o,s):l.getFieldDefinitionColumn(this.fieldDefinitionSource,s)){let t=e.fieldDefinitionRangeItem[i].display;n[s]=t}else n[s]=i}else n[s]=i}},getTypeRepresentationValue:function(t,i){let n;switch(t){case"string":n=i instanceof e.Class.Collection?u.getAttributeValues(i,"title")||"":i;break;case"number":n=Number(i);break;case"progress":n=parseInt(i)}return n},createModelFields:function(e,t,i,n,o){for(let s in t)e.isNew()?this.setFieldsFromConfig(e,t[s]):this.setFieldsFromConfig(e,t[s],i,n,o)},getRecursiveDataModels:function(e,t,i){let n=[],o=this.collection;return o&&o.length&&o.forEach(o=>{let s=o,a=!1;i.forEach(i=>{let n=s.get(i);if(n&&n.length){u.filterObjects(n,e,t).length&&(a=!0)}}),a&&(s.isExpanded=!0,n.push(s))}),n},filterDataModels:function(t,i,n){let o,s=e.clone(n||{},!1),a=s.filterFromTreeDocument,l=this.collection;if(this.searchValue=t,a){let e=this.treeDocument.getNodeModels();e.length&&(l=e)}if(t)if("id"===i){if(o=u.filterObjects(l,i,t),s.iterateRecursiveKeys&&s.iterateRecursiveKeys.length){let e=this.getRecursiveDataModels(i,t,s.iterateRecursiveKeys);o=o.concat(e),o=[...new Set(o)]}}else o=l.filter(function(e){if(e.get(i)&&e.get(i).contains(t))return e});return this.treeDocument=this.createTreeDocumentForCollection(o||this.collection),this.treeDocument},createClonedModel:function(t){let i,n,o={},s={},a=e.clone(t||{},!1),l=a.isNew,r=a.model,c=a.service,d=a.isSelect,h=a.isExpand,u=a.isMassUpdate,m=a.treeDocument,g=a.treeNodeModel;if(r){let e=a.config||m&&m.config;if(e&&this.createModelFields(r,e,o,s,c),i=new(u?this.massUpdateCloneModel:this.CloneModel)(r,a),!r.isNew())for(let e in o)o.hasOwnProperty(e)&&i.set(e,o[e])}return g?g.updateOptions({label:g.getNodeModelLabel(i),data:i,grid:s}):(!m||m instanceof C||(m=(n=m).getTreeDocument()),m&&m.createTreeNodeModel(i,{isNew:l,isSelect:d,isExpand:h,attributes:s,parentNode:n})),i},getSpecificTabConfig:function(e){let t;return t=e.isMassUpdate?this.tabConfigForMassUpdate:e.model.isNew()?this.TabConfigForCreate:this.TabConfig},resetDataModelFromClone:function(e){let t=this;if(e){let i={};this.getSpecificTabConfig(e).values.forEach(function(n){n.config&&n.config.values.forEach(function(n){t.prepareLocalAttributesToModelAttributes(i,e,n)})}),e.model.set(i)}},setStartStopAttrInfo:function(t,i,n){let o=this;if(e.is(i,"array")){let e=[];i.forEach(t=>{e.push(o.convertDate(t.actualValue||t))}),n[t]=e}else i&&(n[t]=this.convertDate(i.actualValue||i))},setUOMAttrInfo:function(t,i,n,o){e.is(i,"number")?n[t]=l.getFieldRangeItemActualValue(this.fieldDefinitionSource,t,i):n[t]=i},prepareLocalAttributesToModelAttributes:function(t,i,n){let o,s=i.localAttributes[n.name];if(!s&&"startStop"===n.type){let e=n.endDateAttribute,s=i.localAttributes[e];null!=s&&(this.setStartStopAttrInfo(e,s,t),o=!0)}if(null!=s&&!o)if("date"===n.type||"startStop"===n.type){this.setStartStopAttrInfo(n.name,s,t);let e=n.endDateAttribute;e&&(s=i.localAttributes[e],this.setStartStopAttrInfo(e,s,t))}else if("uom"===n.type){this.setUOMAttrInfo(n.name,s,t);let e=n.unitAttribute;e&&(s=i.localAttributes[e])&&this.setUOMAttrInfo(e,s,t,i)}else if("object"!==n.type&&"person"!==n.type||i.model.get(n.name)){let i=s;e.is(s.actualValue,"string")&&(i=s.actualValue),n.key?(t[n.key]=i,t[n.name]=void 0):t[n.name]=i}else n.key&&s.length?t[n.key]=s.at(0).get("id"):t[n.name]=s},convertDate:function(e){return e?new Date(e):e},createTreeDocumentForCollection:function(t,i){let n=this,o=e.clone(i||{},!1),s=o.config||this.ListConfig.columnInfo,a=o.doNotApplyNodeExpand||this.ListConfig.doNotApplyNodeExpand,l=new C({config:s,viewCollection:n,doNotApplyNodeExpand:a});return t&&t.length&&t.forEach(function(e){let t={model:e,service:o.service,treeDocument:l};n.createClonedModel(t)}),l},updateChildrenForNodeModel:function(t){let i=e.clone(t||{},!1),n=i.model,o=i.collection;o&&(n=o.get(n.id));let s=n&&n.getChildRelationsNames();if(s&&s.length){i.childMemberNames=s;let e=this.treeDocument.getTreeNodeModelById(n.id);e&&this._addChildNode(n,e,i)}},updateTreeDocumentForCollection:function(t,i){let n,o,s=this,a=this.treeDocument,l=e.clone(i||{},!1);t&&t.length&&t.forEach(function(e){if(n=e.id||e.physicalid,o=a.getTreeNodeModelById(n)){let t={model:e,config:l.config,treeDocument:a,treeNodeModel:o};s.createClonedModel(t)}l.isMassUpdate&&s.updateCacheAndTaggerData(e,{forceUpdate:!0})})},getFieldsAndIncludeParamsForDataModelDetails:function(e){let t,i="none";return this.TabConfig&&this.TabConfig.values.forEach(function(n){!e.include&&n.include&&(t?t+=","+n.include:t=n.include),n.fields&&(i+=","+n.fields)}),{fields:i,include:t}},getDataModelDetails:function(t){let n=this,o=e.clone(t||{},!1),s=!o.model&&(o.treeNodeModel||this.getCurrentNode()),a=o.model||s.options.data.model;return new i(function(e,t){let i=n.getFieldsAndIncludeParamsForDataModelDetails(o);a.fetch({debug:!1,owned:!o.owned||o.owned,fields:o.fields||i.fields,include:o.include||i.include,mask:o.mask,refresh:o.refresh,storageKey:o.storageKey,fetchSource:o.fetchSource,subType:o.subType,ignoreFieldDefinition:o.ignoreFieldDefinition,onComplete:function(t){if(!o.donotPersist&&c.set(o.storageKey||a.get("id"),a),s){let e={model:a,config:n.getPropertiesColumnInfo(a),treeNodeModel:s};t=n.createClonedModel(e)}e(t)},onFailure:function(e,i){p.buildNotification({title:f.FETCH_FAILURE,message:u.getErrorMessage(e,i)},"error"),t(i)}})})},getPropertiesColumnInfo:function(){return this.PropertiesConfig.columnInfo},getDataModels:function(t){let i,n=this,o=e.clone(t||{},!1),a=t.collection||new this.DataModels,l="none",r="none",c=Boolean(o.expandCall),d=Boolean(o.initialCall),m=o.fetchColumnName,g=this.ListConfig&&this.ListConfig.values;if(o.paramData&&o.paramData.forEach(function(e){i?i+=","+(e.objectId||e.get("id")):i=e.objectId||e.get("id")}),o.fields||o.includeFields)l+=","+o.fields,r+=","+o.includeFields;else if(m){let e=u.findObject(g,"dataIndex",m);if(e){if(e.initialFields)return void(o.onComplete&&o.onComplete(n.treeDocument));e.fields&&(l+=","+e.fields),e.include&&(r+=","+e.include)}}else g&&g.length&&g.forEach(function(e){let t=d?e.initialFields:e.fields,i=d?e.initialInclude:e.include;if(t&&(l+=","+t),i&&(r+=","+i),c){let t=e.expandFields,i=e.expandInclude;t&&(l+=","+t),i&&(r+=","+i)}});a.fetch({debug:!1,filter:i?void 0:widget.getValue("FilterOption"),contextId:i?void 0:o.contextId,idList:i,completed:i?void 0:s.get(h.COMPLETED_PREFERENCE),fields:l,include:r,top:o.top,rmcType:o.rmcType,onComplete:function(e){if(n.fieldDefinitionSource=a.getFieldDefinitionSource(),o.paramData&&o.paramData.length>0&&e.length<o.paramData.length){let t;o.paramData.forEach(i=>{e.get(i.objectId||i.get("id"))||(t=t?t+","+(i.displayName||i.get("title")):i.displayName||i.get("title"))}),t&&p.buildNotification({message:f.FAILED_TO_RETRIEVE_OR_ACCESS+" : "+t},"error")}o.updateCurrentTreeDocument?(n.updateTreeDocumentForCollection(e,o),o.onComplete&&o.onComplete.apply(this,arguments)):c?(n.updateChildrenForNodeModel(o),o.onComplete&&o.onComplete.apply(this,arguments)):(n.collection=a,n.treeDocument=n.createTreeDocumentForCollection(e),o.fetchChildDetails||o.addChild?n._fetchChildDetails(n.treeDocument,o):o.onComplete&&o.onComplete(n.treeDocument))},onFailure:function(e,t){p.buildNotification({title:f.FETCH_FAILURE,message:u.getErrorMessage(e,t)},"error"),o.onFailure&&o.onFailure(t)}})},_fetchChildDetails:function(e,t){let n=this;e.prepareUpdate();let o=e.getChildren();if(o&&o.length>0){let s=[];o.forEach(function(i){s.push(n._fetchModelDetails(i,e,t))}),s.length?i.all(s).then(()=>{e.updateSortAndExpandAll(),t.onComplete&&t.onComplete(e)}):t.onFailure()}else t.onComplete&&t.onComplete(e)},_fetchModelDetails:function(e,t,n){let o=this;return new i(function(t,i){n.fetchChildDetails?e.options.data.model.fetch({mask:n.mask,depth:n.depth,onComplete:function(i){o._addChildNode(i,e,n),t()},onFailure:function(e,t){p.buildNotification({title:f.FETCH_FAILURE,message:u.getErrorMessage(e,t)},"error"),i(e,t)}}):n.addChild&&(o._addChildNode(e.options.data.model,e,n),t())})},_addChildNode:function(e,t,i){let n=this,o=widget.getValue("isTaggersSelected"),s=u.getAttributeValues(t.getAllDescendants(),"id");i.childMemberNames&&i.childMemberNames.forEach(function(i){let a=e.get(i);a&&a.forEach(function(e){if(!o||!n.searchValue||-1!==n.searchValue.indexOf(e.id)&&-1===s.indexOf(e.id)){let i={model:e,config:n.ListConfig.columnInfo,treeDocument:t};n.createClonedModel(i)}})});let a=t.getChildren();a&&a.length&&a.forEach(function(e){let t=e.options.data;t?n._addChildNode(t.model,e,i):e.remove()})},hasPropertyInTaggerMap:function(e){return Boolean(Object.keys(l.getFieldTaggerMap()).filter(t=>new RegExp(e).test(t)).length)},processTagger:function(t){let n=this,o=e.clone(t||{},!1);return o.isSeverityExistsInTagger=this.hasPropertyInTaggerMap("severity"),new i(function(e,t){n.taggerProxy=new g(n.collection,o),n.taggerProxy.loadTagData(o).then(function(){e(n.taggerProxy)},function(e,i){p.buildNotification({title:f.TAGGER_ERROR,message:u.getErrorMessage(e,i)},"error"),t(e,i)})})},_clearCachedData:function(){this.collection&&this.collection.forEach(e=>{c.remove(e.get("id"))})},getContextInfo:function(t,n){let o=this,a=e.clone(n||{},!1),r=s.get("isComponent"),c=t._sourceType,d=t._fetchSource||a.defaultSource,u=a.initialCall||!1,m=this.ListConfig&&this.ListConfig.values,g=r?a.showCompletedRisks||widget.getValue(h.COMPLETED_PREFERENCE):s.get(h.COMPLETED_PREFERENCE);return new i(function(e,i){let n=o.ListConfig.getContextFields?o.ListConfig.getContextFields():"none",s=o.ListConfig.getContextIncludeFields?o.ListConfig.getContextIncludeFields():"none";s+=","+c,m&&m.length&&m.forEach(function(e){let t=u?e.initialFields:e.fields,i=u?e.initialInclude:e.include;if(t){t.split(",").forEach(function(e){e.includes(".")?n+=","+e:n+=","+c+"."+e})}i&&(s+=","+i)});let a=l.getFieldsDefinition(t.getFieldDefinitionSource());t.fetch({fetchSource:d,filter:widget.getValue("FilterOption"),subFilter:widget.getValue("SubFilterOption"),completed:g,fields:n,include:s,definition:!a||!a.fieldDefinitionColumns||void 0,fieldDefinitionSource:t.getFieldDefinitionSource(),refresh:!0,onComplete:function(){o.fieldDefinitionSource=t.getFieldDefinitionSource(),o.resetCollection(t.get(c)),e(t)},onFailure:function(e,t){return p.buildNotification({title:f.CONTEXT_SELECTION_FAILURE,message:f.FAILED_TO_RETRIEVE_OR_ACCESS},"warning"),i(e,t)}})})},getHistory:function(){return this.getRelatedResource("history")},getDataModelTrend:function(e){return this.getRelatedResource("rpn",e)},getRelatedResource:function(e,t){let n=this;return new i(function(i,o){let s=n.getCurrentDataModel(),a=new d;a.fetch({id:s.get("id"),refresh:!0,relatedSource:e,sourceType:t,onComplete:function(){i(a)},onFailure:function(e,t){return p.buildNotification({title:f.FETCH_FAILURE,message:u.getErrorMessage(e,t)},"error"),o(e,t)}})})},saveDataModel:function(t,i){this.resetDataModelFromClone(t),this.preProcessReferences(t,i);let n=t.model.changedAttributes();Object.keys(n).length&&(this.changedSaveAttrsSinceLastChange=e.clone(n,!1)),this.saveIfNotWaitingForAsync(t,i)},setProjectField:function(e){let t=e.getCollabSpace();t&&e.set("project",t)},deleteDataModel:function(t,n){let o=this,s=e.clone(n||{},!1),a=t||this.getCurrentNode();return a&&new i(function(e,t){s.onComplete=function(t){o.handleDeleteDataModelOnComplete(t,a,e,s)},s.onFailure=function(e,i){p.buildNotification({title:f.DELETE_FAILURE,message:u.getErrorMessage(e,i)},"error"),t(i)},a.options.data.model.destroy(s)})},handleDeleteDataModelOnComplete:function(t,i,n,o){let s=o.isSelect;s=!e.is(s,"boolean")||s;let a=i.options.data,l=a.model.title,r=i.getNextNode();i.remove(),s&&(r?r.select():this.treeDocument.getNodeModelsLength()&&this.selectDataModel(0)),this._updateTaggerData(a.model,!0);let c=u.getNLS(this.NLS,i.model.type,"Type");c=c||this.governingTypeNLS,!o.doNotShowDeleteMessage&&p.buildNotification({message:c+' "'+l+'" '+f.DELETED,title:""},"success"),n(t)},preProcessReferences:function(t,i){let n=this,o=t.get("references");if(o&&o.relatedDataToAdd.length){let s=e.clone(i||{},!1);s.callback=this.saveIfNotWaitingForAsync.bind(this),s.onFailure=function(e,t){n.handleSaveFailure(e,t,i)},t.uploadFiles(o.relatedDataToAdd,s)}},unselect:function(t){if(e.is(t,"number")&&t>-1){let e=this.getCurrentNode(t);e&&e.unselect()}else this.treeDocument.unselectAll()},processSaveDataModel:function(t,i){let n=this,o=e.clone(i||{},!1),s=o.isNew,a=o.collection||this.collection,l=function(){if(!s&&n.getCurrentDataModel()){let e=n.getCurrentDataModel().model;e.dispatchEvent("onSaveModelComplete",[e,n.changedSaveAttrsSinceLastChange]),delete n.changedSaveAttrsSinceLastChange}n.saveClassification(t,o)},r=function(e,t){n.handleSaveFailure(e,t,o),a.dispatchEvent("onError",[e,o])},c="none",d="none";s?(n.TabConfig&&n.TabConfig.values.forEach(function(e){e.fields&&(d+=","+e.fields)}),n.TabConfigForCreate&&n.TabConfigForCreate.values.forEach(function(e){e.include&&(c+=","+e.include)}),a.create(t.model,{fields:d,include:c,onComplete:l,onFailure:r})):(d="modifyAccess,deleteAccess,RMCConnectAccess,changeOwnerAccess,modified",(o.inValidRMC||o.isContextModified)&&(d+=",rmcActual.title,rmcGoverning.title,validConfiguration",c="rmcActual,rmcGoverning"),t.model.save(null,{fields:d,include:c,onComplete:l,onFailure:r}))},saveClassification:function(e,t){let i=this,n=function(){t.ignorePostSave||(e.cancel(),i.performPostSave(e,t),t.onComplete&&t.onComplete.apply(this,arguments))};e.get("ClassificationAttributes")?this.handleClassifications(e,t).then(n,function(n){t.ignorePostSave||i.performPostSave(e,t),i.handleSaveFailure(n,n,t)}):n.apply(this,arguments)},handleClassifications:function(e,t){let n=this;return new i(function(i){let o=e.get("ClassificationAttributes"),s={onComplete:function(s){o?(o.relatedDataToAdd=[],o.relatedDataToDelete=[],s&&p.buildNotification({title:f.CLASSIFICATION_FAILURE,message:s},"error"),t={mask:"dslib:ClassifiedItemBaseMask",refresh:!0,model:e.model},n.getDataModelDetails(t).then(function(){n._saveClassAttributes(e,t).then(function(e){if(s){let t={};t.data=e,t.err={message:s},i(t)}else i(e)},function(t){p.buildNotification({title:f.CLASSIFICATION_FAILURE,message:u.getErrorMessage(t)},"error"),t&&(t.data=e),i(t)})},function(e,t){i(e,t)})):i(e)}};n._addRemoveClasses(e,o,0,0,void 0,s)})},_addRemoveClasses:function(e,t,i,n,o,s){let a,l,r,c=this;if(t&&i<t.relatedDataToAdd.length?(a=t.relatedDataToAdd[i],l="add"):t&&n<t.relatedDataToDelete.length&&(a=t.relatedDataToDelete[n],l="remove"),!a)return s.onComplete();a.save(null,{classifiedItemId:e.get("id"),operation:l,relativePath:e.get("relativePath"),source:e.get("source"),type:e.get("type"),onComplete:function(d){if(e.model.set("modified",new Date),d.get("ObjectsNotClassified")>0||d.get("ObjectsNotDeclassified")>0){let e=d.get("StatusOfObjects"),t=Object.keys(e),i=e[t[0]].Reason+"; status: "+e[t[0]].status;o?o+=", "+t[0]+": "+i:o=d.get("id")+": "+i,r=d.get("ObjectsNotClassified")>0?1:2}c.processAfterClassficationAddRemove(e,t,i,n,o,a,r,l,s)},onFailure:function(d,h){r="add"===l?1:2;let m=a.title+": "+u.getErrorMessage(d,h);o=o?o+", "+m:m,p.buildNotification({title:f.CLASSIFICATION_FAILURE,message:o},"error"),c.processAfterClassficationAddRemove(e,t,i,n,o,a,r,l,s)}})},processAfterClassficationAddRemove:function(e,t,i,n,o,s,l,r,c){if(1===l){let e=t.get(s.get("id"));t.remove(e,{ignoreAddref:!0})}else if(2===l)t.add(s,{ignoreAddref:!0});else if("add"===r){i++;let t=e.get("classes");t||(t=new d,e.model.set("classes",t));let n=new a({id:s.get("id"),name:s.get("name"),title:s.get("title")});t.add(n,{ignoreAddref:!0})}else{n++;let t=e.get("classes");t&&t.remove(s.get("id"),{ignoreAddref:!0})}if(!(i<t.relatedDataToAdd.length||n<t.relatedDataToDelete.length))return c.onComplete(o);this._addRemoveClasses(e,t,i,n,o,c)},_saveClassAttributes:function(e){return new i(function(t,i){let n,o,s=e.get("ClassificationAttributes");if(!s.isEmpty()&&(o=s.find(function(e){return n=e.get("Attributes"),Boolean(e.hasChanged()&&n&&n.length)}))){let n={classifiedItemId:!0,operation:"modify",mask:"dslib:ClassificationAttributesMask",onComplete:function(i){e.model.set("modified",new Date),t(i)},onFailure:function(e,t){if(t&&t.message&&t.message.length&&t.message.length>0){let e=t.message.indexOf(":");e>0&&(t.message=t.message.substring(e+1))}i({data:e,err:t})}};e.model.save(null,n)}!o&&t(e.model)})},performPostSave:function(t,i){let n,o=e.clone(i||{},!1),s=t.model||t;c.set(t.id,s),o.isNew?(!o.treeDocument&&this.unselect(),n=f.CREATED):n=f.UPDATED,i.isReload||(t=this.updateTreeNodeModel(s,o)),i.doNotUpdateTaggerData||this._updateTaggerData(t,!1);let a=u.getNLS(this.NLS,s.type,"Type");a=a||this.governingTypeNLS,!i.donotShowMessage&&p.buildNotification({message:a+' "'+s.title+'" '+n},"success")},updateTreeNodeModel:function(t,i){let n=e.clone(i||{},!1),o=n.isNew,s={isNew:o,model:t,isSelect:n.isSelect,isExpand:n.isExpand,treeDocument:n.treeDocument||this.treeDocument,treeNodeModel:n.treeNodeModel||!o&&this.getCurrentNode()};return this.createClonedModel(s)},handleSaveFailure:function(e,t,i){return p.buildNotification({title:f.SAVE_FAILURE,message:u.getErrorMessage(e,t)},"error"),i.onFailure&&i.onFailure(e,t)},saveIfNotWaitingForAsync:function(e,t){this.shouldWaitForSave(e)||this.processSaveDataModel(e,t)},shouldWaitForSave:function(e){return e.isUploadingFiles()},setSearchSource:function(e){let t=e.config;if(!t)return;let i=t.getPersonSearchSource(),n=r.filterSearchSources(i);for(let o in t.columnInfo)if(t.columnInfo.hasOwnProperty(o)){let s=t.columnInfo[o];"person"===s.type?(n=r.filterSearchSources(i),s.searchSource=n,s.searchSourceTypes=t.getPersonSearchSourceTypes(i)):"object"===s.type&&this.setSearchSourceForObjects(e,o)}},handleSearchSourceTypesFor3dplan:function(e,t){if(t=t||h.XPLAN_SOURCE,!e.searchSourceTypes||!e.searchSourceTypes[t]){let i=l.getFieldsDefinition(t),n=u.findObject(i,"name",e.name),o=n&&n.typesForSearch;if(o)!e.searchSourceTypes&&(e.searchSourceTypes={}),e.searchSourceTypes[t]=o.split(",");else{let i=e.searchSource.findIndex(e=>e===t);-1!==i&&e.searchSource.splice(i,1)}}},handleSearchSourceTypesFor3dspace:function(e,t){if(t=t||h.DEFAULT_SOURCE,!e.searchSourceTypes||!e.searchSourceTypes[t]){let i;if(e.typesForSearchFieldName)i=l.getFieldDefinitionColumn(this.fieldDefinitionSource,e.typesForSearchFieldName);else{let t=l.getFieldDefinitionColumn(this.fieldDefinitionSource,e.name);i=t&&t.items.find(e=>"typesForSearch"===e.name)}if(!i)return;if(!e.searchSourceTypes&&(e.searchSourceTypes={}),e.searchSourceTypes[t]=[],e.typesForSearchFieldName)i.fieldDefinitionRangeItem.hasOwnProperty(e.name)&&this._getTypeSearchFieldValueFromRange(i,t,e,e.name);else for(let n in i.fieldDefinitionRangeItem)i.fieldDefinitionRangeItem.hasOwnProperty(n)&&this._getTypeSearchFieldValueFromRange(i,t,e,n)}},_getTypeSearchFieldValueFromRange:function(e,t,i,n){let o=e.fieldDefinitionRangeItem[n].display.split(",");i.searchSourceTypes[t].length?i.searchSourceTypes[t].concat(o):i.searchSourceTypes[t]=o},setSearchSourceForObjects:function(e,t){let i=e.getObjectSearchSource?e:e.config,n=i.getObjectSearchSource();if(n&&n.length){let e=i.columnInfo[t];e.searchSource=n,n.forEach(t=>{switch(t){case h.XPLAN_SOURCE:this.handleSearchSourceTypesFor3dplan(e,t);break;default:this.handleSearchSourceTypesFor3dspace(e,t)}})}},fetchAdditionalDataForModels:function(t){let i=e.clone(t||{},!1),n={updateCurrentTreeDocument:!0,paramData:i.paramData||this.collection,collection:i.collection||this.collection};return e.extend(i,n),this.collection&&this.getDataModels(i)},saveDataModels:function(t,i){let n=this,s=e.clone(i||{},!1),a=s.operation,l=s.donotShowMessage;t&&this.resetDataModelFromClone(t);let r=this.treeDocument.getSelectedNodes(),c=a===h.DUPLICATE;if(!r.length&&c&&(r=[t]),r.length){let i,a,d=new o({isDuplicate:c,selectedNodes:r,modelInstance:this.DataModel,fieldDefinitionSource:this.fieldDefinitionSource,massUpdateModel:t&&t.model});if(c){let e=this.getFieldsAndIncludeParamsForDataModelDetails(s);a=e.fields,i=e.include}else i="",a="modifyAccess,deleteAccess,promoteAccess,demoteAccess,fromConnectAccess,toConnectAccess,modified";d.save(null,{fields:a,include:i,onComplete:function(i){if(t&&t.cancel(),e.extend(s,{donotShowMessage:!0}),c){e.extend(s,{isNew:!0,treeNodeModel:void 0}),i.get("duplicatedModels").forEach(e=>n.performPostSave(e,s))}else r.forEach(t=>{e.extend(s,{treeNodeModel:t}),n.performPostSave(t.options.data,s)});!l&&p.buildNotification({message:f.MASS_UPDATE_SUCCESS},"success"),s.onComplete&&s.onComplete.apply(this,arguments)},onFailure:function(e,t){!l&&p.buildNotification({title:f.MASS_UPDATE_FAILURE,message:u.getErrorMessage(e,t)},"error"),s.onFailure&&s.onFailure.apply(this,arguments)}})}},_updateTaggerData:function(e,t){this.taggerProxy&&this.taggerProxy.updateTagObject(e.model||e,t,this.fieldDefinitionSource).then(function(){},function(e){p.buildNotification({title:f.TAGGER_ERROR,message:e},"error")})},updateCacheAndTaggerData:function(t,i){if(t){let n=e.clone(i||{},!1),o=n.forceUpdate,s=n.childrenTaggerUpdate;if(c.get(t.id)&&c.set(t.id,t),!o&&this.taggerProxy.taggerData.hasOwnProperty("pid://"+t.id)||this._updateTaggerData(t,!1),s){let e=t.getChildRelationsNames();e&&e.length&&e.forEach(e=>{let i=t.get(e);i&&i.length&&i.forEach(e=>{!o&&this.taggerProxy.taggerData.hasOwnProperty("pid://"+e.id)||this._updateTaggerData(e,!1)})})}}},duplicateDataModels:function(t){if(!this.validateDuplicateDataModels(t))return;let i=e.clone(t||{},!1),n=i.onComplete,o=i.onFailure;e.extend(i,{donotShowMessage:!0,onComplete:function(){p.buildNotification({message:f.DUPLICATE_SUCCESS},"success"),n&&n.apply(this,arguments)},onFailure:function(e,t){p.buildNotification({title:f.DUPLICATE_FAILURE,message:u.getErrorMessage(e,t)},"error"),o&&o.apply(this,arguments)}}),this.saveDataModels(i.cloneModelToSave,i)},validateDuplicateDataModels:function(){return!0},destroy:function(){this.collection&&(this.collection=null),this.treeDocument&&this.treeDocument.destroy(),this.treeDocument=null}})}),define("DS/ENOProjectMgmtCommonComponents/views/MultiValueCustomView",["UWA/Core","DS/Controls/ComboBox","DS/Controls/DatePicker","DS/Controls/LineEditor","DS/Controls/SelectionChips","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l){"use strict";return s.extend({_uwaClassName:"MultiValueCustomView",setup:function(e){this.options=e,this.model=e&&e.model,this._parent.apply(this,arguments)},render:function(){let s=this;if(this.container.empty(!0),this.multiValueContainer=e.createElement("div",{class:(this.model.model.canModify(),"editable")}),this.multiValueContainer.inject(this.container),this.attributeLabel=new e.Element("label",{text:this.options.config.label}),this.attributeLabel.inject(this.multiValueContainer),this.groupStackedFields=e.createElement("div",{class:"field-group stacked-fields"}),this.groupStackedFields.inject(this.multiValueContainer),this.groupWrapper=e.createElement("div",{class:"input-group-wrapper"}),this.groupWrapper.inject(this.groupStackedFields),this.editorContainer=e.createElement("div",{class:"input-group"}),this.editorContainer.inject(this.groupWrapper),this.editorSpan=e.createElement("span",{class:"input-element"}),this.editorSpan.inject(this.editorContainer),this.model.model.canModify()){if(this.selectionChipsContainer=e.createElement("div",{class:"input-group"}),this.selectionChipsContainer.inject(this.groupWrapper),this.selectionChipsSpan=e.createElement("span",{class:"input-element"}),this.selectionChipsSpan.inject(this.selectionChipsContainer),this.options.config.values||"checkbox"===this.options.config.type){let e=[];"checkbox"===this.options.config.type?e=[{label:l.TRUE_VALUE,value:!0},{label:l.FALSE_VALUE,value:!1}]:this.options.config.values.forEach(t=>{e.push(t.displayValue)}),this.comboBox=new t({placeholder:l.SELECT_AN_OPTION,enableSearchFlag:!1,reachablePlaceholderFlag:!0,elementsList:e}),this.comboBox.addEventListener("change",function(e){s._addChip(e.dsModel.value,e.dsModel.label)}),this.comboBox.inject(this.editorSpan)}else"date"===this.options.config.type?(this.datePicker=new i({timePickerFlag:!1}).inject(this.editorSpan),this.datePicker.addEventListener("change",function(e){let t=e.dsModel.value;s._addChip(t.toString())})):(this.lineEditor=new n({placeholder:l.ENTER_A_VALUE}),this.lineEditor.inject(this.editorSpan),this.lineEditor.addEventListener("change",function(){s.lineEditor.value&&""!==s.lineEditor.value&&s._addChip(s.lineEditor.value)}));this.selectionChips=new o,this.selectionChips.inject(this.selectionChipsSpan);let r=this.model.get(this.options.config.name);if(r&&r.length>0){let e=0;r.forEach(t=>{let i,n;if("date"===this.options.config.type){let e=a.getIntlDateFormat(t);i=e.displayValue,n=e.actualValue}else"checkbox"===this.options.config.type?(i=t?l.TRUE_VALUE:l.FALSE_VALUE,n=t):(i=t.toString(),n=t);s.selectionChips.addChip({label:i,index:e,value:n}),e++})}this.selectionChips.addEventListener("change",function(){s._setChipValuesToModel()})}else{let t=this.model.get(this.options.config.name);if(t&&t.length>0){let i=[],n=new e.Element("ul");n.inject(this.editorSpan),t.forEach(t=>{let o;o="date"===s.options.config.type?a.getIntlDateFormat(t).displayValue:"checkbox"===this.options.config.type?t&&l.TRUE_VALUE||l.FALSE_VALUE:t,i.push({label:o});let r=new e.Element("li");r.inject(n),new e.Element("span",{class:"read-only",text:o}).inject(r)})}}return this},_convertToDate:function(t){let i=new Date(t);return i&&"Invalid Date"!==i.toString()&&e.Date.strftime(i,"%Y/%m/%d@12:%M:%S:GMT")||""},_addChip:function(e,t){this.selectionChips.addChip({label:t||e,value:e}),this._setChipValuesToModel()},_setChipValuesToModel:function(){let e=this.selectionChips.getAllChipsOptions(),t=[];e.forEach(e=>{t.push(e.value)}),this.model.set(this.options.config.name,t)},destroy:function(){this.attributeLabel.destroy(),this.lineEditor&&this.lineEditor.destroy(),this.datePicker&&this.datePicker.destroy(),this.editorContainer.destroy(),this.selectionChipsSpan&&this.selectionChipsSpan.destroy(),this.selectionChips&&this.selectionChips.destroy(),this.selectionChipsContainer&&this.selectionChipsContainer.destroy(),this.groupWrapper.destroy(),this.groupStackedFields.destroy(),this.multiValueContainer.destroy(),this._parent.apply(this,arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/config/CommonListConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t){"use strict";let i=e.extend({_uwaClassName:"CommonListConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"basic",values:[{text:t.TITLE,key:"title",dataIndex:"tree",fields:"title,name",icon:""}],doNotApplyNodeExpand:!0});return i._instance=i._instance||new i,i._instance}),define("DS/ENOProjectMgmtCommonComponents/collection/ClassificationCollection",["UWA/Core","DS/ENOProjectMgmtCommonComponents/config/CommonListConfig","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel","DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection","DS/ENOProjectMgmtModels/Models/Library","DS/ENOProjectMgmtModels/Collections/Libraries","DS/ENOProjectMgmtModels/Models/RelatedDataItem","DS/ENOProjectMgmtModels/Constants/Constants"],function(e,t,i,n,o,s,a,l){"use strict";let r=n.singleton({_uwaClassName:"ClassificationCollection",classPaths:{},classNames:{},setup:function(){let e={};e.DataModels=s,e.DataModel=o,e.PropertiesConfig=t,e.ListConfig=t,e.CloneModel=i,e.governingType=l.TYPENAMES.LIBRARIES,e.governingTypeNLS="Libraries",this._parent(e)},getClassPath:function(e){return this._loadClassPaths(),this.classPaths[e]},getClassName:function(e){return this._loadClassPaths(),this.classNames[e]},reloadClassifications:function(e){this.resetClassFlags(),this.loadClassifications(e),r.resetCollection()},loadClassifications:function(t){let i=e.clone(t||{},!1);i.fetchChildDetails=!0,i.mask="dslib:ExpandClassesDetailsMask",i.depth=20,i.top=999,i.childMemberNames=["ChildClasses"],r.getDataModels(i)},getClassDefinition:function(e){let t=void 0;e.model?t=e.model:(t=new a).set("id",e.id||r.getCurrentDataModel().get("id"));let i={storageKey:t.id+"ClassAttributesMask",mask:"dslib:ClassAttributesMask",model:t,fetchSource:l.APPLICATIONS.LIBRARIES,subType:l.APPLICATIONS.CLASS};return r.getDataModelDetails(i)},getClassifiedItemAttributes:function(e){let t={mask:"dslib:ClassificationAttributesMask",refresh:!0,model:e};return r.getDataModelDetails(t)},_loadClassPaths:function(){Object.keys(this.classPaths).length||(this.classPaths={},this.classNames={},this._initializeClassPaths(this.collection,void 0))},_initializeClassPaths:function(e,t){let i=this;e&&e.forEach(function(e){let n=e.id,o=e.title;if(i.classNames[n]=e.get("name"),!i.classPaths[n]){let s=t?t+" > "+o:o;i.classPaths[n]=s;let a=e.get("ChildClasses");a&&i._initializeClassPaths(a,s)}})},resetClassFlags:function(){this.classPaths={},this.classNames={}},destroy:function(){this._parent()}});return r}),define("DS/ENOProjectMgmtCommonComponents/utils/PlatformManager",["UWA/Class/Events","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/constants/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s){"use strict";return e.singleton({_serviceData:[],initializeServiceData:function(){let e=this;return new Promise(function(t,n){e._serviceData.length?t():i.getPlatformServices({onComplete:function(i){e.storePlatformServiceData(i),t()},onFailure:function(e){n(e)}})})},configure:function(){let e=this;return new Promise(function(i,o){e.initializeServiceData().then(function(){let o,s,a,l;window.widget?(o=window.widget.getUrl(),s=window.widget.getUrl().match(/[?&]runYourApp=([^&]*)?/),a=t.getApplicationConfiguration("app.urls.myapps"),o=o.substring(0,o.indexOf("/webapps")),l=window.widget.lang):o=window.location.origin,a&&!s||(a=o);let r,c,d=(new Date).getTimezoneOffset(),h=t.getUser();h&&h.login&&(r=h.firstName,c=h.lastName,h=h.login);let u={url:o,language:l,timezone:d,myAppsUrl:a,user:h,firstName:r,lastName:c,isStandaloneWidget:void 0!==window.widget,widgetId:widget.id,appId:widget.data.appId};n.set(u),e.processStorages(e._serviceData),i()},function(e){o(e)})})},processStorages:function(){let e,t=[];if(this._serviceData.forEach(function(i){i[o.SPACE_SOURCE]&&(e||(e=i),t.push({label:i.displayName||i.platformId,value:i.platformId}))}),!n.get("isComponent")){let e=void 0,i=widget.getValue(o.COLLABSTORAGE);if(i)for(let t of this._serviceData)if(t.platformId===i||t[o.SPACE_SOURCE]===i){e=t.platformId;break}e||(e=widget.data.x3dPlatformId||t[0].value),widget.addPreference({name:o.COLLABSTORAGE,type:"list",disabled:!(t.length>1),defaultValue:e,options:t,label:s["3DEXPERIENCE_PLATFORM"]}),i!==e&&widget.setValue(o.COLLABSTORAGE,e)}this.processStorage(),n.get("3DSpace")||this.processStorageForUndefinedPlatform()},processStorageForUndefinedPlatform:function(){let e=n.get("isComponent");for(let t of this._serviceData)if(t["3DSpace"]){let i=t;n.set(o.TENANT,i.platformId),n.set(i),e||(widget.setValue(o.TENANT,i.platformId),widget.setValue(o.X3D_PLATFORMID,i.platformId));break}},processStorage:function(){let e,t=void 0,i=n.get("isComponent");t=i?widget.getValue("x3dPlatformId"):widget.getValue(o.COLLABSTORAGE)||widget.getValue(o.TENANT);for(let i of this._serviceData)if(i.platformId===t||i[o.SPACE_SOURCE]===t){e=i;break}if(!e&&!widget.getValue(o.COLLABSTORAGE)&&this._serviceData.length>0&&(e=this._serviceData[0]),!e)return i||widget.deleteValue(o.TENANT),n.unset(o.TENANT),void n.unset("platformId");i||(widget.setValue(o.TENANT,e.platformId),widget.setValue(o.X3D_PLATFORMID,e.platformId)),n.set(o.TENANT,e.platformId),n.set(e)},isStandaloneWidget:function(){return void 0!==window.widget},storePlatformServiceData:function(e){this._serviceData=e},getTenant:function(){if(this.isStandaloneWidget()){return widget.getValue(o.TENANT)}},isOnPremise:function(){return"OnPremise"===this.getTenant()}})}),define("DS/ENOProjectMgmtCommonComponents/config/MatrixConfigActionButtonConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t){"use strict";let i=e.extend({_uwaClassName:"MatrixConfigActionButtonConfig",type:"actionButtons",columnInfo:{},setup:function(){this.setColumnInfo()},values:[{name:"export",value:"export",text:t.EXPORT,title:t.EXPORT,fonticon:"export"},{name:"delete",value:"delete",text:t.DELETE,title:t.DELETE,fonticon:"trash"}],getItems:function(e,t){if(!e)return;let i,n,o=[],s=UWA.clone(t||{},!1),a=s.isDefault,l=s.isCreateNewSelected;return this.values.forEach(function(t){switch(t.name){case"export":i=l;break;case"delete":i=a||!e.canDelete()}(n=UWA.clone(t||{},!1)).className=i?"disabled":"",o.push(n)}),o}});return i._instance=i._instance||new i,i._instance}),define("DS/ENOProjectMgmtCommonComponents/config/TabMatrixConfigCreate",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/config/MatrixSettingsViewConfig","DS/ENOProjectMgmtCommonComponents/config/MatrixConfigActionButtonConfig"],function(e,t,i){"use strict";let n=e.extend({_uwaClassName:"TabMatrixConfigCreate",columnInfo:{},setup:function(){this.setColumnInfo()},type:"tab",actionButtonConfig:i,hide:!0,values:[{name:"",key:"matrixCreate",selected:!0,fields:"title,name,owner,modifyAccess,deleteAccess,project,projectTitle,configuredItems.title,configuredItems.name,configuredItems.image,configuredItems.thumbnail,ownerInfo.title,ownerInfo.name,ownerInfo.image,ownerInfo.firstname,ownerInfo.lastname,ownerInfo.company,rmcType",include:"matrix,configuredItems,ownerInfo",config:t,checkFlag:!0}],getDefaultTab:function(){for(let e in this.values)if(this.values[e].checkFlag)return this.values[e]}});return n._instance=n._instance||new n,n._instance}),define("DS/ENOProjectMgmtCommonComponents/config/MatrixConfigListConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t){"use strict";let i=e.extend({_uwaClassName:"MatrixConfigListConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"basic",values:[{text:t.TITLE,key:"title",dataIndex:"tree",fields:"title,name,rmcType",include:"matrix",icon:""}]});return i._instance=i._instance||new i,i._instance}),define("DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtSummaryChartsUtil",["UWA/Class","DS/ENOProjectMgmtCommonComponents/config/AppConfig","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/constants/Constants","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtHeatMapChartUtil","DS/ENOProjectMgmtCommonComponents/collection/ClassificationCollection","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/FieldsDefinition","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r){"use strict";let c,d,h,u,m={},g={},p={},C={};return e.extend({_uwaClassName:"ProjectMgmtSummaryChartsUtil",_breakdownChartConfig:void 0,_heatMapChartConfig:void 0,_classificationChartConfig:void 0,_actionPlanChartConfig:void 0,_matrixConfigCollection:void 0,_collection:void 0,_createConfig:void 0,_planConfig:void 0,_parentView:void 0,_matrixDataCount:void 0,_rmcObject:void 0,_isDefaultRMC:void 0,init:function(e){this._breakdownChartConfig=e.breakdownChartConfig,this._heatMapChartConfig=e.heatMapChartConfig,this._classificationChartConfig=e.classificationChartConfig,this._actionPlanChartConfig=e.actionPlanChartConfig,this._matrixConfigCollection=e.matrixConfigCollection,this._collection=e.collection,this._createConfig=e.createConfig,this._planConfig=e.planConfig,this._parentView=e.parentView,c=this.getMitigationTypes(),this.resetChartData()},resetChartData:function(){this.resetRangeData(h,m),this.resetRangeData(u,g),this.resetRangeData(d,p),this.resetRangeData(c,C)},resetRangeData:function(e,t){e&&e.forEach(function(e){t[e.actualValue||e.matrixXY||e]=0})},calculateDataBasedOnKey:function(e,t){e[t]||(e[t]=0),e[t]++},getTreeDocumentCollection:function(){let e=this._collection&&this._collection.getDocument();return e&&e.getChildren()},getMitigationTypes:function(){if(c=this._planConfig.columnInfo.mitigationType.values)return c.forEach(function(e,i){e.rangeColor=t.ColorPalette[i].color}),c},reloadClassification:function(){let e=this;d&&this.resetRangeData(d,p);let t=this.getTreeDocumentCollection(),i=t&&t.length,n=[];i&&t.forEach(function(t){let i=t.options.data;e.getClassificationData(i,n)}),this.processClassificationChart(n,i),this.Highcharts&&(this.classificationChart=new this.Highcharts.Chart(this._classificationChartConfig))},getClassificationData:function(e,t){let i=this,n=e.get("classType"),o=l.getFieldRangeItemObject(this._collection.fieldDefinitionSource,"classType",n);t.push({actualValue:n,displayValue:o.display,classType:"Risk"}),this.calculateDataBasedOnKey(p,n);let a=e.get("classes");a&&a.length&&a.forEach(function(e){let n=e.get("id"),o=s.getClassName(n),a=e.get("title");t.push({actualValue:a,className:o,classType:"Classification"}),i.calculateDataBasedOnKey(p,a)})},getRMCDetails:function(e){let t;if(e){let i=e.get("configuration");t=i&&i.length&&1===i.length?i[0]||i.at(0):this._matrixConfigCollection._defaultConfiguration}else t=this._matrixConfigCollection._defaultConfiguration;return t},reloadMatrixConfiguration:function(){this._isDefaultRMC=!1;let e=a.get("context"),t=this.getRMCDetails(e);if(t=t&&this._matrixConfigCollection.getMatrixConfigDefinition(t.id||t)){this._rmcObject=t;let i={chartConfig:this._heatMapChartConfig,matrixConfiguration:t},s=new o(i);h=s&&s.heatMapChartArray[0].data;let a=this._rmcObject?this._rmcObject.get("name"):"";this._isDefaultRMC=!e&&(a===n.DEFAULT||a===n.DEFAULT_OPPORTUNITY)}},getMatrixData:function(e,t,n){let o=e.get("validConfiguration"),s=e.get("contextValidConfiguration");if("FALSE"===o||"FALSE"===s)return;this._matrixDataCount++;let a,l=e.get("impact")+e.get("probability");if(this._isDefaultRMC){let t=e.getMappedValue();t&&(this.calculateDataBasedOnKey(m,t.matrixXY),a=t.severityItem)}else if(this.calculateDataBasedOnKey(m,l),!n){let t=e.getRiskSeverityInfo&&e.getRiskSeverityInfo();a=t&&i.getSeverityItem(t)}n||(a&&t.push(a),a&&this.calculateDataBasedOnKey(g,a.actualValue))},processChartsData:function(){let e=this,t=a.get("isComponent"),i=this.getTreeDocumentCollection(),n=i&&i.length;this.reloadMatrixConfiguration();let o=[],s=[];this._matrixDataCount=0,n&&i.forEach(function(i){let n=i.options.data.model;if(n&&(e.getMatrixData(n,s,t),!t)){e.getClassificationData(n,o);let t=n.get("mitigationType");C[t]++}}),this.processCharts(o,s,n,t)},processCharts:function(e,t,i,n){this.processHeatmapChart(n),n||(this.processBreakdownChart(t,i),this.processClassificationChart(e,i),this.processActionPlanChart(i))},processHeatmapChart:function(e){let t=0===this._matrixDataCount;h&&(h.forEach(function(e){let i=e.matrixXY,n=m[i];n?(e.cellCount=n,e.dataLabels.format=n+" "):(e.cellCount=0,t&&(e.opacity=.5),e.dataLabels.format=" ")}),e||(this._heatMapChartConfig.plotOptions.series.point={events:{click:function(){if(0===this.cellCount)return;let e=this.Xvalue+" * "+this.Yvalue;this.series.chart.options.onClickCallBack("ds6w:what/ds6w:heatMap",e)}}},this._heatMapChartConfig.onClickCallBack=this._chartClickCallbackFunction.bind(this)))},preProcessBreakdownChart:function(e){return u=[...new Map(e.map(e=>[e.actualValue,e])).values()]},processBreakdownChart:function(e){u=e&&this.preProcessBreakdownChart(e);let i=[],n=0===this._matrixDataCount;n?i.push({y:1,name:r.NO_DATA,isEmpty:!0,color:t.ChartsColor.GREY0_COLOR}):u&&u.forEach(function(e){let t=e.actualValue,n=g[t]||0;i.push({name:e.displayValue,y:n,severityIndex:e.severityIndex,color:e.backgroundColor,severityLevel:t})}),i.sort(function(e,t){return e.severityIndex-t.severityIndex}),this._breakdownChartConfig.tooltip.enabled=!n,this._breakdownChartConfig.series.isEmpty=n,this._breakdownChartConfig.title.text=this._matrixDataCount.toString(),this._breakdownChartConfig.onClickCallBack=this._chartClickCallbackFunction.bind(this),this._breakdownChartConfig.series[0].data=i},preProcessClassificationChart:function(e){let t=[];(d=[...new Map(e.map(e=>[e.actualValue,e])).values()]).forEach(e=>{t.push(e.displayValue||e.actualValue)}),this._parentView.addChartScroller(t.length)},processClassificationChart:function(e,t){let i=0===t;this.preProcessClassificationChart(e);let n=[];i?n.push({y:0,isEmpty:!0,name:r.NO_DATA}):d.forEach(function(e){let t=p[e.actualValue];t?n.push({name:e.displayValue||e.actualValue,y:t,classType:e.classType,className:e.className,actualValue:e.actualValue}):n.push(null)}),this._classificationChartConfig.tooltip.enabled=!i,this._classificationChartConfig.onClickCallBack=this._chartClickCallbackFunction.bind(this),this._classificationChartConfig.series[0].data=n},processActionPlanChart:function(e){let i=[],n=0===e;n?i.push({y:1,name:r.NO_DATA,isEmpty:!0,color:t.ChartsColor.GREY0_COLOR}):c&&c.forEach(function(e){C[e.actualValue]>0&&i.push({name:e.displayValue,actualValue:e.actualValue,y:C[e.actualValue],color:e.rangeColor})}),this._actionPlanChartConfig.tooltip.enabled=!n,this._actionPlanChartConfig.series.isEmpty=n,this._actionPlanChartConfig.title.text=e.toString(),this._actionPlanChartConfig.onClickCallBack=this._chartClickCallbackFunction.bind(this),this._actionPlanChartConfig.series[0].data=i},renderCharts:function(e,t){let i=a.get("isComponent");(!i||i&&t.SUMMARY_VIEW===t.currentViewName)&&(this.parentApp=t,this.Highcharts=e,this.Highcharts&&(this.heatMapChart=new e.Chart(this._heatMapChartConfig),i||(this.breakdownChart=new e.Chart(this._breakdownChartConfig),this.classificationChart=new e.Chart(this._classificationChartConfig),this.actionPlanChart=new e.Chart(this._actionPlanChartConfig)),this.reflowCharts()))},reflowCharts:function(){this.heatMapChart&&this.heatMapChart.reflow(),this.breakdownChart&&this.breakdownChart.reflow(),this.classificationChart&&this.classificationChart.reflow(),this.actionPlanChart&&this.actionPlanChart.reflow()},_chartClickCallbackFunction:function(e,t){if(this.parentApp){let i=this.parentApp.getTaggerProxy();i&&i.set6WFilterOptions(e,t)}},destroyCharts:function(){this.heatMapChart&&(this.heatMapChart.destroy(),delete this.heatMapChart),this.breakdownChart&&(this.breakdownChart.destroy(),delete this.breakdownChart),this.classificationChart&&(this.classificationChart.destroy(),delete this.classificationChart),this.actionPlanChart&&(this.actionPlanChart.destroy(),delete this.actionPlanChart),this.resetChartData()},enableAnimation:function(e){this._breakdownChartConfig.plotOptions.pie.animation=e,this._actionPlanChartConfig.plotOptions.pie.animation=e,this._classificationChartConfig.plotOptions.bar.animation=e}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtSummaryView",["UWA/Class/View","UWA/Core","UWA/Element","DS/Controls/TooltipModel","DS/ENOProjectMgmtCommonComponents/config/AppConfig","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtSummaryChartsUtil","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Models/AppSettings","DS/Controls/Button","DS/UIKIT/Scroller","text!DS/ENOProjectMgmtCommonComponents/assets/templates/summaryView.html.handlebars","text!DS/ENOProjectMgmtCommonComponents/assets/templates/summaryHeatmap.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m){"use strict";return e.extend({_uwaClassName:"ProjectMgmtSummaryView",_appContainer:void 0,parentApp:void 0,chartOptions:void 0,height:void 0,Highcharts:void 0,summaryChartsUtil:void 0,_breakdownChartConfig:void 0,_heatMapChartConfig:void 0,_classificationChartConfig:void 0,_actionPlanBreakdownChartConfig:void 0,_collection:void 0,_createConfig:void 0,_planConfig:void 0,_governingTypeNLS:void 0,_taggerUpdated:void 0,init:function(e,i){this.parentApp=e,this._breakdownChartConfig=i.breakdownChartConfig,this._heatMapChartConfig=i.heatMapChartConfig,this._classificationChartConfig=i.classificationChartConfig,this._actionPlanBreakdownChartConfig=i.actionPlanBreakdownChartConfig,this._matrixConfigCollection=i.matrixConfigCollection,this._collection=i.collection,this._createConfig=i.createConfig,this._planConfig=i.planConfig,this._governingTypeNLS=i.governingTypeNLS,this._appContainer=t.createElement("div")},render:function(e){let i=t.clone(e||{},!1),n=r.get("isComponent");return this.initContainerResizeEvent(n),n?(this._appContainer.setHTML(u),this._appContainer.getElement("#heatmapLabel").setHTML(this._governingTypeNLS+" "+m.HEAT_MAP),this._heatMapChartConfig.chart.renderTo=this._appContainer.getElement("#heatmapChart")):(this._appContainer.setHTML(h),this.summaryChart=this._appContainer.getElement(".summary-chart"),this._appContainer.getElement("#heatmapLabel").setHTML(m.HEAT_MAP),this._heatMapChartConfig.chart.renderTo=this._appContainer.getElement("#heatmapChart"),this._appContainer.getElement("#breakdownLabel").setHTML(m.BREAKDOWN),this._breakdownChartConfig.chart.renderTo=this._appContainer.getElement("#breakdownChart"),this._appContainer.getElement("#classificationLabel").setHTML(m.CLASSIFICATION),this.classificationChart=this._appContainer.getElement("#classificationChart"),this._classificationChartConfig.chart.renderTo=this.classificationChart,this._appContainer.getElement("#actionPlanBreakdownLabel").setHTML(m.ACTION_PLAN),this._actionPlanBreakdownChartConfig.chart.renderTo=this._appContainer.getElement("#actionPlanBreakdownChart")),t.extend(i,{parentView:this,breakdownChartConfig:this._breakdownChartConfig,heatMapChartConfig:this._heatMapChartConfig,classificationChartConfig:this._classificationChartConfig,actionPlanChartConfig:this._actionPlanBreakdownChartConfig,matrixConfigCollection:this._matrixConfigCollection,collection:this._collection,createConfig:this._createConfig,planConfig:this._planConfig}),this.summaryChartsUtil=new s(i),!n&&this.addScroller(),this._appContainer},initContainerResizeEvent:function(e){let t=this;this._appContainer.removeEvent("resize"),this._appContainer.addEvent("resize",function(){t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){t._shouldWeReloadOnResize()&&(t.summaryChartsUtil&&t.summaryChartsUtil.reflowCharts(),e||t.chartScrollElement&&t.chartScrollElement.setStyle("height",t.summaryChart.getSize().height+"px")),delete t.timer},100)})},addScroller:function(){let e=this._appContainer.getElement("#summaryViewContent");e.setStyle("height",this.getHeight()+"px"),new d({element:e}).inject(this._appContainer.getElement("#summaryViewContainer"))},addChartScroller:function(e){let i=this._appContainer.getElement("#classificationChartContainer"),n=this.summaryChart.getSize().height||i.getSize().height;if(i&&i.empty(),this.chartScrollElement&&this.chartScrollElement.destroy(),e&&e>10){this.chartScrollElement=new t.createElement("div",{id:"chartScrollerElement"}),this.chartScrollElement.setStyle("height",n+"px"),this.classificationChart.inject(this.chartScrollElement),new d({element:this.chartScrollElement}).inject(i)}else this.classificationChart.inject(i)},reset:function(){this.parentApp.showHideRightPanel(!1),this.parentApp.showMassUpdateToolbarButton(!1),this.summaryChartsUtil.destroyCharts()},loadData:function(e){this.reset(),this._containerHeight=this._appContainer.getBoundingClientRect().height,this._containerWidth=this._appContainer.getBoundingClientRect().width,this.Highcharts?this.summaryChartsUtil.enableAnimation(!1):this.Highcharts=r.get("highcharts"),this.summaryChartsUtil.processChartsData(e),this.summaryChartsUtil.renderCharts(this.Highcharts,this.parentApp,e),this.handleInvalidCount()},reloadCharts:function(){!r.get("isComponent")&&this.summaryChartsUtil.reloadClassification()},handleInvalidCount:function(){let e=r.get("context"),t=r.get("isComponent"),i=this._collection.getModelsCountWithInvalidConfig(),n=e&&this._collection.getModelsCountWithInvalidConfigForContext();this._setInvalidCounts(i,n,"#fixInvalidRisksForHeatmap","#configurationMismatchForHeatmap","#heatmapBadge"),t||this._setInvalidCounts(i,n,"#fixInvalidRisksForBreakdown","#configurationMismatchForBreakdown","#breakdownBadge")},_setInvalidCounts:function(e,t,n,o,s){let a=this,l=i.extend(this._appContainer.getElement(s)),d=i.extend(this._appContainer.getElement(n)),h=i.extend(this._appContainer.getElement(o));if(l&&l.show(),d&&d.empty(),h&&h.empty(),e){let t=new c({label:m.FIX+" "+e+" "+m.INVALID+" "+this._governingTypeNLS,emphasize:"medium-attention"});t.inject(d),t.getContent().addEventListener("buttonclick",function(){r.set("invalidRiskFilterisOn","set"),a.parentApp.switchTab(1)})}t?(h.set({text:t+" "+m.INVALID_CONFIGURATION+" "+this._governingTypeNLS,title:this._governingTypeNLS+" "+m.INVALID_CONFIGURATION_TOOLTIP}),l&&l.show()):l&&l.hide()},_shouldWeReloadOnResize:function(){var e=this._appContainer.getBoundingClientRect(),t=e.height>0&&e.width>0&&(this._containerHeight!==e.height||this._containerWidth!==e.width);return t&&(this._containerHeight=e.height,this._containerWidth=e.width),t},destroy:function(){this._appContainer&&this._appContainer.destroy()},getHeight:function(){return this.height=this.height?this.height:this.parentApp.getHeight()-5},setHeight:function(e){if(this.height=e,this._appContainer){let e=this._appContainer.getElement("#summaryViewContent");e&&e.setStyle("height",this.height+"px")}},isHidden:function(){return this._appContainer.isHidden()},show:function(){this._appContainer&&this._appContainer.show()},hide:function(){this._appContainer&&this._appContainer.hide()}})}),define("DS/ENOProjectMgmtCommonComponents/utils/PreferenceManager",["UWA/Core","UWA/Class/Events","DS/ENOProjectMgmtModels/Utils/DataUtils","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Collections/SecurityContexts","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/PlatformManager","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/constants/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c){"use strict";window.dataVersion=.3;let d={name:r.COLLABSPACE,type:"list",defaultValue:"",options:[{label:"None",value:"None"}],label:c.CREDENTIALS};return t.extend({defaultWindowedHeight:505,homeModule:void 0,homeView:void 0,option:void 0,parentContainer:void 0,homeViewLoading:!1,init:function(e,t){let i=this;this.homeModule=t;let o=e.isComponent;if(n.set("isComponent",o),this.initUtils(),!o){widget.useUIKitSelect=!0,widget.addEvents({onEdit:this.onPreferencesOpened.bind(this),endEdit:this.onPreferencesClosed.bind(this),onViewChange:function(){i.onViewChange()},onRefresh:this.refreshWidget.bind(this)});let e=top.document.getElementsByName("viewport");e&&e.length&&e[0].setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"),i._initializePreference()}a.configure().then(function(){i.homeModule&&(i._initializeHomeView(e),i._initPreferencesWithConstants(),i.setSpace(e)),e.onComplete&&e.onComplete()},function(){l.buildNotification({message:c["3DEXPERIENCE_PLATFORM_CONFIGURATION_FAILURE"],title:c.ERROR},"error"),e.onFailure&&e.onFailure()})},initUtils:function(){i.properties.forEach(e=>!s[e]&&(s[e]=i[e]))},refreshWidget:function(e){this.homeViewLoading||(this.homeView&&!this._prefOpenedAndClosed&&this.handleModicationPending(e),delete this._prefOpenedAndClosed)},_initializeHomeView:function(t){let i=this,n=e.clone(t||{},!1);if(widget.data.X3DContentId){let e=JSON.parse(widget.data.X3DContentId);n.paramData=e.data.items}else widget.data.ids&&(n.paramData=[{objectId:widget.data.ids,serviceId:"3DSpace"}]);this.homeView=new i.homeModule(n),this.homeView.listenTo(widget,"onResize",function(){i.setDimensions()})},getHomeView:function(){return this.homeView},_initializePreference:function(){n.get("isComponent")||(widget.addPreference({name:r.COLLABSTORAGE,type:"list",disabled:!0,options:[{label:"None",value:"None"}],label:c["3DEXPERIENCE_PLATFORM"]}),widget.addPreference(d))},_initPreferencesWithConstants:function(){this.REFRESHTIMEOUT=1e3*parseInt("REFRESH_TIMEOUT",10),widget.dispatchEvent("onResize")},onPreferencesOpened:function(){this._prefsWhenOpened=widget.getPreferences().reduce(function(e,t){return e[t.name]=t.value,e},{})},onPreferencesClosed:function(e){e&&e.submitted&&(this.homeViewLoading=!1,this.handleModicationPending(),this._prefOpenedAndClosed=!0)},onViewChange:function(){let e=widget.getView();e.previous&&e.previous.type!==e.type&&this.setDimensions()},setDimensions:function(){let e=widget.getViewportDimensions();n.set(e),n.dispatchEvent("onChange:dimensions")},renderHomeView:function(t){if(this.homeView){let i=e.clone(t||{},!1);delete i.callback,this.homeViewLoading=!1,i.showLoadSpinner=!0,this.homeView.reload(i)}},setSpace:function(e){if(e.callback=this.setSpace.bind(this,e),this.homeView&&!this.homeView.handleUnsaveForSearchAndPreferences(e)){let t=this;if(this.homeViewLoading)return;this.homeViewLoading=!0;let i=!1,o=!1,h=n.get("isComponent");if(this._prefsWhenOpened||e.refresh){for(let e in this._prefsWhenOpened)this._prefsWhenOpened[e]!==widget.getValue(e)&&(e===r.COLLABSTORAGE?(a.processStorage(),i=!0,h||(widget.addPreference(d),widget.setValue(r.COLLABSPACE,""),widget.setValue(r.X_PREF_CREDENTIAL,"")),n.unset(r.COLLABSPACE)):(e===r.COLLABSPACE&!h&&widget.setValue(r.X_PREF_CREDENTIAL,widget.getValue(e).replace(r.CTX_PREFIX,"")),n.set(e,widget.getValue(e)),o=!0),t.homeView.clearParamData());e.refresh&&!o&&(e.showRefreshMessage=!0,t.handleHomeView(e))}else a.processStorage(),i=!0;i?this.getSecurityContexts().then(function(i){let n=t._getDefaultSecurityContext(i);h||(widget.setValue(r.COLLABSPACE,n),widget.setValue(r.X_PREF_CREDENTIAL,n.replace(r.CTX_PREFIX,""))),t.setSecurityContext(n),t.homeView?t.handleHomeView(e):s.loadType(t.homeModule).then(function(){t.handleHomeView(e)},function(){t.homeViewLoading=!1,l.buildNotification({message:c.HOMEVIEW_INITIALIZATION_FAILED,title:c.ERROR},"error")})}):o?t.handleHomeView(e):t.homeViewLoading=!1}},setSecurityContext:function(e,t){t&&a.processStorage(),n.set(r.COLLABSPACE,e)},_getDefaultSecurityContext:function(e){let t,i,o=!1;return n.get("isComponent")?n.get(r.COLLABSPACE):(t=(i=widget.getPreference(r.COLLABSPACE)).value,e=e&&e.list,t&&e&&(o=s.findObject(e,"value",t))?t:i.defaultValue)},getSecurityContexts:function(){let e=this,t=new o;return new Promise(function(i,o){t.fetch({onComplete:function(t){let o=t.getSortedPreferences();if(o&&o.list.length){let t=o.defaultValue,i=t.replace(r.CTX_PREFIX,"");n.get("isComponent")?(n.set(r.X_PREF_CREDENTIAL,i),e.setSecurityContext(t)):(widget.setValue(r.X_PREF_CREDENTIAL,i),widget.addPreference({name:r.COLLABSPACE,type:"list",disabled:!1,defaultValue:t,options:o.list,label:c.CREDENTIALS}))}i(o)},onFailure:function(e,t){o(t)}})})},handleModicationPending:function(t){l.clearNotificationMessages();let i=e.clone(t||{},!1);e.extend(i,{refresh:!0,valiateInvalidRisksContext:!0}),s.validateModificationsPending({parentView:this.homeView,isReload:!0,dontResetModel:!0,yesEventFunc:this.setSpace.bind(this,e.extend({yesEvent:!0},i)),noEventFunc:this.setSpace.bind(this,i)})},handleHomeView:function(e){!n.get("isComponent")&&this.renderHomeView(e)},destroy:function(){n.clear(),this.homeView&&this.homeView.destroy(),this._parent()}})}),define("DS/ENOProjectMgmtCommonComponents/views/DetailsDisplay",["UWA/Core","UWA/Promise","DS/DocumentManagement/DocumentManagement","DS/E6WCommonUI/Views/DetailsDisplayView","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a){"use strict";return e.Class.View.extend({_uwaClassName:"DetailsDisplay",container:void 0,detailsDisplayView:void 0,homeView:void 0,model:void 0,customViewInitialized:!1,height:void 0,setup:function(e,t){this.container=e,this.homeView=t,this.height=t.getHeight(),this.model=t.currentModel,this.detailsDisplayView=new n({DocumentManagement:i,homeView:this.homeView,model:t.currentModel,displayMessage:s.displayMessage}),this.listenTo(this.model,"onValidationSuccess",this.clearValidationErrors)},setConfig:function(e){this._config=e},render:function(){this.container.empty();let t=e.clone(this._config.values||{},!1);this.handleCustomFieldConfigs(t),this.detailsDisplayView.setConfig(t),this.detailsDisplayView.render().inject(this.container);let i=Object.keys(this.model.localAttributes),n=Object.keys(this.model.localRelatedItems);i.length||n.length||(delete this.model.modificationsPending,this.homeView.showSaveCancelFooter(!1)),this.handleEvents()},handleEvents:function(){this.listenTo(this.model,{resetDetailsDisplay:this.resetConfigAndRender})},resetModel:function(e){this.detailsDisplayView.resetModel(e)},reRender:function(){this.detailsDisplayView&&this.detailsDisplayView.render()},acceptChanges:function(){this.resetConfigAndRender()},resetConfigAndRender:function(){this.setConfig(this._config),this.render(),this.homeView.updateScrollPosition()},getFieldViewByName:function(){return this.detailsDisplayView&&this.detailsDisplayView.getFieldViewByName.apply(this.detailsDisplayView,arguments)},clearValidationErrors:function(){for(var e=this.container.getElements(".has-error"),t=0;t<e.length;t++)e[t].toggleClassName("has-error",!1)},handleCustomFieldConfigs:function(t){let i=o.filterObjects(t,"name",this.homeView.getCustomFields());i.length&&i.forEach(i=>{let n=i.values;if(e.is(n,"array")&&1===n.length)if(this.homeView.isNew){let e=o.findIndex(t,"name",i.name);-1!==e&&t.splice(e,1)}else i.readWrite=!1,"policy"===i.name&&(i.group=a.MORE)})},destroy:function(){this.stopListening(),this.detailsDisplayView&&(this.detailsDisplayView.destroy(),delete this.detailsDisplayView)}})}),define("DS/ENOProjectMgmtCommonComponents/config/CalendarDisplayListConfig",["UWA/Core","DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/config/DefaultGridConfig","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";let o=t.extend({_uwaClassName:"CalendarDisplayListConfig",columnInfo:{},ignoreCheckBoxSelection:!0,customContentColumnInfo:{},setup:function(){this.setColumnInfo()},type:"list",gridConfig:function(){let t=e.clone(i);return t.identifier="CalendarListGridView",t.columnsHeader=!0,t.showContextualMenuColumnFlag=!1,t.layoutOptions.rowsHeader=!1,t.layoutOptions.columnsHeader=!0,t}(),values:[{text:n.EXCEPTION_NAME,key:"title",dataIndex:"tree",minWidth:"150",icon:""},{text:n.EXCEPTION_TYPE,minWidth:"120",dataIndex:"exceptionType"},{text:n.NEXT_INSTANCE,minWidth:"120",dataIndex:"nextOccurrence",typeRepresentation:"date"},{text:n.FREQUENCY,minWidth:"120",dataIndex:"frequency"},{text:n.PATTERN,minWidth:"220",dataIndex:"pattern"},{text:n.EFFECTIVE_FROM,minWidth:"120",dataIndex:"startDate",alignmentValue:"center",typeRepresentation:"date"},{text:n.EFFECTIVE_TO,minWidth:"120",dataIndex:"endDate",alignmentValue:"center",typeRepresentation:"date"}]});return o._instance=o._instance||new o,o._instance}),define("DS/ENOProjectMgmtCommonComponents/utils/ClassificationCloneModel",["UWA/Core","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel"],function(e,t){"use strict";return t.extend({_uwaClassName:"ClassificationCloneModel",set:function(){let t=arguments[1];t&&e.is(t,"object")&&(t=t.actualValue,arguments[1]=t),this._parent.apply(this,arguments),this.dispatchEvent("onChangeAttributeValue",arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/components/CommonCalendar",["UWA/Core","DS/Controls/Tab","DS/ENOProjectMgmtModels/Models/Calendar","DS/ENOProjectMgmtCommonComponents/views/CalendarsView","DS/ENOProjectMgmtCommonComponents/components/CustomDataGridView","DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/config/CalendarDisplayListConfig","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","UWA/Class/Collection","UWA/Class/Model","text!DS/ENOProjectMgmtCommonComponents/assets/templates/calendar-view-template.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g){"use strict";return e.Class.View.extend({_uwaClassName:"CalendarsView",_appConfig:void 0,_container:void 0,_viewCollection:void 0,_calendar:void 0,_calendarData:void 0,_currentModel:void 0,_workingExceptions:[],_nonWorkingExceptions:[],_weekendDays:[],_eventContainer:void 0,_days:{Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},_monthslist:{January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11},_days_small:{Sun:0,Mon:1,Tue:2,Wed:3,Thu:4,Fri:5,Sat:6},init:function(t,n){let o=n||{};if(this._container=t,this._calendarContainer=new e.createElement("div"),this._appConfig=o.appConfig,o.calendarId)this._currentModel=new i,this._currentModel.set("id",o.calendarId);else if(o.model)if(o.model.get("exceptions")&&o.model.get("workweek"))this._currentModel=o.model;else{this._currentModel=new i,this._currentModel.id=o.model.get("id")||o.model.get("calendarId"),this._currentModel.url=o.model.url;let e={};e.id=this._currentModel.id,e.title=o.model.get("title"),e.relativePath=o.model.get("relativePath"),this._currentModel.set(e)}o&&o.viewCollection?this._viewCollection=n.viewCollection:this._viewCollection=new s({})},render:function(){let i=this;if(this._container.empty&&this._container.empty(!0),this._calendarContainer=this._calendarContainer.setHTML(m),this._calendarContainer=this._calendarContainer.getElement(".ds-app-dialog-container"),this._exceptionTabContainer=this._calendarContainer.getElement(".ds-app-calendar-gridview-container"),this._exceptionContainer=new e.createElement("div"),this._exceptionContainer.inject(this._exceptionTabContainer),this._calendarTabContainer=this._calendarContainer.getElement(".ds-app-calendar-preview-container"),this._calendarControlContainer=this._calendarTabContainer.getElement(".ds-app-calendar-preview"),this._eventListContainer=this._calendarTabContainer.getElement(".ds-app-calendar-event-list"),this._eventContainer=this._eventListContainer.getElement(".ds-app-calendar-events"),this._toolbarContainer=this._calendarContainer.getElement(".ds-app-dialog-toolbar"),!this._currentModel)return;let n={ignoreFieldDefinition:!0,model:this._currentModel,fields:"all,exceptions.nextOccurrence"};this._ddTabBar=new t({id:"commonCalendarDialogTab",displayStyle:"strip",showComboBoxFlag:!1}),this._ddTabBar.inject(this._toolbarContainer),this._createTabs();let o=this._handleTabClickEvents.bind(this);return this._ddTabBar.addEventListener("tabButtonClick",o),this._ddTabBar.fire("tabButtonClick"),this._createCalendar(),i._calendar.addEventListener("change",function(){i._calendar.allowUndefinedFlag=!0}),i._calendar.elements.monthsCombo.addEventListener("change",function(){i._calendar.value=void 0}),i._calendar.elements.yearsCombo.addEventListener("change",function(){i._calendar.value=void 0}),i._calendar.elements.todayButton.addEventListener("buttonclick",function(){i._calendar.value=[new Date]}),this._currentModel.get("exceptions")&&this._currentModel.get("workweek")?i._onPostCalendarDetailsFetch():this._viewCollection.getDataModelDetails(n).then(function(){i._onPostCalendarDetailsFetch()},function(){}),this._calendarContainer},_onPostCalendarDetailsFetch:function(){this._workingExceptions=[],this._nonWorkingExceptions=[],this._generatePatternForExceptions(),this.repaintCalendarDates()},_createExeptionsDefinition:function(){this._exceptionDefinitionDataGrid=new o({container:this._exceptionContainer,treeDocument:this._treeDocument,config:l})},_createCalendar:function(){this._calendar=new n(this,{value:void 0,allowMultipleValuesFlag:!0,minValue:new Date(1900,1,1),maxValue:new Date(2122,1,1)}),this._calendar.inject(this._calendarControlContainer)},_createTabs:function(){let e=this,t=[{name:g.CALENDAR,selected:!0,font:"calendar",checkFlag:!0},{name:g.EXCEPTION_DEFINITION,font:"view-list",checkFlag:!0}];t.forEach(i=>{e._ddTabBar.add({label:i.name,isSelected:i.selected,icon:{iconName:i.font,fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"2x"},checkFlag:t.checkFlag}).button})},_handleTabClickEvents:function(e){let t=e.dsModel,i=t.value;t.buttonGroup&&(t.buttonGroup.previouslySelectedIndex=i[0]),0===i[0]?(this._calendarTabContainer.show(),this._exceptionTabContainer.hide()):(this._calendarTabContainer.hide(),this._exceptionTabContainer.show())},_createDisplayElements:function(t,i,n){return new e.createElement(t,{class:i,text:n})},_retrieveWorkHours:function(e,t){return t.get("workweek")[e].workingHours.split(/[-,]+/)},_displayExceptionList:function(t,i,n,o){let s=this._getFirstDateInDisplayPanel(),l=this._getLastDateInDisplayPanel(),r=new e.createElement("div",{class:"ds-app-calendar-event"});if(r.inject(this._eventContainer),!o||n){if(i>=s&&i<=l){let e=a.getIntlDateFormat(i);if(this._createDisplayElements("div","ds-app-calendar-date",e.displayValue).inject(r),!n){this._createDisplayElements("div","ds-app-exception-name",t.title).inject(r)}let o=n?this._retrieveWorkHours(i.getDay(),t):t.workingHours.split(/[-,]+/),s=this._getWorkingHoursFormat(o[0].slice(0,2),o[0].slice(2,4)),l=this._getWorkingHoursFormat(o[o.length-1].slice(0,2),o[o.length-1].slice(2,4)),c=!1;if(n?"Working"===t.get("workweek")[i.getDay()].workdayType&&(c=!0):"Working"===t.exceptionType&&(c=!0),c){this._createDisplayElements("div","ds-app-exception-hours",g.WORKING_HOURS+": "+s+"-"+l).inject(r)}if(!n){this._getWeekendDays();let e="Non Working"===t.exceptionType?"non-working":"working",n=this._weekendDays[i.getDay()]?"weekend":"weekday",o="Working"===t.exceptionType?g.WORKING:g.NON_WORKING,s=this._createDisplayElements("div","ds-app-exception-type",o);s.setAttributes({"data-exception-type":e,"data-day-type":n}),s.inject(r)}}}else{this._createDisplayElements("span","empty-view-title",g.NO_CALENDAR_EXCEPTIONS_FOUND).inject(r)}},_addClassToElement:function(e,t,i,n){e.hasClassName(t)&&(n&&e.removeClassName(t),e.addClassName(i))},repaintCalendarDates:function(){if(!this._calendar)return;this._getExceptionList();let t=this._calendar.getContent().getElements(".other-date"),i=this._calendar.getContent().getElements(".days");null!==this._calendar.getContent().getElement(".today")&&i.push(this._calendar.getContent().getElement(".today")),i.push(...t);let n=e.clone(this._weekendDays),o=e.clone(this._nonWorkingExceptions),s=e.clone(this._workingExceptions),a=[],l=[];a=this._getDatesInElementValueFormat(o),l=this._getDatesInElementValueFormat(s);for(let e=0;e<i.length;e+=1){a.includes(i[e].dataset.value)&&(this._addClassToElement(i[e],"other-date","ds-app-non-working")||this._addClassToElement(i[e],"days","ds-app-non-working")||this._addClassToElement(i[e],"today","ds-app-non-working")),l.includes(i[e].dataset.value)&&a.includes(i[e].dataset.value)?this._addClassToElement(i[e],"ds-app-non-working","ds-app-working",!0):l.includes(i[e].dataset.value)&&(this._addClassToElement(i[e],"other-date","ds-app-working")||this._addClassToElement(i[e],"days","ds-app-working")||this._addClassToElement(i[e],"today","ds-app-working"));let t=i[e].dataset.value.split("/"),o=t[1]+"/"+t[0]+"/"+t[2];n[new Date(o).getDay()]&&(a.includes(i[e].dataset.value)?this._addClassToElement(i[e],"ds-app-non-working","ds-app-weekend")||this._addClassToElement(i[e],"other-date","ds-app-weekend non-working"):l.includes(i[e].dataset.value)?this._addClassToElement(i[e],"ds-app-working","ds-app-weekend")||this._addClassToElement(i[e],"other-date","ds-app-weekend working"):this._addClassToElement(i[e],"days","ds-app-weekend"))}this._workingExceptions=[],this._nonWorkingExceptions=[]},_getDailyExceptionDates:function(e,t){let i=this._getFirstDateInDisplayPanel(),n=this._getLastDateInDisplayPanel(),o=this._getDateBasedOnMMDDYYYY(new Date(Math.max(e,i))),s=this._getDateBasedOnMMDDYYYY(new Date(Math.min(t,n))),a=this._getDateBasedOnMMDDYYYY(new Date(e.getTime())),l=[];for(;a<=s;){if(o<=a&&a<=s&&a>=i&&a<=n){let e=this._getDateBasedOnMMDDYYYY(new Date(a));l.push(e)}a.setDate(a.getDate()+1)}return l},_getWeeklyExceptionDates:function(e,t,i){let n=e.split(","),o=[];return n.forEach(e=>{if(""!==e){let n=this._days_small[e],s=this._getFirstDateInDisplayPanel(),a=this._getLastDateInDisplayPanel();for(;s.getDay()!==n;)s.setDate(s.getDate()+1);for(;s<=a;)t<=s&&s<=i&&(o.push(new Date(s.getTime())),this._getDateBasedOnMMDDYYYY(new Date(s))),s.setDate(s.getDate()+7)}}),o},_getMonthlyException_TypeWeekly_Helper:function(e,t,i,n,o,s,a,l){let r=this._getFirstInstanceOfSelectedWeekDay(e,t),c=this._weekdaysProcessing(n,r,i),d=this._getSelectedDayOfWeekForMonthly(c,o),h=void 0;return"CURRENTMONTH"===l&&s<=d&&d<=a&&(h=this._getDateBasedOnMMDDYYYY(new Date(d))),"PREVIOUSMONTH"===l&&this._getFirstDateInDisplayPanel()<=d&&d<=i&&s<=d&&d<=a&&(h=this._getDateBasedOnMMDDYYYY(new Date(d))),"NEXTMONTH"===l&&this._getFirstDateInDisplayPanel()<=d&&d<=this._getLastDateInDisplayPanel()&&s<=d&&d<=a&&(h=this._getDateBasedOnMMDDYYYY(new Date(d))),h},_getMonthlyExceptionDates_DayOfWeekOfMonthType:function(e,t,i,n){let o=[],s=this._days[e],a=this._getDateBasedOnMMDDYYYY(new Date(i)),l=this._getDateBasedOnMMDDYYYY(new Date(n)),r=this._getMonthAndDateSwappedForFirstElement(".days"),c=new Date(r),d=this._getDateBasedOnMMDDYYYY(new Date(c.getFullYear(),c.getMonth(),1)),h=new Date(c.getFullYear(),c.getMonth()+1,0),u=this._getMonthlyException_TypeWeekly_Helper(s,c,h,[],t,a,l,"CURRENTMONTH");void 0!==u&&o.push(u);let m=[],g=this._getFirstDateInDisplayPanel();if(g<new Date(d)){let e=this._getDateBasedOnMMDDYYYY(this._getFirstDateOfSelectedMonth(g)),i=this._getDateBasedOnMMDDYYYY(this._getLastDateOfSelectedMonth(g)),n=this._getMonthlyException_TypeWeekly_Helper(s,e,i,m,t,a,l,"PREVIOUSMONTH");void 0!==n&&o.push(n)}let p=[],C=this._getLastDateInDisplayPanel(),f=this._getFirstDateOfSelectedMonth(C),D=this._getLastDateOfSelectedMonth(C);if(C>h){let e=this._getMonthlyException_TypeWeekly_Helper(s,f,D,p,t,a,l,"NEXTMONTH");void 0!==e&&o.push(e)}return o},_getYearlyExceptionsDates_DayOfMonthTypeHelper:function(e,t,i,n,o,s,a){let l=[];if(i.getMonth()===this._monthslist[t]&&e>=i.getDate()&&e<=n){let t=new Date(i.getMonth()+1+"/"+e+"/"+i.getFullYear()),r=this._getDateBasedOnMMDDYYYY(new Date(t));"CURRENTMONTH"===a&&o<=r&&r<=s&&l.push(new Date(t)),"PREVIOUSMONTH"===a&&o<=r&&r<=s&&r>=i&&l.push(new Date(t)),"NEXTMONTH"===a&&o<=r&&r<=s&&r<=n&&l.push(new Date(t))}return l},_getYearlyExceptionsDates_DayOfMonthType:function(e,t,i,n){let o=this._getFirstDateOfSelectedMonth(this._calendar.referenceDate),s=this._getLastDateOfSelectedMonth(o).getDate(),a=this._getYearlyExceptionsDates_DayOfMonthTypeHelper(e,t,o,s,i,n,"CURRENTMONTH"),l=this._getFirstDateInDisplayPanel(),r=new Date(l.getFullYear(),l.getMonth()+1,0).getDate();if(l<o){let o=this._getYearlyExceptionsDates_DayOfMonthTypeHelper(e,t,l,r,i,n,"PREVIOUSMONTH");a.push(...o)}let c=this._getLastDateInDisplayPanel();if(c.getMonth()!==o.getMonth()){let s=new Date(c.getFullYear(),c.getMonth(),1);if(c>o){let o=this._getYearlyExceptionsDates_DayOfMonthTypeHelper(e,t,s,c,i,n,"NEXTMONTH");a.push(...o)}}return a},_getMonthlyException_TypeDayOfMonth_Helper:function(e,t,i,n,o,s,a){let l=[];if(s.getDate()<=e&&e<=a.getDate()){s.setDate(e);let a=new Date(s);a>=n&&a<=o&&a>=t&&a<=i&&l.push(this._getDateBasedOnMMDDYYYY(new Date(a)))}return l},_getMonthlyException_TypeDayOfMonth:function(e,t,i,n,o){let s=this._getFirstDateOfSelectedMonth(this._calendar.referenceDate),a=this._getLastDateOfSelectedMonth(this._calendar.referenceDate),l=this._getMonthlyException_TypeDayOfMonth_Helper(e,t,i,n,o,s,a),r=this._getFirstDateInDisplayPanel(),c=this._getLastDateOfSelectedMonth(r);if(r.getMonth()!==s.getMonth()){let s=this._getMonthlyException_TypeDayOfMonth_Helper(e,t,i,n,o,r,c);l.push(...s)}let d=this._getLastDateInDisplayPanel(),h=this._getFirstDateOfSelectedMonth(d),u=this._getLastDateOfSelectedMonth(d);if(d.getMonth()!==s.getMonth()){let s=this._getMonthlyException_TypeDayOfMonth_Helper(e,t,i,n,o,h,u);l.push(...s)}return l},_getYearlyExceptionsDates_WeekOfMonthTypeHelper(e,t,i,n,o,s,a,l,r){let c=[],d=this._getFirstInstanceOfSelectedWeekDay(e,n),h=this._weekdaysProcessing([],d,o),u=this._getSelectedDayOfWeekForMonthly(h,t);return s<=u&&u<=a&&u>=l&&u<=r&&o.getMonth()===this._monthslist[i]&&c.push(this._getDateBasedOnMMDDYYYY(new Date(u))),c},_getYearlyExceptionsDates_WeekOfMonthType:function(e,t,i,n,o){let s=this._getFirstDateOfSelectedMonth(this._calendar.referenceDate),a=this._getFirstDateInDisplayPanel(),l=this._getLastDateInDisplayPanel(),r=this._getLastDateOfSelectedMonth(s),c=this._getYearlyExceptionsDates_WeekOfMonthTypeHelper(e,t,i,s,r,n,o,a,l);if(a<s){let s=this._getFirstDateOfSelectedMonth(a),r=this._getLastDateOfSelectedMonth(a),d=this._getYearlyExceptionsDates_WeekOfMonthTypeHelper(e,t,i,s,r,n,o,a,l);c.push(...d)}if(l>r){let s=this._getFirstDateOfSelectedMonth(l),r=this._getLastDateOfSelectedMonth(l),d=this._getYearlyExceptionsDates_WeekOfMonthTypeHelper(e,t,i,s,r,n,o,a,l);c.push(...d)}return c},_callToDisplayFilteredExceptionList:function(e,t){if(0===e.size){let e=!0;this._displayExceptionList(this._currentModel,this._getDateBasedOnMMDDYYYY(new Date),!1,e)}if(t.length>0){let i=!1;for(let n=0;n<t.length;n++)e.has(t[n])?this._displayExceptionList(e.get(t[n]),this._getDateBasedOnMMDDYYYY(new Date(t[n])),!1,i):this._displayExceptionList(this._currentModel,this._getDateBasedOnMMDDYYYY(new Date(t[n])),!0,i)}else{let t=!1;e.forEach((e,i)=>{this._displayExceptionList(e,this._getDateBasedOnMMDDYYYY(new Date(i)),!1,t)})}},_setSortedDatesInSelectedDatesMap:function(e,t,i){for(let e=0;e<i.length;e++){let n=this._getDateBasedOnMMDDYYYY(i._models[e].get("date")).toDateString(),o=i._models[e].get("label");t.has(n)?"Working"===o.exceptionType&&t.set(n,o):t.set(n,o)}return t},_getDatesInElementValueFormat:function(e){let t=[];for(let i=0;i<e.length;i+=1)t[i]='"'+e[i].getDate()+"/"+(e[i].getMonth()+1)+"/"+e[i].getFullYear()+'"';return t},_generatePatternForExceptions:function(){let e=new d;this._eventContainer.empty(),this._treeDocument=new r({dataModelSet:e}),this._currentModel.get("exceptions").forEach(t=>{let i=this._getPatternOfException(t);t.pattern=i;let n="Working"===t.exceptionType?g.WORKING:g.NON_WORKING,o="Daily"===t.frequency?g.DAILY:"Monthly"===t.frequency?g.MONTHLY:"Weekly"===t.frequency?g.WEEKLY:g.YEARLY,s=JSON.parse(JSON.stringify(t));s.exceptionType=n,s.frequency=o;let a=c.createTreeNodeDataModel(e,{label:s.title,grid:s});this._treeDocument.addChild(a),this._exceptionDefinitionDataGrid||this._createExeptionsDefinition()})},_createUWAModelForExceptions:function(e,t){let i=new u;return i.set("label",e),i.set("date",t),i},_getExceptionList:function(){this._eventContainer.empty();let e=new h([],{comparator:"date"});0===this._currentModel.get("exceptions").length&&(this._exceptionDefinitionDataGrid||this._createExeptionsDefinition()),this._currentModel.get("exceptions").forEach(t=>{let i="Working"===t.exceptionType?this._workingExceptions:this._nonWorkingExceptions,n=this._getDateBasedOnMMDDYYYY(new Date(t.startDate)),o=this._getDateBasedOnMMDDYYYY(new Date(t.endDate)),s=this._getFirstDateInDisplayPanel(),a=this._getLastDateInDisplayPanel();if("Daily"===t.frequency){this._getDailyExceptionDates(n,o).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}else if("Weekly"===t.frequency){this._getWeeklyExceptionDates(t.daysOfWeek,n,o).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}else if("Monthly"===t.frequency)if(""!==t.weekOfMonth){this._getMonthlyExceptionDates_DayOfWeekOfMonthType(t.dayOfWeek,t.weekOfMonth,t.startDate,t.endDate).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}else{let l=parseInt(t.dayOfMonth);this._getMonthlyException_TypeDayOfMonth(l,s,a,n,o).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}else if("Yearly"===t.frequency)if(""===t.weekOfMonth){t.dayOfMonth,t.monthOfYear;this._getYearlyExceptionsDates_DayOfMonthType(t.dayOfMonth,t.monthOfYear,n,o).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}else{let s=this._days[t.dayOfWeek],a=t.monthOfYear,l=t.weekOfMonth;this._getYearlyExceptionsDates_WeekOfMonthType(s,l,a,n,o).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}});let t=e.sort(function(e,t){return Number(e[1].date)-Number(t[1].date)}),i=this._getMonthAndDateSwappedForElements(".selected"),n=new Map;n=this._setSortedDatesInSelectedDatesMap(i,n,t),this._callToDisplayFilteredExceptionList(n,i),n.clear(),this._getWeekendDays()},_getDateBasedOnMMDDYYYY:function(e){return new Date(e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear())},_getMonthAndDateSwappedForElements:function(e){let t=this._calendar.getContent().getElements(e),i=[];for(let e=0;e<t.length;e++){let n=t[e].dataset.value.split("/"),o=n[1].replace(/\\|"/g,"")+"/"+n[0].replace(/\\|"/g,"")+"/"+n[2].replace(/\\|"/g,"");i.push(this._getDateBasedOnMMDDYYYY(new Date(o)).toDateString())}return i},_getMonthAndDateSwappedForFirstElement:function(e){let t=this._calendar.getContent().getElement(e).dataset.value.split("/");return t[1].replace(/\\|"/g,"")+"/"+t[0].replace(/\\|"/g,"")+"/"+t[2].replace(/\\|"/g,"")},_getFirstDateOfSelectedMonth:function(e){let t=this._getDateBasedOnMMDDYYYY(e),i=new Date(t.getFullYear(),t.getMonth(),1);return this._getDateBasedOnMMDDYYYY(i)},_getLastDateOfSelectedMonth:function(e){let t=this._getDateBasedOnMMDDYYYY(e),i=new Date(t.getFullYear(),t.getMonth()+1,0);return this._getDateBasedOnMMDDYYYY(i)},_weekdaysProcessing:function(e,t,i){for(;t<=i;)e.push(new Date(t.getTime())),t.setDate(t.getDate()+7);return e},_getSelectedDayOfWeekForMonthly:function(e,t){let i={first:0,second:1,third:2,fourth:3,last:e.length-1}[t.toLowerCase()];return this._getDateBasedOnMMDDYYYY(new Date(e[i]))},_getFirstInstanceOfSelectedWeekDay:function(e,t){for(;t.getDay()!==e;)t.setDate(t.getDate()+1);return t},_getPatternOfException:function(e){let t="",i={First:0,Second:1,Third:2,Fourth:3,Last:4};if("Daily"===e.frequency)t="";else if("Weekly"===e.frequency){let i="";e.daysOfWeek.split(",").forEach(e=>{if(""!==e){let t=this._days_small[e];i+=g.SHORTWEEKDAYS[t]+","}}),t=i.slice(0,i.length-1)}else"Monthly"===e.frequency?t=""!==e.weekOfMonth?g.replace(g.WEEKOFMONTH_DAYOFWEEK_OF_EVERY_MONTH,{WeekOfMonth:g.WEEKOFMONTHLIST[i[e.weekOfMonth]],DayOfWeek:g.WEEKDAYS[this._days[e.dayOfWeek]]}):g.replace(g.DAY_DAYOFMONTH_OF_EVERY_MONTH,{dayOfMonth:e.dayOfMonth}):"Yearly"===e.frequency&&(t=""===e.weekOfMonth?g.replace(g.DAY_DAYOFMONTH_MONTHOFYEAR,{DayOfWeek:e.dayOfMonth,MonthOfYear:g.MONTHS[this._monthslist[e.monthOfYear]]}):g.replace(g.WEEKOFMONTH_DAYOFWEEK_OF_MONTHOFYEAR,{WeekOfMonth:g.WEEKOFMONTHLIST[i[e.weekOfMonth]],DayOfWeek:g.WEEKDAYS[this._days[e.dayOfWeek]],MonthOfYear:g.MONTHS[this._monthslist[e.monthOfYear]]}));return t},_getLastDateInDisplayPanel:function(){let e=this._getMonthAndDateSwappedForElements(".days"),t=e[e.length-1];if(null===this._calendar.getContent().getElement(".other-date"))return this._getDateBasedOnMMDDYYYY(new Date(t));let i=this._getMonthAndDateSwappedForElements(".other-date"),n=new Date(i[i.length-1]),o=new Date(t);return this._getDateBasedOnMMDDYYYY(new Date(Math.max(n,o)))},_getFirstDateInDisplayPanel:function(){if(null===this._calendar.getContent().getElement(".other-date"))return this._getDateBasedOnMMDDYYYY(new Date(this._getMonthAndDateSwappedForFirstElement(".days")));let e=this._getDateBasedOnMMDDYYYY(new Date(this._getMonthAndDateSwappedForFirstElement(".other-date"))),t=this._getDateBasedOnMMDDYYYY(new Date(this._getMonthAndDateSwappedForFirstElement(".days")));return this._getDateBasedOnMMDDYYYY(new Date(Math.min(e,t)))},_getWorkingHoursFormat:function(e,t){let i=e,n=i>=12?"PM":"AM";return(i=i%12||12)+":"+t+" "+n},_getWeekendDays:function(){this._currentModel.get("workweek").forEach(e=>{if("Non Working"===e.workdayType){let t=this._days[e.dayOfWeek];this._weekendDays[t]=!0}})},destroy:function(){this._calendar&&this._calendar.destroy(),this._container.empty&&this._container.empty(),this._exceptionDefinitionDataGrid&&(this._exceptionDefinitionDataGrid.destroy(),delete this._exceptionDefinitionDataGrid)}})}),define("DS/ENOProjectMgmtCommonComponents/views/DateCustomView",["UWA/Core","DS/Controls/DatePicker","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils"],function(e,t,i,n){"use strict";return i.extend({setup:function(e){this.options=e,this.model=e&&e.model,this._parent.apply(this,arguments)},render:function(){let i=this;this.container.empty(!0),this.dateFieldContainer=e.createElement("div",{class:(this.model.model.canModify(),"editable")}),this.dateFieldContainer.inject(this.container),this.attributeLabel=new e.Element("label",{text:this.options.config.label}),this.attributeLabel.inject(this.dateFieldContainer),this.groupStackedFields=e.createElement("div",{class:"field-group stacked-fields"}),this.groupStackedFields.inject(this.dateFieldContainer),this.groupWrapper=e.createElement("div",{class:"input-group-wrapper"}),this.groupWrapper.inject(this.groupStackedFields),this.datePickrSpanContainer=e.createElement("div",{class:"input-group"}),this.datePickrSpanContainer.inject(this.groupWrapper),this.datePickerContainer=e.createElement("span",{class:"input-element"}),this.datePickerContainer.inject(this.datePickrSpanContainer);let o=this.options.config.name,s=this.model.get(o),a=s&&n.getIntlDateFormat(s);return this.model.model.canModify()?(this.datePicker=new t({value:a&&a.actualValue||s,timePickerFlag:!1}).inject(this.datePickerContainer),this.datePicker.fired=!1,this.datePicker.addEventListener("change",function(e){i.model.set(o,e.dsModel.value)})):(this.attributeValueLabel=new e.Element("span",{class:"read-only",text:a.displayValue||s}),this.attributeValueLabel.inject(this.datePickerContainer)),this},destroy:function(){this.attributeLabel.destroy(),this.datePicker&&this.datePicker.destroy(),this.datePickrSpanContainer&&this.datePickrSpanContainer.destroy(),this.datePickerContainer&&this.datePickerContainer.destroy(),this.groupWrapper.destroy(),this.groupStackedFields.destroy(),this.dateFieldContainer.destroy(),this._parent.apply(this,arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/views/CalendarPopup",["UWA/Core","DS/ENOProjectMgmtCommonComponents/components/CommonCalendar","DS/ENOProjectMgmtCommonComponents/components/PopupCommon","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";return e.Class.View.extend({_uwaClassName:"CalendarPopup",init:function(e,t){this._parentView=e,this._options=t,this.model=t&&t.model,this._parent(t)},render:function(){let e=new t(this,this._options);this.createDialogView=i.createDialog({minWidth:600,contentView:e,doNotshowDefaultButtons:!0,title:n.PREVIEW+" - "+(this.model&&(this.model.get("title")||this.model.title))||""}),this.createDialogView.buttons=void 0;let o=this.createDialogView.getContent().getElement(".wux-windows-window-maincontent.wux-element-contentbox");o&&o.addClassName("ds-app-calendar-preview-dialog")},getHeight:function(){return this._parentView.getHeight()},destroy:function(){this.createDialogView&&this.createDialogView.destroy()}})}),define("DS/ENOProjectMgmtCommonComponents/views/CalendarPopupSharedView",["UWA/Core","DS/Controls/Button","DS/ENOProjectMgmtCommonComponents/views/CalendarPopup","DS/E6WCommonUI/Views/DetailsDisplaySharedView"],function(e,t,i,n){"use strict";return n.extend({_sourceModel:void 0,_calendarModel:void 0,_calendarId:void 0,setup:function(e){this.options=e||{},this._sourceModel=e.model,this.calendarId=e.calendarId,this._parent.apply(this,arguments)},render:function(){let e=this;this.container.empty(!0);let n=this._sourceModel.get("calendar");if(n&&(this._calendarModel=n.at(0)),this._calendarModel){this._calendarId=this._calendarModel.get("id"),this.calendarButton=new t({displayStyle:"icon",icon:"calendar",label:this._calendarModel.get("title")}).inject(this.container);let n={model:this._calendarModel};this.calendarButton.addEventListener("click",function(){this._calendarPopup=new i(e,n),this._calendarPopup.render()})}return this},getHeight:function(){this.options.homeView.getHeight()},destroy:function(){this.calendarButton&&this.calendarButton.destroy(),this._calendarPopup&&this._calendarPopup.destroy(),this._parent.apply(this,arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/views/MassUpdateView",["UWA/Core","UWA/Class/View","DS/PlatformAPI/PlatformAPI","DS/LifecycleCmd/MaturityCmd","DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_TransferOwnershipCmd","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/config/MassUpdateToolbarConfig","DS/ENOProjectMgmtModels/Models/AppSettings"],function(e,t,i,n,o,s,a,l,r){"use strict";return t.extend({_uwaClassName:"MassUpdateView",init:function(e){this.homeView=e,this._collection=this.homeView._collection,this.massUpdateToolbarConfig=l,function(){let e=this,t=n.prototype.executeCmd;n.prototype.executeCmd=function(i){let n=i&&i.controller;e.listenTo(n,"onStateChanged",e.updateTreeDocument.bind(e)),e.listenTo(n,"onError",function(t){e.isOnErrorEventInvoked=t.dontshowsuccess}),t.apply(this,arguments)}}.apply(this,arguments),this.subscribeToPlatformEvents()},handleMassUpdateButtonEvents:function(e){switch(e){case s.DUPLICATE:this._collection.duplicateDataModels({operation:e,isSelect:this.homeView._detailsAndRelationships.prototype._isPropertyPanelOpen});break;case s.MATURITY:this.handleChangeMaturity();break;case s.CHANGE_OWNER:this.handleChangeOwner();break;case s.RELATIONS:this.handleRelations()}},handleChangeMaturity:function(e){delete this.isOnErrorEventInvoked;let t=this.getSelectedNodes(e);if(t.length){(new n).execute(t)}},handleChangeOwner:function(){let e=this.getSelectedNodes();if(e.length){new o({context:{getSelectedNodes:()=>e},ID:"ActionBar_ChangeOwner"}).execute()}},handleRelations:function(){a.launchApp(s.RELATIONS_WIDGET_APP_ID,this._collection.treeDocument.getSelectedNodeModels())},subscribeToPlatformEvents:function(){let e=this;i.unsubscribe("ENOLC_MOVE_CMD_UPDATE"),i.subscribe("ENOLC_MOVE_CMD_UPDATE",function(t){let i=t&&t.data,n=i&&i.paths;e.massUpdateForResultData(n)}),this.listenTo(this.homeView,"invokeMaturityUpdate",this.handleChangeMaturity)},updateTreeDocument:function(e){let t=e&&!this.isOnErrorEventInvoked&&e.data;this.massUpdateForResultData(t)},massUpdateForResultData:function(e){if(e){let t=[];if(e&&e.length&&e.forEach(function(e){let i=e.physicalid||e;t.push({objectId:i})}),t&&t.length){let e={collection:this._collection.collection.clone(),paramData:t,onComplete:this.onCompleteMassUpdate.bind(this),isMassUpdate:!0,fields:this.massUpdateToolbarConfig.fetchOptions.fields,includeFields:this.massUpdateToolbarConfig.fetchOptions.includeFields};this._collection.fetchAdditionalDataForModels(e)}}},onCompleteMassUpdate:function(){let e=this.homeView.getGridView();if(e){let t=e.detailsAndRelationships;t&&t.currentModel&&t.postCreateProcess()}},getSelectedNodes:function(t){t&&!e.is(t,"array")&&(t=[t]);let i=[];return(t=t||this._collection.treeDocument.getSelectedNodes())&&t.length&&t.forEach(e=>{let t=e.options.data,n=t.title,o=function(){return n};i.push({displayName:n,getLabel:o,getDisplayName:o,physicalid:t.id,getID:function(){return t.id},getType:function(){return t.get("type")},getOwner:function(){return t.get("owner")}})}),i}})}),define("DS/ENOProjectMgmtCommonComponents/config/ViewConfigBase",["UWA/Core","UWA/Class/View","DS/VENHighChart/UIHighCharts","DS/i3DXCompassPlatformServices/OpenWith","DS/ENORIPE_Relations/RelationsTabSettings","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/FieldsDefinition","DS/ENOProjectMgmtModels/Constants/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c){"use strict";let d,h,u=t.extend({_uwaClassName:"ViewConfig",_fieldDefinitionSource:void 0,setup:function(e){let t=this;this._initializeHighcharts(),this._fieldDefinitionSource=e,l.get(e)||l.set(e,{}),this.listenTo(l,"onChange:"+e,this._initializeRangeValues),this.listenTo(a,"onChange:tenant",function(){t._initializeOpenWith(),t._initializeRelationsTabSettings()})},_initializeHighcharts:function(){i.setOptions({lang:{weekdays:c.WEEKDAYS,shortMonths:c.SHORTMONTHS,months:c.MONTHS}}),a.set("highcharts",i)},_initializeOpenWith:function(){let e=this,t=new n;t._fetchCompatibleApps(function(i){t._appsList=i,e.setOpenWithInfo(t)})},setOpenWithInfo:function(e){d=e},getOpenWithInfo:function(){return d},_initializeRelationsTabSettings:function(){let t=this,i={isDraggable:!1,isProfilesVisible:!1,appID:a.get("appId"),isExternal:!0},n={getPlatformID:function(){return a.get("tenant")},getServiceID:function(){return r.SPACE_SOURCE}};o.isAvailable(n,i).then(function(i){e.is(i,"object")&&i.isAvailable&&i.facetInfo&&t.setRelationsFacetInfo(i.facetInfo)})},setRelationsFacetInfo:function(e){h=e},getRelationsFacetInfo:function(){return h},setFieldDefinitionData:function(e,t){let i={fieldServiceColumns:{},fieldCompositionServiceColumns:{},fieldDefinitionColumns:{classes:{isFieldGroup:!1,itemType:"service",items:[],name:"classes"},isLibraryInstalled:{label:t?"TRUE":"FALSE"}}};l.setFieldsDefinition(e,i)},isLibraryInstalled:function(){let e=this._fieldDefinitionSource&&l.getFieldDefinitionColumn(this._fieldDefinitionSource,"isLibraryInstalled");return Boolean(e&&"TRUE"===e.label)},matrixConfigCreateAccess:function(){let e=this._fieldDefinitionSource&&l.getFieldDefinitionColumn(r.APPLICATIONS.MATRIX_CONFIGURATION,"matrixConfigCreateAccess");return Boolean(e&&e.fieldDefinitionRangeItem&&e.fieldDefinitionRangeItem.TRUE)},_initializeRangeValues:function(e){let t=e.get(this._fieldDefinitionSource);for(let e in t)if("field"===t[e].itemType&&t[e].range)this._addRangeValues(t[e]);else if("service"===t[e].itemType)for(let i in t[e].items)"field"===t[e].items[i].itemType&&t[e].items[i].range&&this._addRangeValues(t[e].items[i])},_addUOMValuesToConfig:function(e,t,i,n){n.columnInfo[e].uomValues=s.getAttributeValues(t,"displayValue"),n.columnInfo[e].defaultValues=t},_addRangeValuesToConfigs:function(e,t,i,n){if(n){let o,s,a;n.forEach(n=>{s=n.uomMappedkeyValues&&n.uomMappedkeyValues[e.name],a=s||e.name,(o=n.columnInfo[a])&&(s?(this._addUOMValuesToConfig(a,t,i,n),e.format="uom"):(e.name!==r.IMPACT_ATTR&&e.name!==r.PROBABILITY_ATTR||(t=[],i=""),o.showIcon&&this.handleIconForRangeValues(t),n.columnInfo[a].values=t,n.columnInfo[a].defaultValue=i,n.columnInfo[a].defaultValues=t))})}},handleIconForRangeValues:function(e){e&&e.length&&e.forEach(e=>{e.fontIcon=e.actualValue})},_addRangeValues:function(e){let t,i=[],n=e.range.item;for(let e in n)if(n.hasOwnProperty(e)){let o={};o.displayValue=n[e].display,o.actualValue=n[e].value,(n[e].default||1===n.length)&&(t=n[e].value),i.push(o)}this._addRangeValuesToConfigs(e,i,t)},addRangeValuesFromCollection:function(e,t,i,n){let o=[];e.forEach(function(e){let t={};t.displayValue=e.get("title"),t.actualValue=e.get("id"),o.push(t)}),u.prototype._addRangeValuesToConfigs({name:t},o,n,i)},removeObjectFromConfigArray:function(e,t,i){let n=e.findIndex(e=>e[t]===i);-1!==n&&e.splice(n,1)},getObjectFromConfigArray:function(e,t,i){return e.find(function(e){return e[t]===i})}});return u}),define("DS/ENOProjectMgmtCommonComponents/views/ClassificationView",["UWA/Core","UWA/Utils","UWA/Promise","DS/Controls/Button","DS/Controls/ComboBox","DS/Controls/Accordeon","DS/Controls/TooltipModel","DS/UIKIT/DropdownMenu","DS/DocumentManagement/DocumentManagement","DS/E6WCommonUI/Views/DetailsDisplayView","DS/ENOProjectMgmtCommonComponents/views/DateCustomView","DS/ENOProjectMgmtCommonComponents/views/MultiValueCustomView","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel","DS/ENOProjectMgmtCommonComponents/utils/ClassificationCloneModel","DS/ENOProjectMgmtCommonComponents/collection/ClassificationCollection","DS/ENOProjectMgmtModels/Models/Task","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/RelatedDataItem","DS/ENOProjectMgmtModels/Collections/RelatedDataItems","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g,p,C,f,D,M,E,_,w){"use strict";return e.Class.View.extend({_uwaClassName:"ClassificationView",propertiesList:void 0,labelContainer:void 0,comboBoxContainer:void 0,comboBox:void 0,container:void 0,currentModel:void 0,sourceModel:void 0,detailsDisplayViews:void 0,filledSeperateAccordeon:void 0,homeView:void 0,init:function(t,i){let n=e.clone(i||{},!1);if(this.container=t,this.isComponent=n.isComponent,this.homeView=n.homeView,this.isComponent){this.sourceModel=n.currentModel;let e=new D({id:this.sourceModel.get("id"),type:this.sourceModel.get("type"),modifyAccess:this.sourceModel.get("modifyAccess"),state:this.sourceModel.get("state")}),t=new p(e);this.currentModel=t}else this.currentModel=n.currentModel},reset:function(){this.comboBoxContainer&&this.comboBoxContainer.destroy();for(let e in this.detailsDisplayViews)this.detailsDisplayViews.hasOwnProperty(e)&&this.detailsDisplayViews[e].destroy();this.filledSeperateAccordeon&&(this.filledSeperateAccordeon.destroy(),delete this.filledSeperateAccordeon)},render:function(){let t=this;if(this.container.empty(!0),this.reset(),this.container.addClassName("object-properties"),this.detailsDisplayViews={},this.parent=e.createElement("div",{class:"object-properties-list"}),this.container.appendChild(this.parent),this.labelContainer=e.createElement("div"),this.labelContainer.inject(this.parent),this.selectLabel=e.createElement("label",{id:"selectLabel",text:w.SELECT_CLASSIFICATION_TO_ADD}),this.selectLabel.inject(this.labelContainer),this.comboBoxContainer=e.createElement("div"),this.comboBoxContainer.inject(this.parent),this.detailsContainer=e.createElement("div"),this.detailsContainer.inject(this.parent),this.isComponent){if(!M.isValidCollabspace())return this.selectLabel.setContent(w.UNSUPPORTED_CREDENTIAL),this;let e={model:this.currentModel.model,fields:"none,classes.title",include:"none,classes",refresh:!0};f.getDataModelDetails(e).then(function(){t._loadClassifictions()},function(e){u.buildNotification({title:w.CLASSIFICATION_FAILURE,message:g.getErrorMessage(e)},"error")})}else this._loadClassifictions();return this},acceptChanges:function(e){e&&(this.currentModel=e),this.render()},_loadClassifictions:function(){let e=this;try{let t={addChild:!0,childMemberNames:["ChildClasses"],onComplete:function(){f.resetClassFlags(),e._createClassificationList(),e._checkClassificationAttributesAndAddView()}};f.resetTreeDocument(t)}catch(e){u.buildNotification({title:w.CLASSIFICATION_FAILURE,message:g.getErrorMessage(e)},"error")}},addClassification:function(e){let t=this,i=f.getCurrentDataModel(void 0,e);"General Library"!==i.get("type")&&f.getClassDefinition({id:i.id}).then(function(e){let i=e.get("ClassAttributes");if(i){let n=new E({id:e.id,type:"General Class",name:e.get("name"),title:e.title,Attributes:i,serviceId:m.DEFAULT_SOURCE,modifyAccess:t.currentModel.isNew?"TRUE":t.currentModel.model.get("modifyAccess")}),o=t.currentModel.get("ClassificationAttributes");if(o||(o=new _,t.currentModel.model.set("ClassificationAttributes",o)),!t.currentModel.get("classes")){let e=new _;t.currentModel.model.set("classes",e)}n.isAttributesNew=!0,o.add(n),t.addViewForClassesForCurrentModel().then(t.validateLocalAttrs.bind(t))}},function(e,t){u.buildNotification({title:w.CLASSIFICATION_FAILURE,message:g.getErrorMessage(e,t)},"error")})},_checkClassificationAttributesAndAddView:function(){let e=this;this.currentModel.model.isNew()||e.currentModel.get("ClassificationAttributes")?e.addViewForClassesForCurrentModel():f.getClassifiedItemAttributes(e.currentModel.model).then(function(){e.addViewForClassesForCurrentModel()},function(e,t){u.buildNotification({title:w.CLASSIFICATION_FAILURE,message:g.getErrorMessage(e,t)},"error")})},addViewForClassesForCurrentModel:function(){let e=this;return new i(function(t,i){let n=e.currentModel.get("ClassificationAttributes");n&&n.length?e.prepareClassificationAttributes(n).then(function(i){if(e.filledSeperateAccordeon)i.forEach(t=>{e.filledSeperateAccordeon.addItem(t);let i=e.filledSeperateAccordeon.items.length-1;e._addChevronForExpander(n,t,i)});else{e.filledSeperateAccordeon=new s({items:i,style:"filled-separate",exclusive:!1}).inject(e.detailsContainer);for(let t=0;t<i.length;t++)e._addChevronForExpander(n,i[t],t)}t(i)},function(e,t){u.buildNotification({title:w.CLASSIFICATION_FAILURE,message:g.getErrorMessage(e,t)},"error"),i()}):t()})},createAndShowContextMenu:function(e){this.createMenu(e),g.showAndUpdateContextualDropdownMenuPosition(this.dropdownMenu,e)},createMenu:function(t,i){t.stopPropagation(),t.preventDefault();let n=e.Event.getElement(t),o=n.getClosest(".wux-controls-expander-header").getAttribute("data-id"),s=e.clone(i||{},!1),a=this.currentModel.get("ClassificationAttributes"),l={event:t,key:o,target:s.target||n,model:a&&a.get(o)};this.dropdownMenu&&this.dropdownMenu.destroy(),this.createClassificationsMenu(l)},createClassificationsMenu:function(t){let i=this,n=e.clone(t||{},!1);this.dropdownMenu=new l({target:n.target,key:n.key,items:this.getClassificationsDropDownMenuItems(n),events:{onClickOutside:function(){this.menus&&this.destroy(),delete i.dropdownMenu},onHide:function(){this.menus&&this.destroy(),delete i.dropdownMenu}}}),this.setDropdownMenu();let o=this.homeView._viewConfig;return g.addOpenMenuItem(this.dropdownMenu,n.model,o),this.dropdownMenu},getClassificationsDropDownMenuItems:function(e){return[this.getPropertiesButton(e),this.getRemoveButton(e),this.getRelationsButton(e)]},getPropertiesButton:function(t){let i=e.clone(t||{},!1).model;return{name:"properties",text:w.PROPERTIES,fonticon:"attributes",handler:function(){g.launchProperties(i.id,t)}}},getRemoveButton:function(t){let i=this,n=e.clone(t||{},!1);return{name:"remove",text:w.REMOVE,fonticon:"cancel",className:this.currentModel.model.canEdit()?"":"hidden",handler:function(){i._removeClassification(n.key)}}},getRelationsButton:function(e){return g.getRelationsButton(e)},_addChevronForExpander:function(e,t,i){let o=this.filledSeperateAccordeon.getExpanderFromIndex(i),s=o.getContent().getElement(".wux-controls-expander-header");s.setAttribute("data-id",t.key),s.tooltipInfos=new a({shortHelp:t.header});let l=new n({domId:"clasificatonAttributeOptionsButton",emphasize:"secondary",icon:{iconName:"chevron-down",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},tooltipInfos:new a({shortHelp:w.MORE_ACTIONS})}).inject(s);this._handleEvents(o,l,s)},_handleEvents:function(e,t,i){let n=this;e.elements.bodyContainer.addEventListener("keyup",function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1}),t.getContent().addEventListener("buttonclick",function(){e.expandedFlag=Boolean(!e.expandedFlag),n.createMenu(event,{target:this}),setTimeout(function(){n.dropdownMenu.show()},1)}),i.addEventListener("contextmenu",function(e){n.createAndShowContextMenu(e)},!1)},removeClassificationSectionView:function(e){let t=g.findIndex(this.filledSeperateAccordeon.items,"key",e),i=this.filledSeperateAccordeon.items[t];i.content&&i.content.destroy(),delete this.detailsDisplayViews[i.key],this.filledSeperateAccordeon.deleteItem(t)},_removeClassification:function(e){this.removeClassificationSectionView(e);let t=this.currentModel.get("ClassificationAttributes");if(t){let i=t.get(e);t.remove(i),this.validateLocalAttrs()}},prepareClassificationAttributes:function(e){let t=this,n=[],o={};return t.filledSeperateAccordeon&&t.filledSeperateAccordeon.items&&t.filledSeperateAccordeon.items.forEach(e=>{o[e.key]=!0}),new i(function(i,s){if(e.length){let a=[];e.forEach(function(e){a.push(t._getClassDefinitionAttribute(o,n,e))}),a.length?Promise.all(a).then(()=>{i(n)}):s()}else i(n)})},_getClassDefinitionAttribute:function(t,n,o){let s=this;return new i(function(i,a){if(t[o.get("id")])return i();let l=new e.Element("div"),r={key:o.id,expandedFlag:!0,content:l};n.push(r),s.addClassificationAttribute(o.id,s.currentModel,l).then(function(){if(r.header=s._getClassPath(o),n.length){Object.keys(s.currentModel.localAttributes).length||s.currentModel.model.isNew()||delete s.currentModel.modificationsPending}i()},function(e,t){u.buildNotification({title:w.CLASSIFICATION_FAILURE,message:g.getErrorMessage(e,t)},"error"),a()})})},_getClassPath:function(e){return f.getClassPath(e.id)||e.title},addClassificationAttribute:function(e,t,n){let o=this;return new i(function(i,s){let a=t.get("ClassificationAttributes"),l=a&&a.get(e);f.getClassDefinition({id:l.get("id")}).then(function(e){let t=l.get("name")||e.get("name"),s=l.get("title")||e.get("title");l.set({name:t,title:s,type:"General Class",serviceId:m.DEFAULT_SOURCE,modifyAccess:o.currentModel.isNew?"TRUE":o.currentModel.model.get("modifyAccess")}),l.resetChangedAttrs();let a=e.get("ClassAttributes");a&&(o.addModelClassAttribute(l,a,n),i())},function(e,t){u.buildNotification({title:w.CLASSIFICATION_FAILURE,message:g.getErrorMessage(e,t)},"error"),s(t)})})},addModelClassAttribute:function(e,t,i){let n=this;if(e){let o=[],s=e.get("Attributes");if(s&&s.forEach(function(i){let s=i.name,a=s.split(" ").join(""),l={label:s,name:a,readWrite:!0},r=g.findObject(t,"name",s);e.set(a,n._getDetailsDisplayType(i,r,l)),o.push(l)}),o.length){let t=new C(e);this.listenTo(t,{"onChange:modificationsPending":this.validateLocalAttrs.bind(this),onChangeAttributeValue:n._updateAttributeOnOtherClasses.bind(this)});let s=new c({DocumentManagement:r,homeView:this,model:t});s.setConfig(o),s.render().inject(i),this.detailsDisplayViews[e.id]=s}}return i},validateLocalAttrs:function(){this.setModificationPending(),this.currentModel.validationError=this.currentModel.validate(this.currentModel.toJSON()),this.validationError?this.dispatchEvent("onValidationFailure"):this.dispatchEvent("onValidationSuccess")},_updateAttributeOnOtherClasses:function(e,t){for(let i in this.detailsDisplayViews)if(this.detailsDisplayViews.hasOwnProperty(i)){this.detailsDisplayViews[i].model.get(e)!==t&&this.detailsDisplayViews[i].model.set(e,t)}},setModificationPending:function(){this.currentModel.modificationsPending=!0,this.currentModel.dispatchEvent("onChange:modificationsPending",[this.currentModel]),this.isComponent&&(this.sourceModel.modificationsPending=!0,this.sourceModel.dispatchEvent("onChange:modificationsPending",[this.sourceModel]))},prepareSave:function(){let t=this;for(let i in this.detailsDisplayViews)if(this.detailsDisplayViews.hasOwnProperty(i)){let n={};this.detailsDisplayViews[i]._config.forEach(o=>{let s=t.detailsDisplayViews[i].model,a=s.get(o.name);"checkbox"===o.type&&e.is(a,"array")?n[o.name]="TRUE"===a:f.prepareLocalAttributesToModelAttributes(n,s,o)}),this.detailsDisplayViews[i].model.model.set(n)}},save:function(t){let i=this,n=e.clone(t||{},!1);this.prepareSave();let o={ignorePostSave:!1,isReload:!0,doNotUpdateTaggerData:!0,donotShowMessage:!0,onComplete:function(){i.acceptChanges(),n.onComplete&&n.onComplete.apply(this,arguments)},onFailure:n.onFailure};f.saveClassification(this.currentModel,o)},_getDetailsDisplayType:function(e,t,i){let n=t.type,o=e.value||t.default;if(!n)return i.type="text",i.type;if(t.multivalued)i.customView=h;else if("timestamp"===t.type&&(i.customView=d),o)switch(t.type){case"integer":o=o.toString();break;case"real":o=Number(o.toString());break;case"boolean":o=Boolean(o).toString().toUpperCase()}if(t.authorizedValues&&(this._addAuthorizedValues(t,i),i.type="select"),!t.authorizedValues||t.multivalued)switch(t.type){case"string":i.type="text",i.numberOfDisplayLines=1,i.numberOfEditableLines=1,i.removeCarriageReturns=!0;break;case"boolean":i.type="checkbox";break;case"timestamp":i.type="date";break;case"real":case"integer":i.type="number";break;case"range":i.type="range";break;default:i.type="text"}return o},_addAuthorizedValues:function(e,t){let i=[],n="real"===e.type;e.authorizedValues.forEach(e=>{let t={displayValue:e,actualValue:n?Number(e):e};i.push(t)}),t.values=i},_createClassificationList:function(){let e=this.currentModel.model.isNew()?"CreateNewView":void 0,t=f.getDocument(e,!!e||void 0),i=t.getChildren().length;this.currentModel.model.canEdit()||this.currentModel.model.isNew()?(this.selectLabel.setContent(w.SELECT_CLASSIFICATION_TO_ADD),this.comboBox&&(this.comboBox.destroy(),delete this.comboBox),i&&(this.comboBox=new o({elementsTree:t}),this.comboBox.selectedIndex=0,this.comboBox.inject(this.comboBoxContainer),this.comboBox.addEventListener("change",this.addClassification.bind(this,e)))):this.selectLabel.setContent(w.CLASSIFICATION_PATHS),!i&&this.selectLabel.setContent(w.CLASSIFICATION_LIBRARY_NOT_FOUND)},setDropdownMenu:function(){let e=this.homeView;e&&(e.dropdown=this.dropdownMenu)},destroy:function(){this.selectLabel.destroy(),this.labelContainer.destroy(),f.resetTreeDocument({view:this.currentModel.model.isNew()?"CreateNewView":void 0}),this.comboBox&&this.comboBox.removeEventListener("change"),this.comboBox&&this.comboBox.destroy(),this.reset(),this.parent.destroy()}})}),define("DS/ENOProjectMgmtCommonComponents/components/CommonInitializer",["UWA/Core","UWA/Class/Events","UWA/Class/Listener","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/Utilities/TouchUtils","DS/ENOProjectMgmtModels/Constants/Constants","DS/ENOProjectMgmtCommonComponents/config/ViewConfigBase","DS/ENOProjectMgmtCommonComponents/utils/PreferenceManager","DS/ENOProjectMgmtCommonComponents/collection/ClassificationCollection","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r){"use strict";let c,d={summary:"summaryView",risk:"gridView"};return t.extend({_preferenceManager:void 0,_homeView:void 0,init:function(e){let t=e||{};t.container||(t.container=document.querySelector("#container")),this._homeView=e.homeView,this._initializePlatformServices(t)},_initializePlatformServices:function(t){let i=this,r=e.clone(t||{},!1);if(r.isComponent)this.viewConfig=new a(s.APPLICATIONS.TASK),this.viewConfig.setFieldDefinitionData(s.APPLICATIONS.TASK,r.isLibraryInstalled),this.initializeComponent(r),this.initializeEvents(),this.handleInitialLoad(r);else{let e={onLoad:function(){c=new l(r,i._homeView)}};widget.addEvent("onLoad",e.onLoad),n.getPlatformServices({onComplete:function(e){var t=e[0];widget.setIcon(t["3DSpace"]+"/widget/images/MyApps/iconENOVIA.png")}}),window.addEventListener("dragover",function(e){(e=e||event).preventDefault()},!1),window.addEventListener("drop",function(e){(e=e||event).preventDefault()},!1),o.setTouchMode(!0)}},initializeComponent:function(e){if(this._options={},c)c.setSecurityContext(e.securityContext,!0),e.securityContext&&r.reloadClassifications(e);else{if(this.viewConfig.isLibraryInstalled()&&e.loadClassification){let t=e.onComplete,i=e.onFailure;e.onComplete=function(){e.securityContext&&e.loadClassification&&(e.onComplete=t,e.onFailure=i,r.loadClassifications(e))},e.onFailure=function(){i()}}c=new l(e,this._homeView),e.securityContext&&c.setSecurityContext(e.securityContext)}},handleInitialLoad:function(e){let t,i=this;Object.defineProperty(c,"homeView",{get:function(){return t},set:function(n){(t=n)&&i.dispatchEvent("onInitialLoad",e)}})},initializeEvents:function(){let e=this;this.listener=new i,this.listener.listenTo(this,{onWidgetRefresh:function(){e._options.resetWidgetData=!0,e.getHomeView().container.click()},onInitialLoad:function(t){e.renderView(t),e.initializeHomeViewEvents()},onResize:function(){let t=e.getHomeView(),i=e.getGridView(),n=i&&i.gridViewContent;t&&n&&n.setStyle("height",t.getHeight()+"px")},rskClosePropertyPanel:function(){let t=e.getGridView();t&&t.detailsAndRelationships.hideRightPanel()}})},initializeHomeViewEvents:function(){let e=this,t=this.getHomeView();this.listener.listenTo(t,{switchToRisksTab:function(){e.dispatchEvent("switchToRisksTab")},xppClosePropertyPanel:function(){e.dispatchEvent("xppClosePropertyPanel")}})},renderView:function(t){let i=this.getHomeView();if(!i)return;let n=e.clone(t||{},!1),o=n.context,s=this.isContextChanged(o),a=n.viewName,l=i.currentViewName,r=this.getSelectedFacetViewName();if(!s&&l&&(l===a||l===r))return;e.extend(n,this._options),i.currentViewName=a;let d=n.resetWidgetData;!d&&s&&(n.contexChanged=!0,this.context=o,d=!0),n.doNotFetchDataForView=!d,c.renderHomeView(n),this._options&&delete this._options.resetWidgetData},isContextChanged:function(e){return!this.context||e&&this.context&&e.id!==this.context.id},getHomeView:function(){return c&&c.getHomeView()},getHomeBodyView:function(){let e=this.getHomeView();return e&&e.homeBodyView},getSelectedFacetViewName:function(){let e=widget.getValue("selectedProgramAndFilter"),t=e&&e.substr(1,e.length-2).split("/")[2];return d[t]},getGridView:function(){let e=this.getHomeView();return e&&e.getView("gridView")},getSummaryView:function(){let e=this.getHomeView();return e&&e.getView("summaryView")},isRiskGridViewLoaded:function(){return Boolean(this.getGridView())},isRiskHeatMapViewLoaded:function(){return Boolean(this.getSummaryView())}})}),define("DS/ENOProjectMgmtCommonComponents/utils/MatrixConfigCloneModel",["UWA/Core","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel","DS/ENOProjectMgmtCommonComponents/constants/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a){"use strict";let l,r;return o.extend({_uwaClassName:"MatrixConfigCloneModel",add:function(t,i,n){let o=e.clone(n||{},!1);if("configuredItems"===t)return o.sourceType="matrixConfiguration",o.refresh=!0,o.rmcType=o.model.get("rmcType"),void((i=this._addModel(t,i,o))&&i.length&&i.forEach(e=>{e.addEventOnce("onSync",this.handleWhereUsedOnSync.bind(this,{fieldName:t,whereUsedOptions:o}))}));this._parent(t,i,o)},validateMatirx:function(t){let i=!0,n=!0,o={fields:[],messages:{}},s=t.title;if(s){this._isString(s)&&s.trim().length||(i=!1,o.fields.push(a.INCORRECT_TITLE))}else i=!1,o.fields.push(a.CREATE_BLANK_TITLE_ALERT);let l=t.matrix;if(l&&e.is(l,"object")&&l)if(l.Xaxis&&l.Yaxis&&l.cells&&l.severity){let e=l.severity;(e&&this._isArray(e)&&e.length)>25?(i=!1,o.fields.push(a.ERROR_RISK_LEVEL_LIMIT)):i=this._validateRiskLevelsInfo(e,o,i);let t=l.Xaxis,s=t&&t.name;s&&this._isString(s)&&s.trim().length||(i=!1,o.fields.push(a.INCORRECT_AXIS_NAME));let r=t&&t.nodes,c=r&&this._isArray(r)&&r.length;(c<3||c>5)&&(i=!1,n=!1,o.fields.push(a.ERROR_NODES_LIMIT)),n&&(i=this._validateNodeInfo(r,o,i));let d=l.Yaxis,h=d&&d.name;h&&this._isString(h)&&h.trim().length||(i=!1,o.fields.push(a.INCORRECT_AXIS_NAME));let u=d&&d.nodes,m=u&&this._isArray(u)&&u.length;n&&(m<3||m>5)&&(i=!1,n=!1,o.fields.push(a.ERROR_NODES_LIMIT)),n&&(i=this._validateNodeInfo(u,o,i));let g=l.cells,p=g&&g.length,C=c*m;i&&p>25&&p!==C?(i=!1,o.fields.push(a.INVALID_TOTAL_CELLS)):i=this._validateCellsInfo(g,o,i,c,m,C,e)}else i=!1,o.fields.push(a.INVALID_CONFIGURATION_FORMAT);else i=!1,o.fields.push(a.NO_CONFIGURATION);return this.dispatchEvent("disableSaveButton",!i),this.dispatchEvent("onChangeImportFile",{isValid:i,errorMessage:o.fields}),i},compareCell:function(e,t){if(e.cells.length!==t.cells.length)return!1;for(let i=0;i<e.cells.length;i++){let n=e.cells[i],o=t.cells[i];if(n.Xvalue!==o.Xvalue||n.Yvalue!==o.Yvalue)return!1}return!0},_validateRiskLevelsInfo:function(e,t,i){let n=this;return l={},e&&e.forEach(function(e,o){if(!i)return;let s=e.riskLevel;if(l[s])i=!1,t.fields.push(a.DUPLICATE_RISK_LEVEL);else{l[s]=s;let o=s&&n._isString(s)&&s.trim().length,r=e.name,c=e.backgroundColor,d=e.textColor,h=r&&n._isString(r)&&r.trim().length,u=c&&n._isValidColor(c),m=d&&n._isValidColor(d);(!i||o)&&h&&u&&m||(i=!1,t.fields.push(a.INCORRECT_RISK_LEVEL_VALUE))}}),i},_validateNodeInfo:function(e,t,i){let n=this;return e&&e.forEach(function(e,o){if(!i)return;let s=e.label,l=s&&n._isString(s)&&s.trim().length,r=e.value&&Number(e.value);(i&&!l||r!==o+1)&&(i=!1,t.fields.push(a.INCORRECT_NODES_VALUE))}),i},_validateCellsInfo:function(e,t,n,o,s,l,c){let d=this;return r={},e&&e.forEach(function(e){if(!n)return;let h=e.Xvalue,u=e.Yvalue,m=h+u,g=h&&d._isNormalInteger(h)&&h<=o,p=u&&d._isNormalInteger(u)&&u<=s;if(r[m])n=!1,t.fields.push(a.DUPLICATE_CELL_XY_VALUE);else{r[m]=m;let o=e.defaultCellId,s=void 0===o;o&&(s=o&&d._isNormalInteger(o)&&o>0&&o<=25);let C=e.riskLevel,f=C&&d._isString(C)&&C.trim().length&&Boolean(i.findObject(c,"riskLevel",C)),D=e.rpn;D=D&&Number(D),h=h&&Number(h),u=u&&Number(u),(n&&!s||!g||!p||!f||D!==h*u||D>l)&&(n=!1,t.fields.push(a.INCORRECT_CELLS_VALUE))}}),n},handleWhereUsedOnSync:function(e,t){let i,o=e.fieldName,s=e.whereUsedOptions,l=t.get("configuration"),r=l&&l.length&&l[0];if(r&&"TRUE"!==r.resolved){i='"'+(t.get("title")||t.get("name"))+'" '+a.OBJECT_ALREADY_ASSOCIATED+' "'+(r.title||r.name)+'"'}else t.isXPlanObject()&&!t.canCreate()&&(i=a.NO_RMC_ACCESS);if(i)return n.buildNotification({message:i},"error"),void(!this.model.isNew()&&!Object.keys(this.localAttributes).length&&this.dispatchEvent("disableSaveButton",!0));s.changed=Boolean(!i),this.setRelatedItemData(o,t,s)},isDefault:function(){let e=this.get("name");return e===s.DEFAULT||e===s.DEFAULT_OPPORTUNITY},_isValidColor:function(e){e=e.toLowerCase();let t=(new Option).style;t.color=e;let i=t.color===e,n=/^#[0-9A-F]{6}$/i.test(e);return Boolean(i||n)},_isNumber:function(t){return e.is(Number(t),"number")},_isString:function(t){return e.is(t,"string")},_isArray:function(t){return e.is(t,"array")},_isNormalInteger:function(e){return/^(0|[1-9]\d*)$/.test(e)}})}),define("DS/ENOProjectMgmtCommonComponents/collection/MatrixConfigCollection",["UWA/Core","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/constants/Constants","DS/ENOProjectMgmtCommonComponents/utils/MatrixConfigCloneModel","DS/ENOProjectMgmtCommonComponents/config/TabMatrixConfigCreate","DS/ENOProjectMgmtCommonComponents/config/MatrixConfigListConfig","DS/ENOProjectMgmtCommonComponents/config/MatrixSettingsViewConfig","DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection","DS/ENOProjectMgmtModels/Constants/Constants","DS/ENOProjectMgmtModels/Models/MatrixConfiguration","DS/ENOProjectMgmtModels/Collections/MatrixConfigurations","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h){"use strict";return l.singleton({_uwaClassName:"MatrixConfigCollection",_defaultConfiguration:void 0,setup:function(){let e={};e.DataModels=d,e.DataModel=c,e.PropertiesConfig=a,e.TabConfig=o,e.TabConfigForCreate=o,e.ListConfig=s,e.CloneModel=n,e.governingType=r.TYPENAMES.MATRIX_CONFIGURATION,e.governingTypeNLS=h.MATRIX_CONFIGURATION,this._parent(e)},getMatrixConfigDefinition:function(t){if(this.collection)return t instanceof e.Class.Model?t=t._attributes:e.is(t,"string")&&(t={id:t}),this.collection.get(t.id)},getDefaultConfiguration:function(){return!this._defaultConfiguration&&this.collection&&(this._defaultConfiguration=t.findObject(this.collection,"name",i.DEFAULT),this._defaultConfiguration||(this._defaultConfiguration=t.findObject(this.collection,"name",i.DEFAULT_OPPORTUNITY))),this._defaultConfiguration},getMatrixCellInfo:function(e,t,i){let n=this.getMatrixCells(e);return n&&n.find(function(e){return e.Xvalue===t&&e.Yvalue===i})},getMatrixCellInfoBasedOnKey:function(e,i,n){let o=this.getMatrixCells(e);return t.findObject(o,i,n)},getMatrixCells:function(t){let i=t instanceof e.Class.Model?t.get("matrix"):t;return i&&i.cells}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtTrendView",["UWA/Core","UWA/Class/View","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomDataGridView","DS/ENOProjectMgmtCommonComponents/collection/MatrixConfigCollection","DS/ENOProjectMgmtModels/Models/AppSettings","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a){"use strict";return t.extend({_uwaClassName:"ProjectMgmtTrendView",_appContainer:void 0,_collection:void 0,_trendConfig:void 0,_trendChartConfig:void 0,_nlsTrend:void 0,init:function(t,i){let n=this;this._appContainer=t,this._collection=i.collection,this._trendConfig=i.trendConfig,this._nlsTrend=i.nlsTrend,this._appContainer.setHTML(i.trendTemplate),this._chartConfig=e.clone(i.trendChartConfig||{}),this.Highcharts=a.get("highcharts"),this.trendChartDiv=this._appContainer.getElement(".trend-chart"),this._riskTrendGridView=this._appContainer.getElement(".risk-trend-grid"),this.trendChartDiv.addEvent("resize",function(){n.trendChart&&n.trendChart.reflow()}),this._chartConfig.chart.renderTo=this.trendChartDiv},render:function(){let e=this,t=this._collection.getCurrentDataModel(),i=t&&t.model._sourceType;return this._collection.getDataModelTrend(i).then(function(t){if(e.Highcharts){e._appContainer.getElement("#chartLabel").setHTML(e._nlsTrend);let i=e.getRiskTrendData(t);e._chartConfig.series[0].data=i;let n=e._chartConfig.goalXAxisField,o=e._chartConfig.goalYAxisField,s=e._chartConfig.goalLineDashStyle,a=e._chartConfig.goalLineDashColor,l=e._chartConfig.goalLineDashWidth,r=e._chartConfig.goalLineLabel,c=e._collection.getCurrentDataModel().get(n)*e._collection.getCurrentDataModel().get(o);c&&(e._chartConfig.yAxis.plotLines=[{value:c,color:a,width:l,dashStyle:s,label:{useHTML:!0,formatter:function(){return"<span>"+r+" : "+c+"</span>"}}}]),e.trendChart=new e.Highcharts.Chart(e._chartConfig),e.trendChart.redraw()}let i=e._collection.getCurrentDataModel();e._trendConfig.setModel(i.model),e.treeDocument=e._collection.createTreeDocumentForCollection(t,{config:e._trendConfig.columnInfo}),e.riskTrendDataGrid=new o({container:e._riskTrendGridView,treeDocument:e.treeDocument,config:e._trendConfig})}),this._appContainer},reload:function(){this.trendChart&&this.riskTrendDataGrid&&(this.trendChart.destroy(),this.trendChart=void 0,this.riskTrendDataGrid.destroy(),this.render())},getRiskTrendData:function(e){let t=[],i="",o=this._collection.getCurrentDataModel(),a=o.model.get("state");if("Complete"===a){let e=n.getFormattedDate(o.model.get("actualFinishDate"));i=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())}else{let e=new Date;i=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())}t.push({x:i,y:Number(o.model.get("rpnValue")),marker:{symbol:"url()"},fontIcon:'<i class="fonticon '+("Complete"===a?"fonticon-status-ok ":"fonticon-expand-right ")+"object-maturity "+a.toLowerCase()+' "></i> '});let l=o&&o.model.getMatrixConfig(),r=l&&l.get("matrix").severity;return e.forEach(function(e){let o=n.getFormattedDate(e.get("modified"));i=Date.UTC(o.getFullYear(),o.getMonth(),o.getDate());let a=l&&s.getMatrixCellInfo(l,e.get("rpnImpact"),e.get("rpnProbability")),c=n.findObject(r,"riskLevel",a&&a.riskLevel);t.push({x:i,y:Number(e.get("rpnValue")),marker:{fillColor:c&&c.backgroundColor||"#77797C",states:{hover:{fillColor:c&&c.backgroundColor||"#77797C"}}}})}),t},destroy:function(){this._riskTrendGridView.destroy(),this.trendChart&&this.trendChart.destroy(),this.riskTrendDataGrid&&this.riskTrendDataGrid.destroy(),this._appContainer&&this._appContainer.destroy()}})}),define("DS/ENOProjectMgmtCommonComponents/views/HomeViewBase",["UWA/Core","UWA/Class/View","DS/ENOProjectMgmtCommonComponents/views/MassUpdateView","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/collection/MatrixConfigCollection","DS/ENOProjectMgmtCommonComponents/collection/ClassificationCollection","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s){"use strict";return t.extend({_uwaClassName:"HomeViewBase",init:function(t){let a=e.clone(t||{},!1);this._nls=a.nls,this.appName=a.appName,this._rmcType=a.rmcType,this.container=a.container,this._appConfig=a.appConfig,this._paramData=a.paramData,this._collection=a.collection,this._viewConfig=a.viewConfig,this._initialCall=a.initialCall,this._trendConfig=a.trendConfig,this._homeTabConfig=a.homeTabConfig,this._trendTemplate=a.trendTemplate,this.baseContextModel=a.baseContextModel,this._trendChartConfig=a.trendChartConfig,this._contextSourceInfo=a.contextSourceInfo,this._tabConfigForCreate=a.tabConfigForCreate,this._tabConfigForMassUpdate=a.tabConfigForMassUpdate,this._contextSelectionConfig=a.contextSelectionConfig,this._detailsAndRelationships=a.detailsAndRelationships,this.homeBodyView={},this._matrixConfigCollection=o,this._classificationCollection=s,widget.projectMgmtAlertManager=n.init(),this._setExternalDetailsPanel(a),a.doNotLoadMassUpdateView||this.massUpdateView||(this.massUpdateView=new i(this))},_setExternalDetailsPanel:function(t){let i=e.clone(t||{},!1);i.detailsPanelContainer&&(this._externalRightPanelOptions={detailsPanelContainer:i.detailsPanelContainer,openDetailsPanel:i.openDetailsPanel,closeDetailsPanel:i.closeDetailsPanel})},getHeight:function(){},getView:function(e){return this.homeBodyView[e]},reload:function(e){this.render(e)},clearParamData:Function.prototype,handleUnsaveForSearchAndPreferences:Function.prototype})}),define("DS/ENOProjectMgmtCommonComponents/views/HomeViewTabBase",["UWA/Core","DS/Controls/Tab","DS/Controls/Button","DS/Controls/TooltipModel","DS/E6WCommonUI/Views/DetailsDisplayView","DS/DocumentManagement/DocumentManagement","DS/ENOProjectMgmtModels/Models/FieldsDefinition","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/views/HomeViewBase","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/components/CommonInitializer","text!DS/ENOProjectMgmtCommonComponents/assets/templates/tmpl-risk-toolbar.html.handlebars","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Constants/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g){"use strict";let p={group1:".ds-app-toolbar-group.ds-navigation",group2:".ds-app-toolbar-group.ds-contextual-actions",group3:".ds-app-toolbar-group.ds-filtering",group4:".ds-app-toolbar-group.ds-panel-actions"};return r.extend({_uwaClassName:"HomeViewTabBase",_toolbarButtons:{},_customObjects:{},initializeTabContainers:function(t){this.homeToolbarContent=this._appContainer.getElement(".ds-app-facet-toolbar");let i=e.clone(t||{},!1);this.actionToolbarContainer=i.actionToolbarContainer,this.actionToolbarContainer&&(this.actionToolbarContainer.empty(),this.homeToolbarContent.toggleClassName("hide",!0),this.homeToolbarContent=this.actionToolbarContainer),this.canHideTopBar()?this.homeBodyContent=this._appContainer:(this._homeTabConfig.leftPanel?(this.homeToolbarContent=this.container.getElement(".ds-app-panel-head"),this.homeBodyContent=this.container.getElement(".ds-app-panel-body")):this.homeBodyContent=this._myPanelMainContent.getElement(".ds-app-content.ds-app-facet"),this.homeToolbarContent.setHTML(h),this.dpmToolbar=this.homeToolbarContent.getElement(".ds-app-toolbar-container"),this.addToolbarAndTabBar(this._homeTabConfig.getHomePanel(!0)))},addToolbarAndTabBar:function(e){let i=u.get("isComponent"),n=e.toolbarConfig;this.dpmToolbar=this.homeToolbarContent.getElement(".ds-app-toolbar-container");for(let o in n){if(n.hasOwnProperty(o)){let e=n[o],s=this.dpmToolbar.getElement(p[o]),a=void 0;for(let n=0;n<e.length;n++){let o=e[n],r=void 0;if("tab"===o.type&&0!==n||(o.groupInContextActionToolbar?(a||(a=this.getToolbarDivContent(o,"contextualActionsContainer",!0)),r=a):r=this.getToolbarDivContent(o)),"tab"!==o.type||o.doNotCreate)"cardView"!==o.type||i?"button"===o.type&&r&&(this.addButton(r,o),r.inject(s)):r&&(r.addClassName("ds-input-element"),this.addContextSelection(r),r.inject(s));else if(0===n){this.ddTabBar=new t({id:"prjmgmtCommonToolbarTab",displayStyle:"strip",showComboBoxFlag:!1}),this.ddTabBar.inject(r),r.inject(s),this.createTab(this.ddTabBar,o);let i=this.handleTabClickEvents.bind(this,{_parentView:this,_config:e});o.validateModificationsPending?this.ddTabBar.addEventListener("tabButtonClick",l.validateModificationsPending.bind(this,{parentView:this,yesEventFunc:i,noEventFunc:function(e){let t=e.dsModel.buttonGroup;t&&t.selectIndex(t.previouslySelectedIndex)}})):this.ddTabBar.addEventListener("tabButtonClick",i)}else this.createTab(this.ddTabBar,o)}}if(e.toolbarConfig.hasOwnProperty("group3")){l.findObject(e.toolbarConfig.group3,"type","cardView")&&!i&&this.dpmToolbar.addClassName("include-filtering-input"),l.findObject(e.toolbarConfig.group3,"domId","filterNewButton")&&this.dpmToolbar.addClassName("include-filtering")}}},addTabViewToolbarButtons:function(e){if(this.resetToolbar(this.dpmToolbar),!e.tabViewToolbarConfig)return;this.dpmToolbar=this.homeToolbarContent.getElement(".ds-app-toolbar-container");let t=e.tabViewToolbarConfig.group2,i=this.dpmToolbar.getElement(p.group2),n=void 0,o=void 0;for(let e=0;e<t.length;e++){let s=t[e];s.groupInContextActionToolbar?(o||(o=this.getToolbarDivContent(s,"contextualActionsContainer",!0)),n=o):n=this.getToolbarDivContent(s),"button"===s.type&&(this.addButton(n,s),n&&n.inject(i))}},getToolbarDivContent:function(t,i,n){let o="ds-app-toolbar";return new e.createElement("div",{id:i||("tab"===t.type?"projectMgmtTabbarContainer":t.name),class:n||t.separator?o+=" include-separator":o})},resetToolbar:function(e){let t=e.getElement(p.group2);t&&t.empty()},createTab:function(e,t){return e.add({label:t.label,isSelected:t.selected,icon:{iconName:t.font,fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"2x"},checkFlag:t.checkFlag}).button},initializeButtonEvents:function(e){let t=this,i=e.buttonClick;if(i){let n=e.customViewKey,o=function(){let o=t;n&&(!t._customObjects[n]&&e.customView&&(t._customObjects[n]=new e.customView(t)),o=t._customObjects[n]||t[n]),o[i.functionName](i.params)};i.validateModificationsPending?this._toolbarButtons[e.name].getContent().addEventListener("buttonclick",l.validateModificationsPending.bind(void 0,{parentView:t,yesEventFunc:o})):t._toolbarButtons[e.name].getContent().addEventListener("buttonclick",o)}},addButton:function(e,t){let o=t.name;this._toolbarButtons[o]&&this._toolbarButtons[o].destroy(),this._toolbarButtons[o]=new i({domId:t.domId,recId:t.customViewKey,emphasize:t.emphasize,displayStyle:t.displayStyle,icon:{iconName:t.iconName,fontIconSize:t.fontIconSize,fontIconFamily:WUXManagedFontIcons.Font3DS},tooltipInfos:new n({shortHelp:t.shortHelp})}).inject(e),this.initializeButtonEvents(t)},addContextSelection:function(e){let t=this._contextSourceInfo.fieldDefinitionSource,i=t&&a.get(t);if(i&&i.length)return this.contextView&&this.contextView.destroy(),this.contextView=new o({DocumentManagement:s,model:this.contextScope,homeView:this,displayMessage:c.displayMessage}),this.contextView.resetModel(this.contextScope),this._collection.fieldDefinitionSource=t,this._collection.setSearchSourceForObjects(this._contextSelectionConfig,"context"),this.contextView.setConfig(this._contextSelectionConfig.values),void this.contextView.render().inject(e);t&&this.listenTo(a,"onChange:"+t,this.addContextSelection.bind(this,e))},getToolbarButton:function(e){return this._toolbarButtons[e]},showMassUpdateToolbarButton:function(e){let t=this.massUpdateView&&this.massUpdateView.massUpdateButtons,i=t&&Object.keys(t).length;for(let i in t)t.hasOwnProperty(i)&&(t[i].visibleFlag=e);let n=this.dpmToolbar&&this.dpmToolbar.getElement("#toolbarMultiObjectActions");n&&n.toggleClassName("include-separator",Boolean(i&&e))},updateStateOfActionsButtons:function(){let e=u.get("context"),t=u.get("isComponent"),i=Boolean(e&&(e.isProgramContext()||!e.canCreate())),n=Object.values(this._toolbarButtons),o=l.findObject(n,"domId","createNewButton"),s=l.findObject(n,"domId","settingsButton");o&&(o.disabled=i,o.tooltipInfos.shortHelp=this.getNLSMessageForCreateBtn(e,t,i)),t&&s&&(s.disabled=i,s.tooltipInfos.shortHelp=this.getNLSMessageForSettingsBtn(e,i)),l.isGridViewSelected()&&this.disableMassUpdateButton(!0)},getNLSMessageForCreateBtn:function(e,t,i){let n=g.replace(g.CREATE,{appName:this.appName||""});if(i){if(e.get("project"))if(t)n=g.NO_XPROJECT_CREATE_ACCESS_XPP;else{switch(n=g.NO_CREATE_ACCESS_TT_MSG,e.type){case m.TYPENAMES.PROJECT:n+=g.NO_DPMPROJECT_CREATE_ACCESS_TT_MSG;break;case m.TYPENAMES.XPROJECT:n+=g.NO_XPROJECT_CREATE_ACCESS_TT_MSG}}else n=g.COLLAB_SPACE_SELECT_ERROR}return n},getNLSMessageForSettingsBtn:function(e,t){let i=g.MATRIX_CONFIGURATION;if(t){i=e.get("project")?g.NO_RMC_ACCESS:g.COLLAB_SPACE_SELECT_ERROR}return i},disableMassUpdateButton:function(e){let t=this.massUpdateView&&l.filterObjects(Object.values(this._toolbarButtons),"recId","massUpdateView");for(let i in t)t.hasOwnProperty(i)&&(t[i].disabled=e)},handleTabClickEvents:function(t,i){let n,o=e.clone(t||{},!1),s=i.dsModel,a=s.value;s.buttonGroup&&(s.buttonGroup.previouslySelectedIndex=a[0]);let l=o._parentView,r=o.isComponent,c=o._config.length>1?o._config[a]:o._config[0],d=c.name;u.setSelectedViewName(d),c.tabViewToolbarConfig&&this.addTabViewToolbarButtons(c),!this.canHideTopBar()&&this.updateStateOfActionsButtons();let h=o._parentView._appContainer&&o._parentView._appContainer.getElement(c.bodyContainer)||o._parentView.homeBodyContent;(n=l.homeBodyView[d])||(c.options&&(c.options.viewConfig=l._viewConfig,c.options.matrixConfigCollection=this._matrixConfigCollection),l.homeBodyView[d]=new c.content(l,c.options),l.homeBodyView[d].render(o).inject(h)),r&&this._options&&!this._options.contexChanged&&l.homeBodyView[d].render(o).inject(l.homeBodyContent);for(let e in l.homeBodyView)if(l.homeBodyView.hasOwnProperty(e)){n=l.homeBodyView[e];let t=u.get("invalidRiskFilterisOn");if(n)if(d!==e)n.hide();else if(t)switch(t){case"set":u.set("invalidRiskFilterisOn","beforeFilter"),this.filterRisksBasedOnSearch("FALSE","validConfiguration",!0);break;case"beforeFilter":u.set("invalidRiskFilterisOn","fired"),n.show(),n.loadData(o);break;case"fired":u.unset("invalidRiskFilterisOn"),this.filterRisksBasedOnSearch()}else n.show(),n.loadData(o)}},canHideTopBar:function(){let e=u.get("isComponent");return Boolean(e&&this.currentViewName===this.SUMMARY_VIEW)},_processTabContentRenderView:function(t){if(u.get("isComponent")){let i={},n=e.clone(t||{},!1),o=this._homeTabConfig.getHomePanel().toolbarConfig.group1;e.extend(n,{_parentView:this,_config:o}),i.value=l.findIndex(o,"name",this.currentViewName),this.handleTabClickEvents(n,{dsModel:i})}else this.ddTabBar.fire("tabButtonClick")},switchTab:function(e){u.get("isComponent")?this.dispatchEvent("switchToRisksTab"):(this.ddTabBar.tabBar.getButtonFromValue(e).checkFlag=!0,this._processTabContentRenderView())},destroy:function(){if(this.ddTabBar&&this.ddTabBar.destroy(),this.settingsButton&&this.settingsButton.destroy(),this.massUpdateButton&&this.massUpdateButton.destroy(),this.massUpdateView&&this.massUpdateView.destroy(),this._customObjects)for(let e in this._customObjects)this._customObjects.hasOwnProperty(e)&&(this._customObjects[e].destroy(),delete this._customObjects[e])}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtDetailsAndRelationships",["UWA/Core","UWA/Class/View","DS/Utilities/Dom","DS/Controls/Tab","DS/Controls/Button","DS/Controls/TooltipModel","DS/UIKIT/Scroller","DS/UIKIT/DropdownMenu","DS/SocialToolbar/SocialToolbar","DS/ENOProjectMgmtCommonComponents/views/DetailsDisplay","DS/ENOProjectMgmtCommonComponents/views/ClassificationView","DS/ENOProjectMgmtCommonComponents/views/DetailsDisplayFooter","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtTrendView","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/components/ProgressSpinner","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Utils/FederatedSearch","DS/ENOProjectMgmtModels/Models/AppSettings","text!DS/ENOProjectMgmtCommonComponents/assets/templates/template_RightPanel.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g,p,C,f,D,M,E){"use strict";let _,w=0,S=1,y=2,b=3,O=["type","policy"],T=t.extend({_uwaClassName:"ProjectMgmtDetailsAndRelationships",getCustomFields:function(){return O.slice(0,O.length)},init:function(t,i){let n=e.clone(i||{},!1);this.options=n,this.parentContainer=t,this.isCreate=n.isCreate,this._nlsTrend=n.nlsTrend,this.parentApp=n.parentApp,this._appConfig=n.appConfig,this._tabConfig=n.tabConfig,this._collection=n.collection,this._viewConfig=n.viewConfig,this._trendConfig=n.trendConfig,this.isMassUpdate=n.isMassUpdate,this._createConfig=n.createConfig,this._trendTemplate=n.trendTemplate,this._trendChartConfig=n.trendChartConfig,this._matrixConfigCollection=i.matrixConfigCollection,this.relatedView={},this.actionButtons=[],this.scrollElements={},this.detailsDisplayBodyContainers={},this.detailsContainer=e.createElement("div",{id:"objectInfoContainer"}),this.detailsContainer.setHTML(M),this.propertiesContainer=this.detailsContainer.getElement(".object-properties"),this.propertiesBodyContainer=this.detailsContainer.getElement(".object-properties-body"),this.buildTabBarContainer(),!this.isCreate&&!this.isRMCContext&&this.clearRightPanelContent(this.parentContainer),this.isCreate||(this.clearRightPanelContent(this.parentContainer),this.detailsContainer.inject(this.parentContainer),this.detailsDisplayFooterContainer=this.detailsContainer.getElement(".object-properties-footer"),this.detailsDisplayFooter=new h(this.detailsDisplayFooterContainer,this)),this.addActionButtons()},clearRightPanelContent:function(e){if(e){e.getElements("#objectInfoContainer").forEach(e=>e.remove())}},reset:function(){this.destroyDetailsDisplayTabContent();for(let e in this.scrollElements)this.scrollElements.hasOwnProperty(e)&&this.scrollElements[e].destroy();this.scrollElements={},this._isPropertyPanelOpen=!1,this.currentModel&&this.currentModelEvents&&this.currentModel.removeEvents(this.currentModelEvents),delete this.currentTab,delete this.currentModel,delete this.currentModelEvents,delete this._isPropertyPanelOpen},render:function(e){this.showSpinnerView(this.propertiesContainer,E.FETCHING);let t=this;if(this.isCreate||this.parentContainer.getElement(".object-properties")||this.detailsContainer.inject(this.parentContainer),this.reset(),this.isCreate||this.isMassUpdate)this.createData(this._tabConfig.values[0].config);else{this._collection.getDataModelDetails(e).then(e=>t.handleGetDataResponse(e))}return this.detailsContainer},handleDetailsDisplay:function(e){this.showDetailsDisplay(e),this._initialLoad&&this.handleInitialOpenPropertyPanel()},handleInitialOpenPropertyPanel:function(){delete this.currentModel.modificationsPending,this.currentModel.dispatchEvent("onChange:modificationsPending"),this.isNew&&this.currentModel.dispatchEvent("onValidationSuccess")},handleGetDataResponse:function(){this._initialLoad=!0,this.ddTabBar?this.ddTabBar.fire("tabButtonClick"):this.handleDetailsDisplay(),delete this._initialLoad,this.hideSpinnerView(this.propertiesContainer)},getDetailsDisplayDivContent:function(t){return e.createElement("div",{id:t+"Container",class:"details-display-container"})},addScroller:function(t,i){if(this.propertiesBodyContainer){this.scrollElements[t]=new e.createElement("div",{id:"scrollerElement"}),this.scrollElements[t].setStyle("height",this.getHeight()+"px"),i.inject(this.scrollElements[t]);let n=new a({element:this.scrollElements[t]});n.elements.content.addEventListener("scroll",()=>this.dropdown&&this.dropdown.destroy()),n.inject(this.propertiesBodyContainer),this.relatedView[t].scroller=n}},getScroller:function(e){let t=e;return this.relatedView&&this.currentTab&&(t=this.relatedView[this.currentTab.key]),t&&t.scroller},updateScrollPosition:function(){let e=this.getScroller();if(e){let t=e._previousInfos;t&&e.scrollTo(t.x.scrollPosition,t.y.scrollPosition)}},buildTabBarContainer:function(t){let i=this,o=e.clone(t||{},!1);this._tabConfig=o.tabConfig||this._tabConfig;let a=i.detailsContainer.getElement(".object-properties-tabs");if(this._tabConfig.hide)this._tabConfig.values.forEach(function(e){i._collection.setSearchSource(e)});else{this.ddTabBar=new n({id:"detailsPanelTab",displayStyle:"strip",showComboBoxFlag:!1}),this.ddTabBar.inject(a);for(let e=0;e<this._tabConfig.values.length;e++){let t=this._tabConfig.values[e];"classification"!==t.key||this._viewConfig.isLibraryInstalled()?t.doNotShowTab||(this.ddTabBar.add({isSelected:t.selected,icon:{iconName:t.font,fontIconFamily:WUXManagedFontIcons.Font3DS},tooltipInfos:new s({shortHelp:t.name}),type:"radio",checkFlag:t.checkFlag}),this._collection.setSearchSource(t)):(this._tabConfig.values.splice(e,1),e--)}this.initializeTabEvents()}},initializeTabEvents:function(){let t=this.ddTabBar.tabBar,i=t.buttonGroup,n=t.showNextButton,o=t.showPreviousButton;this.ddTabBar.addEventListener("dragenter",function(){let t=event.target.dsModel,n=t&&t.value;if(e.is(n,"number")&&n>=0){let e=i.getButton(n);e.clickMode=0,e.fire("click")}}),n&&n.addEventListener("dragenter",function(){!n.disabled&&n.fire("click")}),o&&o.addEventListener("dragenter",function(){!o.disabled&&o.fire("click")}),this.ddTabBar.addEventListener("tabButtonClick",this.handleTabBarActionEvents.bind(this))},handleTabBarActionEvents:function(t){let i=t.target.dsModel,n=i&&i.value[0];if(e.is(n,"number")&&n>=0){let e=this._tabConfig.values[n],t=e.key;this.currentTab=e,this.currentTabView=this.relatedView[t],"history"!==t&&"riskTrend"!==t||this.relatedView[t]&&this.relatedView[t].reload();for(let e in this.relatedView)t!==e?this.scrollElements[e].hide():this.scrollElements[e].show();this.relatedView[t]||this.handleDetailsDisplay(e)}},_setFieldReadWrite:function(e,t){let i=this.currentTab.config.values.find(t=>t.name===e);if(i){let e=Boolean(this.currentModel.model[t]());i.readWrite=e.toString()}},cancelCreateOrEdit:function(){this.currentModel=this.currentModel||this._collection.getCurrentDataModel(void 0),this.currentModel?(this.currentModel.cancel(),delete this.currentModel,this._collection.reselectCurrentDataModel()):(this.destroyDetailsDisplayTabContent(),this.showSaveCancelFooter(!1))},addActionButtons:function(){if(this._actionButtonConfig=this._tabConfig.actionButtonConfig,!this._actionButtonConfig)return;let e=this.detailsContainer.getElement(".object-properties-actions");this.actionsButton=new o({displayStyle:"lite",domId:"actionsButton",emphasize:"secondary",icon:{iconName:"fonticon fonticon-chevron-down site-icon",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},tooltipInfos:new s({shortHelp:"Actions"}),checkFlag:!1}).inject(e),this.actionsButton.getContent().addEventListener("buttonclick",C.validateModificationsPending.bind(void 0,{dontResetModel:!0,parentView:this.parentApp.parentApp,yesEventFunc:this.createActionsDropdownMenu.bind(this)}))},createActionsDropdownMenu:function(e){let t=this._actionButtonConfig.getItems(this.currentModel.model,e);this.dropdownMenu&&this.dropdownMenu.destroy(),this.dropdownMenu=new l({target:this.actionsButton.getContent(),items:t,events:{onClick:this.handleActionButtonEvents.bind(this)}}),this.dropdownMenu.show()},handleActionButtonEvents:function(e,t){let i=t.name;switch(i){case p.DELETE:this.handleDeleteAction();break;case p.DUPLICATE:this._collection.duplicateDataModels({operation:i,isSelect:this.isPropertyPanelOpen()});break;case p.LINK:C.getCopyLinkURL(this.currentModel),m.buildNotification({message:E.LINK_COPY_TO_CLIPBOARD},"success");break;case p.COMPLETE:case p.RE_OPEN:{this.currentModel.cancel();let e=i===p.COMPLETE?p.COMPLETE_STATE:p.IN_WORK_STATE;this.currentModel.handleAttrsUpdateForActions(p.STATE_ATTR,e);break}}},createData:function(e){this.currentModel=this._collection.getNewDataModel(e,{isMassUpdate:this.isMassUpdate}),this.CreateOrEdit(),this.updateStateOfFooterButtons(!0),this.hideSpinnerView()},CreateOrEdit:function(){this.handleDetailsDisplay(),this.showSaveCancelFooter(!0)},modelChanged:function(e){!this.isCreate&&this._validateActionButtons(),this.showSaveCancelFooter(e)},initializeEvents:function(t){let i=e.clone(t||{},!1);this.currentModelEvents={submitSave:this.save,"onChange:modificationsPending":this._notifyChanges,disableSaveButton:this.updateStateOfFooterButtons},Object.keys(i).length&&e.extend(this.currentModelEvents,i),this.listenTo(this.currentModel,this.currentModelEvents)},showDetailsDisplay:function(e){if(e||(e=this._tabConfig.getDefaultTab()),this.currentTab=e||this.currentTab,this.currentModel||(this.currentModel=this._collection.getCurrentDataModel(void 0)),!this.currentModel)return;this.isNew=this.currentModel.isNew,this.isNew||(this._checkAccess(),this._validateActionButtons(),this._isPropertyPanelOpen=!0);let t=this.currentTab.config,i=t&&t.columnInfo.context;if(this.currentTab.checkFlag&&i){let e=!1;if(this.isNew)e=!D.get("context");else{let t=this.currentModel.getContextModel();e=Boolean(!t||t.canReadAccess())}i.readWrite=e}this.initializeEvents();let n=this.currentTab.key;switch(n){case"comments":this._addComments();break;case"relations":this._addRelation();break;case"riskTrend":this._addTrend();break;case"classification":this._addClassification();break;default:this.currentTab.isCustom?this._addCustomTabContent():this._addDetailsTabContent()}this.currentTabView=this.relatedView[n]},isPropertiesTab:function(){return Boolean("properties"===this.currentTab.key&&this.currentTabView&&this.currentModel)},isClassificationTab:function(){return Boolean("classification"===this.currentTab.key&&this.currentTabView&&this.currentModel)},_addDetailsTabContent:function(e){let t=this.currentTab.key,i=this.currentTab.config;if(!this.relatedView[t]){let e=this.getDetailsDisplayDivContent(t);this.relatedView[t]=new c(e,this),this.addScroller(t,e),this.detailsDisplayBodyContainers[t]=e}this.relatedView[t].setConfig(e||i),this.relatedView[t].resetModel(this.currentModel),this.relatedView[t].render()},_addRelation:function(){let e=this,t=this.currentTab.key;if(!this.relatedView[t]){let i=this.getDetailsDisplayDivContent(t),n=this._viewConfig.getRelationsFacetInfo();n&&require([n.require],function(n){e.relatedView[t]=new n,e.relatedView[t].updateFacetExternal(e.currentModel.model.getModelForRelations()),e.relatedView[t].elements.container.inject(i),e.addScroller(t,i)}),this.detailsDisplayBodyContainers[t]=i}},_addComments:function(){let e=this.currentTab.key;if(!this.relatedView[e]){let t=this.getDetailsDisplayDivContent(e),i=this.currentModel.get("id"),n=D.get("appId"),o=D.get("tenant"),s=D.get("3DSwym"),a="pid:"+i,l=D.get("3DSpace")+"/resources/",c=["/#app:",n,"/content:id=",i,"&propertyPanelTab=commentsTab&x3dPlatformId=",o].join("");this.relatedView[e]=new r({subjectURI:a,subjectUri:a,tenantId:o,serviceURL:l,serviceUrl:l,enableShare:!1,"3DSwymUrl":s,appForcedLinkUri:c,commentsNumberAtInit:8,commentProxyToken:{header:"X-DS-CSRFTOKEN"}}),this.relatedView[e].inject(t),this.addScroller(e,t),this.detailsDisplayBodyContainers[e]=t}},_addTrend:function(){let e=this.currentTab.key;if(!this.relatedView[e]){let t=this.getDetailsDisplayDivContent(e);this.relatedView[e]=new u(t,{nlsTrend:this._nlsTrend,collection:this._collection,trendConfig:this._trendConfig,trendTemplate:this._trendTemplate,trendChartConfig:this._trendChartConfig}),this.relatedView[e].render(),this.addScroller(e,t),this.detailsDisplayBodyContainers[e]=t}},_addClassification:function(){let e=this,t=this.currentTab.key;if(!this.relatedView[t]){let i=this.getDetailsDisplayDivContent(t);e.relatedView[t]=new d(i,{homeView:this,currentModel:this.currentModel}),this.relatedView[t].render(),this.addScroller(t,i),this.detailsDisplayBodyContainers[t]=i}},_addCustomTabContent:function(){let e=this,t=this.currentTab.key;if(!this.relatedView[t]){let i=this.getDetailsDisplayDivContent(t);e.relatedView[t]=this.getCustomView(i,t),this.relatedView&&this.relatedView[t].render(),this.addScroller(t,i),this.detailsDisplayBodyContainers[t]=i}},getCustomView:Function.prototype,_notifyChanges:function(e){this.modelChanged(e&&e.modificationsPending)},updateStateOfFooterButtons:function(e){let t;this.parentApp&&this.parentApp.createDialogView?t=this.parentApp.createDialogView.buttons.Save:this.detailsDisplayFooter&&(t=this.detailsDisplayFooter.saveButton),t&&(t.disabled=e,t.label=this.isNew&&!this.isMassUpdate?E.CREATE_BUTTON_LABEL:E.SAVE)},destroyDetailsDisplayTabContent:function(){if(this.detailsDisplayBodyContainers)for(let e in this.detailsDisplayBodyContainers)this.relatedView[e]&&(this.relatedView[e].destroy(),delete this.relatedView[e]);this.relatedView={}},isPropertyPanelOpen:function(){return this._isPropertyPanelOpen||this.isCreate&&!this.isRMCContext},save:function(t){let i=this;this.currentModel.saving=!0,this.currentModel.dispatchEvent("disableSaveButton",!0),this.showSpinnerView(this.propertiesContainer,E.SAVING);let n=e.clone(t||{},!1),o=n.onFailure,s=n.onComplete,a=n.resetWidgetData,l=this.parentApp.parentApp||this.parentApp,r=this.isPropertyPanelOpen(),c=function(){i.currentModel.saving=!1,i.postCreateProcess(this.isNew?S:y,l,{resetWidgetData:Boolean(a),isSelect:r||Boolean(i.isCreate)}),s&&s.apply(this,arguments)},d=function(){i.currentModel.saving=!1,i.currentModel.dispatchEvent("disableSaveButton",!1),i.hideSpinnerView(),!this.isNew&&i.handlePostSaveFailure(i.currentModel.model),o&&o.apply(this,arguments)};for(let e in this.relatedView)this.relatedView.hasOwnProperty(e)&&this.relatedView[e].prepareSave&&this.relatedView[e].prepareSave();this.isMassUpdate?this._collection.saveDataModels(this.currentModel,{onComplete:c.bind(this),onFailure:d.bind(this)}):this._collection.saveDataModel(this.currentModel,{isNew:this.isNew,isSelect:r,inValidRMC:this.inValidRMC,isContextModified:this.isContextModified,onComplete:c.bind(this),onFailure:d.bind(this)})},handlePostSaveFailure:function(){this.isNew||(this.currentModel.cancel(),this.currentModel.model.set(this.currentModel.model.previousAttributes()),this.currentModel.model.resetChangedAttrs(),this.updateCurrentTabPostSave())},postCreateProcess:function(t,i,n){let o=e.clone(n||{},!1);b===t||w===t?i.postCreateProcess():S===t?(i.createDialogView&&i.createDialogView.close({dontClearAlertMessages:!0}),i.postCreateProcess()):this.currentTab&&this.updateCurrentTabPostSave(),this.hideSpinnerView(),this._isPropertyPanelOpen=o.isSelect,o.resetWidgetData&&(this.currentModel.cancel(),D.setFilterSearchString(""),i.reload({refresh:!0,resetWidgetData:o.resetWidgetData,showLoadSpinner:!0,valiateInvalidRisksContext:!0,loadingMessage:E.MATRIX_CONFIG_LOADING}))},updateCurrentTabPostSave:function(t){e.clone(t||{},!1).doNotUpdateCurrentTab||(this.currentModel.cancel(),this._checkAccess(),this._validateActionButtons(),this.currentTabView&&this.currentTabView.acceptChanges&&this.currentTabView.acceptChanges(this.currentModel)),this.handleInitialOpenPropertyPanel()},handleDeleteAction:function(t){let i=e.clone(t||{},!1),n=i.treeNodeModel,o=(n&&n.options.data||this.currentModel).model.title,s={dontResetModel:!0,title:E.DELETE+' "'+o+'"',message:E.replace(E.DELETE_CONFIRM_MSG,{title:o}),yesEventFunc:this.deleteDataObjectModel.bind(this,n,i),noEventFunc:function(){this.hideSpinnerView(),i.callback&&i.callback.apply(this,arguments)}.bind(this),yesLabel:E.YES,noLabel:E.NO};m.confirmDialog(s)},deleteDataObjectModel:function(e,t){g.showProgressSpinner(this.propertiesContainer,E.DELETING),this._collection.deleteDataModel(e,t).then(this.handleDeleteOnComplete.bind(this,t),this.hideSpinnerView)},handleDeleteOnComplete:function(t){let i=e.clone(t||{},!1).callback,n=this._collection.getDocument(),o=this.parentApp.parentApp||this.parentApp;n&&n.getSelectedNodes().length||this.hideRightPanel(),this.postCreateProcess(b,o),i&&i.apply(this,arguments)},showSpinnerView:function(e,t){g.showProgressSpinner(e||this.propertiesContainer,t)},hideSpinnerView:function(e){g.hideProgressSpinner(e||this.propertiesContainer)},showSaveCancelFooter:function(e){this.detailsDisplayFooter&&this.detailsDisplayFooter.showSaveCancelFooter(e)},destroy:function(){this.destroyDetailsDisplayTabContent&&this.destroyDetailsDisplayTabContent();for(let e in this.detailsDisplayBodyContainers)this.detailsDisplayBodyContainers[e]&&(this.detailsDisplayBodyContainers[e].destroy(),delete this.detailsDisplayBodyContainers[e]);for(let e in this.actionButtons)this.actionButtons.hasOwnProperty(e)&&this.actionButtons[e].destroy();this.detailsDisplayFooter&&this.detailsDisplayFooter.destroy(),this.detailsDisplayFooterContainer&&this.detailsDisplayFooterContainer.destroy(),this.detailsContainer&&this.detailsContainer.destroy()},getHeight:function(){return this.isNew?(this.height=this.height?this.height:this.parentApp.getHeight(),this._calculateHeight()-70):(this.height=this.height?this.height:this.parentApp.parentApp?this.parentApp.parentApp.height:this.parentApp.height,this._calculateHeight()+10)},_calculateHeight:function(){if(this.detailsDisplayFooterContainer){let e=this.detailsDisplayFooterContainer.clientHeight,t=this.detailsContainer.getElement(".object-properties-toolbar"),i=t&&t.clientHeight||0;return this.height-(i+e)}return this.height},setHeight:function(e){this.height=e;for(let e in this.scrollElements)this.scrollElements.hasOwnProperty(e)&&this.scrollElements[e].setStyle("height",this.getHeight()+"px")},hideRightPanel:function(){(this.parentApp.parentApp||this.parentApp).showHideRightPanel(!1),this.reset()},_checkAccess:Function.prototype,_validateActionButtons:Function.prototype});return Object.defineProperty(T.prototype,"_isPropertyPanelOpen",{get:function(){return _},set:function(e){_=e}}),T}),define("DS/ENOProjectMgmtCommonComponents/views/CommonFacetView",["UWA/Core","DS/Controls/Button","DS/ControlsEx/IDCard","DS/Controls/TooltipModel","DS/ENOProjectMgmtCommonComponents/views/HomeViewTabBase","text!DS/ENOProjectMgmtCommonComponents/assets/templates/tmpl-risk-toolbar.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a){"use strict";return o.extend({_uwaClassName:"CommonFacetView",init:function(t,i){let n=e.clone(i||{},!1);this.homeView=n.parentApp,this.massUpdateView=this.homeView.massUpdateView,this._parent.apply(this,arguments),this._appContainer=t,this._nlsTrend=n.nlsTrend,this._appConfig=n.appConfig,this._tabConfig=n.tabConfig,this._viewConfig=n.viewConfig,this.facetConfig=n.facetConfig,this._collection=n.collection,this._detailsAndRelationships=n.detailsAndRelationships,this.headerContainer=this._appContainer.getElement(".ds-app-facet-toolbar"),this.homeBodyContent=this._appContainer.getElement(this.facetConfig.bodyContainer)},reset:function(){this.idCard&&this.idCard.destroy(),this.detailsAndRelationships&&this.detailsAndRelationships.destroy(),this.homeView.getRightPanelContainer().empty()},render:function(){return this.reset(),this._currentModel=this._collection.getCurrentDataModel(),this.initializeContainers(),this.detailsAndRelationships=new this._detailsAndRelationships(this.homeView.getRightPanelContainer(),{isCreate:!1,parentApp:this.homeView,nlsTrend:this._nlsTrend,collection:this._collection,appConfig:this._appConfig,tabConfig:this._tabConfig,viewConfig:this._viewConfig}),this.addIdCard(),this._processTabContentRenderView(),this},initializeContainers:function(){this.homeToolbarContent=this._appContainer.getElement(".ds-app-facet-toolbar"),this.homeToolbarContent.setHTML(s),this.dpmToolbar=this.homeToolbarContent.getElement(".ds-app-toolbar-container"),this.facetToolbarContainer=this.dpmToolbar.getElement("#toolbarFacetTabs"),this.addToolbarAndTabBar(this.facetConfig)},getToolbarSplitter:function(){return new e.createElement("div",{class:"wux-controls-toolbar-category-separator"})},addHomeButton:function(e){delete this.homeButton,this.homeButton=new t({domId:"facetHomeButton",displayStyle:"smartIcon",icon:{iconName:"home",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},tooltipInfos:new n({shortHelp:a.HOME})}).inject(e)},addIdCardContent:function(){let t=this.idCard.getContent().getElement(".wux-controls-toolbar-containers.wux-controls-toolbar-farContainer");this.getToolbarSplitter().inject(t);let i=new e.createElement("div",{class:"wux-generated-toolbar-items wux-toolbar-items wux-toolbar-items-far"}),n=new e.createElement("div",{class:"wux-tweakers"}),o=new e.createElement("div",{class:"wux-generated-toolbar-items-tweaker"});o.inject(i),n.inject(o),this.addHomeButton(n),i.inject(t)},renderDetailsDisplayView:function(){this.detailsAndRelationships||(this.detailsAndRelationships=new this._detailsAndRelationships(this.homeView.getRightPanelContainer(),{isCreate:!1,parentApp:this.homeView,nlsTrend:this._nlsTrend,collection:this._collection,appConfig:this._appConfig,tabConfig:this._tabConfig,viewConfig:this._viewConfig})),this.detailsAndRelationships.render()},initializeIdCardEvents:function(){let e=this;this.idCard&&this.idCard.addEventListener("infoClicked",function(){e.detailsAndRelationships.render(),e.homeView.showHideRightPanel(!0)}),this.homeButton&&this.homeButton.getContent().addEventListener("buttonclick",function(){e.detailsAndRelationships&&(e.detailsAndRelationships._isPropertyPanelOpen=!1),e.homeView.showHideLeftPanel(!0)}),this.listenTo(this.homeView,"updateCommonFacet",this.fetchAndUpdateIDCard.bind(this)),this.detailsAndRelationships&&this.detailsAndRelationships._isPropertyPanelOpen&&this.detailsAndRelationships.render()},addIdCard:function(){delete this.homeButton,this.idCard=new i({isFoldedFlag:!0,infoVisibleFlag:!0,infoActivatedFlag:!0,identifier:"ProjectMgmtCommonFacetIdCard",titleText:this._currentModel.get("name"),pictureSrc:this._currentModel.get("image"),titleIcon:this._currentModel.get("typeicon"),description:this._currentModel.get("description")||""}),this.addIdCardContent(),this.initializeIdCardEvents(),this.idCard.inject(this._getIdCardContainer()),this.fetchAndUpdateIDCard()},fetchAndUpdateIDCard:function(){let e=this;this._currentModel.get("image")?e.idCard.titleText=e._currentModel.title:this._collection.getDataModelDetails({model:this._currentModel.model,refresh:!0}).then(function(){e.idCard.titleIcon=e._currentModel.get("typeicon"),e.idCard.titleText=e._currentModel.get("name"),e.idCard.pictureSrc=e._currentModel.get("image"),e.idCard.description=e._currentModel.get("description")})},_getIdCardContainer:function(){return this._appContainer.getElement(".ds-app-skeleton-idcard")},destroy:function(){this.homeButton&&(this.homeButton.destroy(),delete this.homeButton),this.idCard&&(this.idCard.destroy(),delete this.idCard),this.detailsAndRelationships&&(this.detailsAndRelationships.destroy(),delete this.detailsAndRelationships),this.bodyContent&&(this.homeButton.destroy(),delete this.bodyContent)}})}),define("DS/ENOProjectMgmtCommonComponents/views/MatrixConfigDetailsAndRelationships",["UWA/Core","DS/Controls/ComboBox","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/config/TabMatrixConfigCreate","DS/ENOProjectMgmtCommonComponents/collection/MatrixConfigCollection","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtDetailsAndRelationships","DS/ENOProjectMgmtModels/Models/AppSettings","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r){"use strict";return a.extend({_uwaClassName:"MatrixConfigDetailsAndRelationships",init:function(t,i){var n=e.clone(i||{},!1);this.isRMCContext=i&&i.isRMCContext,this.contextMatrixConfiguration=n.contextMatrixConfiguration,e.extend(n,{hideTab:!0,tabConfig:o,collection:s}),this._parent(t,n)},clearRightPanelContent:function(){!this.isRMCContext&&this._parent.apply(this,arguments)},render:function(){if(this.treeDocument=s.getDocument(),this.propertiesList=this.detailsContainer.getElement(".object-properties-list"),this.labelContainer=e.createElement("div"),this.labelContainer.inject(this.propertiesList),this.selectLabel=e.createElement("label",{id:"selectLabel",text:r.SELECT_EXISTING_CONFIGURATION}),this.selectLabel.inject(this.labelContainer),this.comboBoxContainer=e.createElement("div"),this.comboBoxContainer.inject(this.propertiesList),this.comboBox=new t({elementsTree:this.treeDocument}),this.comboBox.selectedIndex=0,this.comboBox.inject(this.comboBoxContainer),this.comboBox.addEventListener("change",this.handleChangeMatrixConfigurations.bind(this)),s.getDataModelsCount()<=0)this.isCreate=!0;else{this.contextMatrixConfiguration&&this.treeDocument.selectNodeById(this.contextMatrixConfiguration),s.getCurrentDataModel().model.unset("configuredItems")}return this._parent({refresh:!0})},_enableDisableButtons:function(e){let t=this.detailsContainer.getElement(".wux-tweakers-blob-main");t&&(t.toggleClassName("disabled",e),t.style.pointerEvents=e?"none":"auto")},beforeClose:function(){this.currentModel&&this.currentModel.cancel(),this.resetWidgetData&&this.parentApp.reload({refresh:!0,showLoadSpinner:!0,valiateInvalidRisksContext:!0,resetWidgetData:this.resetWidgetData,loadingMessage:r.MATRIX_CONFIG_LOADING})},_addDetailsTabContent:function(e){let t=this._canCreate(),n=this.currentModel.model.isNew(),o=this.currentModel.model.canModify(),s=l.get("isComponent");if(!t&&!n&&!o||s){(e=this.currentTab.config.cloneConfig()).values.splice(0,1),delete e.columnInfo.import;let t=i.findIndex(e.values,"name","configuredItems");t>=0&&(e.values[t].readWrite=o)}this._parent(e,!0),this.isCreate?(this.comboBox.selectedIndex=-1,this._enableDisableButtons(!1)):this._enableDisableButtons(!o)},save:function(){this._parent(!0)},postCreateProcess:function(t,i,n){this.isCreate&&(this.isCreate=!1,this.comboBox.selectedIndex=0);let o=e.clone(n||{},!1);this.resetWidgetData=!0,3===t&&(this.comboBox.selectedIndex=-1,this.comboBox.selectedIndex=0),this._parent(0,i,o)},handlePostSaveFailure:function(){let e=this;this.currentModel.model.unset("configuredItems"),s.getDataModelDetails({refresh:!0}).then(function(t){e.currentModel=t})},handleButtonGroupValueChange:function(e){if(e.dsModel.checkFlag){let t=0===e.dsModel.value;if(this.isCreate=t,t)this.comboBox.selectedIndex=-1,this.createData(this._tabConfig.values[0].config);else{s.selectDataModel(0);let e=this.treeDocument.getSelectedNode();e&&(e=e.options.data,this.relatedView[this.currentTab.key].resetModel(e),this.currentModel.dispatchEvent("disableSaveButton",!0))}}},_canCreate:function(){return Boolean(this.parentApp._viewConfig.matrixConfigCreateAccess())},handleActionButtonEvents:function(e,t){if(this._parent.apply(this,arguments),"export"===t.name){this.currentModel.cancel();let e=JSON.stringify({title:this.currentModel.title,name:this.currentModel.get("name"),matrix:this.currentModel.get("matrix")});i.downloadFile(e,e.title+".json")}},handleChangeMatrixConfigurations:function(){let e=this;if(this.comboBox.selectedIndex>=0){this.showSpinnerView(this.propertiesContainer,r.FETCHING),this.isCreate=!1,this.currentModel&&this.currentModel.cancel(),s.getDataModelDetails({refresh:!0}).then(function(t){e.currentModel=t,e.showDetailsDisplay(),e.currentModel.dispatchEvent("disableSaveButton",!0),e.hideSpinnerView()})}},createActionsDropdownMenu:function(t){let i=e.clone(t||{},!1);e.extend(i,{isDefault:this.currentModel.isDefault(),isCreateNewSelected:-1===this.comboBox.selectedIndex}),this._parent(i)},destroy:function(){this.selectLabel.destroy(),this.labelContainer.destroy(),this._collection.resetTreeDocument(),this.comboBox.removeEventListener("change"),this.comboBox.destroy(),this.comboBoxContainer.destroy(),this.propertiesList.destroy(),this._parent()}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtHomeView",["UWA/Core","UWA/Class/View","DS/UIKIT/DropdownMenu","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/config/AppConfig","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/components/PopupCommon","DS/ENOProjectMgmtCommonComponents/components/ProgressSpinner","DS/ENOProjectMgmtCommonComponents/views/CommonFacetView","DS/ENOProjectMgmtCommonComponents/views/HomeViewTabBase","DS/ENOProjectMgmtCommonComponents/views/MatrixConfigDetailsAndRelationships","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/BaseContext","DS/ENOProjectMgmtModels/Models/BaseContextScope","DS/ENOProjectMgmtModels/Constants/Constants","DS/ENOProjectMgmtModels/Utils/StorageDataUtil","text!DS/ENOProjectMgmtCommonComponents/assets/templates/app-skeleton-template.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g,p,C,f,D){"use strict";return d.extend({_uwaClassName:"ProjectMgmtHomeView",init:function(e){this._parent(e),this.contextScope=new g,widget.projectMgmtAlertManager=a.init(),!u.get("isComponent")&&this._initializeContainersAndViews(e),this.initializeEvents(),r.initializeProgressSpinner(this.container)},_initializeContainersAndViews:function(t){let i=this.canHideTopBar();if(this.container=t.container,this.container=e.extendElement(this.container),this.container.empty(),i)this._appContainer=this.container;else{this.container=this.container.setHTML(f);let t=this.container.getElement(".ds-app-skeleton-navigationbar");t.hide();let i=this.container.getElement(".ds-app-skeleton-statusbar");if(t.hide(),i.hide(),this._myPanelMainContent=this.container.getElement(".ds-app-skeleton-main-content"),this._leftPanelContent=this.container.getElement(".ds-app-skeleton-panel.ds-app-panel-left"),this._rightPanelContent=this.container.getElement(".ds-app-skeleton-panel.ds-app-panel-right"),this._homeTabConfig.leftPanel){this._leftPanelContent.addClassName("ds-app-panel-open"),this._leftPanelContent.addClassName("ds-app-panel-maximized"),this._appContainer=this.container;let t=e.clone(this._homeTabConfig.mainPanel.options||{},!1);t.parentApp=this,t.facetConfig=this._homeTabConfig.mainPanel,t.viewConfig=this._viewConfig,this.commonFacetView=new c(this._myPanelMainContent,t)}else this._appContainer=this._myPanelMainContent.getElement(".ds-app-skeleton-content-container"),this.homeBodyContent=this._myPanelMainContent.getElement(".ds-app-content.ds-app-facet")}this._initAppPreference(),this.initializeTabContainers(t)},_loadMatrixConfigurations:function(e){let t=this,i={rmcType:t._rmcType,onComplete:function(){t._matrixConfigCollection.getDefaultConfiguration(),t._processPostCompleteDataModels(e)},onFailure:function(){}};this._matrixConfigCollection.getDataModels(i)},_processPostCompleteDataModels:function(t){let i=e.clone(t||{},!1),n=this._homeTabConfig&&(u.getContextInfo()?this._homeTabConfig.mainPanel:this._homeTabConfig.leftPanel);(n=n||i._config)&&"facet"===n.type||this._processTabContentRenderView(i),this.handleGetRisksResponse(i),i.showRefreshMessage&&a.buildNotification({message:D.REFRESH_SUCCESSFUL},"success"),i.callback&&i.callback()},_loadMatrixConfigurationDetails:function(){let e=this.contextScope.getConnectedRMC(),t={parentApp:this,isRMCContext:!0,contextMatrixConfiguration:e&&e.id},i=new h(this.container,t);this.createDialogView=l.createDialog({title:D.MATRIX_CONFIGURATION,saveButtonLabel:D.SAVE,contentView:i,beforeCloseCallBack:i.beforeClose.bind(this)})},_initAppPreference:function(){if(!u.get("isComponent")){let e=widget.getValue("completedRisks");e?widget.deleteValue("completedRisks"):e=widget.getValue(n.COMPLETED_PREFERENCE);let t=this._appConfig.completedPreference&&this._appConfig.completedPreference.getDefault();u.set(n.COMPLETED_PREFERENCE,e||t);let i={name:n.COMPLETED_PREFERENCE,type:"list",defaultValue:t,options:this._appConfig.completedPreference&&this._appConfig.completedPreference.values,label:this._nls.SHOW_COMPLETED};widget.addPreference(i)}},initializeEvents:function(){let e=this;this.listenTo(this.contextScope,{onAdd:function(e){r.showProgressSpinner(this.container,this._nls.LOADING),this.clearParamData(),this._loadDataModels(e)},onRemove:this.handleRemoveContext}),this.listenTo(this,"resetModel",this.resetCurrentModel),this.listenTo(u,"onChange:dimensions",this.setHeight),this.listenTo(widget,{onSearch:function(t){e.filterRisksBasedOnSearch(t,"title",!0)},onResetSearch:this.filterRisksBasedOnSearch})},filterRisksBasedOnSearch:function(e,t,i){u.setFilterSearchString(e||""),s.validateModificationsPending({parentView:this,isReload:!0,dontResetModel:!0,yesEventFunc:this.processFilterRisks.bind(this,{yesEvent:!0,searchColAttr:t||"title",searchFilter:e,filterFromTreeDocument:i}),noEventFunc:this.processFilterRisks.bind(this,{searchColAttr:t||"title",searchFilter:e,filterFromTreeDocument:i})})},processFilterRisks:function(t){let i=e.clone(t||{},!1);if(i.callback=this.processFilterRisks.bind(this,t),!this.handleUnsaveForSearchAndPreferences(i)){let e=i.searchFilter,t=i.searchColAttr,n=i.filterFromTreeDocument;e||n||!this.taggerRiskIds||(e=this.taggerRiskIds,t="id"),this._collection.filterDataModels(e,t,{filterFromTreeDocument:n}),this._processTabContentRenderView(),this.setTitle()}},reset:function(e){if(this.container&&this.container.click(),delete this._options,e&&!e.contexChanged)return!0;this._collection.resetCollection()},handleComponentView:function(t){if(this._setExternalDetailsPanel(t),t.container&&this._initializeContainersAndViews(t),t.showLoadSpinner&&r.showProgressSpinner(this.container,this._nls.LOADING),t.contexChanged){this.homeBodyView={};let i=t.context;this.context=this.handleContextForModel(i),this.initializeEventsForComponentContext(i,t),this.contextScope.set("context",this.context,e.extend(t,{homeView:this,config:this._contextSelectionConfig.values[0]}))}else this._loadDataModels(t)},handleContextForModel:function(e,t){let i=e.getTransferObject(),n=s.getObjectDataFromDropData(i.data.items[0]);return s.getObjectForAdding(n.id,{modelConstructor:t||m,attrs:n,sourceInfo:this._contextSourceInfo})},initializeEventsForComponentContext:function(e){this.listenTo(e,"onChange:"+p.XPROJECT_COLLAB_SPACE,function(e,t){let i=u.get("context"),n=i.get("project"),o=t&&t.id;this._options&&n!==o&&(delete this._options.doNotFetchDataForView,delete this._options.contexChanged,i.set("project",o),this.reload(this._options))})},getContextInfo:function(){let e=u.getContextInfo();if(this.isParamSupportedTypeForContext()){let t=this._paramData[0];e={id:t.objectId,type:t.objectType,name:t.displayName,serviceId:t.serviceId},delete this._paramData}return e},clearContentForRefresh:function(){this.homeBodyView={},C.clear(),this.homeBodyContent.empty()},render:function(t){let i=e.clone(t||{},!1);if(this.reset(i),this._options=i,i.refresh&&this.clearContentForRefresh(),u.get("isComponent"))this.handleComponentView(i);else{i.showLoadSpinner&&r.showProgressSpinner(this.container,this._nls.LOADING),this.handleParamDataObjectsInApp();let t=this.getContextInfo();if(e.extend(i,{homeView:this,detailedObjects:[t],config:this._contextSelectionConfig.values[0]}),t)this._homeTabConfig.leftPanel&&e.extend(i,{modelConstructor:this.baseContextModel,callback:function(){this.showHideLeftPanel(Boolean(!u.getContextInfo()))}.bind(this)}),this.contextScope.add("context",t.id,i);else{let e=this.contextScope.get("context");e&&e.length?this.contextScope.remove("context",void 0,i):this._loadDataModels(i)}}},isParamObjectsSupportedInApp:function(){let e,t,i=this._appConfig.supportedTypesAsParamsInAppListing;if(!this._paramData||!i)return!1;let n=[],o={};return this._paramData.forEach(s=>{e=s.objectType,i.includes(e)?n.push(s):(t=s.displayType||e,o[t]||(o[t]=[]),o[t].push(s.displayName))}),Object.keys(o).length&&a.showSingleErrorMessageForDataObjects(o,D.PARAM_DATA_NOT_SUPPORTED),this._paramData=n,Boolean(n.length)},_loadDataModels:function(t){let i=e.clone(t||{},!1),n=u.get("context");if(u.get("isComponent")&&i.doNotFetchDataForView&&this._collection.collection)return i.ignoreFetchDataForView=!0,void this.onCompleteDataModels(i,n);let o=this.onCompleteDataModels.bind(this,i),s=this.onFailureDataModels.bind(this,i);this._paramData||!n?(i.onComplete=o,i.onFailure=s,i.paramData=this._paramData,i.initialCall=this._initialCall,this._collection.getDataModels(i)):(e.extend(i,{initialCall:this._initialCall}),this._collection.getContextInfo(n,i).then(o,s))},handleGetRisksResponse:function(e){this.setTitle();let t=u.get("isComponent"),i=u.getSelectedViewName();t&&i!==this.currentViewName||r.hideProgressSpinner(this.container),this.load6WTagger(e)},load6WTagger:function(t){let i=this,n=e.clone(t||{},!1);if(n.ignoreFetchDataForView||this._options.hide6WTagger)return;let o=this.taggerProxy&&this.taggerProxy.tnProxy;o&&(n.tnProxy=o),!o&&(o=n.tnProxy);let s=u.get("isComponent");!o&&s||this._collection.processTagger(n).then(function(e){i.taggerProxy=e,i.updateTaggerData(),i.listenTo(i.taggerProxy,"onSubjectChanged",function(e){let t=Boolean(e&&(Object.keys(e.allfilters).length||Object.keys(e.localfilters).length));widget.setValue("isTaggersSelected",t),i.taggerRiskIds=[],e&&e.filteredSubjectList&&e.filteredSubjectList.length&&e.filteredSubjectList.forEach(function(e){i.taggerRiskIds.push(e.split("pid://")[1])}),i.filterRisksBasedOnTags(i.taggerRiskIds)})},function(e){a.buildNotification({message:D.TAGGER_ERROR,title:e},"error")})},filterRisksBasedOnTags:function(e,t){this._collection.filterDataModels(e,"id",t),this._processTabContentRenderView(),this.setTitle()},getTaggerProxy:function(){return this.taggerProxy},updateTaggerData:function(){let e=this.taggerProxy;if(!u.get("context")&&e){let t=this._collection&&this._collection.getDocument(),i=t&&t.getChildren();e.updateMappedTagObjects(i)}},handleParamDataObjectsInApp:function(){let e,t,i=this._appConfig.supportedTypesAsParamsInAppListing;if(!this._paramData||!i)return!1;let n={},o=[],s=[],l=[],r=this._appConfig.supportedTypesAsParamsForContext,c=this._paramData.length;c&&this._paramData.forEach(a=>{e=a.objectType,i.includes(e)?o.push(a):r.includes(e)?l.push(a):(t=a.displayType||e,n[t]||(n[t]=[]),n[t].push(a.displayName),s.push(a))});let d=!0,h=l.length;o.length?this._paramData=o:1===h&&(this._paramData=l,d=!1),d&&h&&l.forEach(e=>{t=e.displayType||e.objectType,n[t]||(n[t]=[]),n[t].push(e.displayName)}),s.length===c&&delete this._paramData,Object.keys(s).length&&a.showSingleErrorMessageForDataObjects(n,D.PARAM_DATA_NOT_SUPPORTED)},isParamSupportedTypeForContext:function(){return this._paramData&&1===this._paramData.length&&this._appConfig.supportedTypesAsParamsForContext&&this._appConfig.supportedTypesAsParamsForContext.includes(this._paramData[0].objectType)},handleCenterPanelView:function(){if(this._homeTabConfig.leftPanel){let e=this._collection.getCurrentDataModel();e?e=this.handleContextForModel(e.model,this.baseContextModel):(e=u.get("context"),this._collection.resetCollection(),this._collection.getCollection().push(e),this._collection.resetTreeDocument(),this._collection.getDocument().selectNodeByRowId(0)),this.contextScope.setContextCache(e),this.commonFacetView.render()}},onCompleteDataModels:function(t,i){let n=e.clone(t||{},!1),o=n.ignoreFetchDataForView||this._options.ignoreFetchDataForView;i&&i instanceof e.Class.Model&&(this.clearParamData(),this.dropdownMenu&&this.dropdownMenu.updateItem({id:p.ALL_ITEMS,text:this._nls.ALL_CONTEXT_RISKS,label:this._nls.ALL_CONTEXT_RISKS})),this.canHideTopBar()||this.addViewByFilter(n);let s=u.getFilterSearchString();s&&this._collection.filterDataModels(s,"title"),o?this._processPostCompleteDataModels(n):(this._options.ignoreMatrixConfiguration||this._loadMatrixConfigurations(n),this._viewConfig.isLibraryInstalled()?(this._classificationCollection.loadClassifications(),this.fetchAdditionalDataForModels(this._options)):this._processPostCompleteDataModels(n))},fetchAdditionalDataForModels:function(t){let i=e.clone(t||{},!1),n={fields:"classes.title",includeFields:"classes",paramData:i.paramData,onComplete:this.onCompleteAdditionalDataModels.bind(this,i),onFailure:this.onFailureAdditionalDataModels.bind(this)};this._collection.fetchAdditionalDataForModels(n)},onCompleteAdditionalDataModels:function(e){u.getSelectedViewName()&&u.getSelectedViewName()===this.SUMMARY_VIEW&&this.homeBodyView.summaryView&&this.homeBodyView.summaryView.reloadCharts(),e&&e.processPostCompleteDataModels&&this._processPostCompleteDataModels(e)},onFailureAdditionalDataModels:Function.prototype,onFailureDataModels:function(e,t){if(!u.get("isComponent")){this.contextScope.get("context")&&this.contextScope.remove("context",void 0,e)}this.handleGetRisksResponse(),t&&!t.success&&400===t.statusCode&&this.container.empty&&this.container.empty()},clearParamData:function(){delete this._paramData},handleRemoveContext:function(t){let i=e.clone(t||{},!1);i.showLoadSpinner=!0,this.reload(i)},setTitle:function(){if(!u.get("isComponent")){let e=u.get("context"),t=this._collection.getDataModelsCount(),i=this._paramData&&D.SEARCHED_LIST||"";if(!i){let t=e&&e.get("title")||"",n=this.filterButton&&this.filterButton.selectedSubFilterOption,o=this.filterButton&&this.filterButton.selectedFilterOption;n&&(o+=" - "+n),t&&(i=t+" - "),o&&(i+=o),u.get("invalidRiskFilterisOn")&&(i+=" - "+D.INVALID+" "+D.LIST)}widget.setTitle(i+" ("+t+")")}},addViewByFilter:function(){let e=this,t=this._appConfig.filterPreferenceForDropdown;if(!t)return;this.filterButton=this.getToolbarButton("viewFilterbuttonContainer");let n=t.getItems(u.get("context"));this.setSelectView(n),this.dropdownMenu&&this.dropdownMenu.destroy(),this.dropdownMenu=new i({target:this.filterButton.getContent(),items:n,events:{onClick:s.validateModificationsPending.bind(void 0,{parentView:this,yesEventFunc:function(t,i){e.clearParamData(),-1!==i.className.indexOf("view-by-menu")&&widget.setValue("FilterOption",i.name),-1!==i.className.indexOf("filter-menu")&&widget.setValue("SubFilterOption",i.name),e.reload({showLoadSpinner:!0}),e.addViewByFilter()},noEventFunc:function(){e.addViewByFilter()}})}})},setSelectView:function(e){this.filterButton&&delete this.filterButton.selectedFilterOption,this.filterButton&&delete this.filterButton.selectedSubFilterOption;let t=this,i=widget.getValue("FilterOption"),n=widget.getValue("SubFilterOption");if(e.forEach(function(e){let o="fonticon";i!==e.value&&n!==e.value||(o+=" fonticon-check",-1!==e.className.indexOf("view-by-menu")&&(t.filterButton.selectedFilterOption=e.label),-1!==e.className.indexOf("filter-menu")&&(t.filterButton.selectedSubFilterOption=e.label)),e.fonticon=o}),!this.filterButton.selectedFilterOption){let t=s.findObject(e,"name",p.ALL_ITEMS);t.fonticon+=" fonticon-check",this.filterButton.selectedFilterOption=t.label}return e},createNew:function(e){let t=new this._detailsAndRelationships(this.container,{parentApp:this,collection:this._collection,matrixConfigCollection:this._matrixConfigCollection,trendConfig:this._trendConfig,trendChartConfig:this._trendChartConfig,trendTemplate:this._trendTemplate,viewConfig:this._viewConfig,nlsTrend:this._nls.RISK_TREND,appConfig:this._appConfig,tabConfig:e?this._tabConfigForMassUpdate:this._tabConfigForCreate,isCreate:!e,isMassUpdate:e});this.createDialogView=l.createDialog({contentView:t,saveButtonLabel:e?D.SAVE:D.CREATE_BUTTON_LABEL,title:e?D.MASS_UPDATE:D.replace(D.CREATE_TITLE,{appName:this.appName})})},handleUnsaveForSearchAndPreferences:function(e){let t=!1,i=this.getSelectedCurrentModel();return e.yesEvent&&i&&i.modificationsPending?(this._collection.saveDataModel(i,{isReload:!0,onComplete:e&&e.callback}),t=!0):i&&i.cancel(),t},reload:function(t){let i=e.clone(t||{},!1),n=i.valiateInvalidRisksContext,o=u.get("invalidRiskFilterisOn");n&&o&&"fired"===o&&u.set("invalidRiskFilterisOn","set"),this._parent(i)},destroy:function(){this.dropdownMenu&&this.dropdownMenu.destroy();for(let e in this.homeBodyView)this.homeBodyView.hasOwnProperty(e)&&this.homeBodyView[e].destroy();this.taggerProxy&&this.taggerProxy.destroy(),this._appContainer&&this._appContainer.destroy(),this._leftPanelContent&&this._leftPanelContent.destroy(),this.commonFacetView&&this.commonFacetView.destroy(),this._myPanelMainContent&&this._myPanelMainContent.destroy(),this._rightPanelContent&&this._rightPanelContent.destroy()},showHideRightPanel:function(e){this._externalRightPanelOptions?e?this._externalRightPanelOptions.openDetailsPanel():this._externalRightPanelOptions.closeDetailsPanel():this._rightPanelContent&&this._rightPanelContent.toggleClassName("ds-app-panel-open",e)},showHideLeftPanel:function(e){e?(this.showHideRightPanel(!1),this.contextScope.setContextCache(),!this.homeBodyView[this._homeTabConfig.leftPanel.defaultTab]&&this._loadDataModels()):this.handleCenterPanelView(),this._leftPanelContent.toggleClassName("ds-app-panel-open ds-app-panel-maximized",e)},getHeight:function(){let e=u.get("isComponent");this.homeToolbarContainer=this._appContainer.getElement(".ds-app-toolbar-container");let t=this.homeToolbarContainer&&this.homeToolbarContainer.clientHeight;if(e){return this.container.offsetHeight-t}return t?this.height-t:this.height},setHeight:function(e){let t=this;this.height=u.get("height"),(e=e||this._homeTabConfig.leftPanel||this._homeTabConfig.mainPanel).toolbarConfig.group1.forEach(function(e){t.homeBodyView[e.name]&&t.homeBodyView[e.name].setHeight&&t.homeBodyView[e.name].setHeight(t.getHeight())});let i=t.commonFacetView&&t.commonFacetView.homeBodyView;if(i){let e=Object.keys(i);e.length&&e.forEach(e=>{i[e].setHeight(t.getHeight())})}},postCreateProcess:function(){this.setTitle();let e=u.getSelectedViewName();"summaryView"===e&&this.homeBodyView[e].loadData()},getGridView:function(){return s.isGridViewSelected()&&this.homeBodyView[u.getSelectedViewName()]},getSelectedCurrentModel:function(){let e=this.getGridView();return e&&e.detailsAndRelationships.currentModel},resetCurrentModel:function(){let e=this.getGridView();e&&e.detailsAndRelationships.cancelCreateOrEdit()},getRightPanelContainer:function(){return this._externalRightPanelOptions&&this._externalRightPanelOptions.detailsPanelContainer||this._rightPanelContent},SUMMARY_VIEW:"summaryView"})});