define("DS/3DPlayDMUExperience/3DPlayDMUExperience",["DS/3DPlayExperienceModule/PlayExperience3D","DS/Visualization/ThreeJS_DS","DS/DMUReadPersistence/DMUReviewPersistenceServices","DS/DMUBaseUIControllers/DMUReviewContextInitializer","DS/DMUBaseUIServices/DMUSlidePreferences","DS/DMUBaseExperience/EXPImportServices","DS/DMUControls/EXPNotify","DS/DMUBaseExperience/DMUContextManager","DS/DMUBaseUIControllers/DMU2DSheetManager","DS/DMUBaseExperience/EXPManagerSet","DS/DMUPlaySlide/controllers/DMUSlideShowController","DS/ApplicationFrame/CommandsManager","DS/DMUBaseUIControllers/DMUSlidesController","DS/DMUBaseUIControllers/DMUCommentsController","DS/DMUReadPersistence/DMUWebServicesUtils","DS/DMUBaseUIControllers/DMUApplicativeContextManager","DS/CATWebUXPreferences/CATWebUXPreferencesManager","DS/CATWebUXPreferences/CATWebUXPreferencesUtils","DS/CATWebUXSelectionManager/CATWebUXSelectionManager","DS/CATWebUXComponents/CATWebUXUtils","DS/DMUMeasurable/DMUToolsSceneGraph","DS/DMUReadPersistence/DMULoadingContextController","i18n!DS/3DPlayDMUExperience/assets/nls/3DPlayDMUExperience"],function(e,t,n,r,o,i,a,l,s,c,d,p,D,u,m,g,f,C,w,y,M,V,P){"use strict";var S;return e.extend({init:function(e){var h,v,x,b,U,R,A,I,T,W,k,O,E=new n,F=!1,L=this,j=!0,_=!1,B=!1,X={},N="";let G=null,q=!1,H="Perspective",J=!1,z=!1,K="selectParentReference",Q=!1;function Y(e){var t={lastCommand:[],currentCommand:null,defaultCommand:null},n=L.pad3DViewer.getCommandContext();n?p._commandsState[n]=t:p._commandsState=t,p.resetDefaultCommand(n),p._isCommandEnding=!1,p._ignoreCommandBeginWhileEndingCommand=!1,["_commands","_cmdCheckHeader"].forEach(function(e){var t=n&&p[e]?p[e][n]:p[e];t&&Object.keys(t).forEach(function(e){var n=t[e];n&&n._destroy&&n._destroy(),delete t[e]})});var r=L.pad3DViewer.getFrameWindow().getActionBar(),o=r.onActionBarReady(function(){r.removeCallback(o),setTimeout(e.actionBarReadyCb,500)});L.pad3DViewer.loadActionBar({file:e.file,module:e.module})}function Z(e,t){var n=function(){if(L.pad3DViewer){var e,n=p.getCommandCheckHeader("WebDocumentBookmarksPanelCmdHdr",L.pad3DViewer.getCommandContext());if(n){let e=localStorage.getItem("DMUBookmarksPanelDisplayed");"true"!==e&&("false"===e||"Requirement"!==t&&"Requirement Specification"!==t)||n.setState(!0),v&&v.documentHasBookmarks()?n.enable():n.disable()}if((n=p.getCommand("WebDocumentRotatePagesLeftCmdHdr",L.pad3DViewer.getCommandContext()))&&(v&&"Document"===v.getDocumentType()?n.enable():n.disable()),(n=p.getCommand("WebDocumentRotatePagesRightCmdHdr",L.pad3DViewer.getCommandContext()))&&(v&&"Document"===v.getDocumentType()?n.enable():n.disable()),(n=p.getCommand("DMUNextCommentCmdHdr",L.pad3DViewer.getCommandContext()))&&(A&&A.hasComments()?n.enable():n.disable()),(n=p.getCommand("DMUPreviousCommentCmdHdr",L.pad3DViewer.getCommandContext()))&&(A&&A.hasComments()?n.enable():n.disable()),l.getReviewContext({context:L.pad3DViewer})&&l.getReviewContext({context:L.pad3DViewer}).getCurrentSessionMarkup()&&(e=l.getReviewContext({context:L.pad3DViewer}).getCurrentSessionMarkup()),e){var r=e.getSlides(),o=e.getAttribute("sCurrentSlideId"),i=D.giveDMUSlidesController({context:L.frmWindow});if(L.autoReframe=!1,i)if("string"==typeof o){for(var a=0;a<r.length;a++)if(r[a].getAttribute("sID")===o){i.setActiveSlide(r[a]);break}}else r.length&&i.setActiveSlide(r[0])}}};N!==e?("ITF"===e?Y({file:"3DPlayDMUAndITFSection.xml",module:"3DPlayDMUExperience",actionBarReadyCb:n}):"Document"===e?Y({file:"3DPlayDMUExperienceDocument.xml",module:"3DPlayDMUExperience",actionBarReadyCb:n}):"3D"===e?Y({file:"3DPlayDMUExperience.xml",module:"3DPlayDMUExperience",actionBarReadyCb:n}):"2D"===e?Y({file:"3DPlayDMUDrawingExperience.xml",module:"3DPlayDMUExperience",actionBarReadyCb:n}):"MSR"===e&&Y({file:"3DPlayDMUMSRExperience.xml",module:"3DPlayDMUExperience",actionBarReadyCb:n}),N=e):n()}function $(e){b||(b=g.getDMUApplicativeContextManager({context:L.pad3DViewer})).initApplicativeContainer(e,{onReady:function(e){e&&e.length&&e.forEach(function(e){"POI"!==e.getApplicativeContainerID()&&e.setActiveState(!0)})}})}function ee(){if(_&&B){var e;L.pad3DViewer.getRootBagPath().getChildrenPathes()[0]&&(e=M.getNodeType(L.pad3DViewer.getRootBagPath().getChildrenPathes()[0].getLastElement(!0)));var t=L.pad3DViewer.getApplicativeData().getLoadedItfData&&L.pad3DViewer.getApplicativeData().getLoadedItfData().data.length?"ITF":"Drawing"===e||"DIFLayout"===e||"DIFSheet"===e?"2D":"Document"===e||"Requirement"===e||"Requirement Specification"===e?"Document":"DesignSight"===e?"MSR":"3D";$(t),"Document"!==t||"DXF"!==x.getLoadMarkupCtxType()&&"DWG"!==x.getLoadMarkupCtxType()||(t="2D"),Z(t),"Document"===t&&L.pad3DViewer.getViewpoint().setDefaultController(!0,"CATIA"),(k=w.getSelectionManager({context:L.pad3DViewer})).setActiveState(!0),(W=f.getPreferenceManager({context:L.pad3DViewer.getFrameWindow()}))&&(W.setUnitsPreferencesDisplayFlag(!0),W.setDisplayPreferencesDisplayFlag(!0),W.set3DSelectionPreferencesDisplayFlag(!0),W.set2DSelectionPreferencesDisplayFlag(!0),W.addPreferences([{nls:P.preferences.markupSectionTitle,id:"MarkupPreferences",type:"section",preferences:[{nls:P.preferences.SlideTitleDisplayLbl,id:"DisplaySlideTitle",type:"checkbox",getValue:function(){return"true"===localStorage.getItem("CATWebUXMePreferences_DisplaySlideTitle")},getDefaultValue:function(){return!1},setValue:function(e){e!==("true"===localStorage.getItem("CATWebUXMePreferences_DisplaySlideTitle"))&&localStorage.setItem("CATWebUXMePreferences_DisplaySlideTitle",e?"true":"false")}},{nls:P.preferences.compareSectionTitle,id:"ComparePreferences",type:"section",preferences:[{nls:P.preferences.firstProductColor,id:"CompareFirstColor",type:"color",getValue:function(){return localStorage.getItem("CATWebUXMePreferences_CompareFirstColor")?localStorage.getItem("CATWebUXMePreferences_CompareFirstColor"):"#FF0000"},getDefaultValue:function(){return"#FF0000"},setValue:function(e){localStorage.setItem("CATWebUXMePreferences_CompareFirstColor",e)}},{nls:P.preferences.secondProductColor,id:"CompareSecondColor",type:"color",getValue:function(){return localStorage.getItem("CATWebUXMePreferences_CompareSecondColor")?localStorage.getItem("CATWebUXMePreferences_CompareSecondColor"):"#00FF00"},getDefaultValue:function(){return"#00FF00"},setValue:function(e){localStorage.setItem("CATWebUXMePreferences_CompareSecondColor",e)}},{nls:P.preferences.compare3DCommonColor,id:"Compare3DCommonColor",type:"color",getValue:function(){return localStorage.getItem("CATWebUXMePreferences_Compare3DCommonColor")?localStorage.getItem("CATWebUXMePreferences_Compare3DCommonColor"):"#D3D3D3"},getDefaultValue:function(){return"#D3D3D3"},setValue:function(e){localStorage.setItem("CATWebUXMePreferences_Compare3DCommonColor",e)}},{nls:P.preferences.compare2DCommonColor,id:"Compare2DCommonColor",type:"color",getValue:function(){return localStorage.getItem("CATWebUXMePreferences_Compare2DCommonColor")?localStorage.getItem("CATWebUXMePreferences_Compare2DCommonColor"):"#000000"},getDefaultValue:function(){return"#000000"},setValue:function(e){localStorage.setItem("CATWebUXMePreferences_Compare2DCommonColor",e)}}]}]}]),W.setPreferredPreferenceContainersOrder(["MarkupPreferences","MeasurePreferences","SectionPreferences","ComparePreferences"]),G=W.subscribe("com.ds.mep:onPrefUpdate",function(e){let t=JSON.parse(e[1].preferences);for(let e=0;e<t.repositories.length;e++)for(let n=0;n<t.repositories[e].preferences.length;n++)"SelectParentReferenceOr3DShape"===t.repositories[e].preferences[n].name?(K=t.repositories[e].preferences[n].value,k&&k.selectParentReference("select3DShape"!==K)):"Select3DGeometry"===t.repositories[e].preferences[n].name?(J="true"===t.repositories[e].preferences[n].value,k&&k.setPicking(J?0:1)):"Select2DGeometry"===t.repositories[e].preferences[n].name?(z="true"===t.repositories[e].preferences[n].value,k&&L.pad3DViewer.getViewer().get2DMode()&&k.setPicking(z?0:1)):"ProjectionType"===t.repositories[e].preferences[n].name?(H=t.repositories[e].preferences[n].value,L.pad3DViewer&&L.pad3DViewer.getViewer()&&L.pad3DViewer.getViewer().currentViewpoint&&L.pad3DViewer.getViewer().currentViewpoint.setProjectionType(H)):"Gravity"===t.repositories[e].preferences[n].name&&(q="true"===t.repositories[e].preferences[n].value,L.pad3DViewer&&L.pad3DViewer.getViewer()&&L.pad3DViewer.getViewer().currentViewpoint&&L.pad3DViewer.getViewer().currentViewpoint.control&&(L.pad3DViewer.getViewer().currentViewpoint.getControl().setRotationRolling(!q),L.pad3DViewer.getViewer().currentViewpoint.getControl().setRollingForTouchAvailable(!q)))}),C.readPreferences([{Repository:"VisualizationRepository",PreferenceNames:["Gravity"]},{Repository:"FrameGeneral",PreferenceNames:["ProjectionType"]},{Repository:"SelectionRepository",PreferenceNames:["Select3DGeometry","SelectParentReferenceOr3DShape","Select2DGeometry"]}]).then(e=>{let t=e.repositories;for(let e=0;e<t.length;e++)if("VisualizationRepository"===t[e].name)q="true"===t[e].preferences[0].value;else if("FrameGeneral"===t[e].name)H=t[e].preferences[0].value;else if("SelectionRepository"===t[e].name){let n=t[e].preferences;for(let e=0;e<n.length;e++)"Select3DGeometry"===n[e].name?J="true"===n[e].value:"Select2DGeometry"===n[e].name?z=n[e].value:"SelectParentReferenceOr3DShape"===n[e].name&&(K=n[e].value)}L.pad3DViewer.getViewer().get2DMode()?k&&k.setPicking(z?0:1):("boolean"==typeof q&&(L.pad3DViewer.getViewer().currentViewpoint.getControl().setRotationRolling(!q),L.pad3DViewer.getViewer().currentViewpoint.getControl().setRollingForTouchAvailable(!q)),"Perspective"!==H&&"Parallel"!==H||L.pad3DViewer.getViewer().currentViewpoint.setProjectionType("Perspective"===H?0:1),k&&k.setPicking(J?0:1),k&&k.selectParentReference("select3DShape"!==K))}).catch(e=>{L.pad3DViewer.getViewer().get2DMode()?(k&&k.setPicking(z?0:1),window.console.warn("Could not get server value, default value set instead.",e)):("boolean"==typeof q&&(L.pad3DViewer.getViewer().currentViewpoint.getControl().setRotationRolling(!q),L.pad3DViewer.getViewer().currentViewpoint.getControl().setRollingForTouchAvailable(!q)),"Perspective"!==H&&"Parallel"!==H||L.pad3DViewer.getViewer().currentViewpoint.setProjectionType("Perspective"===H?0:1),k&&k.setPicking(J?0:1),k&&k.selectParentReference("select3DShape"!==K),window.console.warn("Could not get server value, default value set instead.",e))}))}}function te(){if(!B){if(B=!0,l.getReviewContext({context:L.pad3DViewer})&&l.getReviewContext({context:L.pad3DViewer}).getCurrentSessionMarkup()){var e;L.pad3DViewer.getRootBagPath().getChildrenPathes()[0]&&(e=M.getNodeType(L.pad3DViewer.getRootBagPath().getChildrenPathes()[0].getLastElement(!0)));var t=L.pad3DViewer.getApplicativeData().getLoadedItfData&&L.pad3DViewer.getApplicativeData().getLoadedItfData().data.length?"ITF":"Drawing"===e||"DIFLayout"===e||"DIFSheet"===e?"2D":"Document"===e||"Requirement"===e||"Requirement Specification"===e?"Document":"DesignSight"===e?"MSR":"3D";if(x||(x=V.getLoadingContextController({context:L.pad3DViewer})),"DXF"!==x.getLoadMarkupCtxType()&&"DWG"!==x.getLoadMarkupCtxType()||(t="2D"),$(t),Z(t,e),"Document"===t&&(L.pad3DViewer.getViewpoint().setDefaultController(!0,"CATIA"),v||(v=c.getManager({name:"DMU2DSheetManager",context:L.frmWindow})),A||(A=u.giveDMUCommentsController({context:L.frmWindow,commandContext:L.pad3DViewer.getCommandContext()})),!v.isADocumentDisplayed())){let n=l.giveEventsController({viewer:L.pad3DViewer.getViewer()}),r=n.addEvent("on2DDocumentLoadSuccess",()=>{n.removeEvent(r),Z(t,e)})}R||(R=new d({context:L.pad3DViewer})).subscribe("onActiveStateModified",function(e){j=!e.state}),F||(o.setSlidePreferences({context:L.frmWindow,preferences:{displayNominal:!0}}),F=!0)}ee()}}function ne(e){if(!_&&void 0!==e.reviewId){let t;(t="Markup"===e.reviewType?E.getDnDReviewAndJSONFile:E.getMarkupStream)({markupId:e.reviewId,markupType:e.reviewType,markupOwner:e.owner},function(t){var n,a={},s=null,c=null,p=async function(){var n=l.getReviewContext({viewer:L.pad3DViewer.getViewer()});n||(n=await r.createReviewContext({context:L.pad3DViewer}));var a=new i({viewer:L.frmWindow.getViewer(),experience:n,appType:"3dPlay"});a.importDataModel(t.jsonObj,function(r){a.postImport(),n.setCurrentSessionMarkup(r[0].getMarkupContent?r[0].getMarkupContent():r[0]),n.setReadOnly(!0),n.refreshNode(),x||(x=V.getLoadingContextController({context:L.pad3DViewer})),n.setReviewCtxInformation({contextId:e.physicalid,contextType:x?x.getLoadMarkupCtxType():O,reviewId:t.reviewPid,reviewName:e.displayname,reviewType:t.reviewType,modifiable:t.modifiable,owner:t.owner,tempObjectInfo:x?x.getTempObjectInformations():void 0}),_=!0,o.setSlidePreferences({context:L.frmWindow,preferences:{panelTitle:e.displayname}}),ee()})};t.jsonObj.Contexts?(e.refresh&&p(),x||(x=V.getLoadingContextController({context:L.pad3DViewer})),"Document"===e.dtype?(t.jsonObj.Contexts[0].documentVersionInfos&&(n=t.jsonObj.Contexts[0].documentVersionInfos),a.objectId=e.physicalid,a.objectType="Document",a.documentType=t.jsonObj.Contexts[0].documentType,a.fileId=n?n.fileId:"",a.cbOK=async function(){await p()},a.appInfo="X3DPLAW_AP",x.load({data:a})):(c=t.jsonObj.Contexts[0].listData,s=t.jsonObj.Contexts[0].loadingInfos,c&&0!==c.length?(a.objectId=c,a.objectType="PLMPIMMetricReference",a.loadMode=s,a.appInfo="X3DPLAW_AP",a.cbOK=function(){p()},x.load({data:a})):(a.objectId=e.physicalid,a.objectType="SIMItfSimulation",a.loadMode=s,a.appInfo="X3DPLAW_AP",a.cbOK=function(){p()},x.load({data:a})))):"Requirement"===e.dtype||"Requirement Specification"===e.dtype?(x||(x=V.getLoadingContextController({context:L.pad3DViewer})),a.objectId=e.physicalid,a.objectType=e.dtype,a.cbOK=function(){p()},a.appInfo="X3DPLAW_AP",x.load({data:a})):p();R||(R=new d({context:L.pad3DViewer})).subscribe("onActiveStateModified",function(e){j=!e.state}),F||(o.setSlidePreferences({context:L.frmWindow,preferences:{displayNominal:!0}}),F=!0)},function(){h&&h.destroy(),h=new a({body:L.frmWindow.getUIFrame(),type:"error",message:P.noMarkup})})}}S=null,this.internalLoad=function(e){if(l.removeReviewContext({context:L.pad3DViewer}),U=e?JSON.stringify(e):null,e){var t=e.asset.physicalid,n=e.asset.type;if(t){var r=function(){h&&h.destroy(),h=new a({body:L.frmWindow.getUIFrame(),type:"error",message:P.loadError})};let o;(o="Markup"===e.asset.type?E.getProductByMarkerId:E.getMarkupInfos)(e.asset,function(o){var i=e.asset;i.physicalid=o.MarkupContext.serviceID&&"r2vsurvey"===o.MarkupContext.serviceID?o.MarkupContext.contextId:o.MarkupContext.contexts[0].id,i.dtype=o.MarkupContext.serviceID&&"r2vsurvey"===o.MarkupContext.serviceID?"R2VFeatureState":o.MarkupContext.contexts[0].type,i.reviewId=t,i.reviewType=n,i.owner=o.owner,O=i.dtype;var a,l,d=function(){I||(I=L.pad3DViewer.subscribe({event:"onRootAdded"},function(e){var t;t={physicalid:e.id,dtype:M.getNodeType(e.path.getLastElement(!0)),onComplete:function(){Q||(Q=!0,L.onModelLoadingCompleted(),te(),ne(i))},onFailure:function(){Q||(Q=!0,L.onModelLoadingCompleted(),L.clearView(),r())}},v&&require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSettingsMgt"],function(e,n){e&&n&&v.load2DDocument({phyID:t.physicalid,serverUrl:e.get3DSpaceUrl(),securityContext:n.getSetting("pad_security_ctx"),dataType:t.dtype,is2DCompareActive:Q,parentNode:L.pad3DViewer.getRootBagPath().getChildrenPathes()[L.pad3DViewer.getRootBagPath().getChildrenPathes().length-1].getLastElement(!0),onLoadingStarted:function(){Q||L.onModelLoadingStarted(!0)},onComplete:t.onComplete,onFailure:t.onFailure})})})),T||(T=L.pad3DViewer.subscribe({event:"onRootRemoved"},function(e){v&&v.clean2DDocument(e)})),(v=c.getManager({name:"DMU2DSheetManager",context:L.frmWindow}))||(v=new s({ctxViewer:L.pad3DViewer}),c.addManager({name:"DMU2DSheetManager",context:L.frmWindow,manager:v})),L.pad3DViewer.addRoots({objects:[{path:[i.physicalid]}]})};a=i.dtype,l=function(e){e&&e.length&&-1!==e.indexOf("SIMItfSimulation")?ne(i):e&&e.length&&-1!==e.indexOf("DesignSight")?function(){x||(x=V.getLoadingContextController({context:L.pad3DViewer}));var e={};e.objectId=i.physicalid,e.objectType=i.dtype,x.load({data:e}),ne(i)}():e&&e.length&&(-1!==e.indexOf("Drawing")||-1!==e.indexOf("CATDrawing"))?d():-1!==e.indexOf("DIFLayout")||-1!==e.indexOf("DIFSheet")?function(){x||(x=V.getLoadingContextController({context:L.pad3DViewer}));var e={};e.objectId=i.physicalid,e.objectType=i.dtype,x.load({data:e}),ne(i)}():e&&e.length&&(e.includes("Document")||e.includes("Requirement")||e.includes("Requirement Specification"))?(I||(I=L.pad3DViewer.subscribe({event:"onRootAdded"},function(){te()})),(v=c.getManager({name:"DMU2DSheetManager",context:L.frmWindow}))||(v=new s({ctxViewer:L.pad3DViewer}),c.addManager({name:"DMU2DSheetManager",context:L.frmWindow,manager:v})),A||(A=u.getDMUCommentsController({context:L.frmWindow,commandContext:L.pad3DViewer.getCommandContext()})),ne(i)):e&&e.length&&-1!==e.indexOf("R2VFeatureState")?(I||(I=L.pad3DViewer.subscribe({event:"onRootAdded"},function(){L.onModelLoadingCompleted(),te(),ne(i)})),L.pad3DViewer.addR2Vs({objects:[{displayName:"r2vName",objectId:i.physicalid,objectType:"R2V_FeatureState",path:[{resourceid:i.physicalid,type:"R2V_FeatureState"}],serviceId:"r2vsurvey"}],reframe:!1,displayNotif:!0,dispatch:!0})):(I||(I=L.pad3DViewer.subscribe({event:"onRootAdded"},function(){L.onModelLoadingCompleted(),te(),ne(i)})),"ENOStrRefinementSpecification"===O?L.pad3DViewer.addFilter([{objectId:i.physicalid}]):L.pad3DViewer.addRoots({objects:[{path:[i.physicalid]}]}))},m.getParentTypes(a).then(function(e){l([a].concat(e))}).catch(function(){l([a])})},r)}}},this.internalClear=function(e){if(W){W.removePreferences(["MarkupPreferences"]);var t=Object.keys(X);for(let e=0;e<t.length;e++)W.unsubscribe(X[t[e]]);X={}}if(L.pad3DViewer&&I&&L.pad3DViewer.unsubscribe(I),I=null,L.pad3DViewer&&T&&L.pad3DViewer.unsubscribe(T),T=null,G&&(W.unsubscribe(G),G=null),R&&(R.clean(),R=null),b&&g.unreferenceDMUApplicativeContextManager({context:L.pad3DViewer}),e){if(f.unreferencePreferenceManager({context:L.pad3DViewer.getFrameWindow()}),W=null,w.unreferenceSelectionManager({context:L.pad3DViewer}),k=null,l.removeReviewContext({context:L.pad3DViewer}),v&&v.clean2DDocument(),A&&A.cleanCommentsPanel(),u.unreferenceDMUCommentsController({context:L.frmWindow}),L.pad3DViewer.getRootBagPath().getChildrenPathes()[0]){var n=M.getNodeID(L.pad3DViewer.getRootBagPath().getChildrenPathes()[0].getLastElement(!0));L.pad3DViewer.getController().removeRoots({pids:[n]})}c.removeManager({name:"DMU2DSheetManager",context:L.frmWindow})}_=!1,B=!1,Q=!1,v=A=b=null},this.internalDispose=function(e){U=null,L.frmWindow.getContextualUIManager().unregister("3DPlayDMUExperience"),o.removeSlidePreferences({context:L.frmWindow}),L.internalClear&&L.internalClear("ENOR3D_AP"!==e),E=null,F=!1},this.internalRefresh=function(){U&&(L.internalClear(!0),L.internalLoad(JSON.parse(U),!0))},this.internalPostCreate=function(){L.frmWindow.getContextualUIManager().register({subscriberId:"3DPlayDMUExperience",workbenchName:"3DPlayDMUExperience",context:L.pad3DViewer.getCommandContext(),cmdPrefix:"",fileName:"3DPlayDMUExperience.xml",module:"3DPlayDMUExperience",onContextualMenuReady:function(e,n){var r=[];if(j&&n&&n.XmousePosition){var o=new t.Vector2(n.XmousePosition,n.YmousePosition),i=L.frmWindow.getViewer().getMousePosition(o);0===L.frmWindow.getViewer().pick(i,"mesh",!0).path.length&&(y.isMobile()||(r=[{line:1,name:"DMU3DReviewDisplaySubMenu",resourceFile:"DMUBaseCommands/3DPlayPro",hdr_list:["VisuQMCommand"]}]),r=r.concat([{line:1,name:"DMU3DReviewAmbiencesSubMenu",resourceFile:"DMUBaseCommands/3DPlayPro",hdr_list:["VisuPureWhiteOCACmd","VisuWhiteMirrorOCACmd","VisuWhiteReviewOCACmd","VisuWhiteExperienceOCACmd","VisuStudioOCACmd","VisuDarkMirrorOCACmd","VisuDarkReviewOCACmd","VisuWhiteDesignOCACmd","VisuBlueDesignOCACmd","VisuDarkDesignOCACmd","VisuIndoorOCACmd","VisuCityOCACmd","VisuRoadOCACmd","VisuOutdoorOCACmd","VisuBasicOCACmd"]}]))}return{cmdList:r}}})},e.commandApplication=!1,e.workbenchs=e.workbenchs||[],e.options.pad3DViewer||e.workbenchs.push({name:"3DPlayDMUExperience",module:"3DPlayDMUExperience"}),this._parent(e),this.subscribe("ASSET/LOADINGFINISHED",te,!0)},clearView:function(){this.internalClear&&this.internalClear(!0),this._parent()},onPostCreate:function(){this.pad3DViewer.getViewer().setPrePicking({activated:!0,displayHL:!0}),window.widget.setMetas({helpPath:"3DPlayDMUExperience/assets/help"}),window.widget.dispatchEvent("onPlayExperienceReady",[{pad3DViewer:this.pad3DViewer}]),this.internalPostCreate&&this.internalPostCreate()},dispose:function(e){window.widget.setMetas({helpPath:void 0}),this.internalDispose&&this.internalDispose(S),S=null,this._parent(e)},refresh:function(){return this.internalRefresh&&this.internalRefresh(),!0},loadAsset:function(e){e&&e.asset&&e.asset.physicalid&&this.internalLoad&&(this.clearView(),this.internalLoad(e))},acceptSwitch:function(e){var t=!1;return e&&e.options&&e.options.id&&("ENOR3D_AP"!==(S=e.options.id)&&"CATC3D_AP"!==S&&"CATA3I_AP"!==S||(t=!0)),t}})});