define("DS/UnifiedExportCommand/Utils/ExchangeInfra",["UWA/Class","DS/WAFData/WAFData","DS/CoreEvents/ModelEvents","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e,t,n,o){"use strict";return e.singleton({URLS:{CVSERVLET_PROGESSIVEEXPAND:"/cvservlet/progressiveexpand/v2?output_format=cvjson&xrequestedwith=xmlhttprequest"},EVENTS:{LOAD_METHOD_FAILED:"loadmethodfailed",ERROR_OCCURED:"erroroccured"}},{setup:function(e){let t=this;return t.APP_ID=widget.getValue("x3dAppId"),t._private_={modelEvents:new n},t.options=UWA.merge(t.options||{},e),UWA.Promise.all([t.expectations(),t.getPlatformServices().then(t.getSecurityContext.bind(null,t)).then(t.getGrantedRoles.bind(null,t))])},get:function(){return{platformServices:this.platformServices,securityContext:this.securityContext,grantedRoles:this.grantedRoles}},getPlatformServices:function(){let e=this;return new UWA.Promise(function(t,n){o.getPlatformServices({onComplete:e.postGetPlatformServices.bind(null,e,t)})})},postGetPlatformServices:function(e,t,n){let o=n.find(function(e){return e.platformId==widget.getValue("x3dPlatformId")});o||(o=n[0]),e.platformServices=o,t()},getSecurityContext:function(e){return new UWA.Promise(function(n,o){t.authenticatedRequest(e.platformServices["3DSpace"]+"/resources/pno/person/getsecuritycontext",{method:"GET",type:"json",proxy:"passport",onComplete:e.postGetSecurityContext.bind(null,e,n)})})},postGetSecurityContext:function(e,t,n){e.securityContext=n.SecurityContext,t()},getGrantedRoles:function(e){return new UWA.Promise(function(t,n){o.getGrantedRoles(e.postGetGrantedRoles.bind(null,e,t))})},postGetGrantedRoles:function(e,t,n){e.grantedRoles=n,t()},expectations:function(){var e=this;return new UWA.Promise(function(t,n){var o=["DS/UnifiedExportCommand/Utils/Expectations",["ENOFOL3_AP","ENOPSTR_AP","ENOSCEN_AP"].includes(e.APP_ID)&&e.APP_ID||"ExpectationsBase"].join("/");require([o],n=>{for(var o in n.prototype)"contructor"!=n.prototype&&(e.__proto__[o]=n.prototype[o]);t()},n)})}})}),define("DS/UnifiedExportCommand/Views/ParameterView",["UWA/Class/Model","UWA/Class/View","DS/Controls/Abstract","DS/Controls/Label","DS/Controls/TooltipModel","DS/Controls/Popup","DS/Controls/Button"],function(e,t,n,o,i,s,a){"use strict";return t.extend({tagName:"div",className:"exportcommand-parameterview",setup:function(){try{this.model=new e}catch(e){console.log(e)}},defaults:function(e){},build:function(e,t){try{let n=this;return n.key=e.key,n.resolve=t,e.type?(n.defaults(e),require([e.type],function(t){(n.control=new t(e.options),e.custom)?n.control.inject(n.container):(n.control.getContent().setStyles({width:"100%"}),n.model.validate=e.validate,e.label?n.buildRow(e,n.control).inject(n.container):n.control.inject(n.container),n.control.addEventListener("change",e.change?e.change:t=>{let o=t.target.dsModel;null==o.checkFlag&&null==o.value||n.model.set(e.key,null!=o.checkFlag?o.checkFlag:o.value)}),"boolean"==UWA.typeOf(n.control.value)?(n.control.checkFlag=!e.value,n.control.checkFlag=e.value):(n.control.value=void 0,n.control.value=e.value));n.resolve&&n.resolve(n.control)})):e.hidden&&n.model.set(e.key,e.value),n.control}catch(e){console.log(e)}},buildError:function(e){return UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-alert exportcommand-parametersview-field-invalid",title:e||"Invalid Input",styles:{padding:2,marginLeft:5,borderRadius:"50%",color:"white",background:"#EA4F37"}})},buildDisable:function(){let e=this,t=new a({displayStyle:"lite",emphasize:"primary",icon:"remove"});return t.addEventListener("click",()=>{e.destroy(),e.model.clear()}),t},buildRow:function(e,t){let n=this;try{let o=UWA.createElement("div",{class:"exportcommand-parametersview-row"}),i=(UWA.createElement("div",{class:"exportcommand-parametersview-col-label",html:n.buildLabel(e)}).inject(o),UWA.createElement("div",{class:"exportcommand-parametersview-col-value"}).inject(o));return n.buildValue(t,e).inject(i),o}catch(e){console.log(e)}},buildLabel:function(e){var t={value:e.label};e.help&&(t.tooltipInfos=new i({title:e.label,shortHelp:e.help,mouseRelativePosition:!0,position:"top"}));var n=new o(t);return n.getContent().style.background="transparent",n.getContent().style.fontWeight="bold",n.getContent().style.maxWidth="95%",n},buildValue:function(e,t){var n=UWA.createElement("div",{styles:{display:"flex",justifyContent:"space-between"}});return UWA.createElement("div",{html:e,styles:{width:"90%"}}).inject(n),UWA.createElement("div",{html:t.optional?this.buildDisable():"",styles:{width:"8%"}}).inject(n),n},valid:function(){return!0},reset:function(){}})}),define("DS/UnifiedExportCommand/Views/MoreOptionsView",["UWA/Class/Collection","UWA/Class/View","DS/Controls/Button"],function(e,t,n){"use strict";let o=t.extend({tagName:"div",setup:function(e){this.model=e.model,this.setupContent()},setupContent:function(){let e=this;e.content=UWA.createElement("div",{class:"exportcommand-views-manageoptions-content"}).inject(e.container),e.label=UWA.createElement("span",{class:"exportcommand-views-manageoptions-content-label",html:e.model.get("label")}).inject(e.content),e.content.addEventListener("click",function(){e.model.destroy(),e.content.destroy()})}});return t.extend({tagName:"div",className:"exportcommand-views-manageoptions",setup:function(){try{let t=this;t.collection=new e,t.hide(),t.setupView(),t.listenTo(t.collection,"onAdd",function(e){1==t.collection.size()&&t.show(),new o({model:e}).inject(t.optionsListContainer)}),t.listenTo(t.collection,"onRemove",function(e){0==t.collection.size()&&t.container.hide()})}catch(e){console.log(e)}},setupView:function(){let e=this;e.btnMore=new n({label:UWA.i18n("exchangecommand.options.field.moreoptions"),displayStyle:"lite",icon:{iconName:"task-list-pencil",fontIconFamily:WUXManagedFontIcons.Font3DS}}).inject(e.container),e.optionsListContainer=UWA.createElement("div",{class:"exchangecommand-options-field-moreoptions-list"}),e.optionsListContainer.hide(),e.optionsListContainer.inject(e.container),e.btnMore.addEventListener("click",function(){e.optionsListContainer.isHidden()?(e.btnMore.checkFlag=!0,e.optionsListContainer.show()):(e.btnMore.checkFlag=!1,e.optionsListContainer.hide())})}})}),define("DS/UnifiedExportCommand/Utils/Expectations/ExpectationsBase",["UWA/Class","DS/Utilities/UUID"],function(e,t){"use strict";return e.extend({SELECTION:{treatAsRoot:!1},CVQUERY:{EXPAND:{batch:{graph:{}},outputs:{select_object:["identifier","physicalid","type","interface","ds6w:cadMaster","flattenedtaxonomies"],select_relation:["identifier","physicalid","type","interface"],format:"entity_relation_occurrence"}}}},{isGroupingApplied:function(){return this.getTreeDocument().isGroupingApplied&&this.getTreeDocument().isGroupingApplied()},getTreeDocument:function(){var e=this.options.context;return e.options.model||e.getPADTreeDocument()},processSelectedNodes:function(e){var t=this,n=[];return e.forEach(e=>{if(e.isGroupingNode){t.options.groupingApplied=!0;var o=e.getChildren();o.length?n=n.concat(t.processSelectedNodes(o)):t._private_.modelEvents.publish({event:t.EVENTS.ERROR_OCCURED,data:{message:UWA.i18n("exchangecommand.notification.expansionfailed.groupnotexpanded")}})}else n.push(e)||t._private_.modelEvents.publish({event:t.EVENTS.ERROR_OCCURED,data:{message:UWA.i18n("exchangecommand.notification.exportfailed.unsupportedselection")}})}),n},getSelectedNodes:function(){return this.options.context.getSelectedNodes()},getExportableContent:function(){var e=this.getSelectedNodes();return this.processSelectedNodes(e)},extractNodes:function(){var e=this,t=[],n=[];return e.getExportableContent().forEach(o=>{let i=-1;if(e.isGroupingApplied()||e.SELECTION.treatAsRoot){var s=o.getID();-1===(i=t.indexOf(s))&&(t.push(s),n.push([[s]]))}else{let e=o.getOccurencePath&&o.getOccurencePath(),s=o.getRoot().getID();-1===(i=t.indexOf(s))?(t.push(s),n.push([e])):n[i]&&n[i].push(e)}}),{roots:t,paths:n}},expandLabel:function(){return`unifiedexport-${this.APP_ID}-${t.v4()}`},expandGraphParams:function(){return this.CVQUERY.EXPAND.batch.graph},expandFilterParams:function(e,t){var n=this.options.context,o={filter:{all:1}};if(n.GetFilterSpec){var i=t.map(e=>({physical_id_path:e}));o=n.GetFilterSpec(e,{V2:{prefixPathArray:i}})}return o.filter},expandOutput:function(){return{select_object:this.CVQUERY.EXPAND.outputs.select_object,select_relation:this.CVQUERY.EXPAND.outputs.select_relation,format:"entity_relation_occurrence"}},expandBatch:function(e,t){return{label:this.expandLabel(),root:{physical_id:e},filter:this.expandFilterParams(e,t),graph:this.expandGraphParams()}},expandQuery:function(){var e=this,t=e.extractNodes(),n=t.roots,o=t.paths;return{batch:{expands:n.map((t,n)=>{var i=o[n];return e.expandBatch(t,i)})},outputs:e.expandOutput()}},alterExpansion:function(e){return new UWA.Promise(function(t,n){t(e)})}})}),define("DS/UnifiedExportCommand/Utils/Expectations/ENOPSTR_AP",["DS/UnifiedExportCommand/Utils/Expectations/ExpectationsBase"],e=>{"use strict";return e.extend()}),define("DS/UnifiedExportCommand/Utils/Expectations/ENOFOL3_AP",["DS/UnifiedExportCommand/Utils/Expectations/ExpectationsBase"],e=>{"use strict";return e.extend({SELECTION:{treatAsRoot:!0},CVQUERY:{EXPAND:{batch:{graph:{descending_condition_object:{uql:'(flattenedtaxonomies:"types/Workspace Vault") OR (flattenedtaxonomies:"types/Workspace") OR (flattenedtaxonomies:"types/VPMReference") OR (flattenedtaxonomies:"types/VPMRepReference") OR (flattenedtaxonomies:"types/XCADNonPSBaseRepReference") OR (flattenedtaxonomies:"types/XCADModelRepReference") OR (flattenedtaxonomies:"types/Document")'},descending_condition_relation:{uql:"(taxonomies:*Vaults*) OR (taxonomies:*Vaulted Objects*) OR (taxonomies:*VPMInstance*) OR (taxonomies:*VPMRepInstance*) OR (taxonomies:*XCADAssemblyRepInstance*)"}}}}}},{alterExpansion:function(e){return new UWA.Promise(function(t,n){let o=e,i=[],s=[],a=["VPMInstance","VPMRepInstance","VPMRepInstance","XCADAssemblyRepInstance"],r=new Set;o.reduce((e,t)=>(t.Path?s.push(t):t.flattenedtaxonomies&&(t.flattenedtaxonomies.includes("types/VPMReference")||t.flattenedtaxonomies.includes("types/VPMRepReference")||t.flattenedtaxonomies.includes("types/XCADNonPSBaseRepReference")||t.flattenedtaxonomies.includes("types/XCADModelRepReference")||t.flattenedtaxonomies.includes("types/Document"))?e.push(t):t.from&&a.includes(t.type)?e.push(t):r.add(t),e),i);let l=s.map(e=>{let t=new Set(e.Path);return r.forEach(e=>{e.Path||t.delete(e.resourceid)}),{...e,Path:[...t]}});0==(i=[...i,...l.filter(e=>e.Path.length>0)]).length?n(UWA.i18n("exchangecommand.notification.exportfailed.noresults3")):t(i)})}})}),define("DS/UnifiedExportCommand/Utils/Expectations/ENOSCEN_AP",["DS/UnifiedExportCommand/Utils/Expectations/ExpectationsBase"],e=>{"use strict";return e.extend()}),define("DS/UnifiedExportCommand/Utils/CVExpandUtil",["DS/WAFData/WAFData","DS/UnifiedExportCommand/Utils/ExchangeInfra"],function(e,t){"use strict";var n={expand:function(){let o=t.platformServices["3DSpace"]+t.URLS.CVSERVLET_PROGESSIVEEXPAND;return new UWA.Promise(function(i,s){let a=t.expandQuery();e.authenticatedRequest(o,{data:JSON.stringify(a),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":window.widget?window.widget.lang:"en","X-Requested-With":"XMLHttpRequest",SecurityContext:t.securityContext},onComplete:n.postExpandSuccess.bind(null,i,s),onFailure:n.postExpandFailure.bind(null,s)})})},postExpandSuccess:function(e,n,o){var i=(o=JSON.parse(o)).errors,s=o.results;i?n(UWA.i18n("exchangecommand.notification.exportfailed.message2")):s&&(s.length?t.alterExpansion(s).then(e).fail(n):n(UWA.i18n("exchangecommand.notification.exportfailed.noresults")))},postExpandFailure:function(e){e(UWA.i18n("exchangecommand.notification.expansionfailed"))}};return n}),define("DS/UnifiedExportCommand/Views/ParametersView",["UWA/Class/Model","UWA/Class/Collection","UWA/Class/View","DS/UnifiedExportCommand/Views/MoreOptionsView","DS/UnifiedExportCommand/Views/ParameterView"],function(e,t,n,o,i){"use strict";let s=e.extend({}),a=n.extend({tagName:"div",className:"exportcommand-parametersview",setup:function(){try{let e=this;e.model=new s,e.collection=new t,e.setupOptions()}catch(e){console.log(e)}},setupOptions:function(){let e=this;e.optionsView=new o,e.optionsView.inject(e.container),e.optionsView.getContent().style.marginLeft="10px",e.optionsView.listenTo(e.optionsView.collection,"onRemove",function(t){e.insert2(t._attributes)})},insert:function(e,t){let n=this;e.optional?n.optionsView.collection.add(e):n.insert2(e,t)},insert2:function(e,t){let n=this,o=new i;n.collection.add(o.model),o.listenTo(o.model,"onChange",function(t){if(0==t.keys().length)n.optionsView.collection.add(e),n.model.unset(e.key);else{let e=t._attributes;n.model.set(e)}}),n.container.insertBefore(o.getContent(),n.optionsView.getContent()),o.build(e,t)}});return{getInstance:function(){return new a}}}),define("DS/UnifiedExportCommand/Models/Exchange",["UWA/Class/Model","DS/WAFData/WAFData","DS/Utilities/UUID","DS/UnifiedExportCommand/Utils/ExchangeInfra","DS/UnifiedExportCommand/Utils/CVExpandUtil","text!DS/UnifiedExportCommand/assets/config/UnifiedExportCommand.json"],function(e,t,n,o,i,s){"use strict";try{let a=require.toUrl("");a=a.substr(0,a.lastIndexOf("?")),s=JSON.parse(s);return e.extend({defaults:{title:"Export - "+n.v4()},preprocess:null,transform:null,setup:function(){let e=this,t=o.get();for(const n in t)e[n]=t[n]},authorize:function(){let e=this;return new UWA.Promise(function(t,n){e.exporters=[],e.grantedRoles=e.grantedRoles,s.forEach(t=>{e.validateExporter(t)&&e.exporters.push(t)}),e.exporters.length>0?t():n(UWA.i18n("exchangecommand.notification.notallowed"))})},validateExporter:function(e){return e&&e.value&&this.grantedRoles.some(function(t){return e.roles.indexOf(t.id)>-1})&&e.value&&e.service&&e.service.id&&e.service.url&&e.service.ui},expand:function(){var e=this;return new UWA.Promise((t,n)=>{o._private_.modelEvents.subscribe({event:o.EVENTS.ERROR_OCCURED},function(e){n(e.message)}),i.expand().then(function(n){e.set("objects",n),t()}).fail(n)})},save:function(){let e=this,t=o.getSelectedNodes(),n=e.get("objects"),i=e.preprocess?e.preprocess.bind(null,{selectedNodes:t,expandedNodes:n,securityContext:e.securityContext,platformServices:e.platformServices}):e=>e();return new UWA.Promise(i).then(e.export.bind(null,e))},export:function(e){return new Promise(function(n,o){let i=e.platformServices[e.service.id]+e.service.url,s=e.exportPayload(),a={Accept:"application/json","Content-Type":"application/json","Accept-Language":window.widget?window.widget.lang:"en","X-Requested-With":"XMLHttpRequest",SecurityContext:e.securityContext},r={data:JSON.stringify(s),method:"POST",headers:a,onComplete:e.success.bind(null,e,n),onFailure:e.failure.bind(null,e,o)};t.authenticatedRequest(i,r)})},exportPayload:function(){let e=this;if(e.transform)try{return e.transform.call(UWA.clone(e._attributes),{platformServices:e.platformServices,securityContext:e.securityContext})}catch(e){console.log(e)}return e._attributes},switchBaseUrl:function(e){let t=this;try{if(t.platformServices[e.service.id]){let n=[t.platformServices[e.service.id],e.service.base?e.service.base:"/webapps"].join("");require.toUrl(n),require.config({baseUrl:n})}}catch(e){console.log(e)}},resetBaseUrl:function(){require.config({baseUrl:a})},success:function(e,t,n){t&&t(UWA.i18n("exchangecommand.notification.exportstarted.message"))},failure:function(e,t,n){t&&t(UWA.i18n("exchangecommand.notification.exportfailed.message"))}})}catch(e){console.log()}}),define("DS/UnifiedExportCommand/Views/ParametersViewFactory",["UWA/Class","DS/UnifiedExportCommand/Views/ParameterView","DS/UnifiedExportCommand/Views/ParametersView"],function(e,t,n){"use strict";var o=e.extend({build:function(e){let t=this,o=n.getInstance();return e.forEach(e=>{e.successors?t.buildSuccessors(o,e):e.children?t.buildGroup(o,e):o.insert(e)}),o},buildSuccessors:function(e,n){let o,i=this,s=new t;s.inject(e.container),s.build(n);let a=[];s.listenTo(s.model,"onChange:"+n.key,function(t){if(e.model.set(t._attributes),n.successors){o&&o.container.empty();let s=n.successors.call(UWA.clone(t._attributes));s?(s.forEach(function(e){a.push(e.key)}),(o=i.build(s)).inject(e.container),o.listenTo(o.model,"onChange",function(t){a.forEach(function(t){e.model.unset(t)}),e.model.set(t._attributes)})):a.forEach(function(t){e.model.unset(t)})}})},buildGroup:function(e,n){let o=this;e.model.set(n.key,{}),new UWA.Promise(function(o){let i=new t;i.inject(e.container),i.build(n,o)}).then(function(t){n.children.forEach((i,s)=>{if(0==s&&(i.isSelected=!0),i.label&&(i.header=i.label),i.icon&&(i.icon={iconName:i.icon,fontIconFamily:WUXManagedFontIcons.Font3DS}),i.fields){let s=o.build(i.fields);i.content=s.getContent(),s.listenTo(s.model,"onChange",function(t){let o=t._attributes,s=UWA.clone(e.model.get(n.key));s[i.key]=o,e.model.set(n.key,s)}),t.add?t.add(i):t.addItem?t.addItem(i):s.inject(e.container)}}),t.expandItem&&t.expandItem(0)})}});return{getInstance:function(){return new o}}}),define("DS/UnifiedExportCommand/Views/ExchangeOptions",["UWA/Class/View","DS/Controls/Loader","DS/Utilities/UUID","DS/UnifiedExportCommand/Views/ParametersViewFactory","DS/UnifiedExportCommand/Utils/ExchangeInfra"],function(e,t,n,o,i){"use strict";let s,a;return e.extend({tagName:"div",id:"exportcommand-optionsview",className:"exportcommand-optionsview",setup:function(e){try{let e=this;e.setupMethods(),e.loader=new t,e.loader.off(""),e.loader.inject(e.container)}catch(e){console.log(e)}},setupMethods:function(){let e=this;if(e.model.exporters&&e.model.exporters.length){let t=null,n=[];e.model.exporters.forEach((e,o)=>{0==o&&(t=e),n.push({value:e.value,label:UWA.i18n(e.label)})}),(s=o.getInstance().build([{id:"type",label:UWA.i18n("exchangecommand.options.field.exportOutput"),help:UWA.i18n("exchangecommand.options.field.exportOutput.help"),type:"DS/Controls/ComboBox",value:widget.getValue("exportMethod")?widget.getValue("exportMethod"):t.value,options:{elementsList:n},change:e.changeOutput.bind(null,e)}])).inject(e.container)}},clear:function(){let e=this.model.get("objects");this.model.clear(),this.model.set("objects",e),a&&a.container.empty()},changeOutput:function(e,t){e.exportmethodcombobox=t.target;let n=e.exportmethodcombobox.dsModel.value;if(n){e.clear(),e.exportmethodcombobox.dsModel.disabled=!0,widget.setValue("exportMethod",n);for(let t of e.model.exporters)if(t.value==n){e.model.service=t.service,e.load(t);break}}},load:function(e){let t=this;t.loader.on(""),t.model.switchBaseUrl(e),require([e.service.ui],e=>{t.exportmethodcombobox.dsModel.disabled=!1,t.parse(e)},e=>{i._private_.modelEvents.publish({event:i.EVENT_LOAD_METHOD_FAILED})})},parse:function(e){let t=this,n=i.getSelectedNodes();t.config=e,e.preprocess?t.model.preprocess=e.preprocess:t.model.preprocess=void 0,e.transform&&(t.model.transform=e.transform);var o="function"==UWA.typeOf(e.fields)?e.fields.bind(null,{platformServices:i.platformServices,securityContext:i.securityContext,selectedNodes:n}):t=>t(e.fields);new UWA.Promise(o).then(function(e){t.parseExpoterFields(e)})},parseExpoterFields:function(e){let t=this;t.loader.off();let n=UWA.clone(e);n=t.refine(n);let i=o.getInstance();(a=i.build(n)).inject(t.container),a.listenTo(a.model,"onChange",function(e){let n=e._attributes;t.model.set(n)})},refine:function(e){let t=[];return e.forEach((e,o)=>{if("title"==e.key){var i=n.v4();e.value="Export - "+i.substring(0,10).replaceAll("-",""),e.type="DS/Controls/LineEditor",e.label=UWA.i18n("exchangecommand.options.field.title"),t.splice(0,0,e)}else t.push(e)}),t}})}),define("DS/UnifiedExportCommand/Views/ExchangeProcessDialog",["UWA/Class/View","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/UnifiedExportCommand/Models/Exchange","DS/UnifiedExportCommand/Views/ExchangeOptions","i18n!DS/UnifiedExportCommand/assets/nls/UnifiedExportCommandNLS","css!DS/UnifiedExportCommand/UnifiedExportCommand"],function(e,t,n,o,i,s,a,r,l){"use strict";try{let c,d,u,p,m,f,x,h;return UWA.i18n(l),e.extend({tagName:"div",id:"exportcommand-exchangeprocessdialog",className:"exportcommand-exchangeprocessdialog",setup:function(e){let t=this;t.model=e&&e.model||new a,t.model.authorize().then(t.setupDialog.bind(null,t),t.reject.bind(null,t))},setupDialog:function(e){widget.addEvent("onRefresh",function(){d.close()}),e.model.expand().then(e.expansionResolved.bind(),e.reject.bind(null,e)),(u=new r({model:e.model})).getContent().children.length?(c=UWA.createElement("div",{class:"exchangecommand-dialogcontainer"}),u.inject(c),d&&d.close(),(p=new n).inject(e.container),(d=new t({title:UWA.i18n("exchangecommand.dialog.header"),content:c,immersiveFrame:p,modalFlag:!0,usePaddingFlag:!0,resizableFlag:!0,buttons:e.getFooter()})).addEventListener("close",e.afterClose.bind(null,e)),e.container.inject(widget.body),widget.addEvent("onResize",e.adjust),e.adjust()):e.exportNotAllowed("Select an item to start the Export")},expansionResolved:function(){h.stop(),m.hide(),f.disabled=!1},getFooter:function(){m=new o({displayStyle:"lite",label:UWA.i18n("exchangecommand.dialog.footer.button.ok")}),f=new o({label:UWA.i18n("exchangecommand.dialog.footer.button.save"),disabled:!0,onClick:this.save.bind(null,this)}),x=new o({label:UWA.i18n("exchangecommand.dialog.footer.button.cancel"),onClick:this.cancel.bind(null,this)});var e=m.getContent();return e.style.position="absolute",e.style.left="15px",e.style.cursor="default",(h=new UWA.Fx(e,{duration:1200,wait:!0,events:{onComplete:function(){h.tween("color","#005686","#B4B6BA")}}})).start(),{Ok:m,Save:f,Cancel:x}},save:function(e,t){let n=e;f.label=UWA.i18n("exchangecommand.dialog.footer.button.saving"),f.disabled=!0,n.model.save().then(n.resolve.bind(null,n),n.reject.bind(null,n))},resolve:function(e,t){d&&d.close(),t&&e.exportStarted(t)},reject:function(e,t){d&&d.close(),t&&e.exportNotAllowed(t)},cancel:function(e){d.close()},afterClose:function(e){p.destroy(),d.destroy(),e.model.resetBaseUrl(),e.model.dispatchEvent("closeexchange")},exportStarted:function(e){s.setNotificationManager(i),s.setFadeOutPolicy(2),s.setStackingPolicy(5);let t={message:e,level:"success"};i.addNotif(t)},exportNotAllowed:function(e){s.setNotificationManager(i),s.setFadeOutPolicy(2),s.setStackingPolicy(5);let t={message:e,level:"error"};i.addNotif(t)},adjust:function(){widget.body.clientWidth>360?c.style.minWidth="360px":c.style.minWidth="100%"}})}catch(e){console.log(e)}}),define("DS/UnifiedExportCommand/Commands/UnifiedExportCommand",["DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/UnifiedExportCommand/Views/ExchangeProcessDialog","DS/UnifiedExportCommand/Utils/ExchangeInfra"],function(e,t,n,o){return e.extend({init:function(e){let n=this;(n._parent(e),window.jasmine)||(n.disable(),n.model=e&&e.model,o.setup({context:n.options.context||t.get()}).then(n.onInfraReady.bind(null,n)))},onInfraReady:function(e){var t=o.getTreeDocument();t&&(t._modelEvents.subscribe({event:"select"},e.toggleExport.bind(null,e)),t._modelEvents.subscribe({event:"unselect"},e.toggleExport.bind(null,e)),t._modelEvents.subscribe({event:"removeChild"},e.toggleExport.bind(null,e)))},execute:function(){let e=this;e.disable();let t=new n({model:e.model});t.listenTo(t.model,"closeexchange",()=>{e.toggleExport(e)})},toggleExport:function(e){e.disable(),o.getSelectedNodes()&&o.getSelectedNodes().find(e=>e.getRoot())&&e.enable()}})});