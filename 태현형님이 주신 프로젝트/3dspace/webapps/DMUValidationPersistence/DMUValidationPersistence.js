define("DS/DMUValidationPersistence/DMUValidationPersistenceServices",["DS/DMUReadPersistence/DMUReviewPersistenceServicesSetting","UWA/Utils"],function(e,i){"use strict";const t=e=>{try{JSON.parse(e)}catch(e){return!1}return!0};return{createReviewInDataBase:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/createValidation",config:{verb:"POST",data:JSON.stringify({sName:i.reviewName,sPLMexternalID:i.reviewPLMexternalID,sContextId:i.parentID,sDescription:i.reviewDescription,sAddMarkup:i.createMarkup?"true":"false",sMarkupName:i.markupName,sPLMMarkupexternalID:i.markupPLMexternalID,sMarkupDescription:i.markupDescription,sContextAsValidated:i.contextAsValidated,sServiceID:i.serviceID})},onSuccess:function(e){i.onReviewCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onReviewCreationFailed(e?t(e)?JSON.parse(e):e:{})}})},addChild:function(e){var i=JSON.parse(localStorage.getItem("currentValidation")?localStorage.getItem("currentValidation"):"{}");i.children.push({type:e.type,id:e.id,name:e.name,children:[]}),localStorage.setItem("currentValidation",JSON.stringify(i))},addMarkup:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/addMarkup",config:{verb:"POST",data:JSON.stringify({sName:i.mkpName,sValidationId:i.validationId,sPLMMarkupexternalID:i.markupPLMexternalID,sDescription:i.mkpDescription})},onSuccess:function(e){i.onMarkupCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onMarkupCreationFailed(e?t(e)?JSON.parse(e):e:{})}})},saveReviewMarkup:function(t){var n,a=new Blob([t.jsonContent],{type:"application/json"}),r=i.getUUID().toString();(n="VALReview",new Promise(function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/getCheckinTicket",config:{verb:"POST",data:JSON.stringify({sObjectType:n})},onSuccess:function(e){i(e?JSON.parse(e):{})}})})).then(function(i){var n,o=i.checkinTicket,s=i.actionURL;o&&s&&(n={file:a,ticket:o,URL:s,correlationId:r,fileName:"WebReviewContent.json"},new Promise(function(e){var i=new FormData;i.append("__fcs__jobTicket",n.ticket),i.append("file_0",n.file,n.fileName);var t=new XMLHttpRequest;t.open("POST",n.URL,!0),t.onload=function(){200===t.status&&e(t.responseText)},t.send(i)})).then(function(i){var n=i;n&&function(i){return new Promise(function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/checkinStreamInfo",config:{verb:"POST",data:JSON.stringify({sObjectId:i.ObjectId,sReceipt:i.receipt,sJsonStream:i.stream,sFileName:i.fileName,sPersistencyType:i.persistencyType,sPersistencyName:i.persistencyName})},onSuccess:function(e){t(e?JSON.parse(e):{})}})})}({ObjectId:t.markupRepRefId,receipt:n,stream:t.jsonContent,fileName:"WebReviewContent.json",persistencyName:"WebReviewContent",persistencyType:"json"}).then(function(e){e&&t.onSaveReviewMarkupCompleted()})})})},saveValidatedObject:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/updateValidatedObjects",config:{verb:"POST",data:JSON.stringify({sValidatedId:i.validatedId,sValidatedObjectIds:i.validatedObjects,sServiceID:i.serviceId})},onSuccess:function(e){i.onSaveValidatedObjectsCompleted(e?JSON.parse(e):{}),i.validatedObjects.length?sessionStorage.setItem(i.validatedId,"true"):sessionStorage.setItem(i.validatedId,"false")},onFailure:function(e){i.onSaveValidatedObjectsFailed(e?t(e)?JSON.parse(e):e:{})}})},addChecks:function(i){let n=i.listObjects;e.sendWebServiceCall({url:"resources/validationauthoring/service/addValidationChecks",config:{verb:"POST",data:JSON.stringify({listObjects:n})},onSuccess:function(e){i.onCheckCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onCheckCreationFailed(e?t(e)?JSON.parse(e):e:{})}})},addCheck:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/addValidationCheck",config:{verb:"POST",data:JSON.stringify({sValidationId:i.validationId,sRequirementDocId:i.requirementDocId,sName:i.checkName,sDescription:i.description,iCheckState:i.checkState})},onSuccess:function(e){i.onCheckCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onCheckCreationFailed(e?t(e)?JSON.parse(e):e:{})}})},setCheckRequirement:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/setCheckRequirement",config:{verb:"POST",data:JSON.stringify({sCheckId:i.checkId,sRequirementId:i.requirementId,sRemoveReq:i.removeReq})},onSuccess:function(e){i.onSetCheckRequirementComplete(e?JSON.parse(e):{})},onFailure:function(e){i.onSetCheckRequirementFailed(e?t(e)?JSON.parse(e):e:{})}})},setImpactedCheck:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/setImpactedCheckOnHighlight",config:{verb:"POST",data:JSON.stringify({sCheckId:i.checkId,sHighlightId:i.highlightId})},onSuccess:function(e){i.onSetImpactedCheckComplete(e?JSON.parse(e):{})},onFailure:function(e){i.onSetImpactedCheckFailed(e?t(e)?JSON.parse(e):e:{})}})},removeImpactedCheck:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/removeImpactedCheckOnHighlight",config:{verb:"POST",data:JSON.stringify({sCheckId:i.checkId,sHighlightId:i.highlightId})},onSuccess:function(e){i.onRemoveImpactedCheckComplete(e?JSON.parse(e):{})},onFailure:function(e){i.onRemoveImpactedCheckFailed(e?t(e)?JSON.parse(e):e:{})}})},updateAttributes:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/modifyAttributes",config:{verb:"POST",data:JSON.stringify({listObjects:i.objectsToModify})},onSuccess:function(e){i.onAttributesSaveCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onAttributesSaveFailed(e?t(e)?JSON.parse(e):e:{})},platform:i.platform})},updateReviewContext:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/updateValidationContext",config:{verb:"POST",data:JSON.stringify({sValidationId:i.validationId,sProductId:i.contextId,sServiceID:i.serviceID})},onSuccess:function(e){i.onUpdateReviewContextCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onUpdateReviewContextFailed(e?t(e)?JSON.parse(e):e:{})}})},deleteObject:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/deleteObject",config:{verb:"POST",data:JSON.stringify({sObjectIds:i.objectIds})},onSuccess:function(e){i.onObjectDeletionCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onObjectDeletionFailed(e?t(e)?JSON.parse(e):e:{})}})},addHighlight:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/addHighlight",config:{verb:"POST",data:JSON.stringify({sValidationId:i.validationId,sMarkupRepRefPathIds:i.markupRepRefPathIds,sName:i.checkName,sDescription:i.description,sSlideId:i.slideId,iPresentationRating:i.rating})},onSuccess:function(e){i.onHighlightCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onHighlightCreationFailed(e?t(e)?JSON.parse(e):e:{})}})},addReply:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/addValidationReply",config:{verb:"POST",data:JSON.stringify({sMarkupRefId:i.markupRefId,sName:i.name,sDescription:i.description})},onSuccess:function(e){i.onReplyCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onReplyCreationFailed(e?t(e)?JSON.parse(e):e:{})}})},generateName:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/generateName",config:{verb:"POST",data:JSON.stringify({sListTypeName:i.sListTypeName})},onSuccess:function(e){i.onGenerateNameCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.ononGenerateNameFailed(e?t(e)?JSON.parse(e):e:{})}})}}});