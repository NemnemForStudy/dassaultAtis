define("DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessDataCollectionUI",["UWA/Core","DS/DELWKOViewBehaviors/DELWKOFormUI","text!DS/DELPPWViewBehaviors/assets/json/TypeMapping.json"],function(e,t,n){"use strict";return function(i,r,o,a,l,s,c){var u,d,f,g=null,p=null,y=null,m=null,C=null,v=null,L=null,T=null,I=null,h={},V=null,D=null,S=!1,b=!1,w=new e.Element("div",{class:"Form-Sections-Container"}),F=o.getComponent("ComboBox"),O=o.getComponent("Accordeon"),E=o.getComponent("TooltipModel"),U=e.Json.decode(n),N=function(t){var n;y=t.dsModel.currentValue,n=g.concat("/",y),u.type=n,I.destroy(),e.is(V)&&V.destroy(),null===D&&x(),A(function(e){B(e)}),u.onTypeChange(y,w)},W=function(e){p=e.dsModel.currentValue,D.destroy(),D=null,N(e)},k=function(e){v=e.dsModel.currentValue},M=function(e){e.sort(function(e,t){return e.label.localeCompare(t.label,widget.lang,{numeric:!0})})},P=function(t){var n,i,r=[];return n={elementsList:r=t.elementsList.map(function(e){return{labelItem:e.label,valueItem:e.value}}),actionOnClickFlag:!1,enableSearchFlag:!1},e.is(t.selected)&&(n.selectedIndex=r.findIndex(function(e){return e.valueItem===t.selected})),(i=new F(n)).fieldType=t.fieldType,h[t.name]=i,e.is(t.onChange,"function")&&i.addEventListener("change",t.onChange),i},x=function(){var t=function(){var t,n,r,o,l,s,u,d,g,m,C,L,I,h={},V=[];e.is(T,"object")&&e.owns(T,y)&&(h=T[y]),m=function(t){let n={},i=[];return e.is(h,"object")&&e.owns(h,"Type")&&(n=function(t,n){let i;return Array.isArray(t.Type)&&(i=t.Type.find(function(e){return e.name===n})),e.is(i)?i:{}}(h,t)),e.is(n,"object")&&(e.owns(n,"visibility")&&"true"===n.visibility||!e.owns(n,"visibility"))&&(g=c.getTypeInfo(t),c.isAKindOf(t,"Resource")?(e.owns(g,"isOOTB")&&"false"===g.isOOTB||e.owns(g,"Newable")&&function(e){let t=e.toUpperCase();return["NEW","ALL"].some(e=>t.includes(e))}(g.Newable))&&i.push({value:t,label:a.getNLSValue(t,null,"Type")}):i.push({value:t,label:a.getNLSValue(t,null,"Type")})),i},V=V.concat(m(y)),e.is(p)&&p!==y?(V=V.concat(m(p)),d=c.getTypeHierarchy(p)):d=c.getTypeHierarchy(y),e.is(d,"array")&&d.forEach(function(e){e!==y&&(V=V.concat(m(e)))}),M(V),u=new e.Element("div",{class:"section-container"}),t=new e.Element("div",{class:"wux-field-container inline-container"}).inject(u),o=new e.Element("div",{class:"wux-field-container inline-container"}).inject(u),r=new e.Element("h6",{class:"wux-type-textElement",text:a.getNLSValue("General.Type")}).inject(t),n=P({name:"V_Type",elementsList:V,fieldType:"select",selected:y,onChange:N}),r.tooltipInfos=new E({shortHelp:a.getNLSValue("General.Type")}),n.inject(t),s=new e.Element("h6",{class:"wux-type-textElement",text:a.getNLSValue("General.Credentials")}).inject(o),l=function(){var t=i.getService("ConfigService").getSecurityContext(),n=t.getAllSC(),r=i.getConfig().isFacet&&!t.getSCFromPreferences().includes("ctx::")?"ctx::"+t.getSCFromPreferences():t.getSCFromPreferences(),o=new F({elementsList:n.map(function(e){return{labelItem:e.label,valueItem:e.value}}),actionOnClickFlag:!1,enableSearchFlag:!1,selectedIndex:n.findIndex(function(e){return e.value===r})});return v=r,e.is(k,"function")&&o.addEventListener("change",k),o}(),s.tooltipInfos=new E({shortHelp:a.getNLSValue("General.Credentials")}),l.inject(o),C="Section.General",L=u,I=new e.Element("div",{class:"Type-Section-Container"}).inject(w),new O({items:[{header:a.getNLSValue(C)?a.getNLSValue(C):C,content:L,expandedFlag:!0}],style:"filled-separate"}).inject(I),L.addEvent("resize",function(){var t,n,i,r;r=L.getElements(".wux-field-container"),(i=L.clientWidth)<290?(t="inline-container",n="block-container"):i>290&&"block-container"===f?(t="inline-container",n="block-container"):(t="block-container",n="inline-container"),e.is(r)&&r.forEach(function(e){e.removeClassName(t),e.addClassName(n)})}),D=I};e.is(T)?t():l.getXMLValues(i.getConfig().resource.ItemOOTBFiltering,function(n){e.owns(U,r.getId())&&(T=n.convert("Config.Preferences."+U[r.getId()].section+".OOTBType","name")),t()},function(e){b=!0,r.debug("failed to get ItemOOTBFiltering XML. Error Desc: "+e)})},A=function(t){var n=function(){var n,i=L[y]||{};if(e.owns(i,"Section")||(i.Section={},i.Section.name=a.getNLSValue("Section.Attributes"),i.Section.Attribute=[{dicoType:"PLMEntity",name:"V_Name",mandatory:!0},{dicoType:"PLMEntity",name:"V_description"}]),"ProcessContinuousProvide"===y&&e.is(d)&&!1===d){switch(m){case"LENGTH":n="DELFmiContQuantity_Length";break;case"MASS":n="DELFmiContQuantity_Mass";break;case"AREA":n="DELFmiContQuantity_Area";break;case"VOLUME":n="DELFmiContQuantity_Volume";break;default:n=null}i.Section.Attribute.push({dicoType:n,name:"V_ContQuantity",readOnly:!1})}t(i)};e.is(L)?n():l.getXMLValues(i.getConfig().resource.createWorkOrderFromProcessFormAttributeXML,function(e){L=e.convert("AttributesDescriptionList.Type","name"),n()},function(e){S=!0,r.debug("failed to get createWorkOrderFromProcessFormAttributeXML XML. Error Desc: "+e)})},B=function(n){I=new t(i,r,o,a,s,c),V=new e.Element("div",{class:"Form-container"}),I.createUI({sections:n,type:u.type,renderTo:V,defaultValues:C}),V.inject(w),f=I.getFormStyle()},R=function(){return S||b};return{createUI:function(t){u=t||{},e.is(u.type)&&e.is(u.renderTo)&&(S=!1,b=!1,y=u.type.split("/")[1]||"",g=u.type.split("/")[0],m=u.dimension,u.defaultValues&&(C=u.defaultValues[0]),e.is(u.createRoot)&&(d=u.createRoot),A(function(t){var n,i,r,o;e.is(u.baseTypes)&&(o=u.baseTypes.map(function(e){return{value:e,label:a.getNLSValue(e,null,"Type")}}),M(o),n=new e.Element("div",{class:"top-container inline-container"}).inject(w),i=new e.Element("h6",{class:"wux-type-textElement",text:a.getNLSValue("Base.Type")}).inject(n),r=P({name:"V_BaseType",elementsList:o,fieldType:"select",selected:u.selectedBaseType,onChange:W}),i.tooltipInfos=new E({shortHelp:a.getNLSValue("Base.Type")}),r.inject(n),p=u.selectedBaseType),x(),B(t)}),R()&&e.is(u.onFailure,"function")&&u.onFailure({invalidXML:!0}),w.inject(u.renderTo))},destroy:function(){e.is(I)&&I.destroy(),e.is(V)&&V.destroy(),e.is(w)&&w.destroy()},getValues:function(){var t,n={};return e.owns(h,"V_Type")&&e.is("V_Type")&&(h.V_Type.currentValue?(n.V_Type=g.concat("/",h.V_Type.currentValue),n.type=y):(n.V_Type=h.V_Type,n.type=y)),t=I.getValues(),e.extend(t,n),t},getSecurityContextOverride:function(){return v},validate:function(){return R()?{result:!1,message:a.getNLSValue("ModelBehavior.CreateReference.Failure.InvalidXML")}:I?I.validate():{result:!0,message:null}},updateToDefaultValues:function(e){I&&I.updateToDefaultValues(e)}}}}),define("DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessUI",["UWA/Core","DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessDataCollectionUI"],function(e,t){"use strict";return function(t,n,i,r){var o,a=1,l=2,s=3,c=1,u=2,d=3,f=n.getComponent("Element"),g=n.getComponent("Button"),p=null,y=null,m=null,C=!1,v=function(t){e.is(t)&&e.is(t.invalidXML)&&(C=t.invalidXML)},L=function(e,t){var n;switch(o){case u:return n="InsertUI.ReplaceByNewDialog.Title",i.getNLSValue(n,{type:i.getNLSValue(e,null,"Type")});case d:return n="InsertUI.ContinuousProvidedMaterial.Title",i.getNLSValue(n,{dimension:i.getNLSValue(t,null,"Dimension")});default:return n="InsertUI.CreateDialog.Title",i.getNLSValue(n,{type:i.getNLSValue(e,null,"Type")})}},T=function(c,d,f,v,T){var I,h,V,D,S,b,w,F,O,E=e.is(T)&&e.is(T.fatherPID,"string")&&T.fatherPID.length>0?T.fatherPID:null,U=e.is(T)&&e.is(T.transactionUUID,"string")&&T.transactionUUID.length>0?T.transactionUUID:null,N={transactionUUID:U,requestedCreation:0},W=t.getPreferenceValue("showDialog")&&(!e.is(f,"boolean")||f);switch(F=function(){!0!==(V=p.validate()).result?(h=i.getNLSValue("ModelBehavior.CreateReference.Failure.ReferenceNotCreated")+V.message,t.warn(h),m.close()):(O=p.getSecurityContextOverride(),I=p.getValues(),m.close(),d(I,{securityContextOverride:O,fatherPID:E,transactionUUID:U}))},S=function(n){var i=function(){return V=p.validate(),O=p.getSecurityContextOverride(),!0!==V.result?(e.is(V.message)&&m.error(V.message),!1):(m.clearMessages(),I=p.getValues(),d(I,{securityContextOverride:O,fatherPID:E,transactionUUID:U}),!0)},r=function(){m.close()};switch(n){case a:return function(){V=null,r(),e.is(U)&&t.notify("objectCreationUIClosed",N)};case s:return function(){e.is(U)&&N.requestedCreation++,i()};case l:return function(){i()&&(r(),e.is(U)&&(N.requestedCreation++,t.notify("objectCreationUIClosed",N)))};default:t.log("wrong option")}},o){case u:D={No:new g({label:i.getNLSValue("InsertUI.Close.Title"),onClick:S(a)}),Yes:new g({label:i.getNLSValue("InsertUI.ReplaceAndClose.Title"),onClick:S(l)})};break;default:D={No:new g({label:i.getNLSValue("InsertUI.Close.Title"),onClick:S(a)}),Apply:new g({label:i.getNLSValue("InsertUI.Create.Title"),onClick:S(s)}),Yes:new g({label:i.getNLSValue("InsertUI.CreateAndClose.Title"),onClick:S(l)})}}e.is(n)?(w={title:L(c.split("/")[1]||"",v),domId:"InsertUI-dialog",content:y,resizableFlag:!0,modalFlag:!0,minWidth:290,buttons:D,visibleFlag:W},e.is(r)&&(b=c.indexOf("/")>-1?c.split("/")[1]:c,w="WORKINSTRUCTION"!==r.getPPRTypeFromType(b)||r.isAKindOf(b,"DELWkiDataCollectPlanReference")||r.isAKindOf(b,"DELWkiDataCollectChecklistReference")?e.merge({width:600},w):e.merge({position:{my:"top",at:"top"},height:500,width:600},w)),(m=n.create("Dialog",w)).close=function(){e.is(p)&&(p.destroy(),p=null),e.is(y)&&y.destroy(),this.destroy(),m=null},W?C&&m.error(i.getNLSValue("ModelBehavior.CreateReference.Failure.InvalidXML")):F()):t.debug("uxFactoryBehavior is not available.")},I=function(e){m.title=L(e),m.clearMessages()};return{createDialog:function(t,i,r,a,l,s){o=c,e.is(a)&&(o=d),y=new f("div",{class:"Insert-Command-Container"}),e.is(m)||(e.is(p)||(p=n.create("DELWKOCreateWorkOrderFromProcessDataCollectionUI",{type:t,onTypeChange:I,renderTo:y,dimension:a,createRoot:l,onFailure:v})),T(t,i,r,a,s))},createDialogForReplaceByNew:function(t,i,r,a){o=u,y=new f("div",{class:"Insert-Command-Container"}),e.is(m)||(e.is(p)||(p=n.create("DataCollectionUI",{type:r,baseTypes:t,selectedBaseType:i,onTypeChange:I,renderTo:y,onFailure:v})),T(r,a))},isActive:function(){return!!e.is(m)&&m.visibleFlag},destroyUI:function(){e.is(m)&&m.close()}}}}),define("DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessCmdModule",["UWA/Core","DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessUI"],function(e,t){"use strict";return{behaviors:["UXFactoryBehavior","DELWKOModelBehavior","LinkBehavior","ResourceBehavior","SelectionBehavior","SearchBehavior","ReplaceBehavior"],creator:function(n,i,r,o,a,l,s,c){var u,d,f,g,p={},y=null,m=null;return g=function(){var t,n,i;if(i=l.getSelections(),e.is(i,"array")&&i.length>0)for(n=0;n<i.length;n++)if(t=i[n][0],e.is(t))return t},d=function(e,t){g(),r.createWorkOrderFromProcess(e,void 0,t)},f=function(t,n){e.is(n.newRef)&&c.replace("replaceByNew",n.newRef.id)},function(e,t){t.onComplete=f,t.silent=!0,r.createRefOrInst(e,null,t)},u=function(t){var n,i,r,o=t.arguments,a="",l=[];y.isActive()&&y.destroyUI(),m=null,e.is(o,"array")&&0<o.length&&o.forEach(function(t){if(e.is(t)&&e.is(t.ID,"string")&&e.is(t.Value,"string"))switch(t.ID){case"ReferenceType":a=t.Value;break;case"ShowDialog":n="false"!==t.Value;break;case"DisplayedInTableView":e.is(this._displayedInTableView,"array")||(l=[]),l.push(t.Value);break;case"V_DimensionType":m=t.Value}},this),e.is(m)&&(r=g(),e.is(r)&&(i=!1)),a="DELLmiWorkOrder/DELLmiWorkOrderReference",y.createDialog(a,d,n,m,i)},{listenTo:function(){return{CreateWorkOrderFromProcessCmd:u}},onStart:function(o,l){p=e.extend(p,o),e.is(p.createWorkOrderFromProcessFormAttributeXML)||(n.debug("CreateWorkOrderFromProcess Module loading failed : insertFormAttributeXML option is undefined"),l()),y=new t(n,i,a,r),l()},onStop:function(){y.isActive()&&y.destroyUI(),y=void 0}}}}});