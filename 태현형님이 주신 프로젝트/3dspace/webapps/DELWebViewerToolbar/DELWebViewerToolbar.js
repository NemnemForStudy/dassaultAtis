define("DS/DELWebViewerToolbar/ToolbarContext",[],function(){"use strict";var e,t=function(){var e;return{set:function(t){e=t},get:function(){return e}}};return UWA.is(e)||(e=new t),e}),define("DS/DELWebViewerToolbar/ViewListColumnManager",["DS/DELWebViewerUtils/Utils"],function(e){"use strict";const t={Columns:{Title:{dataIndex:"tree",text:"Title",pinned:"left",editionPolicy:"EditionOnOver",width:"250px",height:"40px"},Maturity:{dataIndex:"status",text:"Maturity State",kind:"string",width:100,height:"40px",editableFlag:!1,typeRepresentation:"tag",className:"lc-maturity-state",alignment:"center",customisation:{exportable:{lock:!1,value:!0}},visibleFlag:!0,getCellClassName:function(e){var t;return-1!==e.rowID&&(t=e&&e.nodeModel&&e.nodeModel.options&&e.nodeModel.options.grid&&e.nodeModel.options.grid.status),t}},BuildUpCategory:{dataIndex:"category",text:"BuildUp Category",typeRepresentation:"string",height:"40px"},HideShow3D:{sortableFlag:!1,editableFlag:!0,isDraggable:!1,isExportable:!1,groupableFlag:!1,dataIndex:"hideShow3D",editionPolicy:"EditionInPlace",typeRepresentation:"visibility",alignment:"center",pinned:"right",text:"",width:30,icon:e.getAssetsUrl("DEL3DViewer","icons/32/I_DELPPR3DViewer.png"),getCellValue:function(e){return e.nodeModel.options.grid.hideShow3D}}},WorkInstructions:{columnPropertiesToOverride:{Title:{getCellKPIColor:null},HideShow3D:{visibleFlag:!1}}},BuildUp:{columnPropertiesToOverride:{Title:{getCellKPIColor:function(e){if(!e.isHeader&&e.nodeModel&&e.nodeModel.options.grid.color)return e.nodeModel.options.grid.color}},HideShow3D:{visibleFlag:!0}}}};return{getColumns:function(e){let o=t.Columns;if(t[e]&&t[e].columnPropertiesToOverride){let i=t[e].columnPropertiesToOverride;Object.keys(i).forEach(e=>{o[e]={...o[e],...i[e]}})}return o}}}),define("DS/DELWebViewerToolbar/DisplayOptionsColumns",[],function(){"use strict";return{HideShow3D:{text:"Visibility",sortableFlag:!1,editableFlag:!0,isDraggable:!1,isExportable:!1,groupableFlag:!1,alignment:"center",dataIndex:"visibility",editionPolicy:"EditionInPlace",typeRepresentation:"visibility",getCellValue:function(e){return e.nodeModel.options.grid.visibility}},Category:{dataIndex:"category",text:"Category",typeRepresentation:"string"},Transparency:{text:"Transparency",dataIndex:"opacity",typeRepresentation:"opacity",editionPolicy:"EditionInPlace",editableFlag:"true",alignment:"center",semantics:{minValue:0,maxValue:1,stepValue:.1,colorFrom:"transparent",colorTo:"#368EC4"}},ShowColor:{text:"Color ON/OFF",dataIndex:"withColor",typeRepresentation:"independantBoolean",editionPolicy:"EditionInPlace",editableFlag:"true",alignment:"center"},Color:{text:"Color",dataIndex:"color",typeRepresentation:"color",editableFlag:"true",editionPolicy:"EditionInPlace",alignment:"center"}}}),define("DS/DELWebViewerToolbar/ToolbarController",["UWA/Core","DS/DELWebViewerToolbar/ToolbarContext","text!DS/DELWebViewerToolbar/assets/json/Toolbar.json"],function(e,t,o){"use strict";return function(i,n,r,a){var l,s=JSON.parse(o),c=a.getOption("eventCollection").getViewerCtrlEventHnd(),d=s.entries.map(function(e){return e.dataElements.value.module}),u=new e.Promise(function(e){require(d,function(){e(Array.prototype.slice.call(arguments))})}),p=function(){u.then(e=>{e&&e.length>0&&e.forEach(function(e){e.destroy()})})},g=function(){let e=n.getMode();s[e]&&s[e].entriesToOverride&&s[e].entriesToOverride.forEach(e=>{l.updateNodeModel({commandId:e.id,...e.dataElements})})};return Object.assign(a,{toolbar:s.entries}),a.getOption("quickToolBar")&&(t.set({viewerInterface:n,modelInterface:r,options:a}),(l=n.getToolBar()).create(s.entries),l.hide(),g(),c.subscribe(c.events.onSetModeComplete,function(){p(),g()})),{reset:function(){l&&(p(),l.reset(),l.hide())}}}}),define("DS/DELWebViewerToolbar/commands/View3DList",["UWA/Core","DS/DELWebViewerToolbar/ToolbarContext","DS/DELWebViewerToolbar/ViewListColumnManager","DS/DELWebViewerUtils/Utils","text!DS/DELWebViewerToolbar/assets/json/BuildUpCategory.json"],function(e,t,o,i,n){"use strict";var r,a=function(){var r,a,l=[],s=function(){var e=t.get(),o=e.viewerInterface,i=e.options.getOption("eventCollection").getViewerCtrlEventHnd();o.getToolBar().updateNodeModel({commandId:"3DViewList",state:!1}),r&&(r.destroy(),r=null),l.forEach(function(e){i.unSubscribe(e)}),l=[]},c=function c(){var d=t.get(),u=d.modelInterface,p=d.viewerInterface,g=d.options,h=g.getOption("mappingKeys"),f=JSON.parse(n),b=u.getDataManager(),y=b.get("process"),v=y.installPath&&y.installPath.length>0?y.installPath[0]:y.mfgId?y.mfgId:null,D=y.resourceId?y.resourceId:null,m=y.filter?y.filter:null,w=b.get("currentBuildupContent"),C=function(t){var o=e.Promise.resolve({results:[]});return t&&t.pathFilter&&t.pathFilter.length>0&&(o=u.getProgressiveExpandData(i.getPayload(t))),o};v&&u&&p&&w&&w.graphicData&&w.graphicData.length>0&&(r?Promise.resolve(r):p.getComponentPromise("3DViewList",{columns:function(){let e=o.getColumns(p.getMode());for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&("HideShow3D"!==t&&(e[t].text=g.getNLSValue("3DViewList.Title."+t)),e[t].description=g.getNLSValue("3DViewList.Description."+t));return Object.values(e)}(),readOnly:p.getToolBar().getNodeModel({commandId:"3DViewList"}).options.readOnly,event:g.getOption("eventCollection").getViewerCtrlEventHnd(),getNLSValue:g.getNLSValue}).then(e=>{r=e})).then(function(){var t,o,n;r&&(t=function(){var t={mfgItems:[],resources:[]},o=e.is(b.get("3DViewListHiddenPaths"),"array")?b.get("3DViewListHiddenPaths"):[],i=b.get("BuildUpSettings");return w.graphicData.forEach(function(n){(n.category&&e.is(n.visibility)&&n.visibility||o.indexOf(n.path.toString())>-1)&&(-1!==Object.keys(i).indexOf(n.category)?t.mfgItems.push(n):t.resources.push(n))}),t}(),n=C({id:v,pathFilter:t.mfgItems.map(e=>e.path),isMfg:!0,filter:m}),o=C({id:D,pathFilter:t.resources.map(e=>e.path),filter:m}),e.Promise.all([n,o]).then(function(o){var n,d=[];o&&o.length>0&&o.forEach(function(e){e&&e.results&&e.results.length>0&&(d=d.concat(e.results))}),r.create(function(e){var o,n=[],r=(o={},e.forEach(function(e){e&&e.resourceid&&(o[e.resourceid]=e)}),o);return t.mfgItems.concat(t.resources).forEach(function(e){var t,o=e.path,l=o[o.length-1],s=r[l],c=Object.keys(f).indexOf(e.category)>-1?f[e.category]:f.resource;s&&n.push({label:s[h.EXPANDENUM.LABEL]?s[h.EXPANDENUM.LABEL]:"",grid:{color:e.color?e.color:"",status:s[h.EXPANDENUM.STATUS]?s[h.EXPANDENUM.STATUS].split(".")[1]:"",category:g.getNLSValue(c),path:o,hideShow3D:e.visibility},icons:Object.keys(f).indexOf(e.category)>-1?[s[h.EXPANDENUM.ICON]]:[(t=s[h.EXPANDENUM.IPML_ICON],a||(a=i.get3DSpaceUrl()+"/snresources/images/icons/small/"),t?a+t+".png":"")]})}),n}(d)),r.onSelect(function(e){var t=[];e.forEach(function(e){t.push(e.options.grid.path)}),p.selectNode({path:t,select:!0,clear:!0})}),n=function(e,t){w.graphicData.forEach(function(o){if(e===o.path.toString())return o.visibility=t,void(o.visibilityFree=!t)}),b.set("currentBuildupContent",w)},r.onShowHide(function(t){var o=t.data.nodeModel,i=o.getAttributeValue("hideShow3D"),r=o.getAttributeValue("path");p.setGraphicProperties({graphicProperties:[{path:r,visibility:i,visibilityFree:!i}]},h.SCENEGRAPHKEYS.BUILDUP).then(function(){var t=u.getDataManager(),o=e.is(t.get("3DViewListHiddenPaths"),"array")?t.get("3DViewListHiddenPaths"):[],a=r.toString();i?o.splice(o.indexOf(a),1):o.push(a),t.set("3DViewListHiddenPaths",o),n(a,i),p.render()})}),function(){var e=g.getOption("eventCollection").getViewerCtrlEventHnd(),t={onCommandClose:function(e){"3DViewList"===e.commandId&&s()},onGlobalBuildUpRemoved:s,on3DViewListResetComplete:c,onGlobalBuildUpComplete:c,onHighlightNode:r.highlight,onUnHighlightNode:r.unHighlight,onUnSelectNode:r.unSelect};if(0===l.length)for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&l.push(e.subscribe(e.events[o],t[o]))}()}))})};return{execute:function(t){var o,i;t&&t.context&&t.context.nodeModel&&t.context.nodeModel.options&&(o=t.context.nodeModel.options,i=e.is(o.state,"boolean")?!o.state:null,t.context.nodeModel.updateOptions({state:i}),i?c():s())},destroy:s}};return e.is(r)||(r=new a),r}),define("DS/DELWebViewerToolbar/commands/ShowBuildupColorsCmd",["UWA/Core","DS/DELWebViewerToolbar/ToolbarContext"],function(e,t){"use strict";var o,i=function(){return{execute:function(o){var i,n,r,a=t.get().options.getOption("eventCollection").getViewerCtrlEventHnd();o&&o.context&&o.context.nodeModel&&o.context.nodeModel.options&&(r=o.context.nodeModel,i=o.context.nodeModel.options,n=e.is(i.state,"boolean")?i.state:null,r.updateOptions({state:!n}),a.publish(a.events.onShowBuildupColorChange,{commandId:"ShowBuildUpColors",state:n}))},destroy:function(){}}};return e.is(o)||(o=new i),o}),define("DS/DELWebViewerToolbar/commands/ResetCmd",["UWA/Core","DS/DELWebViewerToolbar/ToolbarContext"],function(e,t){"use strict";var o,i=function(){return{execute:function(){var o=[],i=t.get(),n=i.modelInterface,r=i.viewerInterface,a=n.getDataManager(),l=e.is(a.get("3DViewListHiddenPaths"),"array")?a.get("3DViewListHiddenPaths"):[],s=i.options.getOption("eventCollection").getViewerCtrlEventHnd(),c=a.get("currentBuildupContent"),d=c.graphicData.filter(e=>e.path&&e.category).map(e=>e.path.toString());l.length>0&&(l.forEach(function(e){d.indexOf(e)>-1&&o.push({path:e.split(","),visibility:!0,visibilityFree:!1})}),o.length>0?r.setGraphicProperties({graphicProperties:o},"delpad3dviewer_scene_graph_buildup").then(function(){a.set("3DViewListHiddenPaths",[]),c.graphicData.forEach(function(e){l.indexOf(e.path.toString())>-1&&(e.visibility=!0,e.visibilityFree=!1)}),a.set("currentBuildupContent",c),r.render(),s.publish(s.events.on3DViewListResetComplete,{success:!0})}):a.set("3DViewListHiddenPaths",[]))},destroy:function(){}}};return e.is(o)||(o=new i),o}),define("DS/DELWebViewerToolbar/commands/BuildupDisplayOptionsCmd",["UWA/Core","DS/DELWebViewerToolbar/ToolbarContext","DS/DELWebViewerToolbar/DisplayOptionsColumns"],function(e,t,o){"use strict";var i,n=function(){var i,n,r,a={current:"BuildUp.Category.Current",previousinsystem:"BuildUp.Category.PreviousInSystem",previousfromprevioussystem:"BuildUp.Category.Previous",disassembled:"BuildUp.Category.Removed",context:"BuildUp.Category.Context"},l=[],s=function(){n&&(n.destroy(),n=null),l.forEach(function(e){r.unSubscribe(e)}),l=[]},c=function(){var c=t.get(),d=c.modelInterface,u=c.viewerInterface,p=c.options,g=d.getDataManager();r=p.getOption("eventCollection").getViewerCtrlEventHnd(),u.getComponentPromise("BuildUpDisplayOptions",{columns:function(e){for(let t in o)Object.prototype.hasOwnProperty.call(o,t)&&(o[t].text=e.getNLSValue("DisplayOptions.Title."+t),o[t].description=e.getNLSValue("DisplayOptions.Description."+t));return Object.values(o)}(p),event:r,getNLSValue:p.getNLSValue}).then(function(t){var o;t&&(o=function(t,o){var i=[];return e.is(t,"array")&&t.length>0&&o&&t.forEach(function(e){var t=o.getNLSValue(a[e.category]);i.push({label:t,text:e.text,grid:{visibility:e.visibility,category:t,opacity:parseInt(e.opacity)/255,withColor:e.withColor,color:e.color},categoryName:e.category})}),i}(function(e){var t=[];return e&&Object.keys(a).forEach(function(o){var i=e[o];i&&t.push(Object.assign({},i,{category:o}))}),t}(g.get("BuildUpSettings")),p),t.create(o),function(e){var t={onGlobalBuildUpRemoved:function(){s(),i&&i.updateOptions({state:!1})}};if(0===l.length)for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&l.push(e.subscribe(e.events[o],t[o]))}(r),n=t)})};return{execute:function(t){var o,n;t&&t.context&&t.context.nodeModel&&t.context.nodeModel.options&&(i=t.context.nodeModel,o=t.context.nodeModel.options,n=e.is(o.state,"boolean")?!o.state:null,i.updateOptions({state:n}),n?c():s())},destroy:s}};return e.is(i)||(i=new n),i});