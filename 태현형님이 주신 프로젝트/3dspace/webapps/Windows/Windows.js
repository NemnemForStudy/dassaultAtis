define("DS/Windows/DockingElement",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/Dom","UWA/Utils/Client","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/Core/WebUXComponents"],function(e,t,i,n,o,s,a,r,l){"use strict";const d="wux-docking-element-hide-docking-zone",h="wux-docking-anim-collapse",c="wux-ui-3ds wux-ui-3ds-1x wux-windows-docking-element-collapseIcon",u="wux-ui-3ds wux-ui-3ds-lg wux-ui-3ds-menu wux-windows-docking-element-collapseIcon",m=1e3,p=300,g=50;var f=t.inherit({name:"dockingElement",markForRecordFlag:!0,publishedProperties:{identifier:{defaultValue:"",type:"string",readOnly:!0,category:"Behavior"},dockingZoneSize:{defaultValue:100,type:"number",advancedSetter:!0,recordFlag:!0},minSize:{defaultValue:20,type:"number"},maxSize:{defaultValue:screen.width,advancedSetter:!0,type:"number"},side:{defaultValue:WUXDockAreaEnum.TopDockArea,type:"number",readOnly:!0},interactiveDockAreaVisibleFlag:{defaultValue:!1,type:"boolean"},collapsibleFlag:{defaultValue:!0,type:"boolean"},collapseDockingZoneFlag:{defaultValue:!1,advancedSetter:!0,type:"boolean",recordFlag:!0},overlayDockingZoneFlag:{defaultValue:!1,type:"boolean"},visibleCollapserFlag:{defaultValue:!0,type:"boolean"},collapserStyle:{defaultValue:0,type:"enum",category:"Appearance",readOnly:!0},visibleDockingZoneFlag:{defaultValue:!0,type:"boolean"},resizableFlag:{defaultValue:!0,type:"boolean"},dockingZoneContent:{defaultValue:null,type:"object"},freeZoneContent:{defaultValue:null,type:"object"},useBordersFlag:{defaultValue:!0,type:"boolean"},useBackgroundFlag:{defaultValue:!1,type:"boolean"},alignment:{defaultValue:"near",type:"string",category:"Appearance"},autoExpandFlag:{defaultValue:!0,type:"boolean"}},buildView:function(){this.elements.container.addClassName("wux-windows-docking-element"),a.setElementRecordMode(this.elements.container,r.RecordModes.DEFAULT_AND_CHILD),this.elements.dockingWithCollapserContainer=new e.Element("div",{class:"wux-windows-docking-and-collapser"}),this.elements.collapser=new e.Element("div",{class:"wux-windows-docking-element-collapser"}),s.Engine.ie||this.elements.collapser.addClassName("collapser-not-IE"),this.elements.dockingZoneMask=new e.Element("div",{class:"wux-windows-docking-element-docking-zone-mask"}),this.elements.fixedArea=new e.Element("div",{class:"wux-windows-docking-element-fixed-area"}).inject(this.elements.dockingZoneMask),this.elements.dockingZone=new e.Element("div",{class:"wux-windows-docking-element-docking-zone"}).inject(this.elements.dockingZoneMask),this.elements.resizeHandler=new e.Element("div",{class:"wux-windows-docking-element-resize-handler"}).inject(this.elements.dockingZoneMask),this.elements.freeZone=new e.Element("div",{class:"wux-windows-docking-element-free-zone"}),this.elements.hackResize=new e.Element("div",{class:"wux-windows-docking-element-hack-resize"}).inject(this.elements.container),this.elements.hackResize.addClassName(d),this.elements.interactiveDockArea=new e.Element("div",{class:"wux-windows-docking-element-interactive-dock-area"}),this._pinnedFlag=!1,Object.defineProperty(this,"pinnedFlag",{get:()=>this._pinnedFlag}),this._scrollBarSize=0,this._collapserSize=20,this._collapserTimer=null,this._expanderTimer=null,this.__forceCollapseDockingZoneFlagCpt=0,this._onClickToPinBind=function(){if(this.collapserStyle===f.COLLAPSER_STYLE.MOVABLE&&this._collapserHasBeenMoved)return;this._expandTimer?(clearTimeout(this._expandTimer),this._expandTimer=null,this.setPropertyFromUIInteraction("collapseDockingZoneFlag",!1)):this.autoExpandFlag&&!0===this._listenToMouseMove?(this._listenToMouseMove=!1,o.removeEventOnElement(this,document,i.POINTERMOVE,this._onDocumentMouseMoveForAutoExpandBind)):this.setPropertyFromUIInteraction("collapseDockingZoneFlag",!this.collapseDockingZoneFlag);w.call(this,!this.collapseDockingZoneFlag),this.elements.dockingWithCollapserContainer.removeAttribute("expand-hover"),this._saveCollapseDockingZoneFlagInPreferences()}.bind(this),this._onDocumentMouseMoveForAutoExpandBind=function(e){n.isMouseOverElement(this.elements.dockingWithCollapserContainer,{x:e.clientX,y:e.clientY})?this._collapseTimer&&(clearTimeout(this._collapseTimer),this._collapseTimer=null):this._collapseTimer||(this._collapseTimer=setTimeout(()=>{o.pushUserInteractionContext(),this.setPropertyFromUIInteraction("collapseDockingZoneFlag",!0),this.elements.dockingWithCollapserContainer.removeAttribute("expand-hover"),this.__collapseMemory=!1,o.popUserInteractionContext(),this._listenToMouseMove=!1,o.removeEventOnElement(this,document,i.POINTERMOVE,this._onDocumentMouseMoveForAutoExpandBind),this._collapseTimer=null},m))}.bind(this),this._onCollapserMouseEnterForAutoExpandBind=function(){!0!==this.collapseDockingZoneFlag||this._expandTimer||(this._expandTimer=setTimeout(()=>{o.pushUserInteractionContext(),this.setPropertyFromUIInteraction("collapseDockingZoneFlag",!1),this.elements.dockingWithCollapserContainer.setAttributeNode(document.createAttribute("expand-hover")),o.popUserInteractionContext(),this._listenToMouseMove=!0,o.addEventOnElement(this,document,i.POINTERMOVE,this._onDocumentMouseMoveForAutoExpandBind),this._expandTimer=null},p))}.bind(this),this._onCollapserMouseLeaveForAutoExpandBind=function(){this._expandTimer&&(clearTimeout(this._expandTimer),this._expandTimer=null)}.bind(this)},handleEvents:function(){(function(){var e=0;let t=0,n=0,s=0,a=0,r="";const l=i=>{i.preventDefault(),e=i[r]-s;const o=t+a*e,l=Math.max(this.minSize,Math.min(o,this.maxSize,n));this.setPropertyFromUIInteraction("dockingZoneSize",l),this.fire("dockIsResizing")},h=()=>{document.body.removeAttribute("resizing"),o.removeEventOnElement(this,document,i.POINTERMOVE,l),o.removeEventOnElement(this,document,i.POINTERUP,h),this.elements.hackResize.setStyle("cursor","default"),this.elements.hackResize.addClassName(d),this.fire("dockResize")};o.addEventOnElement(this,this.elements.resizeHandler,i.POINTERDOWN,e=>{if(!1===this.collapseDockingZoneFlag&&!0===this.resizableFlag){document.body.setAttributeNode(document.createAttribute("resizing")),o.addEventOnElement(this,document,i.POINTERMOVE,l),o.addEventOnElement(this,document,i.POINTERUP,h),t=this.dockingZoneSize;let c=this.elements.freeZone,u=!1;for(;!u;){u=!0;const e=c.getChildren();for(let t=0;t<e.length;t++)if(e[t].hasClassName("wux-windows-docking-element")){const i=e[t].dsModel;i&&(c=i.elements.freeZone,u=!1)}}const m=this.side;let p;switch(m){case WUXDockAreaEnum.TopDockArea:a=1,p="ns-resize",r="pageY",n=c.offsetHeight+t-g;break;case WUXDockAreaEnum.BottomDockArea:a=-1,p="ns-resize",r="pageY",n=c.offsetHeight+t-g;break;case WUXDockAreaEnum.LeftDockArea:a=1,p="ew-resize",r="pageX",n=c.offsetWidth+t-g;break;case WUXDockAreaEnum.RightDockArea:a=-1,p="ew-resize",r="pageX",n=c.offsetWidth+t-g}s=e[r],this.elements.hackResize.setStyle("cursor",p),this.elements.hackResize.removeClassName(d),this.fire("dockStartResize")}})}).call(this),function(){o.addEventOnElement(this,this.elements.collapser,"click",this._onClickToPinBind),this.collapserStyle===f.COLLAPSER_STYLE.FIXED_AREA&&this.elements.expanderBar.addEventListener("click",this._onClickToPinBind)}.call(this)},_postBuildView:function(){const e=this._getCollapseDockingZoneFlagFromPreferences();e&&(this.collapseDockingZoneFlag=e.collapseDockingZoneFlag)},_applySide:function(){const e=this._getClassName();this.elements.container.addClassName(e),this.elements.collapser.addClassName(e),this.elements.dockingWithCollapserContainer.addClassName(e),this.elements.dockingZoneMask.addClassName(e),this.elements.dockingZone.addClassName(e),this.elements.resizeHandler.addClassName(e),this.elements.freeZone.addClassName(e),this.elements.interactiveDockArea.addClassName(e),this.side&WUXDockAreaEnum.LeftDockArea||this.side&WUXDockAreaEnum.TopDockArea?(this.elements.dockingWithCollapserContainer.inject(this.elements.container),this.elements.collapser.inject(this.elements.dockingWithCollapserContainer),this.elements.dockingZoneMask.inject(this.elements.dockingWithCollapserContainer),this.elements.freeZone.inject(this.elements.container)):(this.elements.freeZone.inject(this.elements.container),this.elements.dockingWithCollapserContainer.inject(this.elements.container),this.elements.dockingZoneMask.inject(this.elements.dockingWithCollapserContainer),this.elements.collapser.inject(this.elements.dockingWithCollapserContainer)),this.elements.interactiveDockArea.inject(this.elements.dockingZoneMask)},_preEditDockingZoneSize:function(e,t){return"100%"===t||(void 0!==this.maxSize&&t>this.maxSize?{validValue:this.maxSize}:!(void 0!==this.minSize&&t<this.minSize)||{validValue:this.minSize})},_applyDockingZoneSize:function(e){this._updateDockingZoneSize()},_applyIdentifier:function(){this.identifier&&(this.getContent().setAttribute("wux-identifier",this.identifier),this.elements.dockingWithCollapserContainer.setAttribute("wux-identifier",this.identifier))},_getClassName:function(){switch(this.side){case WUXDockAreaEnum.LeftDockArea:return"wux-docking-element-left";case WUXDockAreaEnum.RightDockArea:return"wux-docking-element-right";case WUXDockAreaEnum.TopDockArea:return"wux-docking-element-top";case WUXDockAreaEnum.BottomDockArea:return"wux-docking-element-bottom"}},_saveCollapseDockingZoneFlagInPreferences:function(){""!==this.identifier&&n.saveDataInLocalPreferences(this,this._getClassName(),"collapseDockingZoneFlag",{collapseDockingZoneFlag:this.collapseDockingZoneFlag})},_getCollapseDockingZoneFlagFromPreferences:function(){if(""!==this.identifier)return n.getDataFromLocalPreferences(this,this._getClassName(),"collapseDockingZoneFlag")},_applyInteractiveDockAreaVisibleFlag:function(){this.interactiveDockAreaVisibleFlag?this.elements.interactiveDockArea.setAttributeNode(document.createAttribute("displayed")):this.elements.interactiveDockArea.removeAttribute("displayed")},_applyCollapsibleFlag:function(){this.collapsibleFlag||(this.__forceCollapseDockingZoneFlagCpt++,this.collapseDockingZoneFlag=!1,this.__forceCollapseDockingZoneFlagCpt--),this._updateSizes()},__shouldCollapserBeVisible:function(){return!(this.collapserStyle===f.COLLAPSER_STYLE.MOVABLE&&(this.pinnedFlag||!function(){if(!this.dockingZoneContent)return!1;if(!this.dockingZoneContent.match('[class^="wux-skeleton"]'))return!0;const e=this.dockingZoneContent.querySelector('[class$="container"]');return e&&e.hasChildNodes()}.call(this)))&&(!(this.collapserStyle===f.COLLAPSER_STYLE.FIXED_AREA&&!this.collapseDockingZoneFlag)&&(this.collapsibleFlag&&this.visibleDockingZoneFlag&&this.visibleCollapserFlag))},_updateCollapserSize:function(){const e=()=>{this._transitionInProgress&&!this._collapserVisibilityToBeChanged&&this.getContent().offsetParent?(this._collapserVisibilityToBeChanged=!0,this.addEventListener("dimensionsChanged",()=>{this._collapserVisibilityToBeChanged&&(this._collapserVisibilityToBeChanged=!1,this.elements.collapser.removeClassName(d))},{once:!0})):(this._collapserVisibilityToBeChanged=!1,this.elements.collapser.removeClassName(d))};this.__shouldCollapserBeVisible()?(this.collapserStyle===f.COLLAPSER_STYLE.MOVABLE?this._collapserSize=0:this._collapserSize=20,e()):(this._collapserVisibilityToBeChanged=!1,this._collapserSize=0,this.elements.collapser.addClassName(d))},_updateDockingZoneSize:function(){let e=this._hasScrollbar();e&&0===this._scrollBarSize?this._scrollBarSize=n.getScrollbarWidth():e||(this._scrollBarSize=0);const t=this.side;let i,o,s,a,r;if(t===WUXDockAreaEnum.TopDockArea||t===WUXDockAreaEnum.BottomDockArea){i="height";const e=function(){return this.elements.fixedArea?this.elements.fixedArea.offsetHeight:0}.call(this);this.elements.dockingZone.setStyle("margin-top",e+"px"),o="100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._scrollBarSize-e+"px"}else t!==WUXDockAreaEnum.LeftDockArea&&t!==WUXDockAreaEnum.RightDockArea||(i="width",o="100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._scrollBarSize+"px");s=this.visibleDockingZoneFlag&&!this.collapseDockingZoneFlag?"100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._scrollBarSize+"px":"0px",a=this.visibleDockingZoneFlag?this.visibleCollapserFlag?this.collapseDockingZoneFlag?this._collapserSize+"px":"100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._collapserSize+this._scrollBarSize+"px":s:"0px",r=!this.visibleDockingZoneFlag||this.collapseDockingZoneFlag&&0===this._collapserSize||this.overlayDockingZoneFlag?"100%":this.collapseDockingZoneFlag&&0!==this._collapserSize?"calc(100% - "+this._collapserSize+"px)":"calc(100% - "+(this.dockingZoneSize+this._collapserSize+this._scrollBarSize)+"px)",this.elements.dockingZone.setStyle(i,o),this.elements.dockingZoneMask.setStyle(i,s),this.elements.dockingWithCollapserContainer.setStyle(i,a),this.elements.freeZone.setStyle(i,r)},_updateSizes:function(){this._updateCollapserSize(),this._updateDockingZoneSize()},_applyOverlayDockingZoneFlag:function(){if(this.overlayDockingZoneFlag){switch(this.side){case WUXDockAreaEnum.TopDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-top");break;case WUXDockAreaEnum.BottomDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-bottom");break;case WUXDockAreaEnum.LeftDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-left");break;case WUXDockAreaEnum.RightDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-right")}this.elements.container.addClassName("wux-windows-docking-element-overlayed")}else this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-top"),this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-bottom"),this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-left"),this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-right"),this.elements.container.removeClassName("wux-windows-docking-element-overlayed");this._updateDockingZoneSize()},_applyVisibleCollapserFlag:function(){this._updateSizes()},_applyCollapserStyle:function(){let t="";this.collapserStyle===f.COLLAPSER_STYLE.FIXED_AREA?(t="fixed-area",function(){this.elements.expanderBar=new e.Element("div",{class:"wux-windows-docking-element-expanderBar"}),this.elements.collapseIconContainer=new e.Element("div",{class:"wux-windows-docking-element-collapse-icon-container"}).inject(this.elements.expanderBar),this.elements.collapseIcon=new e.Element("span",{class:c}).inject(this.elements.collapseIconContainer),this.elements.expanderBar.inject(this.elements.dockingZone,"before")}.call(this)):this.collapserStyle===f.COLLAPSER_STYLE.MOVABLE?(t="movable",function(){this.elements.collapseIcon=new e.Element("span",{class:u}).inject(this.elements.collapser);const t=this.elements.dockingWithCollapserContainer,n=this.elements.collapser;let o,s,a,r;const l=e=>{const t=e.clientX,i=e.clientY,l=this.side===WUXDockAreaEnum.TopDockArea||this.side===WUXDockAreaEnum.BottomDockArea;if(this._getCurrentTouchMode()&&(l&&Math.abs(t-a)<5||!l&&Math.abs(i-r)<5))return;this._collapserHasBeenMoved=!0;let d=Math.max(0,Math.min(o.height-42,i-o.top+s.y)),h=Math.max(0,Math.min(o.width-42,t-o.left+s.x));n.setStyle("top",d+"px"),n.setStyle("left",h+"px")};n.addEventListener(i.POINTERDOWN,e=>{this._collapserHasBeenMoved=!1,o=t.getBoundingClientRect();const d=n.getBoundingClientRect();a=e.clientX,r=e.clientY,s={x:d.left-a,y:d.top-r},document.body.addEventListener(i.POINTERMOVE,l),document.body.addEventListener(i.POINTERUP,()=>{document.body.removeEventListener(i.POINTERMOVE,l)},{once:!0})})}.call(this)):this.collapserStyle===f.COLLAPSER_STYLE.STANDARD&&(t="standard"),this.elements.container.setAttribute("collapser-style",t)},_preEditCollapseDockingZoneFlag:function(){return this.__forceCollapseDockingZoneFlagCpt>0||this.collapsibleFlag},_applyCollapseDockingZoneFlag:function(){if(!n.browserIsIE()){let e=void 0;if(this.__onTransitionEnd=(()=>{this.elements.container&&(n.browserIsIE()||(this._transitionInProgress=!1,this.elements.dockingZone.removeClassName(h),this.elements.dockingZoneMask.removeClassName(h),this.elements.freeZone.removeClassName(h),this.elements.dockingWithCollapserContainer.removeClassName(h)),this.overlayDockingZoneFlag?o.removeEventOnElement(this,this.elements.dockingZone,"transitionend",this.__onTransitionEnd):o.removeEventOnElement(this,this.elements.freeZone,"transitionend",this.__onTransitionEnd),this.fire("dimensionsChanged"),clearTimeout(e))}),this._transitionInProgress)this.__onTransitionEnd();else{this._transitionInProgress=!0;let t=this.overlayDockingZoneFlag?this.elements.dockingZone:this.elements.freeZone;o.addEventOnElement(this,t,"transitionend",this.__onTransitionEnd),e=setTimeout(this.__onTransitionEnd,500),this.elements.dockingZone.addClassName(h),this.elements.dockingZoneMask.addClassName(h),this.elements.freeZone.addClassName(h),this.elements.dockingWithCollapserContainer.addClassName(h)}}this._expandTimer||w.call(this,!this.collapseDockingZoneFlag),this.collapseDockingZoneFlag?function(){this.getContent().setAttributeNode(document.createAttribute("collapsed")),this.elements.dockingWithCollapserContainer.setAttributeNode(document.createAttribute("collapsed")),this.resizableFlag&&this.elements.resizeHandler.addClassName(d);this.collapserStyle===f.COLLAPSER_STYLE.FIXED_AREA?this._updateSizes():this._updateDockingZoneSize();const e=-this.dockingZoneSize+"px";switch(this.side){case WUXDockAreaEnum.TopDockArea:this.elements.dockingZone.getStyle("top")===e&&"0px"===this.elements.dockingZoneMask.getStyle("height")?this.__onTransitionEnd():this.elements.dockingZone.setStyle("top",e);break;case WUXDockAreaEnum.BottomDockArea:"0px"===this.elements.dockingZoneMask.getStyle("height")&&this.__onTransitionEnd();break;case WUXDockAreaEnum.LeftDockArea:this.elements.dockingZone.getStyle("left")===e&&"0px"===this.elements.dockingZoneMask.getStyle("width")?this.__onTransitionEnd():this.elements.dockingZone.setStyle("left",e);break;case WUXDockAreaEnum.RightDockArea:"0px"===this.elements.dockingZoneMask.getStyle("width")&&this.__onTransitionEnd()}this.fire("collapse")}.call(this):function(){this.getContent().removeAttribute("collapsed"),this.elements.dockingWithCollapserContainer.removeAttribute("collapsed"),this.resizableFlag&&this.elements.resizeHandler.removeClassName(d);this.collapserStyle===f.COLLAPSER_STYLE.FIXED_AREA?this._updateSizes():this._updateDockingZoneSize();switch(this.side){case WUXDockAreaEnum.TopDockArea:"0px"!==this.elements.dockingZone.getStyle("top")&&""!==this.elements.dockingZone.getStyle("top")||"0px"===this.elements.dockingZoneMask.getStyle("height")?this.elements.dockingZone.setStyle("top","0px"):this.__onTransitionEnd();break;case WUXDockAreaEnum.BottomDockArea:this.elements.dockingZoneMask.getStyle("height")===this.dockingZoneSize+"px"&&this.__onTransitionEnd();break;case WUXDockAreaEnum.LeftDockArea:"0px"!==this.elements.dockingZone.getStyle("left")&&""!==this.elements.dockingZone.getStyle("left")||"0px"===this.elements.dockingZoneMask.getStyle("width")?this.elements.dockingZone.setStyle("left","0px"):this.__onTransitionEnd();break;case WUXDockAreaEnum.RightDockArea:this.elements.dockingZoneMask.getStyle("width")===this.dockingZoneSize+"px"&&this.__onTransitionEnd()}this.fire("expand")}.call(this)},_applyVisibleDockingZoneFlag:function(){this.visibleDockingZoneFlag?(!0===this.resizableFlag&&this.elements.resizeHandler.removeClassName(d),this.elements.dockingZone.removeClassName(d),this.elements.dockingZoneMask.removeClassName(d)):(this.elements.resizeHandler.addClassName(d),this.elements.dockingZone.addClassName(d),this.elements.dockingZoneMask.addClassName(d)),this._updateSizes()},_applyResizableFlag:function(){!1===this.resizableFlag?this.elements.resizeHandler.addClassName(d):!0===this.visibleDockingZoneFlag&&this.elements.resizeHandler.removeClassName(d)},_applyMinSize:function(){void 0!==this.minSize&&null!==this.minSize&&(void 0!==this.maxSize&&null!==this.maxSize&&this.minSize>this.maxSize&&(this.maxSize=this.minSize),this.minSize>this.dockingZoneSize&&(this.dockingZoneSize=this.minSize))},_preEditMaxSize:function(e,t){return!(void 0!==this.minSize&&null!==this.minSize&&this.minSize>t)||{validValue:this.minSize}},_applyMaxSize:function(){void 0!==this.maxSize&&null!==this.maxSize&&this.maxSize<this.dockingZoneSize&&(this.dockingZoneSize=this.maxSize)},_applyDockingZoneContent:function(t){t&&t.remove(),this.dockingZoneContent&&(e.is(this.dockingZoneContent,"element")&&(this._properties.dockingZoneContent.value=new e.extendElement(this.dockingZoneContent)),this.dockingZoneContent.inject(this.elements.dockingZone)),this.collapserStyle===f.COLLAPSER_STYLE.MOVABLE&&this._updateCollapserSize()},_applyFreeZoneContent:function(t){t&&t.remove(),this.freeZoneContent&&(e.is(this.freeZoneContent,"element")&&(this._properties.freeZoneContent.value=new e.extendElement(this.freeZoneContent)),this.freeZoneContent.inject(this.elements.freeZone))},_applyUseBordersFlag:function(e){this.useBordersFlag?this.elements.dockingZone.addClassName("wux-docking-element-useBorders"):this.elements.dockingZone.removeClassName("wux-docking-element-useBorders")},_applyUseBackgroundFlag:function(e){this.useBackgroundFlag?this.elements.dockingZone.addClassName("wux-docking-element-use-background"):this.elements.dockingZone.removeClassName("wux-docking-element-use-background")},_applyAlignment:function(){"center"===this.alignment?(this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-near"),this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-far"),this.elements.dockingZoneMask.addClassName("wux-docking-element-align-center")):"far"===this.alignment?(this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-near"),this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-center"),this.elements.dockingZoneMask.addClassName("wux-docking-element-align-far")):(this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-center"),this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-far"),this.elements.dockingZoneMask.addClassName("wux-docking-element-align-near"))},_applyAutoExpandFlag:function(){this.autoExpandFlag?(o.addEventOnElement(this,this.elements.collapser,"mouseenter",this._onCollapserMouseEnterForAutoExpandBind),o.addEventOnElement(this,this.elements.collapser,"mouseleave",this._onCollapserMouseLeaveForAutoExpandBind)):(o.removeEventOnElement(this,this.elements.collapser,"mouseenter",this._onCollapserMouseEnterForAutoExpandBind),o.removeEventOnElement(this,this.elements.collapser,"mouseleave",this._onCollapserMouseLeaveForAutoExpandBind))},_applyProperties:function(e){this._parent(e),this.isDirty("collapserStyle")&&this._applyCollapserStyle(e.collapserStyle),this.isDirty("identifier")&&this._applyIdentifier(),this.isDirty("side")&&this._applySide(),this.isDirty("dockingZoneSize")&&l._applyForAdvancedSetterProperty(this,"dockingZoneSize",e.dockingZoneSize,this.dockingZoneSize),this.isDirty("interactiveDockAreaVisibleFlag")&&this._applyInteractiveDockAreaVisibleFlag(),this.isDirty("resizableFlag")&&this._applyResizableFlag(),this.isDirty("dockingZoneContent")&&this._applyDockingZoneContent(),this.isDirty("freeZoneContent")&&this._applyFreeZoneContent(),this.isDirty("collapsibleFlag")&&this._applyCollapsibleFlag(),this.isDirty("visibleDockingZoneFlag")&&this._applyVisibleDockingZoneFlag(),this.isDirty("useBordersFlag")&&this._applyUseBordersFlag(e.useBordersFlag),this.isDirty("useBackgroundFlag")&&this._applyUseBackgroundFlag(e.useBackgroundFlag),this.isDirty("collapseDockingZoneFlag")&&l._applyForAdvancedSetterProperty(this,"collapseDockingZoneFlag",e.collapseDockingZoneFlag||!1,this.collapseDockingZoneFlag),this.isDirty("overlayDockingZoneFlag")&&this._applyOverlayDockingZoneFlag(),this.isDirty("visibleCollapserFlag")&&this._applyVisibleCollapserFlag(),this.isDirty("alignment")&&this._applyAlignment(e.alignment),this.isDirty("autoExpandFlag")&&this._applyAutoExpandFlag(e.autoExpandFlag)},_getFixedArea:function(){return this.elements.fixedArea},_getFixedAreaWidth:function(){return this.elements.fixedArea?this.elements.fixedArea.offsetWidth:0},getSensibilityDockArea:function(){return{x:0,y:0,width:0,height:0}},_getDockingZoneDimensions:function(){const e=window.getComputedStyle(this.elements.dockingZoneMask);let t=e.width,i=e.height;if(this.collapserStyle===f.COLLAPSER_STYLE.FIXED_AREA){const e=window.getComputedStyle(this.elements.expanderBar);t-=e.width+1,i-=e.height+1}return{width:t,height:i}},_scrollToBottom:function(){},__hasBackground:function(){return!1},_pointerEventsAllIfOveflowY:function(){this.pointerEventsAllIfOverflow()},_pointerEventsAllIfOverflow:function(){if(this.getContent().getComputedSize(),this.elements&&this.elements.dockingZone){const e=this.__hasBackground();this._hasScrollbar()?(this.elements.dockingZone.setStyle("pointer-events","all"),this.elements.dockingZoneMask.removeClassName("wux-windows-docking-element-has-background")):e?(this.elements.dockingZone.setStyle("pointer-events",""),this.elements.dockingZoneMask.addClassName("wux-windows-docking-element-has-background")):(this.elements.dockingZone.setStyle("pointer-events",""),this.elements.dockingZoneMask.removeClassName("wux-windows-docking-element-has-background"))}},pointerEventsAllIfOverflow:function(){this._pointerEventsAllIfOverflow()},_hasScrollbar:function(){const e=this.elements.dockingZone;let t,i;if(void 0!==e.currentStyle&&(t=e.currentStyle.overflow),!t){const i=window.getComputedStyle(e,"");t=i?i.overflow:""}if("scroll"===t)return!0;const n=this.side==WUXDockAreaEnum.RightDockArea||this.side==WUXDockAreaEnum.LeftDockArea;if(n){if(void 0!==e.currentStyle&&(i=e.currentStyle.overflowY),!i){const t=window.getComputedStyle(e,"");i=t?t.overflowY:""}}else if(void 0!==e.currentStyle&&(i=e.currentStyle.overflowX),!i){const t=window.getComputedStyle(e,"");i=t?t.overflowX:""}return"scroll"===i||0!==e.getChildren().length&&(!(!/^(visible|auto)$/.test(t)&&!/^(visible|auto)$/.test(i))&&(n?e.scrollHeight>e.offsetHeight:e.scrollWidth>e.offsetWidth))}});function w(e){this._pinnedFlag!==e&&(this._pinnedFlag=e,this.collapserStyle===f.COLLAPSER_STYLE.FIXED_AREA&&function(){if(this.collapserStyle!==f.COLLAPSER_STYLE.FIXED_AREA)return;if(this.pinnedFlag){let e=c;this.side&WUXDockAreaEnum.RightDockArea?e+=" wux-ui-3ds-open-right":this.side&WUXDockAreaEnum.BottomDockArea?e+=" wux-ui-3ds-open-down":this.side&WUXDockAreaEnum.LeftDockArea?e+=" wux-ui-3ds-open-left":this.side&WUXDockAreaEnum.TopDockArea&&(e+=" wux-ui-3ds-open-up"),this.elements.collapseIcon.className=e}else this.elements.collapseIcon.className=c+" wux-ui-3ds-pin"}.call(this),this.collapserStyle===f.COLLAPSER_STYLE.MOVABLE&&this._updateSizes())}return a.register(f,"DS/ControlsRec/AbstractRec"),f.COLLAPSER_STYLE={STANDARD:0,FIXED_AREA:1,MOVABLE:2},f}),define("DS/Windows/WindowActivator",["UWA/Core","UWA/Class","DS/Core/BaseComponent","DS/Utilities/Utils"],function(e,t,i,n){"use strict";return t.singleton({defaultOptions:{},FindFocusableInChildren:function(e,t){var i=null;if(null==e)return null;if(0==t&&(e.getAttribute("tabindex")||e.tabIndex>=0))return e;for(var n=e.childNodes,o=0;o<n.length;o++){var s=n[o];if(1==s.nodeType){if(s.getAttribute("tabindex")||s.tabIndex>=0){i=s;break}if(i=this.FindFocusableInChildren(s,!1))break}}return i},getFocusedWidget:function(e){var t=null;if(null==e||null==e)return null;var i=document.activeElement;if(e==i)return e;if(e)for(var n=e.childNodes,o=0;o<n.length;o++){var s=n[o];if(1==s.nodeType){if(s==i){t=s;break}if(t=this.getFocusedWidget(s))break}}return t}})}),define("DS/Windows/WindowManager",["UWA/Core","UWA/Class","DS/Core/BaseComponent","DS/Utilities/Utils"],function(e,t,i,n){"use strict";return t.singleton({defaultOptions:{},init:function(e){this._parent(e)},setActiveWindow:function(e){if(this._activeWindow!==e){var t=this._activeWindow;this._activeWindow=e,this._activeWindow&&(this._activeWindow.activeFlag=!0),t&&!t._isBeingClosed&&(t.activeFlag=!1)}},getActiveWindow:function(){return this._activeWindow},bringToFront:function(e){if(e&&!e.getDockedFlag()&&!e.maximizedFlag){var t=e.getZIndex();let l=e._floatLayer?e._floatLayer:"middle";var i=-1,n=e.immersiveFrame;if(n){let t=[n];n._linkedImmersiveFrames&&t.push(...n._linkedImmersiveFrames);for(let n=0;n<t.length;n++){let r=t[n];for(var o in r.windows){let t=(a=r.windows[o])._floatLayer?a._floatLayer:"middle";if(a&&!a.getDockedFlag()&&a!==e&&t===l){var s=a.getZIndex();i<s&&(i=s)}}}if("bottom"===l&&i>=100){let t=[];for(var o in n.windows){var a;let i=(a=n.windows[o])._floatLayer?a._floatLayer:"middle";a&&a!==e&&i===l&&t.push(a)}t.sort(function(e,t){return e.getZIndex()>t.getZIndex()});for(let e=0;e<t.length;e++)i=e+1,t[e].setStyle("z-index",i)}}if(-1!==i&&i>=t){var r=i+1;e.getContent().setStyle("z-index",r)}}}})});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/Window",["require","exports","UWA/Core","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/Core/TooltipManager","DS/Utilities/WUXUWAUtils","DS/Utilities/Utils","DS/Utilities/Dom","DS/Utilities/KeyboardUtils","DS/Utilities/DeviceUtils","DS/Utilities/TouchUtils","DS/Controls/Abstract","DS/Controls/Button","DS/Controls/TooltipModel","DS/Windows/WindowActivator","DS/Windows/WindowManager","DS/Menu/ContextualMenu","i18n!DS/Windows/assets/nls/translation","DS/WUXTypings/typings/WEBUX","DS/WUXTypings/typings/UWA"],function(e,t,i,n,o,s,a,r,l,d,h,c,u,m,p,g,f,w,_){"use strict";var v,D,k;!function(e){e[e.NoneArea=0]="NoneArea",e[e.OutsideArea=1]="OutsideArea",e[e.TopArea=2]="TopArea",e[e.BottomArea=3]="BottomArea",e[e.LeftArea=4]="LeftArea",e[e.RightArea=5]="RightArea",e[e.InsideArea=6]="InsideArea"}(v||(v={})),function(e){e[e.GroupAsGrid=0]="GroupAsGrid",e[e.GroupAsTab=1]="GroupAsTab"}(D||(D={})),function(e){e[e.InvalidRole=0]="InvalidRole",e[e.AcceptRole=1]="AcceptRole",e[e.RejectRole=2]="RejectRole",e[e.DestructiveRole=3]="DestructiveRole",e[e.HelpRole=4]="HelpRole",e[e.YesRole=5]="YesRole",e[e.NoRole=6]="NoRole",e[e.ApplyRole=7]="ApplyRole",e[e.ResetRole=8]="ResetRole"}(k||(k={}));var b=Object.freeze({Ok:{name:"Ok",value:1,role:k.AcceptRole},Open:{name:"Open",value:2,role:k.AcceptRole},Save:{name:"Save",value:4,role:k.AcceptRole},Apply:{name:"Apply",value:8,role:k.ApplyRole},Reset:{name:"Reset",value:16,role:k.ResetRole},RestoreDefaults:{name:"RestoreDefaults",value:32,role:k.ResetRole},Help:{name:"Help",value:64,role:k.HelpRole},SaveAll:{name:"SaveAll",value:128,role:k.AcceptRole},Yes:{name:"Yes",value:256,role:k.YesRole},YesToAll:{name:"YesToAll",value:512,role:k.YesRole},No:{name:"No",value:1024,role:k.NoRole},NoToAll:{name:"NoToAll",value:2048,role:k.NoRole},Abort:{name:"Abort",value:4096,role:k.RejectRole},Retry:{name:"Retry",value:8192,role:k.AcceptRole},Ignore:{name:"Ignore",value:16384,role:k.AcceptRole},Discard:{name:"Discard",value:32768,role:k.DestructiveRole},Cancel:{name:"Cancel",value:65536,role:k.RejectRole},Close:{name:"Close",value:1<<17,role:k.RejectRole}}),A="wux-windows-window";var y=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return a.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{identifier:{defaultValue:void 0,type:"string",readOnly:!0,category:"Behavior"},title:{defaultValue:"",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},header:{defaultValue:null,type:"object",category:"Appearance"},content:{defaultValue:null,type:"object",category:"Behavior"},immersiveFrame:{defaultValue:null,type:"object",category:"Behavior"},position:{type:"object",category:"Appearance"},activeFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},movableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},closeButtonFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},expandedFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},allowedDockAreas:{defaultValue:WUXDockAreaEnum.NoneDockArea,type:"integer",category:"Behavior"},currentDockArea:{defaultValue:WUXDockAreaEnum.NoneDockArea,type:"integer",category:"Behavior",advancedSetter:!0},windowGroup:{defaultValue:null,type:"object",category:"Behavior"},activeSnapArea:{defaultValue:v.NoneArea,type:"integer",category:"Behavior"},resizableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},width:{defaultValue:-1,type:"integer",category:"Appearance",advancedSetter:!0},height:{defaultValue:-1,type:"integer",category:"Appearance",advancedSetter:!0},minWidth:{defaultValue:150,defaultTouchValue:200,advancedSetter:!0,type:"integer",category:"Appearance"},minHeight:{defaultValue:0,type:"integer",category:"Appearance"},maximizedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowMaximizeFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},maximizeButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},horizontallyStretchableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},verticallyStretchableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},autoCloseFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},titleBarVisibleFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},usePaddingFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},ensureHeightDefinitionOnHierarchy:{defaultValue:!1,type:"boolean",category:"Behavior"},activateButtonsIfActionPerformed:{defaultValue:!0,type:"boolean",category:"Behavior"},buttons:{defaultValue:{},type:"object",category:"Behavior"},touchMode:{defaultValue:void 0,type:"boolean",category:"Accessibility",advancedSetter:!0},onContextualEvent:{defaultValue:function(e){return this._buildOrDelagateContextualMenu(e)},type:"function"},getDefaultFocusableWidget:{defaultValue:void 0,type:"function",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_floatLayer:{defaultValue:void 0,type:"string",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this._savedPreferencesKeys=["position","dimension","dockedDimensions","dockArea","maximizedFlag"],this._titleBarCenteredFlag=!1,this._buttonsVisibleFlag=!0,e.prototype.init.apply(this,t)},t.prototype.buildView=function(){this._defaultButton=null,this.defaultButton=null,this._escapeButton=null,this._prefRestorationState=WUXPreferenceRestorationStateEnum.NotRestored,this.elements.container.addClassName("wux-windows-window wux-element-contentbox"),this.elements.container.id=i.Utils.getUUID(),this.elements._titleBarDiv=new i.Element("div",{class:"wux-windows-window-titlebar wux-element-contentbox"}),this.elements._titleBarDiv.inject(this.elements.container),this.elements._titleDiv=new i.Element("div",{class:"wux-windows-window-header-title"}).inject(this.elements._titleBarDiv),this.elements.iconPlaceholder=new i.Element("div",{class:"wux-window-icon-placeholder"}).inject(this.elements._titleDiv),this.elements._titleP=new i.Element("p",{text:this.title}),this.elements._titleP.inject(this.elements._titleDiv),this.elements._titlebarButtonsDiv=new i.Element("div",{class:"wux-windows-window-header-buttons-div"}),this.elements._titlebarButtonsDiv.inject(this.elements._titleBarDiv),this.elements._mainCollapsibleContainer=new i.Element("div",{class:"wux-windows-window-mask-content"}),this.elements._mainCollapsibleContainer.inject(this.elements.container),this.elements._mainContentDiv=new i.Element("div",{class:"wux-windows-window-maincontent wux-element-contentbox"}),this.elements._mainContentDiv.inject(this.elements._mainCollapsibleContainer),this.elements._headerDiv=new i.Element("div",{class:"wux-windows-window-header wux-element-contentbox"}),this.elements._headerDiv.inject(this.elements._mainContentDiv),this.elements._contentDiv=new i.Element("div",{class:"wux-windows-window-content wux-element-contentbox"}),this.elements._contentDiv.inject(this.elements._mainContentDiv),this.elements._ghostFloatableElement=new i.Element("div",{class:"wux-windows-window-ghost-floatable-element"}),this.elements._topResizeHandler=new i.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-top wux-windows-window-resize-handler-side"}),this.elements._topResizeHandler.inject(this.elements.container),this.elements._topRightResizeHandler=new i.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-top-right wux-windows-window-resize-handler-corner"}),this.elements._topRightResizeHandler.inject(this.elements.container),this.elements._rightResizeHandler=new i.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-right wux-windows-window-resize-handler-side"}),this.elements._rightResizeHandler.inject(this.elements.container),this.elements._bottomRightResizeHandler=new i.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-bottom-right wux-windows-window-resize-handler-corner"}),this.elements._bottomRightResizeHandler.inject(this.elements.container),this.elements._bottomResizeHandler=new i.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-bottom wux-windows-window-resize-handler-side"}),this.elements._bottomResizeHandler.inject(this.elements.container),this.elements._bottomLeftResizeHandler=new i.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-bottom-left wux-windows-window-resize-handler-corner"}),this.elements._bottomLeftResizeHandler.inject(this.elements.container),this.elements._leftResizeHandler=new i.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-left wux-windows-window-resize-handler-side"}),this.elements._leftResizeHandler.inject(this.elements.container),this.elements._topLeftResizeHandler=new i.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-top-left wux-windows-window-resize-handler-corner"}),this.elements._topLeftResizeHandler.inject(this.elements.container),this.elements._topSnapAreaDiv=new i.Element("div",{class:"wux-windows-window-snap-area wux-windows-window-snap-area-top"}),this.elements._topSnapAreaDiv.inject(this.elements.container),this.elements._bottomSnapAreaDiv=new i.Element("div",{class:"wux-windows-window-snap-area wux-windows-window-snap-area-bottom"}),this.elements._bottomSnapAreaDiv.inject(this.elements.container),this.elements._leftSnapAreaDiv=new i.Element("div",{class:"wux-windows-window-snap-area wux-windows-window-snap-area-left"}),this.elements._leftSnapAreaDiv.inject(this.elements.container),this.elements._rightSnapAreaDiv=new i.Element("div",{class:"wux-windows-window-snap-area wux-windows-window-snap-area-right"}),this.elements._rightSnapAreaDiv.inject(this.elements.container),this.elements._insideSnapAreaDiv=new i.Element("div",{class:"wux-windows-window-snap-area wux-windows-window-snap-area-inside"}),this.elements._insideSnapAreaDiv.inject(this.elements._titleBarDiv)},t.prototype._postBuildView=function(){e.prototype._postBuildView.call(this),this._updateContentVisibleStateChange();var t=this;l.onNodeRendered(this.getContent(),function(){t._isRendered=!0,t&&t.elements&&t.elements.container&&(t._applyHeight(),t._updateTitleMaxWidth(),t._applyPosition(),!0===t.activeFlag&&t._setFocus())}),this._manageContextualMenu()},t.prototype._manageContextualMenu=function(){if(void 0===this._ctxMenuToken){this._launchWebUXContextMenu=!1;var e=this,t=function(t){if(!e._launchWebUXContextMenu){var i=t.offsetX,n=t.offsetY;e._activateWindowForContextMenu(t.target),e._launchWebUXContextMenu=!0;var o=document.createEvent("HTMLEvents");o.initEvent("contextmenu",!0,!1),o.pageX=t.target.getOffsets().x+i,o.pageY=t.target.getOffsets().y+n,t.target.dispatchEvent(o),e._launchWebUXContextMenu=!1}};if(h.isMobileiOS()){var i,o=function(){window.getSelection&&window.getSelection()?(window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges(),window.getSelection().empty&&window.getSelection().empty()):document.selection&&document.selection.empty&&document.selection.empty()};l.addEventOnElement(this,this.elements._titleBarDiv,"DSlonghold",function(e){s.hide(),t(e),i=setInterval(o,500)}),l.addEventOnElement(this,this.elements._titleBarDiv,n.POINTERUP,function(e){setTimeout(function(){clearInterval(i)},1e3)})}this._ctxMenuToken=w.addEventListener(this.elements._titleBarDiv,{callback:function(t){var i=[];return e._launchWebUXContextMenu?i=e.onContextualEvent.call(e,{context:t.context,window:e,infos:t.info,data:t.data}):i}}),l.addEventOnElement(this,this.elements._titleBarDiv,"contextmenu",function(e){t(e)})}},t.prototype._activateWindowForContextMenu=function(e){this.activeFlag=!0},t.prototype._buildOrDelagateContextualMenu=function(e){var t=[],i=e.window;return e&&i&&(t=i.buildDefaultContextualMenu(e)),t},t.prototype.buildDefaultContextualMenu=function(e,t){this._supportedMenus=["close","maximize"];t=i.extend({close:!0,maximize:!0},t);var n=this,o=[];return this._supportedMenus.forEach(function(i){if(!0===t[i]){var s=i.substring(0,1).toUpperCase()+i.substring(1,i.length),a=n["_create"+s+"ContextualMenu"](e);o=o.concat(a)}}),o},t.prototype._createCloseContextualMenu=function(e){var t=this,i=[],n=t._getMenuToAddData("close",e);return n.canbeAdded&&i.push({type:"PushItem",title:n.closeAll?_.get("closeAllContextualMenu"):_.get("close"),icon:{iconName:"close",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{callback:function(e){t._onCloseContextMenuAction(e.context)},context:n.menuTarget}}),i},t.prototype._createMaximizeContextualMenu=function(e){var t=this,i=[],n=this._getMenuToAddData("maximize",e),o=!!this.maximizedFlag;return n.canbeAdded&&i.push({type:"PushItem",title:o?_.get("restore"):_.get("maximize"),icon:{iconName:o?"resize-small":"resize-full",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{callback:function(e){t.maximizedFlag=!o}}}),i},t.prototype._getMenuToAddData=function(e,t){var i=!1;return"close"===e?i=this.closeButtonFlag:"maximize"===e&&(i=this.maximizeButtonFlag),{canbeAdded:i}},t.prototype._onCloseContextMenuAction=function(e){this.close()},t.prototype._applyTitle=function(e){this.elements._titleP.setText(this.title),this.title?this.elements._titleP.setStyle("padding-left",""):this.elements._titleP.setStyle("padding-left","0"),this.windowGroup&&this.windowGroup._updateTitle()},t.prototype._applyIdentifier=function(e){this.identifier?this.getContent().setAttribute("wux-identifier",this.identifier):this.getContent().removeAttribute("wux-identifier")},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this),!0===this._getCurrentTouchMode()?this.elements._titleBarDiv.setAttributeNode(document.createAttribute("touch-mode")):this.elements._titleBarDiv.removeAttribute("touch-mode"),this._postEditTouchMode()},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this.disabled?(this.elements.contentDisabler||(this.elements.contentDisabler=r.createContentDisablerDiv()),this.elements._mainCollapsibleContainer.appendChild(this.elements.contentDisabler)):this.elements.contentDisabler&&this.elements._mainCollapsibleContainer.removeChild(this.elements.contentDisabler)},t.prototype._postEditTouchMode=function(){var e=this._getCurrentTouchMode();this.windowGroup&&(this.windowGroup.touchMode=e),!0===e?this.minWidth===this.publishedProperties.minWidth.defaultValue&&(this.minWidth=this.publishedProperties.minWidth.defaultTouchValue):this.minWidth===this.publishedProperties.minWidth.defaultTouchValue&&(this.minWidth=this.publishedProperties.minWidth.defaultValue),this._applyWidth(),this._applyHeight(),this._applyPosition(),this._updateTitleMaxWidth()},t.prototype.getDefaultButtonLabel=function(e){var t;switch(e){case b.Ok.name:t=_.get("ok");break;case b.Open.name:t=_.get("open");break;case b.Save.name:t=_.get("save");break;case b.SaveAll.name:t=_.get("saveAll");break;case b.Yes.name:t=_.get("yes");break;case b.YesToAll.name:t=_.get("yesToAll");break;case b.Retry.name:t=_.get("retry");break;case b.Ignore.name:t=_.get("ignore");break;case b.Cancel.name:t=_.get("cancel");break;case b.Apply.name:t=_.get("apply");break;case b.Reset.name:t=_.get("reset");break;case b.RestoreDefaults.name:t=_.get("restoreDefaults");break;case b.Help.name:t=_.get("help");break;case b.No.name:t=_.get("no");break;case b.NoToAll.name:t=_.get("noToAll");break;case b.Abort.name:t=_.get("abort");break;case b.Discard.name:t=_.get("discard");break;case b.Close.name:t=_.get("close")}return t},t.prototype._applyIcon=function(e){if("object"==typeof this.icon)this.icon.iconClasses||(this.icon.iconClasses=""),this.icon.iconName||(this.icon.iconName=""),void 0===this.icon.fontIconFamily&&(this.icon.fontIconFamily=WUXManagedFontIcons.Font3DS),this.icon.fontIconSize||(this.icon.fontIconSize="1x");else if("string"==typeof this.icon&&""!==this.icon&&!l.isAPath(this.icon)){var t={iconName:this.icon};this.icon=t}(function(){this.elements.icon&&(this.elements.icon.remove(this.elements.iconPlaceholder),delete this.elements.icon);var e=l.generateIcon(this.icon);e?(this.elements.icon=e,this.elements.iconPlaceholder.show(),this.elements.icon.style.margin="0px",this.elements.icon.inject(this.elements.iconPlaceholder)):this.elements.iconPlaceholder.hide()}).call(this),this.icon?(this.elements.iconPlaceholder.setStyle("padding-left",""),this.elements.iconPlaceholder.setStyle("padding-right","")):(this.elements.iconPlaceholder.setStyle("padding-left","0"),this.elements.iconPlaceholder.setStyle("padding-right","0")),this.windowGroup&&this.windowGroup._updateTitle()},t.prototype._applyHeader=function(e){this.elements._headerDiv.setContent(this.header),this.header?this.elements._headerDiv.show():this.elements._headerDiv.hide(),this._applyPosition()},t.prototype._applyContent=function(e){this.elements._contentDiv.setContent(this.content),this._applyPosition()},t.prototype._applyPosition=function(e){if(this.position){var t=!1;if(!(this.getEmbeddedState()||this.maximizedFlag&&this.allowMaximizeFlag)){var i=this._getCompletePosition();i&&(t=r.setPosition(this,i))}this._isRendered?this._visibility||(this.fire("_preVisibilityChange"),this._visibility=!0,this.getContent().setStyle("visibility","visible"),this.fire("visibilityChange")):(this._visibility=!1,this.getContent().setStyle("visibility","hidden")),t&&this.fire("move")}else this.position={}},t.prototype._getCompletePosition=function(){var e=this._getDefaultPosition();return{my:this.position&&this.position.my?this.position.my:e.my,at:this.position&&this.position.at?this.position.at:e.at,of:this.position&&this.position.of?this.position.of:e.of,constraint:this.position&&this.position.constraint?this.position.constraint:e.constraint,offsetX:this.position&&void 0!==this.position.offsetX?this.position.offsetX:e.offsetX,offsetY:this.position&&void 0!==this.position.offsetY?this.position.offsetY:e.offsetY,collision:this.position&&this.position.collision?this.position.collision:e.collision}},t.prototype._applyActiveFlag=function(){this.windowGroup?this.activeFlag&&(this.windowGroup.activeFlag=this.activeFlag):this.activeFlag?f.getActiveWindow()!=this&&(f.setActiveWindow(this),this.bringToFront()):f.getActiveWindow()===this&&f.setActiveWindow(null),this.activeFlag?(this.fire("activate"),this._setFocus(this._lastFocusedWidget)):(this.fire("deactivate"),this._unsetFocus())},t.prototype._setFocus=function(e){var t=null;null!=e&&l.isElementInside(e,this.getContent())&&(t=e);var i=this.elements._contentDiv;if(this.visibleFlag){if(null==t&&null!=(t=g.getFocusedWidget(i)))return;if(null==t&&null==(t=this.getDefaultFocusableWidget?this.getDefaultFocusableWidget():g.FindFocusableInChildren(i,!0))&&(this._defaultButton&&(t=this._defaultButton.getContent()),null==t&&this._escapeButton&&(t=this._escapeButton.getContent())),t){if(c.getTouchMode()&&t instanceof HTMLInputElement)return;t.focus({preventScroll:!0})}this._lastFocusedWidget=t}},t.prototype._unsetFocus=function(){var e=this._lastFocusedWidget;e&&(e.blur(),null!=e.dsModel&&null!=e.dsModel&&e.dsModel._resetFocus())},t.prototype._applyCloseButtonFlag=function(e){if(this.closeButtonFlag){var t=this;this.elements._closeButton||(this.elements._closeButton=new i.Element("button",{type:"button",class:"wux-windows-window-header-button wux-windows-window-header-close wux-ui-3ds wux-ui-3ds-wrong"}),this.elements._closeButton.tooltipInfos=new p({owner:this.elements._closeButton,shortHelp:_.get("close")}),l.addEventOnElement(t,t.elements._closeButton,"click",function(e){e.stopPropagation(),t._onCloseButtonClick()})),this.elements._closeButton.inject(this.elements._titlebarButtonsDiv,"bottom")}else this.elements._closeButton&&this.elements._closeButton.remove();this.windowGroup&&this.windowGroup._updateCloseButtonFlag(),this._updateTitleMaxWidth()},t.prototype._applyExpandedFlag=function(e){var t=this;if(this.expandedFlag)l.addEventOnElement(this,this.elements._mainContentDiv,"transitionend",function e(i){i.target===t.elements._mainContentDiv&&(i.stopPropagation(),l.removeEventOnElement(t,t.elements._mainContentDiv,"transitionend",e),t._managePointerEvents())}),this.elements._mainContentDiv.removeClassName("wux-windows-window-maincontent-force-collapse"),this.getContent().removeAttribute("collapsed"),this.elements._mainContentDiv.setStyles({"margin-top":"0px"}),this.expandedFlag&&!e&&this.fire("expand");else if(!this.expandedFlag){if(this.getCollapsibleState()){l.addEventOnElement(this,this.elements._mainContentDiv,"transitionend",function e(i){i.target===t.elements._mainContentDiv&&(i.stopPropagation(),t.elements._mainContentDiv.addClassName("wux-windows-window-maincontent-force-collapse"),l.removeEventOnElement(t,t.elements._mainContentDiv,"transitionend",e),t._managePointerEvents())});var i=this.elements._mainContentDiv.getSize().height;this.elements._mainContentDiv.setStyles({"margin-top":"-"+i+"px"}),this.getContent().setAttributeNode(document.createAttribute("collapsed"))}else this.expandedFlag=!0;!this.expandedFlag&&e&&this.fire("collapse")}void 0!==e&&this.expandedFlag!==e&&this._updateContentVisibleStateChange()},t.prototype._applyVisibleFlag=function(t){if(e.prototype._applyVisibleFlag.call(this),this.activeFlag&&this._setFocus(),this._updateContentVisibleStateChange(),this.fire("visibleStateChange"),this.immersiveFrame&&this.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var i=this.immersiveFrame.getDockingElement(this.currentDockArea);i&&(i._updateFromContainedWindows(),i._updateContainedWindows()),this._managePointerEvents()}this.visibleFlag&&this._readWindowPreferences(),this.windowGroup&&this.windowGroup._setWindowVisibility(this),!1===t&&this.visibleFlag&&this._applyPosition()},t.prototype._applyMovableFlag=function(e){this.windowGroup&&this.windowGroup._updateMovableFlag()},t.prototype._applyEnsureHeightDefinitionOnHierarchy=function(e){this.ensureHeightDefinitionOnHierarchy?this.getContent().setAttribute("ensureheightdefinitiononhierarchy",""):this.getContent().removeAttribute("ensureheightdefinitiononhierarchy")},t.prototype._applyButtons=function(e){if(null!=this.elements._buttonsDiv)for(;this.elements._buttonsDiv.childNodes.length>0;){if(!((o=this.elements._buttonsDiv.childNodes[0])&&o.dsModel instanceof m))break;o.remove()}if(this._defaultButton=null,this.defaultButton=null,this._escapeButton=null,this.elements._headerPopup&&(void 0===this.elements._panelButtonsDiv&&(this.elements._panelButtonsDiv=new i.Element("div",{class:"wux-windows-expander-buttons"})),this.elements._panelButtonsDiv.inject(this.elements._buttonsDiv)),this.buttons){var t=Object.keys(this.buttons);t.sort(function(e,t){return b[e]&&b[t]?b[e].value-b[t].value:e-t});for(var n=0;n<t.length;n++){var o,s=t[n];if(s&&b[s]){if(o=this.buttons[s]){var a=b[s].role;a===k.AcceptRole||a===k.YesRole?this._defaultButton||(this._defaultButton=o,this.defaultButton=o):a!==k.RejectRole&&a!==k.NoRole||this._escapeButton||(this._escapeButton=o),o.value=s,o.dialog=this,null!=this.elements._buttonsDiv&&(this.elements._headerPopup&&this.elements._panelButtonsDiv?o.inject(this.elements._panelButtonsDiv):o.inject(this.elements._buttonsDiv))}}else console.log('Error in Window : "'+s+'" is not a valid standard button')}}this._applyPosition()},t.prototype._apply_floatLayer=function(e){this.getContent().removeAttribute("bottom-layer"),this.getContent().removeAttribute("top-layer"),"bottom"===this._floatLayer?this.getContent().setAttributeNode(document.createAttribute("bottom-layer")):"top"===this._floatLayer&&this.getContent().setAttributeNode(document.createAttribute("top-layer"))},t.prototype.getEmbeddedState=function(){return Boolean(null!==this.getContent().getAttribute("docked")||this.windowGroup)},t.prototype.getCollapsibleState=function(){return!1},t.prototype.getFloatableState=function(){return!0},t.prototype.getMovableState=function(){return this.movableFlag},t.prototype.getContentVisibleState=function(){var e=this.visibleFlag&&this.expandedFlag;if(this.windowGroup){e=e&&this.windowGroup.getContentVisibleState();var t=this.windowGroup.currentWindows;null!=t&&0!==t.length&&-1===t.indexOf(this)&&(e=!1)}if(this.getDockedFlag()&&this.immersiveFrame){var i=this.immersiveFrame.getDockingElement(this.currentDockArea);i&&(e=e&&!i.collapseDockingZoneFlag&&i.visibleDockingZoneFlag)}return e},t.prototype._updateContentVisibleStateChange=function(){var e=this.getContentVisibleState();this.contentVisibleState!==e&&(this.contentVisibleState=e,this.fire("contentVisibleStateChange",{contentVisibleState:this.contentVisibleState}))},t.prototype.getResizableFlag=function(){return this.resizableFlag},t.prototype._updateFromEmbeddedState=function(){this.getEmbeddedState()?this.getContent().setAttributeNode(document.createAttribute("embedded")):this.getContent().removeAttribute("embedded"),this._updateContentHeight()},t.prototype._updateFromCollapsibleState=function(){!this.getCollapsibleState()||!this.allowMaximizeFlag&&this.maximizedFlag?(this.getContent().removeAttribute("collapsible"),this.expandedFlag=!0):this.getContent().setAttributeNode(document.createAttribute("collapsible"))},t.prototype._preEditCurrentDockArea=function(e,t){return(t===WUXDockAreaEnum.NoneDockArea||t===WUXDockAreaEnum.TopDockArea||t===WUXDockAreaEnum.BottomDockArea||t===WUXDockAreaEnum.LeftDockArea||t===WUXDockAreaEnum.RightDockArea)&&(!!(this.allowedDockAreas&t||t===WUXDockAreaEnum.NoneDockArea)&&!(t===WUXDockAreaEnum.NoneDockArea&&!this.getFloatableState()))},t.prototype._applyCurrentDockArea=function(e){null===this.immersiveFrame||void 0===this.immersiveFrame||this._isBeingClosed||(this.currentDockArea===WUXDockAreaEnum.NoneDockArea?(this.currentDockArea!==e&&this.fire("prePlaceChange",{previousPlace:{currentDockArea:e}}),this.windowGroup&&this.windowGroup.currentDockArea===this.currentDockArea||(this.windowGroup=null,e&&(this.immersiveFrame.undockWindow(this),this._updateAllWindowsPreferencesInOldDockingElement(e),this.activeFlag&&this.bringToFront())),this.getContent().removeAttribute("docked"),C.call(this,e)):(this.windowGroup&&this.windowGroup.currentDockArea!==this.currentDockArea&&(this.windowGroup=null),this.windowGroup||this._visibility||-1!==this.width&&(this.currentDockArea===WUXDockAreaEnum.LeftDockArea||this.currentDockArea===WUXDockAreaEnum.RightDockArea)||-1!==this.height&&(this.currentDockArea===WUXDockAreaEnum.TopDockArea||this.currentDockArea===WUXDockAreaEnum.BottomDockArea)?E.call(this,e):(this.addEventListener("_preVisibilityChange",E.bind(this,e),{once:!0}),this._moveToImmersiveFrame())))},t.prototype._managePointerEvents=function(){this.immersiveFrame&&this.currentDockArea!==WUXDockAreaEnum.NoneDockArea&&this.immersiveFrame.getDockingElement(this.currentDockArea).pointerEventsAllIfOverflow()},t.prototype._applyImmersiveFrame=function(e){void 0!==e&&this.immersiveFrame!==e&&this.fire("prePlaceChange",{previousPlace:{immersiveFrame:e}}),e&&e.removeWindow(this),this.immersiveFrame&&(this.immersiveFrame.addWindow(this),this._readWindowPreferences(),this.activeFlag&&this.bringToFront(),this._properties.currentDockArea.dirty=!1,this._applyCurrentDockArea(),this.maximizedFlag&&(this._properties.maximizedFlag.dirty=!1,this._applyMaximizedFlag()),this._updateMaxWidth(),this._updateMaxHeight(),this._applyHeight()),void 0!==e&&this.immersiveFrame!==e&&this.fire("placeChange")},t.prototype._applyWindowGroup=function(e){if(void 0!==e&&this.windowGroup!==e&&this.fire("prePlaceChange",{previousPlace:{windowGroup:e}}),e&&(e.detachWindow(this),e._updateAllowedDockAreas()),this.windowGroup){if(!this.windowGroup.containsWindow(this)){var t=null,i=this.windowGroup.getEmbeddedWindows();i&&(t=i[i.length-1]),this.windowGroup.attachWindow(this,t,v.InsideArea)}var n=document.createAttribute("attached-to-group");switch(this.windowGroup.groupType){case D.GroupAsGrid:n.value="grid";break;case D.GroupAsTab:n.value="tab"}this.getContent().setAttributeNode(n),this.windowGroup._updateAllowedDockAreas()}else this.getContent().removeAttribute("attached-to-group");this._updateFromEmbeddedState(),void 0!==e&&this.windowGroup!==e&&(this._updateContentVisibleStateChange(),this.fire("placeChange"))},t.prototype._applyActiveSnapArea=function(e){if(this.activeSnapArea===v.NoneArea||this.activeSnapArea===v.OutsideArea)this.getContent().removeAttribute("active-snap-area"),this.elements._titleBarDiv.removeAttribute("active-snap-area");else{var t=document.createAttribute("active-snap-area");switch(this.activeSnapArea){case v.TopArea:t.value="top";break;case v.BottomArea:t.value="bottom";break;case v.LeftArea:t.value="left";break;case v.RightArea:t.value="right";break;case v.InsideArea:t.value="inside";var i=document.createAttribute("active-snap-area");i.value="inside",this.elements._titleBarDiv.setAttributeNode(i)}this.getContent().setAttributeNode(t)}},t.prototype._applyResizableFlag=function(e){!0===this.resizableFlag?(this.getContent().addClassName("wux-windows-window-vertically-resizable"),this.getContent().addClassName("wux-windows-window-horizontally-resizable")):"vertical"===this.resizableFlag?(this.getContent().addClassName("wux-windows-window-vertically-resizable"),this.getContent().removeClassName("wux-windows-window-horizontally-resizable")):"horizontal"===this.resizableFlag?(this.getContent().addClassName("wux-windows-window-horizontally-resizable"),this.getContent().removeClassName("wux-windows-window-vertically-resizable")):(this.getContent().removeClassName("wux-windows-window-vertically-resizable"),this.getContent().removeClassName("wux-windows-window-horizontally-resizable"))},t.prototype._preEditMinWidth=function(e,t){return null!=t&&!isNaN(t)},t.prototype._applyMinWidth=function(e){this._applyWidth(),this.windowGroup&&this.windowGroup._updateMinWidth(),!this.immersiveFrame||this.currentDockArea!==WUXDockAreaEnum.LeftDockArea&&this.currentDockArea!==WUXDockAreaEnum.RightDockArea||this.immersiveFrame.getDockingElement(this.currentDockArea)._updateFromContainedWindows()},t.prototype._updateMinWidth=function(){if(!this.windowGroup)if(!this.immersiveFrame||!this.immersiveFrame._ActionBar_V3||this.currentDockArea!==WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==WUXDockAreaEnum.BottomDockArea||this.maximizedFlag)this._floatingMinWidth&&(this.minWidth=this._floatingMinWidth);else{var e=this.elements._titleDiv,t=window.getComputedStyle(e,null),i=parseInt(t.borderLeft.slice(0,-2)),n=parseInt(t.borderRight.slice(0,-2)),o=parseInt(t.paddingLeft.slice(0,-2)),s=parseInt(t.paddingRight.slice(0,-2)),a=l.computeStringWidth(this.title,parseInt(t.fontSize),t.fontFamily)+o+s+i+n+this._getDragZoneWidth()+3;a>this.minWidth&&(this._floatingMinWidth=this.minWidth,this.minWidth=a)}},t.prototype._preEditWidth=function(e,t){var i=this.minWidth;return!(-1!==t&&void 0!==i&&t<i)||((-1===e||e>i)&&(this.width=i),!1)},t.prototype._applyWidth=function(e){this._updateMaxWidth();var t=this.width;if(t&&-1!==t)t<this.minWidth&&(t=this.minWidth);else if(this.elements.container&&this.getContent().parentNode){var i=window.getComputedStyle(this.getContent());i&&Math.round(parseInt(i.width))<t&&(t=this.minWidth)}-1===t?(this.getContent().setStyle("width","auto"),this.elements._mainContentDiv.setStyle("width","auto"),this.elements._footerDiv&&this.elements._footerDiv.setStyle("width","100%")):(this.elements._mainContentDiv.setStyle("width",t+"px"),this.currentDockArea===WUXDockAreaEnum.NoneDockArea||this.currentDockArea===WUXDockAreaEnum.TopDockArea||this.currentDockArea===WUXDockAreaEnum.BottomDockArea?this.elements._footerDiv&&this.elements._footerDiv.setStyle("width",t+"px"):this.elements._footerDiv&&this.elements._footerDiv.setStyle("width","100%")),null!==this.header&&this._updateContentHeight(),void 0!==e&&t!==e&&this._fireAndBroadcast("resize",{bubbles:!1}),this.immersiveFrame&&this.immersiveFrame._updateAllDockingZoneSize(),this.windowGroup&&this.windowGroup.width!==t&&this.windowGroup._updateWidthAndHeight(),this._updateTitleBarWidth()},t.prototype._updateTitleBarWidth=function(){if(this.currentDockArea===WUXDockAreaEnum.TopDockArea&&this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&1===this.immersiveFrame.getDockingElement(WUXDockAreaEnum.TopDockArea).getContainedVisibleWindows().length){var e=-1!==this.width?this.width:Math.round(parseFloat(window.getComputedStyle(this.elements._mainContentDiv).width)),t=Math.round(parseFloat(window.getComputedStyle(this.immersiveFrame.getDockingElement(WUXDockAreaEnum.TopDockArea).elements.dockingZone).width));e>t&&(e=t),e=Math.round(e),this.elements._titleBarDiv.setStyle("width",e+"px")}else this.elements._titleBarDiv.setStyle("width","");this.elements._titleDiv.scrollWidth>this.elements._titleDiv.clientWidth?(this.elements._titleDiv.setAttributeNode(document.createAttribute("overflow")),this.elements._titleDiv.tooltipInfos=new p({shortHelp:this.title,owner:this.elements._titleDiv})):(this.elements._titleDiv.removeAttribute("overflow"),this.elements._titleDiv.tooltipInfos=void 0)},t.prototype._getDragZoneWidth=function(){return this._titleBarCenteredFlag?0:(this._getCurrentTouchMode()?36:22)+this.elements._titlebarButtonsDiv.clientWidth},t.prototype._updateTitleMaxWidth=function(){var e=0;this._titleBarCenteredFlag||(e=(this._getCurrentTouchMode()?36:24)+this.elements._titlebarButtonsDiv.clientWidth);this.elements._titleDiv.setStyle("max-width","calc(100% - "+e+"px)")},t.prototype._preEditHeight=function(e,t){if(null!=t&&-1!==t)if(t>=this.minHeight||!this.minHeight){var i=this._getFixedContentHeight();if(t<i)return this.height=i,!1}else if(this.minHeight&&t<this.minHeight)return this.height=this.minHeight,!1;return!0},t.prototype._applyHeight=function(e){this._updateMaxHeight(),null!==this.height&&void 0!==this.height&&(-1===this.height?this.elements._mainContentDiv.setStyle("height",""):this.elements._mainContentDiv.setStyle("height",this.height+"px"),this._updateContentHeight(),void 0!==e&&this.height!==e&&this._fireAndBroadcast("resize",{bubbles:!1})),this.immersiveFrame&&this.immersiveFrame._updateAllDockingZoneSize(),this._applyMinHeight(),this.windowGroup&&this.windowGroup._updateWidthAndHeight()},t.prototype.getMaxWidth=function(){return this.immersiveFrame.getContent().clientWidth-2},t.prototype.getMaxHeight=function(){return this.immersiveFrame.getContent().clientHeight-2},t.prototype._computeDropInsertionData=function(e){var t="after",i=this.immersiveFrame._snapTargetWindow;if(!e)return{targetWindow:i,beforeOrAfter:t};var n=this._getTitleWidth(),o=this.elements._titleDiv.getBoundingClientRect();return{targetWindow:i,beforeOrAfter:t=e.x<o.x+n/2?"before":"after"}},t.prototype._updateMaxWidth=function(){if(this.immersiveFrame&&this.immersiveFrame.elements&&this.immersiveFrame.elements.container&&this.immersiveFrame.getContent().clientWidth>0)if(this.currentDockArea!==WUXDockAreaEnum.NoneDockArea||this.windowGroup)this._titleBarCenteredFlag&&this.isAWindowGroup()&&this._updateMaxTabbarWidth(),this.getContent().setStyle("maxWidth",""),this.elements._titleBarDiv.setStyle("maxWidth",""),this.elements._mainContentDiv.setStyle("maxWidth",""),this.elements._footerDiv&&this.elements._footerDiv.setStyle("maxWidth","");else{var e=this.getMaxWidth();this.getContent().setStyle("maxWidth",e+"px"),this.elements._titleBarDiv.setStyle("maxWidth",e-2+"px"),this.elements._mainContentDiv.setStyle("maxWidth",e-2+"px"),this.elements._footerDiv&&this.elements._footerDiv.setStyle("maxWidth",e-2+"px")}},t.prototype._updateMaxTabbarWidth=function(){},t.prototype._updateMaxHeight=function(){if(this.immersiveFrame&&this.immersiveFrame.elements&&this.immersiveFrame.elements.container&&this.immersiveFrame.getContent().clientHeight>0)if(this.currentDockArea!==WUXDockAreaEnum.NoneDockArea||this.windowGroup)this.getContent().setStyle("maxHeight",""),this.elements._contentDiv.setStyle("maxHeight",""),this.elements._mainContentDiv.setStyle("maxHeight","");else{var e=this.getMaxHeight();this.getContent().setStyle("maxHeight",e+"px");var t=this._getTitleBarHeight(),i=this._getFixedContentHeight();this.elements._mainContentDiv.setStyle("maxHeight",e-t+"px"),this.elements._contentDiv.setStyle("maxHeight",e-t-i+"px")}},t.prototype._getFixedContentHeight=function(){var e=this.header?this.elements._headerDiv.offsetHeight:0,t=this.elements._footerDiv?this.elements._footerDiv.offsetHeight:this.elements._buttonsDiv?this.elements._buttonsDiv.offsetHeight:0,i=window.getComputedStyle(this.elements._contentDiv);return e+t+((i?parseInt(i.getPropertyValue("padding-top"),10):0)+(i?parseInt(i.getPropertyValue("padding-bottom"),10):0))},t.prototype._updateContentHeight=function(){var e=this._getFixedContentHeight(),t=this.currentDockArea;if(this.maximizedFlag&&!this.windowGroup&&this.allowMaximizeFlag||this.maximizedFlag&&this.windowGroup&&this.windowGroup.allowMaximizeFlag||t==WUXDockAreaEnum.TopDockArea||t==WUXDockAreaEnum.BottomDockArea||this.verticallyStretchableFlag&&(t==WUXDockAreaEnum.RightDockArea||t==WUXDockAreaEnum.LeftDockArea)){var i=0;this.elements._titleBarDiv.getParent()===this.elements.container&&(i=this._getTitleBarHeight()),0===i?this.elements._mainCollapsibleContainer.setStyle("height","100%"):this.elements._mainCollapsibleContainer.setStyle("height","calc(100% - "+i+"px)"),this.elements._contentDiv.setStyle("height","calc(100% - "+e+"px)")}else this.elements._mainCollapsibleContainer.setStyle("height",""),-1==this.height?this.elements._contentDiv.setStyle("height","auto"):this.elements._contentDiv.setStyle("height",this.height-e+"px")},t.prototype._applyMinHeight=function(e){var t=this.minHeight;this.height&&-1!==this.height&&this.height<t&&(this.height=t);var i=this._getFixedContentHeight();void 0!==t?this.elements._contentDiv.setStyle("min-height",t-i+"px"):this.elements._contentDiv.setStyle("min-height",""),this.windowGroup&&this.windowGroup._updateMinHeight(),!this.immersiveFrame||this.currentDockArea!==WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==WUXDockAreaEnum.BottomDockArea||this.immersiveFrame.getDockingElement(this.currentDockArea)._updateFromContainedWindows()},t.prototype._applyMaximizedFlag=function(e){if(this.immersiveFrame){if(this._updateFromCollapsibleState(),void 0!==e&&this.maximizedFlag!==e&&this.fire("prePlaceChange",{previousPlace:{maximizedFlag:e}}),this.maximizedFlag&&this.allowMaximizeFlag){var t=document.createAttribute("maximized");this.getContent().setAttributeNode(t),this.windowGroup?this.windowGroup.maximizedFlag=!0:this.immersiveFrame.moveWindowToMaximizeZone(this),this._updateMaximizeButtonIcon()}else if(!0===e){if(this.getContent().removeAttribute("maximized"),this.windowGroup&&this.windowGroup.maximizedFlag!==this.maximizedFlag&&(this.windowGroup=null),this.getDockedFlag()||this.windowGroup||this.currentDockArea!==WUXDockAreaEnum.NoneDockArea){if(!this.windowGroup&&this.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var i=this.currentDockArea;this.currentDockArea=WUXDockAreaEnum.NoneDockArea,this.immersiveFrame.dockWindow(this,i,{restoreDockedDimensions:!0})}}else this._moveToImmersiveFrame(),this.bringToFront();this._updateMaximizeButtonIcon()}this._updateContentHeight(),void 0!==e&&this.maximizedFlag!==e&&(this._updateContentVisibleStateChange(),this.fire("placeChange"),this._fireAndBroadcast("resize,",{bubbles:!1}))}},t.prototype._applyAllowMaximizeFlag=function(e){this.allowMaximizeFlag||(this.maximizedFlag=!1),this._applyMaximizeButtonFlag(),this.windowGroup&&this.windowGroup._updateAllowedDockAreas(),this._updateTitleMaxWidth()},t.prototype._updateMaximizeButtonIcon=function(){this.elements._maximizeButton&&(this.maximizedFlag?(this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-small"),this.elements._maximizeButton.removeClassName("wux-ui-3ds-resize-full"),this.elements._maximizeButton.tooltipInfos.shortHelp=_.get("restore")):(this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-full"),this.elements._maximizeButton.removeClassName("wux-ui-3ds-resize-small"),this.elements._maximizeButton.tooltipInfos.shortHelp=_.get("maximize")))},t.prototype._applyMaximizeButtonFlag=function(e){if(this.maximizeButtonFlag&&this.allowMaximizeFlag){if(!this.elements._maximizeButton){var t=this;this.elements._maximizeButton=new i.Element("button",{type:"button",class:"wux-windows-window-header-button wux-windows-window-header-maximize wux-ui-3ds"}),this.elements._maximizeButton.tooltipInfos=new p({owner:this.elements._maximizeButton,shortHelp:_.get("maximize")}),this._updateMaximizeButtonIcon(),l.addEventOnElement(t,t.elements._maximizeButton,"click",function(e){e.stopPropagation(),t._onMaximizeButtonClick(),t._saveMaximizeInPreferences()})}this.elements._maximizeButton.inject(this.elements._titlebarButtonsDiv,"top")}else this.elements._maximizeButton&&this.elements._maximizeButton.remove();this.windowGroup&&this.windowGroup._updateMaximizeButtonFlag(),this._updateTitleMaxWidth()},t.prototype._applyHorizontallyStretchableFlag=function(e){if(this.horizontallyStretchableFlag?(this.getContent().addClassName("wux-windows-window-horizontally-stretchable"),this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&this.elements._titleBarDiv.addClassName("wux-windows-window-horizontally-stretchable")):(this.getContent().removeClassName("wux-windows-window-horizontally-stretchable"),this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&this.elements._titleBarDiv.removeClassName("wux-windows-window-horizontally-stretchable")),this._applyResizableFlag(),this._managePointerEvents(),this.windowGroup&&this.windowGroup._updateHorizontallyStretchableFlag(),this.immersiveFrame){var t=this.currentDockArea;if(t===WUXDockAreaEnum.TopDockArea||t===WUXDockAreaEnum.BottomDockArea){var i=this.immersiveFrame.getDockingElement(t);i&&i._updateFitToChildState()}}this._updateTitleBarWidth()},t.prototype._applyVerticallyStretchableFlag=function(e){this.verticallyStretchableFlag?this.getContent().addClassName("wux-windows-window-vertically-stretchable"):this.getContent().removeClassName("wux-windows-window-vertically-stretchable"),this._applyResizableFlag(),this._updateContentHeight(),this._managePointerEvents(),this.windowGroup&&this.windowGroup._updateVerticallyStretchableFlag()},t.prototype._applyTitleBarVisibleFlag=function(e){this.elements._titleBarDiv&&(this.titleBarVisibleFlag?this.elements._titleBarDiv.removeClassName("wux-windows-unvisible"):this.elements._titleBarDiv.addClassName("wux-windows-unvisible"))},t.prototype._applyUsePaddingFlag=function(e){this.usePaddingFlag?this.getContent().removeAttribute("no-padding"):this.getContent().setAttributeNode(document.createAttribute("no-padding"))},t.prototype._applyAllowedDockAreas=function(e){if(this.windowGroup&&this.windowGroup._updateAllowedDockAreas(),!(this.getFloatableState()&&this.currentDockArea==WUXDockAreaEnum.NoneDockArea||this.currentDockArea&this.allowedDockAreas))for(var t in this.getFloatableState()&&(this.currentDockArea=WUXDockAreaEnum.NoneDockArea),WUXDockAreaEnum)if(WUXDockAreaEnum[t]!==WUXDockAreaEnum.NoneDockArea&&WUXDockAreaEnum[t]&this.allowedDockAreas){this.currentDockArea=WUXDockAreaEnum[t];break}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("identifier")&&this._applyIdentifier(t.identifier),this.isDirty("content")&&this._applyContent(t.content),this.isDirty("title")&&this._applyTitle(t.title),this.isDirty("_floatLayer")&&this._apply_floatLayer(t._floatLayer),this.isDirty("immersiveFrame")&&this._applyImmersiveFrame(t.immersiveFrame),this.isDirty("icon")&&this._applyIcon(t.icon),this.isDirty("header")&&this._applyHeader(t.header),this.isDirty("position")&&this._applyPosition(t.position),this.isDirty("activeFlag")&&this._applyActiveFlag(),this.isDirty("closeButtonFlag")&&this._applyCloseButtonFlag(),this.isDirty("currentDockArea")&&this._preEditCurrentDockArea(t.currentDockArea,this.currentDockArea)&&this._applyCurrentDockArea(t.currentDockArea),this.isDirty("windowGroup")&&this._applyWindowGroup(t.windowGroup),this.isDirty("activeSnapArea")&&this._applyActiveSnapArea(t.activeSnapArea),this.isDirty("resizableFlag")&&this._applyResizableFlag(t.resizableFlag),this.isDirty("width")&&this._preEditWidth(t.width,this.width)&&this._applyWidth(t.width),this.isDirty("height")&&this._preEditHeight(t.height,this.height)&&this._applyHeight(t.height),this.isDirty("minWidth")&&this._preEditMinWidth(t.minWidth,this.minWidth)&&this._applyMinWidth(t.minWidth),this.isDirty("minHeight")&&this._applyMinHeight(t.minHeight),this.isDirty("expandedFlag")&&this._applyExpandedFlag(t.expandedFlag),this.isDirty("maximizedFlag")&&this._applyMaximizedFlag(t.maximizedFlag),this.isDirty("horizontallyStretchableFlag")&&this._applyHorizontallyStretchableFlag(t.horizontallyStretchableFlag),this.isDirty("verticallyStretchableFlag")&&this._applyVerticallyStretchableFlag(t.verticallyStretchableFlag),this.isDirty("titleBarVisibleFlag")&&this._applyTitleBarVisibleFlag(t.titleBarVisibleFlag),this.isDirty("usePaddingFlag")&&this._applyUsePaddingFlag(t.usePaddingFlag),this.isDirty("buttons")&&this._applyButtons(t.buttons),this.isDirty("ensureHeightDefinitionOnHierarchy")&&this._applyEnsureHeightDefinitionOnHierarchy(),this.isDirty("touchMode")&&this._postEditTouchMode(),this.isDirty("visibleFlag")&&this._applyVisibleFlag(),this._applyMaximizeButtonFlag()},t.prototype._setTitleBarCenteredFlag=function(e){this._titleBarCenteredFlag!==e&&(this._titleBarCenteredFlag=e,this.elements._titleBarDiv&&(this._titleBarCenteredFlag?(this.elements._titleBarDiv.addClassName("wux-windows-window-titlebar-align-center"),this.elements.container.addClassName("wux-windows-window-align-center")):(this.elements._titleBarDiv.removeClassName("wux-windows-window-titlebar-align-center"),this.elements.container.removeClassName("wux-windows-window-align-center"))),this._updateTitleMaxWidth()),this._setButtonsVisibleFlag(!e)},t.prototype._moveTitleBar=function(e,t){if(this.elements._titleBarDiv){var i=this.elements._titleBarDiv.getParent();if(e&&t){var n=t._getFixedArea();n&&i!==n&&this.elements._titleBarDiv.inject(n)}else i!==this.elements.container&&this.elements._titleBarDiv.inject(this.elements.container,"top")}},t.prototype._setButtonsVisibleFlag=function(e){this._buttonsVisibleFlag!==e&&(this._buttonsVisibleFlag=e,this.elements._titlebarButtonsDiv&&(this._buttonsVisibleFlag?this.elements._titlebarButtonsDiv.removeClassName("wux-windows-unvisible"):this.elements._titlebarButtonsDiv.addClassName("wux-windows-unvisible")))},t.prototype.getAbsolutePosition=function(){return this.windowGroup&&this.windowGroup.groupType===D.GroupAsTab?this.windowGroup.getAbsolutePosition():this.elements&&this.elements.container?this.getContent().getPosition(document.body):void 0},t.prototype.setAbsolutePosition=function(e){if(e){var t=this.getOffsetParentPosition(),i=this.getOffsetParentMargins(),n={x:e.x-t.x-i.left,y:e.y-t.y-i.top},o=this._getReferencePosRelativeToOffsetParent();this.position.offsetX=n.x-o.x,this.position.offsetY=n.y-o.y,this._applyPosition()}},t.prototype.getOffsetParentPosition=function(){var e=this.getContent().getOffsetParent(),t={x:0,y:0};return e&&(t=e.getPosition(document.body)),t},t.prototype.getOffsetParentMargins=function(){var e=this.getContent().getOffsetParent(),t={left:0,right:0,top:0,bottom:0};if(e){var i=window.getComputedStyle(e);""===i.marginLeft?t.left=0:t.left=parseInt(i.marginLeft,10),""===i.marginRight?t.right=0:t.right=parseInt(i.marginRight,10),""===i.marginTop?t.top=0:t.top=parseInt(i.marginTop,10),""===i.marginBottom?t.bottom=0:t.bottom=parseInt(i.marginBottom,10)}return t},t.prototype.getPositionRelativeToOffsetParent=function(){if(this.elements&&this.elements.container){var e=this.getContent().getOffsetParent();return this.getContent().getPosition(e)}},t.prototype.close=function(){this._isBeingClosed=!0,this.fire("close"),this.autoCloseFlag&&this.destroy(),this._isBeingClosed=!1},t.prototype.destroy=function(){this._isBeingClosed=!0,this.windowGroup&&(this.windowGroup=null),f.getActiveWindow()===this&&f.setActiveWindow(null),this._ctxMenuToken&&w.removeEventListener(this.elements.container,this._ctxMenuToken),this.immersiveFrame=null,e.prototype.destroy.call(this),this._isBeingClosed=!1},t.prototype.getDockedFlag=function(){return this.currentDockArea!==WUXDockAreaEnum.NoneDockArea},t.prototype.getZIndex=function(){var e=parseInt(getComputedStyle(this.getContent()).zIndex);return isNaN(e)&&(e=-1),e},t.prototype.bringToFront=function(){this.windowGroup?this.windowGroup.bringToFront():f.bringToFront(this)},t.prototype.ensureVisible=function(){if(this.visibleFlag=!0,this.expandedFlag=!0,this.windowGroup){this.windowGroup.ensureVisible();var e=this.windowGroup.currentWindows;null!=e&&0!==e.length&&-1===e.indexOf(this)&&(this.windowGroup.currentWindows=[this])}if(this.getDockedFlag()&&this.immersiveFrame){var t=this.immersiveFrame.getDockingElement(this.currentDockArea);t&&(t.collapseDockingZoneFlag=!1)}var i=this.getContent();i&&(i.parentNode.scrollTop=i.offsetTop,i.parentNode.scrollLeft=i.offsetLeft)},t.prototype.getTitleBar=function(){return this.elements._titleBarDiv},t.prototype._getTitleBarHeight=function(){return this.elements._titleBarDiv.offsetHeight},t.prototype._getTitleWidth=function(){return this.elements._titleDiv.offsetWidth},t.prototype._ensureTitleBarUnderPointer=function(e){var t=this.getOffsetParentPosition(),i=this.getOffsetParentMargins(),n=this.getContent().getSize(),o=this._getTitleBarHeight(),s=this.getPositionRelativeToOffsetParent();(s.x+t.x+n.width<e.x||s.x+t.x>=e.x)&&(s.x=e.x-n.width/2-t.x-i.left),(s.y+t.y+o<e.y||s.y+t.y>=e.y)&&(s.y=e.y-o/2-t.y-i.top);var a=this._getReferencePosRelativeToOffsetParent();this.position.offsetX=s.x-a.x,this.position.offsetY=s.y-a.y,this._applyPosition(),this._initialPointerPosition&&(this._initialPointerPosition.x=e.x,this._initialPointerPosition.y=e.y),this._initialWindowOffset&&(this._initialWindowOffset.x=this.position.offsetX,this._initialWindowOffset.y=this.position.offsetY)},t.prototype._canBeSnapSource=function(e,t){return!1},t.prototype._canBeSnapTarget=function(e,t){return!1},t.prototype.getBoundingClientRect=function(){var e=this.getContent().getBoundingClientRect(),t={top:e.top,left:e.left,bottom:e.bottom,right:e.right,x:e.x,y:e.y,width:e.width,height:e.height},i=this.currentDockArea;if((i===WUXDockAreaEnum.BottomDockArea||i===WUXDockAreaEnum.TopDockArea)&&this.elements._titleBarDiv.getParent()!==this.elements.container){var n=this._getTitleBarHeight();t.top-=n,t.height+=n}return t},t.prototype._getSnapAreaRect=function(e){var t=this.getBoundingClientRect();switch(e){case v.OutsideArea:return t;case v.TopArea:return{left:t.left,top:t.top,width:t.width,height:10};case v.BottomArea:return{left:t.left,top:t.top+t.height-10,width:t.width,height:10};case v.LeftArea:return{left:t.left,top:t.top,width:10,height:t.height};case v.RightArea:return{left:t.left+t.width-10,top:t.top,width:10,height:t.height};case v.InsideArea:var i=this._getTitleBarHeight();return{left:t.left,top:t.top,width:t.width,height:i}}},t.prototype.isAWindowGroup=function(){return Boolean(this.getContent().hasClassName("wux-windows-windowgroup"))},t.prototype.attachToWindow=function(e,t,i){return this._attachToWindow(e,t,i,!1)},t.prototype._locateAndAttachToWindow=function(e,t,i){if(this.immersiveFrame){var n=e;if("["===e.charAt(0)){var o=e.split(";");n=(n=o[o.length-1]).substring(0,n.length-1)}var s=this.immersiveFrame._getWindowFromIdentifier(n);if(s)return this._attachToWindow(s,t,i,!0),!0}return!1},t.prototype._attachToWindow=function(e,t,i,n){var o=-1;if(this.elements&&this.elements.container){var s=this.isAWindowGroup();if(e&&!n){var a=this._getDetachedFromPreferences();if(e.windowGroup||e.isAWindowGroup())for(var r=(e.isAWindowGroup()?e:e.windowGroup).getEmbeddedWindows(),l=0;l<r.length;l++){var d=r[l];if(d&&-1!==a.indexOf(d.identifier))return-1}else if(-1!==a.indexOf(e.identifier))return-1}if(e&&t!==v.NoneArea&&t!==v.OutsideArea&&this._canBeSnapSource(e,t)&&e._canBeSnapTarget(this,t)){var h=t===v.InsideArea?D.GroupAsTab:D.GroupAsGrid,c=e.isAWindowGroup()?e:null;if((!c||c.groupType!==h)&&(c=e.windowGroup)&&c.groupType!==h){if(h===D.GroupAsGrid){var u=this.windowGroup;return u&&u===c?(u.detachWindow(this),o=this._attachToWindow(e,t,i,n),this._applyHeight(),this._applyWidth(),e._postEditTouchMode(),c._postEditTouchMode(),o):(o=this._attachToWindow(c,t,i,n),this._postEditTouchMode(),e._postEditTouchMode(),c._postEditTouchMode(),o)}c=null}if(c||(c=e._createWindowGroup(h))&&(c.immersiveFrame=e.immersiveFrame,c._stackWindowNextTo(e,null,v.NoneArea,i,n),e._postEditTouchMode(),c._postEditTouchMode()),c){if(e.isAWindowGroup()){var m=e.getEmbeddedWindows();e=m[m.length-1]}o=c._stackWindowNextTo(this,e,t,i,n);var p=!0,g=!1;for(l=0;l<c.getEmbeddedWindows().length;l++){var f=c.getEmbeddedWindows()[l];if(!1===f.allowMaximizeFlag){p=!1;break}!0===f.maximizeButtonFlag&&(g=!0)}c.maximizeButtonFlag=p&&g,c._postEditTouchMode()}o&&(!n||s&&0===this.getEmbeddedWindows().length||this._saveWindowGroupInPreferences())}}return o},t.prototype._moveToImmersiveFrame=function(){this.immersiveFrame&&this.immersiveFrame.moveWindowToImmersiveFrame(this)},t.prototype._getDefaultPosition=function(){return{my:"top left",at:"top left",of:this.immersiveFrame?this.immersiveFrame.getContent():document.body,constraint:this.immersiveFrame?this.immersiveFrame.getContent():document.body,offsetX:0,offsetY:0,collision:"fit"}},t.prototype._getReferencePosRelativeToOffsetParent=function(){var e=this._getCompletePosition();return e.offsetX=0,e.offsetY=0,r.getPositionRelativeToOffsetParent(this,e)},t.prototype._fireAndBroadcast=function(e,t){this.fire(e,t)},t.prototype._onDragPointerDown=function(e){if(this.getMovableState()){document.body.setAttributeNode(document.createAttribute("dragging"));var t=this;if(t._onDragPointerDownInfos={dimensions:{height:t.height,width:t.width},maximizedFlag:t.maximizedFlag},l.addEventOnElement(t,t,"close",function(e){l.removeEventOnElement(t,t.elements.container.ownerDocument,n.POINTERMOVE,r),l.removeEventOnElement(t,t.elements.container.ownerDocument,n.POINTERUP,d)}),!this.getFloatableState()){this.immersiveFrame&&this.elements._ghostFloatableElement.inject(this.immersiveFrame.elements.container),this.elements._ghostFloatableElement.setStyles({width:this.elements.container.getStyle("width"),height:this.elements.container.getStyle("height")}),this._initialGhostWindowOffset||(this._initialGhostWindowOffset={x:0,y:0});var i=this.getPositionRelativeToOffsetParent(),o=this._getReferencePosRelativeToOffsetParent();this._initialGhostWindowOffset.x=i.x-o.x,this._initialGhostWindowOffset.y=i.y-o.y}this._initialPointerPosition.x=e.clientX,this._initialPointerPosition.y=e.clientY;var s=this.getPositionRelativeToOffsetParent(),a=this._getReferencePosRelativeToOffsetParent();this._initialWindowOffset.x=s.x-a.x,this._initialWindowOffset.y=s.y-a.y,l.addEventOnElement(this,this.elements.container.ownerDocument,n.POINTERMOVE,r),l.addEventOnElement(this,this.elements.container.ownerDocument,n.POINTERUP,d),this.fire("startWindowDrag")}function r(e){e.preventDefault(),t._onDragPointerMove(e)}function d(e){t._onDragPointerUp(e),t.elements.container&&(l.removeEventOnElement(t,t.elements.container.ownerDocument,n.POINTERMOVE,r),l.removeEventOnElement(t,t.elements.container.ownerDocument,n.POINTERUP,d)),t._savePositionInPreferences(),t._onDragPointerDownInfos.dimensions.height===t.height&&t._onDragPointerDownInfos.dimensions.width===t.width||t._saveDimensionsInPreferences(),t._onDragPointerDownInfos.maximizedFlag!==t.maximizedFlag&&t._saveMaximizeInPreferences(),document.body.removeAttribute("dragging"),t.immersiveFrame&&t.immersiveFrame._resetStackedWindowData()}},t.prototype._onDragPointerMove=function(e){if(0===e.button){e.preventDefault();var t=e.clientX-this._initialPointerPosition.x,i=e.clientY-this._initialPointerPosition.y;if(0!==t||0!==i){var n={};if("top left"!==this.position.my||"top left"!==this.position.at){n.my="top left",n.at="top left";var o=this.getPositionRelativeToOffsetParent();this._initialWindowOffset.x=o.x,this._initialWindowOffset.y=o.y}if(n.offsetX=this._initialWindowOffset.x+t,n.offsetY=this._initialWindowOffset.y+i,this.modifyObjectFromUIInteraction("position",n),this.getFloatableState()){if(this.maximizedFlag&&(Math.abs(t)>15||Math.abs(i)>15)){this.setPropertyFromUIInteraction("maximizedFlag",!1),this._saveMaximizeInPreferences();var s={x:e.clientX,y:e.clientY};this._ensureTitleBarUnderPointer(s)}}else{if(!this.ghostPosition){var a=this._getCompletePosition();this.ghostPosition=a}this.ghostPosition.offsetX=this._initialGhostWindowOffset.x+t,this.ghostPosition.offsetY=this._initialGhostWindowOffset.y+i,r.setPosition(this.elements._ghostFloatableElement,this.ghostPosition),this.elements._ghostFloatableElement.show()}(this.immersiveFrame?this.immersiveFrame._computeFiringWindowDragEvents(this):this).fire("windowDrag",{x:e.clientX,y:e.clientY,deltaX:t,deltaY:i})}}},t.prototype._onDragPointerUp=function(e){this.elements._ghostFloatableElement.hide(),this._setFocus(this._lastFocusedWidget),this.fire("stopWindowDrag",{x:e.clientX,y:e.clientY})},t.prototype._onCloseButtonClick=function(){this.disabled||this.callMethodFromUIInteraction("close")},t.prototype._onMaximizeButtonClick=function(){this.allowMaximizeFlag&&this.setPropertyFromUIInteraction("maximizedFlag",!this.maximizedFlag)},t.prototype.handleEvents=function(){var e=this;l.addEventOnElement(this,document,"touchChange",function(){e._applyWidth(),e._applyHeight(),e._applyPosition()}),l.addEventOnElement(this,this.getContent(),"dimensionsChanged",function(t){if((-1===e.height||e.maximizedFlag||e.header)&&e._updateContentHeight(),-1!==e.height&&-1!==e.width||(e._applyPosition(),e.windowGroup?e.windowGroup._updateTitleBarWidth():e._updateTitleBarWidth()),e.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var i=e.immersiveFrame.getDockingElement(e.currentDockArea);i&&i.pointerEventsAllIfOverflow()}t.stopPropagation()}),l.addEventOnElement(this,this.elements.container,"keydown",function(t){var i=null;switch(t.keyCode){case d.ENTER:i=e._defaultButton;break;case d.ESCAPE:i=e._escapeButton}i&&(e._buttonOnKeydownPressed=i,t.stopPropagation())}),l.addEventOnElement(this,this.elements.container,"keyup",function(t){var i=null;if(!t.altKey&&!t.shiftKey&&!t.ctrlKey){switch(t.keyCode){case d.ENTER:i=e._defaultButton;break;case d.ESCAPE:i=e._escapeButton}if(i&&(t.keyCode!==d.ENTER||!l.isElementInside(t.target,e.elements._buttonsDiv))&&e._buttonOnKeydownPressed===i&&(e.activateButtonsIfActionPerformed||!t.actionPerformed)){var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!0),i.elements.button.dispatchEvent(n),t.stopPropagation(),t.preventDefault()}e._buttonOnKeydownPressed=void 0}}),this._initialPointerPosition||(this._initialPointerPosition={x:0,y:0}),this._initialWindowOffset||(this._initialWindowOffset={x:0,y:0}),this._initialWindowSize||(this._initialWindowSize={height:0,width:0}),l.addEventOnElement(this,e.elements.container,n.POINTERDOWN,function(t){e.activeFlag||(e.setPropertyFromUIInteraction("activeFlag",!0),l.addEventOnElement(e,document.body,n.POINTERUP,function(t){l.isElementInside(t.target,e.getContent())&&!l.isElementInside(document.activeElement,e.getContent())&&e._setFocus(e._lastFocusedWidget)},{once:!0}))}),l.addEventOnElement(this,e.elements._titleBarDiv,n.POINTERDOWN,function(t){e.setPropertyFromUIInteraction("activeFlag",!0),l.isElementInside(t.target,e.elements._titlebarButtonsDiv)||e.elements._tabBarContainer&&l.isElementInside(t.target,e.elements._tabBarContainer)||0!==t.button||e._onDragPointerDown(t)}),l.addEventOnElement(this,e.elements._titleBarDiv,n.POINTERHIT,function(t){2===t.multipleHitCount&&(t.preventDefault(),!e.getCollapsibleState()||l.isElementInside(t.target,e.elements._titlebarButtonsDiv)||e.elements._tabBarContainer&&l.isElementInside(t.target,e.elements._tabBarContainer)||(t.stopPropagation(),e.setPropertyFromUIInteraction("expandedFlag",!e.expandedFlag)))});var t=function(t,i){e._deltaPositionY=t-e._initialPointerPosition.y,"fit"===e._getCompletePosition().collision&&e._initialBoundingRect.top+e._deltaPositionY<0&&(e._deltaPositionY=-e._initialBoundingRect.top),e._initialWindowSize.height-e._deltaPositionY<i&&(e._deltaPositionY=e._initialWindowSize.height-i)};function i(i){i.preventDefault();var n=e._getFixedContentHeight();t(i.clientY,n),e.setPropertyFromUIInteraction("height",e._initialWindowSize.height-e._deltaPositionY),e._deltaPositionY=e._initialWindowSize.height-e.height,F.call(e,null,"top","topHandlerPointerMove")}var o=function(t,i){e._deltaPositionY=t-e._initialPointerPosition.y;var n=e.immersiveFrame?e.immersiveFrame.getContent().clientHeight-e.immersiveFrame.getContent().clientTop:document.body.clientHeight||window.innerHeight,o=n-e._initialBoundingRect.bottom-e._deltaPositionY;"fit"===e._getCompletePosition().collision&&o<0&&(e._deltaPositionY=n-e._initialBoundingRect.bottom),e._initialWindowSize.height+e._deltaPositionY<i&&(e._deltaPositionY=i-e._initialWindowSize.height)};function s(t){t.preventDefault();var i=e._getFixedContentHeight();o(t.clientY,i),e.setPropertyFromUIInteraction("height",e._initialWindowSize.height+e._deltaPositionY),e._deltaPositionY=e.height-e._initialWindowSize.height,F.call(e,null,"bottom","bottomHandlerPointerMove")}var a=function(t){e._deltaPositionX=t-e._initialPointerPosition.x;var i=e.immersiveFrame?e.immersiveFrame.getContent().clientWidth-e.immersiveFrame.getContent().clientLeft:document.body.clientWidth||window.innerWidth;"fit"===e._getCompletePosition().collision&&e._deltaPositionX>i-e._initialBoundingRect.right&&(e._deltaPositionX=i-e._initialBoundingRect.right),e._initialWindowSize.width+e._deltaPositionX<0&&(e._deltaPositionX=-e._initialWindowSize.width)};function r(t){t.preventDefault(),a(t.clientX);var i=e._deltaPositionX;e.currentDockArea===WUXDockAreaEnum.BottomDockArea&&"center"===e.immersiveFrame.getDockingElement(WUXDockAreaEnum.BottomDockArea).alignment&&(i=2*e._deltaPositionX),e.setPropertyFromUIInteraction("width",e._initialWindowSize.width+i),e._deltaPositionX=e.width-e._initialWindowSize.width,F.call(e,"right",null,"rightHandlerPointerMove")}var h=function(t){e._deltaPositionX=t-e._initialPointerPosition.x,"fit"===e._getCompletePosition().collision&&e._initialBoundingRect.left+e._deltaPositionX<0&&(e._deltaPositionX=-e._initialBoundingRect.left),e._initialWindowSize.width-e._deltaPositionX<0&&(e._deltaPositionX=e._initialWindowSize.width)};function c(t){t.preventDefault(),h(t.clientX),e.setPropertyFromUIInteraction("width",e._initialWindowSize.width-e._deltaPositionX),e._deltaPositionX=e._initialWindowSize.width-e.width,F.call(e,"left",null,"leftHandlerPointerMove")}function u(t){i.call(e,t),c.call(e,t)}function m(t){i.call(e,t),r.call(e,t)}function p(t){s.call(e,t),r.call(e,t)}function g(t){s.call(e,t),c.call(e,t)}function f(t){(e._fireAndBroadcast("stopResize"),l.removeEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,i),l.removeEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,r),l.removeEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,s),l.removeEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,c),l.removeEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,u),l.removeEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,m),l.removeEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,p),l.removeEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,g),l.removeEventOnElement(e,e.elements.container.ownerDocument,n.POINTERUP,f),document.body.removeAttribute("resizing"),e.immersiveFrame)&&(e.immersiveFrame.getDockingElement(e.currentDockArea)&&e._managePointerEvents());e._saveDimensionsInPreferences(),e._savePositionInPreferences()}function w(t){document.body.setAttributeNode(document.createAttribute("resizing")),e.setPropertyFromUIInteraction("activeFlag",!0),e._initialPointerPosition.x=t.clientX,e._initialPointerPosition.y=t.clientY,e._initialBoundingRect=e.elements.container.getBoundingClientRect(),e.immersiveFrame&&e.currentDockArea===WUXDockAreaEnum.NoneDockArea&&(e._initialBoundingRect=W.call(e)),e._initialWindowSize.width=e.elements._mainContentDiv.clientWidth,e._initialWindowSize.height=e.elements._mainContentDiv.clientHeight;var i=e.getPositionRelativeToOffsetParent(),n=e._getReferencePosRelativeToOffsetParent();e._initialWindowOffset.x=i.x-n.x,e._initialWindowOffset.y=i.y-n.y}this.elements._resizeZone&&l.addEventOnElement(this,this.elements._resizeZone,n.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom right",cursor:"nw-resize"}),w(t),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,p),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERUP,f)}),l.addEventOnElement(this,this.elements._topResizeHandler,n.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"top",cursor:"s-resize"}),w(t),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,i),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERUP,f)}),l.addEventOnElement(this,this.elements._bottomResizeHandler,n.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom",cursor:"s-resize"}),w(t),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,s),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERUP,f)}),l.addEventOnElement(this,this.elements._rightResizeHandler,n.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"right",cursor:"w-resize"}),w(t),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,r),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERUP,f)}),l.addEventOnElement(this,this.elements._leftResizeHandler,n.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"left",cursor:"w-resize"}),w(t),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,c),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERUP,f)}),l.addEventOnElement(this,this.elements._topLeftResizeHandler,n.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"top left",cursor:"nw-resize"}),w(t),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,u),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERUP,f)}),l.addEventOnElement(this,this.elements._topRightResizeHandler,n.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"top right",cursor:"sw-resize"}),w(t),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,m),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERUP,f)}),l.addEventOnElement(this,this.elements._bottomRightResizeHandler,n.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom right",cursor:"nw-resize"}),w(t),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,p),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERUP,f)}),l.addEventOnElement(this,this.elements._bottomLeftResizeHandler,n.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom left",cursor:"sw-resize"}),w(t),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERMOVE,g),l.addEventOnElement(e,e.elements.container.ownerDocument,n.POINTERUP,f)})},t.prototype._hasValidIdentifier=function(){if(""!==this.identifier){var e=Math.floor(Number(this.identifier));return e<0||String(e)!==this.identifier}return!1},t.prototype._saveDataInPreferences=function(e,t){this._hasValidIdentifier()&&r.saveDataInLocalPreferences(this,A,e,t)},t.prototype._getDataFromPreferences=function(e){var t=void 0;return this._hasValidIdentifier()&&(t=r.getDataFromLocalPreferences(this,A,e)),t},t.prototype._savePositionInPreferences=function(){if(this.identifier){var e=this;this.windowGroup&&(e=this.windowGroup);var t={my:e.position.my,at:e.position.at,collision:e.position.collision,offsetX:e.position.offsetX,offsetY:e.position.offsetY};this._saveDataInPreferences("position",t)}},t.prototype._getPositionFromPreferences=function(){return this._getDataFromPreferences("position")},t.prototype._saveDimensionsInPreferences=function(){if(this.identifier){var e={height:this.height,width:this.width};this._saveDataInPreferences("dimension",e)}},t.prototype._getDimensionsFromPreferences=function(){return this._getDataFromPreferences("dimension")},t.prototype._saveDockedDimensionsInPreferences=function(){if(this.identifier){var e=void 0;this.currentDockArea===WUXDockAreaEnum.NoneDockArea?e={height:void 0,width:void 0}:((e=this._getDockedDimensionsFromPreferences())||(e={}),this.currentDockArea===WUXDockAreaEnum.LeftDockArea||this.currentDockArea===WUXDockAreaEnum.RightDockArea?e.width=this.immersiveFrame.getDockingElement(this.currentDockArea).dockingZoneSize:e.height=this.immersiveFrame.getDockingElement(this.currentDockArea).dockingZoneSize),this._saveDataInPreferences("dockedDimensions",e)}},t.prototype._getDockedDimensionsFromPreferences=function(){return this._getDataFromPreferences("dockedDimensions")},t.prototype._updateAllWindowsPreferencesInOldDockingElement=function(e,t){if(this.immersiveFrame){var i=[],n=[];e!==WUXDockAreaEnum.NoneDockArea&&((n=this.immersiveFrame.getDockingElement(e).getContainedVisibleWindows()).length>0&&n.map(function(e){e._hasValidIdentifier()&&i.push(e.identifier)}),n.length>0&&n.map(function(n){n._hasValidIdentifier()&&(n._saveDataInPreferences("dockAreaOrder",i),t&&n._saveDataInPreferences("dockArea",e))}))}},t.prototype._saveDockAreaInPreferences=function(){if(this.identifier&&this.immersiveFrame){var e=[];this.currentDockArea!==WUXDockAreaEnum.NoneDockArea&&(e=this.immersiveFrame.getDockingElement(this.currentDockArea).getContainedVisibleWindows());var t=this.currentDockArea;e.length>0?this._updateAllWindowsPreferencesInOldDockingElement(t,!0):this._saveDataInPreferences("dockAreaOrder",[]),this._saveDataInPreferences("dockArea",t)}},t.prototype._getDockAreaFromPreferences=function(){return this._getDataFromPreferences("dockArea")},t.prototype._getDockAreaOrderFromPreferences=function(){return this._getDataFromPreferences("dockAreaOrder")},t.prototype._saveMaximizeInPreferences=function(){if(this.identifier){var e=this.maximizedFlag;this._saveDataInPreferences("maximizedFlag",e)}},t.prototype._getMaximizedFlagFromPreferences=function(){return this._getDataFromPreferences("maximizedFlag")},t.prototype._getWindowGroupAsTabFromPreferences=function(){var e=this._getDataFromPreferences("windowGroupAsTab");return e||(e=[]),e},t.prototype._saveWindowGroupAsTabInPreferences=function(e){this._saveDataInPreferences("windowGroupAsTab",e)},t.prototype._getSnappingFromPreferences=function(){var e=this._getDataFromPreferences("windowGroupAsGrid");return e||(e=[]),e},t.prototype._saveSnappingInPreferences=function(e){this._saveDataInPreferences("windowGroupAsGrid",e)},t.prototype._getDetachedFromPreferences=function(){var e=this._getDataFromPreferences("detachedFrom");return e||(e=[]),e},t.prototype._saveDetachedInPreferences=function(e){this._saveDataInPreferences("detachedFrom",e)},t.prototype._saveWindowGroupInPreferences=function(e){if(this.isAWindowGroup())for(var t=this.getEmbeddedWindows(),i=0;i<t.length;i++){(l=t[i])&&void 0!==l.identifier&&(!e||e.isAWindowGroup()&&0===e.getEmbeddedWindows().length||l._saveWindowGroupInPreferences(e))}else if(this.identifier)if(e){var n=this._getDetachedFromPreferences();if(e.isAWindowGroup())for(t=e.getEmbeddedWindows(),i=0;i<t.length;i++){if((l=t[i])&&void 0!==l.identifier){0!==n.length&&-1!==n.indexOf(l.identifier)||l.identifier===this.identifier||n.push(l.identifier);var o=l._getDetachedFromPreferences();0!==o.length&&-1!==o.indexOf(this.identifier)||(o.push(this.identifier),l._saveDetachedInPreferences(o))}}else{void 0===e.identifier||0!==n.length&&-1!==n.indexOf(e.identifier)||n.push(e.identifier);var s=e._getDetachedFromPreferences();0!==s.length&&-1!==s.indexOf(this.identifier)||void 0===e.identifier||(s.push(this.identifier),e._saveDetachedInPreferences(s))}if(this._saveDetachedInPreferences(n),e.isAWindowGroup())for(t=e.getEmbeddedWindows(),this._getWindowGroupAsTabFromPreferences(),i=0;i<t.length;i++){(l=t[i])&&void 0!==l.identifier&&(this._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,l.identifier,this._getWindowGroupAsTabFromPreferences())),l._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(l,this.identifier,l._getWindowGroupAsTabFromPreferences())))}else void 0!==e.identifier&&(this._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,e.identifier,this._getWindowGroupAsTabFromPreferences())),e._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(e,this.identifier,e._getWindowGroupAsTabFromPreferences())));this.windowGroup&&this._saveWindowGroupInPreferences()}else if(this.windowGroup){var a=this.windowGroup;if(a.groupType===D.GroupAsTab){var r=[];a.windowGroup&&a.windowGroup.groupType===D.GroupAsGrid&&a.windowGroup;for(t=a.getEmbeddedWindows(),i=0;i<t.length;i++){(l=t[i])&&void 0!==l.identifier&&r.push(l.identifier)}for(i=0;i<t.length;i++){(l=t[i])&&void 0!==l.identifier&&l._saveWindowGroupAsTabInPreferences(l._addWGAsTabPreferences(r))}for(i=0;i<t.length;i++){var l;if((l=t[i])&&void 0!==l.identifier){n=l._getDetachedFromPreferences();if(l.identifier===this.identifier){for(var d=0;d<r.length;d++){var h=r[d];-1!==n.indexOf(h)&&n.splice(n.indexOf(h),1)}l._saveDetachedInPreferences(n)}else-1!==n.indexOf(this.identifier)&&(n.splice(n.indexOf(this.identifier),1),l._saveDetachedInPreferences(n))}}}else a.groupType===D.GroupAsGrid&&a}else console.log("Saving the preferences of a Window that is being attached to nothing... failed")},t.prototype._locateAndRemoveWindowFromWGAsTabPreferencesArray=function(e,t,i){for(var n=0;n<i.length;n++){var o=i[n];if(-1!==o.indexOf(t)){o.splice(o.indexOf(t),1),1===o.length&&(o[0]===e.identifier?i.splice(n,1):console.log("There is a WindowGroup preferences that is composed of only one Window, but it is not the Window in question"));break}}return i},t.prototype._addWGAsTabPreferences=function(e){var t=this._getWindowGroupAsTabFromPreferences();if(-1===t.indexOf(e)){for(var i=0;i<e.length;i++){var n=e[i];n!==this.identifier&&(t=this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,n,t))}return t.push(e),t}console.log("preferences for this WindowGroup have already been saved : "+this.identifier)},t.prototype._readWindowPreferences=function(){if(this._hasValidIdentifier()&&this.visibleFlag&&this.immersiveFrame&&this.immersiveFrame.containsWindow(this)&&this._prefRestorationState===WUXPreferenceRestorationStateEnum.NotRestored){if(this._prefRestorationState=WUXPreferenceRestorationStateEnum.BeingRestored,this.visibleFlag){var e=this._getDimensionsFromPreferences();e&&(this._properties.height.dirty=!1,this._properties.width.dirty=!1,this.height=e.height,this.width=e.width)}var t=this._getDockAreaFromPreferences(),i=this._getDockAreaOrderFromPreferences();if(void 0!==t){this._properties.currentDockArea.dirty=!1;var n=this.immersiveFrame&&this.immersiveFrame.windows?this.immersiveFrame.windows:[];i&&i.length>0?i.map(function(e){var i=n[e];i&&(i.currentDockArea!==WUXDockAreaEnum.NoneDockArea&&(i.currentDockArea=WUXDockAreaEnum.NoneDockArea),i.currentDockArea=t)}):this.currentDockArea=t}var o=this._getMaximizedFlagFromPreferences();void 0!==o&&(this._properties.maximizedFlag.dirty=!1,this.maximizedFlag=o);var s=this._getWindowGroupAsTabFromPreferences();if(s&&s.length>0)for(var a=s.length-1;a>=0;a--){for(var r=s[a],l=void 0,d=void 0,h=void 0,c=0;c<r.length;c++){var u=r[c];if(u===this.identifier)l=c;else if(this.immersiveFrame.windows[u]){if(void 0!==l){if(h){if(l-d>c-l){h=u,d=c;break}break}h=u,d=c;break}h=u,d=c}}if(void 0!==l&&h&&void 0!==d){var m=l<d?"before":"after",p=this.immersiveFrame.windows[h];if(p.currentDockArea===this.currentDockArea&&p.maximizedFlag===this.maximizedFlag){this.attachToWindow(p,v.InsideArea,m);break}h=void 0,d=void 0,l=void 0}}var g=this._getPositionFromPreferences();if(g){var f={at:g.at,collision:g.collision,my:g.my,offsetX:g.offsetX,offsetY:g.offsetY};this.windowGroup?this.windowGroup.position=f:(this._properties.position.dirty=!1,this.position=f)}this._prefRestorationState=WUXPreferenceRestorationStateEnum.Restored}},t.prototype.deleteWindowPreferences=function(){for(var e=0;e<this._savedPreferencesKeys.length;e++){var t=this._savedPreferencesKeys[e];r.deleteDataFromLocalPreferences(this,A,t)}var i=this._getDetachedFromPreferences();for(e=0;e<i.length;e++){var n=i[e],o=r.getDataFromLocalPreferences(n,A,"detachedFrom");o.splice(o.indexOf(this.identifier),1),r.saveDataInLocalPreferences(n,A,"detachedFrom",o)}r.deleteDataFromLocalPreferences(this,A,"detachedFrom");var s=this._getWindowGroupAsTabFromPreferences();for(e=0;e<s.length;e++)for(var a=s[e],l=0;l<a.length;l++){var d=a[l];if(d!==this.identifier){var h=r.getDataFromLocalPreferences(d,A,"windowGroupAsTab");if(h){for(var c=0;c<h.length;c++){var u=h[c];-1!==u.indexOf(this.identifier)&&u.splice(u.indexOf(this.identifier),1),u.length<=1&&h.splice(c,1)}r.saveDataInLocalPreferences(d,A,"windowGroupAsTab",h)}}}r.deleteDataFromLocalPreferences(this,A,"windowGroupAsTab"),this.immersiveFrame&&this._updateAllWindowsPreferencesInOldDockingElement(this.currentDockArea,!1),r.deleteDataFromLocalPreferences(this,A,"dockAreaOrder")},t.prototype._locateAndModifyWindowGroup=function(e){},t}(u),F=function(e,t){var i=!1,n=void 0,o=void 0,s=this._getCompletePosition();if(t&&(this.height>=this.minHeight||void 0===this.minHeight&&this.height>=0)){var a=this._getFixedContentHeight();this.height>=a&&(s.my.indexOf(t)>-1&&(o=this._initialWindowOffset.y+this._deltaPositionY,i=!0),(s.my.indexOf("center")>-1||"left"===s.my||"right"===s.my)&&(o=this._initialWindowOffset.y+this._deltaPositionY/2,i=!0))}e&&(this.width>=this.minWidth||void 0===this.minWidth&&this.width>=0)&&(s.my.indexOf(e)>-1&&(n=this._initialWindowOffset.x+this._deltaPositionX,i=!0),(s.my.indexOf("center")>-1||"top"===s.my||"bottom"===s.my)&&(n=this._initialWindowOffset.x+this._deltaPositionX/2,i=!0));var r={};return void 0!==n&&(r.offsetX=n),void 0!==o&&(r.offsetY=o),this.modifyObjectFromUIInteraction("position",r),i},W=function(){if(this.immersiveFrame){var e=this.getContent().getBoundingClientRect().top-this.immersiveFrame.getContent().getBoundingClientRect().top,t=this.getContent().clientHeight,i=this.getContent().getBoundingClientRect().left-this.immersiveFrame.getContent().getBoundingClientRect().left,n=this.getContent().clientWidth;return{top:e,height:t,bottom:e+t,left:i,width:n,right:i+n}}};function E(e){if(this.currentDockArea!==WUXDockAreaEnum.NoneDockArea){this.currentDockArea!==e&&this.fire("prePlaceChange",{previousPlace:{currentDockArea:e}}),this.immersiveFrame.dockWindow(this,this.currentDockArea);var t=document.createAttribute("docked");switch(this.currentDockArea){case WUXDockAreaEnum.TopDockArea:t.value="top";break;case WUXDockAreaEnum.BottomDockArea:t.value="bottom";break;case WUXDockAreaEnum.LeftDockArea:t.value="left";break;case WUXDockAreaEnum.RightDockArea:t.value="right"}this.getContent().setAttributeNode(t),C.call(this,e)}}function C(e){this._applyResizableFlag(),this._updateFromCollapsibleState(),this._updateFromEmbeddedState(),this._updateMinWidth(),this._applyWidth(),this._applyHeight(),this._applyPosition(),this.currentDockArea!==e&&(this.fire("placeChange"),this._fireAndBroadcast("resize",{bubbles:!1}));var t=this.immersiveFrame.getDockingElement(e);t&&(!this.immersiveFrame._ActionBar_V3||e!==WUXDockAreaEnum.BottomDockArea&&e!==WUXDockAreaEnum.TopDockArea||this._moveTitleBar(!1,t),t._updateFromContainedWindows(),t._updateContainedWindows());var i=this.immersiveFrame.getDockingElement(this.currentDockArea);i?(i._updateFromContainedWindows(),i._updateContainedWindows()):e===WUXDockAreaEnum.BottomDockArea&&this._setTitleBarCenteredFlag(!1),this.immersiveFrame._manageAllPointerEventsOnDockingElements()}return o.addClass(y,"window"),window.WUXSnapAreaEnum=v,window.WUXWindowGroupTypeEnum=D,window.WUXStandardButtonRoleEnum=k,window.WUXStandardButtonEnum=b,y}),define("DS/Windows/Dialog",["UWA/Core","DS/Windows/Window","DS/Controls/Button","DS/Utilities/Dom","DS/Controls/Toggle","DS/Controls/TooltipModel"],function(e,t,i,n,o,s){"use strict";var a=t.inherit({name:"dialog",publishedProperties:{modalFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},checkboxInfos:{defaultValue:void 0,type:"object",category:"Behavior"},customButtonsDefinition:{defaultValue:void 0,type:"object",category:"Behavior"}},buildView:function(){var t=this;this._parent(),this.elements.container.addClassName("wux-windows-dialog"),this.elements._footerDiv=new e.Element("div",{class:"wux-windows-dialog-footer"}),this.elements._footerDiv.inject(this.elements._mainContentDiv),this.elements._buttonsDiv=new e.Element("div",{class:"wux-windows-dialog-buttons"}),this.elements._buttonsDiv.inject(this.elements._footerDiv),this.elements._resizeZone=new e.Element("div",{class:"wux-windows-dialog-resize-zone"}),this.elements._resizeZone.inject(this.elements._footerDiv),this._applyCurrentDockArea(),n.onNodeRendered(this.getContent(),function(){t.elements.container&&t._applyMinWidth()})},_applyRecId:function(e){if(this._parent(e),this.buttons)for(var t=Object.keys(this.buttons),n=0;n<t.length;n++){var o=t[n],s=this.buttons[o];s&&s instanceof i&&!s.recId&&(s.recId=this.recId+"_"+o)}},_applyImmersiveFrame:function(e){this._parent(e),!this.immersiveFrame&&!this._isBeingClosed&&this.visibleFlag&&this.elements&&this.elements.container&&!this.elements.container.parentNode&&this.inject(document.body),this._applyModalFlag()},_applyResizableFlag:function(e){this._parent(e),!0===this.resizableFlag?(this.elements._resizeZone.show(),this.elements._footerDiv.addClassName("resize-padding")):(this.elements._resizeZone.hide(),this.elements._footerDiv.removeClassName("resize-padding"))},_applyButtons:function(e){if(this._parent(e),this.buttons&&Object.keys(this.buttons).length>0)for(var t=Object.keys(this.buttons),n=0;n<t.length;n++){var o=t[n];if(o&&WUXStandardButtonEnum[o]){var s=this.buttons[o];if(s&&s instanceof i){s.label||(s.label=this.getDefaultButtonLabel(o)),this.recId&&!s.recId&&(s.recId=this.recId+"_"+o);var a=WUXStandardButtonEnum[o].role;a===WUXStandardButtonRoleEnum.AcceptRole||a===WUXStandardButtonRoleEnum.YesRole?s.emphasize="primary":s.emphasize="secondary"}}}else this.customButtonsDefinition&&this._applyCustomButtonsDefinition();0===this.elements._buttonsDiv.childNodes.length?this.elements._footerDiv.hide():this.elements._footerDiv.show(),this._applyMinWidth(),this._applyHeight()},_applyCustomButtonsDefinition:function(){if(this.customButtonsDefinition&&Array.isArray(this.customButtonsDefinition)&&(!this.buttons||0===Object.keys(this.buttons).length)){if(this._defaultButton=null,this._escapeButton=null,this._customButtons)for(var e=0;e<this._customButtons.legnth;e++)this._customButtons[e].destroy();if(this._customButtons=[],null!=this.elements._buttonsDiv)for(;this.elements._buttonsDiv.childNodes.length>0;){var t=this.elements._buttonsDiv.childNodes[0];if(!(t&&t.dsModel instanceof i))break;t.remove()}for(e=0;e<this.customButtonsDefinition.length;e++){let t=new i(this.customButtonsDefinition[e]);this._customButtons.push(t),t.dialog=this,null!=this.elements._buttonsDiv&&t.inject(this.elements._buttonsDiv),this.customButtonsDefinition[e].role&&(this.customButtonsDefinition[e].role===WUXCustomButtonRoleEnum.Validate?this._defaultButton=t:this.customButtonsDefinition[e].role===WUXCustomButtonRoleEnum.Escape&&(this._escapeButton=t))}0===this.elements._buttonsDiv.childNodes.length?this.elements._footerDiv.hide():this.elements._footerDiv.show(),this._applyMinWidth(),this._applyHeight()}},getCustomButtons:function(){if(this.customButtonsDefinition&&Array.isArray(this.customButtonsDefinition)&&(!this.buttons||0===Object.keys(this.buttons).length))return this._customButtons},_applyCheckboxInfos:function(){if(this.elements._footerDiv.removeAttribute("has-checkbox"),this.checkboxInfos&&this.checkboxInfos.label){if(this.elements._footerDiv.setAttributeNode(document.createAttribute("has-checkbox")),this.elements._checkbox){this.elements._checkbox.visibleFlag=!0,this.elements._checkbox.label=this.checkboxInfos.label,this.elements._checkbox.checkFlag=!!this.checkboxInfos.checkFlag;const e=this.checkboxInfos.tooltipInfos?this.checkboxInfos.tooltipInfos:{shortHelp:this.checkboxInfos.label};this.elements._checkbox.tooltipInfos=new s(e)}else{let t=this;this.elements._checkboxDiv=new e.Element("div",{class:"wux-windows-dialog-checkbox"}),this.elements._checkboxDiv.inject(this.elements._buttonsDiv,"before");const i=this.checkboxInfos.tooltipInfos?this.checkboxInfos.tooltipInfos:{shortHelp:this.checkboxInfos.label};this.elements._checkbox=new o({type:"checkbox",label:this.checkboxInfos.label,checkFlag:!!this.checkboxInfos.checkFlag,tooltipInfos:new s(i)}),this.elements._checkbox.addEventListener("change",function(e){t.checkboxInfos.checkFlag=t.elements._checkbox.checkFlag}),this.elements._checkbox.inject(this.elements._checkboxDiv)}this._applyMinWidth()}else this.elements._checkbox&&this.elements._checkbox.visibleFlag&&(this.elements._checkbox.visibleFlag=!1)},_applyMinWidth:function(){this._parent();var e=r.call(this);e>this.minWidth&&(this.minWidth=e)},_updateTitleMaxWidth:function(){var e=this.elements._titlebarButtonsDiv.clientWidth;this.elements._titleDiv.setStyle("max-width","calc(100% - "+e+"px)")},_applyModalFlag:function(){if(void 0!==this.elements.container){var t;this.isDirty("modalFlag");if(!0===this.modalFlag){if(this.elements.container.setAttributeNode(document.createAttribute("modal")),i=this.elements.container.parentNode)this.elements._modalDiv||(this.elements._modalDiv=new e.Element("div",{class:"wux-windows-modalDialog"})),i!==(t=this.elements._modalDiv)&&(i.removeChild(this.elements.container),t.appendChild(this.elements.container),i.dsModel&&void 0!==i.dsModel.rootContainer&&(i=i.dsModel.rootContainer),i.appendChild(t)),t.show()}else if(this.elements.container.removeAttribute("modal"),(t=this.elements._modalDiv)&&t.hasClassName("wux-windows-modalDialog")){if(this.immersiveFrame)this._moveToImmersiveFrame();else{var i,n=t.getParent();if(n)n.removeChild(t),(i=this.elements.container.parentNode)&&i.removeChild(this.elements.container),n.appendChild(this.elements.container)}t.destroy(),delete this.elements._modalDiv}else this._moveToImmersiveFrame()}},_moveToImmersiveFrame:function(){this.immersiveFrame&&!this.modalFlag?this.immersiveFrame.moveWindowToImmersiveFrame(this):this.modalFlag&&this.elements._modalDiv.appendChild(this.elements.container)},_applyVisibleFlag:function(e){if(!0===this.modalFlag){var t=this.elements._modalDiv;t&&(!1===this.visibleFlag?t.hide():t.show())}this._parent(e),!this.immersiveFrame&&!this._isBeingClosed&&this.visibleFlag&&this.elements&&this.elements.container&&!this.elements.container.parentNode&&this.inject(document.body)},_applyProperties:function(e){var t=this.isDirty("modalFlag");this._parent(e),this.isDirty("customButtonsDefinition")&&this._applyCustomButtonsDefinition(e.customButtonsDefinition),t&&this._applyModalFlag(),this.isDirty("resizableFlag")&&this._applyResizableFlag(),this.isDirty("checkboxInfos")&&this._applyCheckboxInfos()},_applyCurrentDockArea:function(e){this._parent(e);var t=this.elements._titleBarDiv.clientHeight;this.elements._buttonsDiv.childNodes.length>0&&(t+=this.elements._footerDiv.clientHeight),0!==t&&this.elements._mainCollapsibleContainer.setStyle("height","calc(100% - "+t+"px)")},_applyMaximizedFlag:function(e){this.immersiveFrame&&(this._updateFromCollapsibleState(),void 0!==e&&this.maximizedFlag!==e&&this.fire("prePlaceChange",{previousPlace:{maximizedFlag:e}}),this.maximizedFlag&&this.allowMaximizeFlag?(this.getContent().setAttributeNode(document.createAttribute("maximized")),this._updateMaximizeButtonIcon()):(this.getContent().removeAttribute("maximized"),this._updateMaximizeButtonIcon()),this._updateContentHeight(),void 0!==e&&this.maximizedFlag!==e&&(this._updateContentVisibleStateChange(),this.fire("placeChange"),this._fireAndBroadcast("resize,",{bubbles:!1})))},_getDefaultPosition:function(){return{my:"center",at:"center",of:this.immersiveFrame?this.immersiveFrame.getContent():document.body,constraint:this.immersiveFrame?this.immersiveFrame.getContent():document.body,offsetX:0,offsetY:0,collision:"fit"}}}),r=function(){if(this.buttons){let a=0,r=0;for(var e in this.buttons){var t=window.getComputedStyle(this.buttons[e].getContent())?window.getComputedStyle(this.buttons[e].getContent()).getPropertyValue("min-width"):"";t=""===t?0:parseInt(t,10);var i=window.getComputedStyle(this.buttons[e].getContent())?window.getComputedStyle(this.buttons[e].getContent()).getPropertyValue("margin-left"):"";i=""===i?0:parseInt(i,10);var n=window.getComputedStyle(this.buttons[e].getContent())?window.getComputedStyle(this.buttons[e].getContent()).getPropertyValue("margin-right"):"";a=a+t+i+(n=""===n?0:parseInt(n,10))}var o,s=0;return this.elements._footerDiv&&(o=window.getComputedStyle(this.elements._footerDiv)?window.getComputedStyle(this.elements._footerDiv).getPropertyValue("padding-left"):"",s=window.getComputedStyle(this.elements._footerDiv)?window.getComputedStyle(this.elements._footerDiv).getPropertyValue("padding-right"):"",o=""===o?0:parseInt(o,10),s=""===s?0:parseInt(s,10),this.checkboxInfos&&(r=80)),a=a+o+s+r}return 0};return a}),define("DS/Windows/DockingElementForImmersiveFrame",["UWA/Core","DS/Utilities/Dom","DS/Windows/DockingElement"],function(e,t,i){"use strict";function n(e){const t=this.elements.dockingZone.getChildren();for(let i=0;i<t.length;i++){if(!t[i].hasClassName("wux-windows-window"))return!0;if((!e||t[i].dsModel.getContent()!==e.getContent())&&t[i].dsModel.visibleFlag)return!0}return!1}function o(){const e=this.getContainedWindows();for(var t=0;t<e.length;t++)e[t]._updateContentVisibleStateChange()}return i.inherit({buildView:function(){this._parent(),this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-immersiveFrameStyle"),this.elements.dockingZoneMask.addClassName("wux-windows-docking-element-immersiveFrameStyle")},handleEvents:function(){this._parent(),function(){t.addEventOnElement(this,this.elements.dockingZone,"DOMNodeRemoved",e=>{if(e.target&&e.target.hasOwnProperty("hasClassName")&&e.target.hasClassName("wux-windows-window")){const t=e.target.dsModel;n.call(this,t)||(this.visibleDockingZoneFlag=!1)}}),t.addEventOnElement(this,this.elements.dockingZone,"DOMNodeInserted",e=>{if(e.target&&e.target.hasOwnProperty("hasClassName")&&e.target.hasClassName("wux-windows-window")){const t=e.target.dsModel;t&&t.visibleFlag&&(this.visibleDockingZoneFlag=!0)}})}.call(this),function(){let e;this.addEventListener("dockStartResize",t=>{if(t.dsModel!==this)return;const i=this.side;let n,o;switch(i){case WUXDockAreaEnum.TopDockArea:n="bottom",o="ns-resize";break;case WUXDockAreaEnum.BottomDockArea:n="top",o="ns-resize";break;case WUXDockAreaEnum.LeftDockArea:n="right",o="ew-resize";break;case WUXDockAreaEnum.RightDockArea:n="left",o="ew-resize"}const s=this.getContainedWindows();for(let t=0;t<s.length;t++)s[t]._fireAndBroadcast("startResize",{side:n,cursor:o}),e||(e=s[t].immersiveFrame)}),this.addEventListener("dockIsResizing",t=>{t.dsModel===this&&e&&e._updateAllDockingZoneSize()}),this.addEventListener("dockResize",e=>{if(e.dsModel!==this)return;const t=this.getContainedWindows();for(let e=0;e<t.length;e++)t[e]._fireAndBroadcast("stopResize");this._saveDockingZoneSizeInPreferences()})}.call(this)},getContainedWindows:function(){const e=this.elements.dockingZone.getChildren();let t=[];for(let i=0;i<e.length;i++)e[i].hasClassName("wux-windows-window")&&t.push(e[i].dsModel);return t},getContainedVisibleWindows:function(){const e=this.elements.dockingZone.getChildren();let t=[];for(var i=0;i<e.length;i++)e[i].hasClassName("wux-windows-window")&&"none"!==e[i].getStyle("display")&&t.push(e[i].dsModel);return t},_preEditDockingZoneSize:function(e,i){let n=this._parent(e,i);if(!0===n&&!t.isCurrentlyCalledFromUIInteraction()&&0===this.getContainedWindows().length){var o=this._getDockingZoneSizeFromPreferences();if(o)return{validValue:o.size}}return n},_applyDockingZoneSize:function(e){if(this._parent(e),void 0!==e&&this.dockingZoneSize!==e){const e=this.getContainedWindows();for(let t=0;t<e.length;t++)e[t]._fireAndBroadcast("resize",{bubbles:!1})}},_applyAlignment:function(){this._parent(),this._updateContainedWindows(),this._updateFitToChildState()},_applyCollapseDockingZoneFlag:function(){this._parent(),o.call(this)},_applyCollapserStyle:function(){this._parent(),this.collapserStyle===i.COLLAPSER_STYLE.FIXED_AREA&&(this.useBordersFlag=!1,this.useBackgroundFlag=!1,this.alignment="near")},_applyVisibleDockingZoneFlag:function(){this._parent(),o.call(this)},_updateDockingZoneSize:function(){this.getContainedVisibleWindows().length>0&&this._updateContainedWindows(),this._parent()},_updateContainedWindows:function(){this.collapserStyle!==i.COLLAPSER_STYLE.FIXED_AREA||this.side!==WUXDockAreaEnum.BottomDockArea&&this.side!==WUXDockAreaEnum.TopDockArea||function(){let e=null;const t=this.getContainedVisibleWindows();1===t.length&&(e=t[0]);e&&(e._moveTitleBar(!0,this),e._updateTitleBarWidth());const i=this.getContainedWindows();for(var n=0;n<i.length;n++){const t=i[n];t&&t!==e&&(t._moveTitleBar(!1,this),t._updateTitleBarWidth())}}.call(this);const e=this.getContainedVisibleWindows();for(let t=0;t<e.length;t++)e[t]._updateContentHeight(),e[t]._setTitleBarCenteredFlag("center"===this.alignment),e[t].isAWindowGroup()&&(e[t]._updateMaxTabbarWidth(),e[t]._updateMinWidth())},_updateFromContainedWindows:function(){this.collapserStyle===i.COLLAPSER_STYLE.FIXED_AREA&&function(){let e="near";if(this.side===WUXDockAreaEnum.BottomDockArea){const t=this.getContainedVisibleWindows();1===t.length&&(e="center")}this.alignment=e}.call(this),this._updateFitToChildState();const e=this.getContainedVisibleWindows();let t=24;if(e&&e.length>0){const i=this.side,o=e[0]._getTitleBarHeight();for(var n=0;n<e.length;n++){const s=e[n];s&&(i===WUXDockAreaEnum.LeftDockArea||i===WUXDockAreaEnum.RightDockArea?t=s.minWidth>t?s.minWidth:t:i!==WUXDockAreaEnum.TopDockArea&&i!==WUXDockAreaEnum.BottomDockArea||(t=s.minHeight+o>t?s.minHeight+o:t))}}this.minSize=t,this._updateCollapserSize()},_updateFitToChildState:function(){let e=!1;if("center"===this.alignment){const t=this.getContainedVisibleWindows();if(1===t.length){const i=t[0];e=!(i.horizontallyStretchableFlag&&(this.side==WUXDockAreaEnum.TopDockArea||this.side==WUXDockAreaEnum.BottomDockArea)||i.verticallyStretchableFlag&&(this.side==WUXDockAreaEnum.LeftDockArea||this.side==WUXDockAreaEnum.RightDockArea))}}e?this.elements.dockingZone.addClassName("wux-docking-element-fit-to-child"):this.elements.dockingZone.removeClassName("wux-docking-element-fit-to-child")},_saveDockingZoneSizeInPreferences:function(){if(""!==this.identifier){const e=this.getContainedVisibleWindows();for(let t=0;t<e.length;t++)e[t]._saveDockedDimensionsInPreferences()}},_getDockingZoneSizeFromPreferences:function(){if(""!==this.identifier){const t=this.getContainedVisibleWindows(),i=this.side===WUXDockAreaEnum.LeftDockArea||this.side===WUXDockAreaEnum.RightDockArea?"width":"height";for(var e=0;e<t.length;e++){const n=t[e]._getDockedDimensionsFromPreferences();if(n&&n[i])return n[i]}}},__shouldCollapserBeVisible:function(){return!(this.collapseDockingZoneFlag&&!n.call(this))&&this._parent()},__hasBackground:function(){return this.side===WUXDockAreaEnum.TopDockArea}})}),define("DS/Windows/WindowGroup",["UWA/Core","UWA/Array","DS/Windows/Window","DS/Controls/Tab","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Utilities/Utils"],function(e,t,i,n,o,s,a){"use strict";var r;Object.defineProperty(Array.prototype,"inter",{enumerable:!1,writable:!0,value:function(e){for(var t=[],i=this.concat(e),n=0;n<i.length;n++){var o=i[n];-1!=e.indexOf(o)&&-1!=this.indexOf(o)||t.push(o)}return t}}),r=i.inherit({publishedProperties:{groupType:{defaultValue:WUXWindowGroupTypeEnum.GroupAsTab,readOnly:!0},currentWindows:{defaultValue:[]},width:{defaultValue:-1,type:"integer",category:"Appearance"},height:{defaultValue:-1,type:"integer",category:"Appearance"}},_computedIdentifier:"",buildView:function(){this._parent(),this.elements.container.addClassName("wux-windows-windowgroup"),this.elements._contentDiv.addClassName("wux-windows-windowgroup-content"),this.elements._tabBarContainer=new e.Element("div",{class:"wux-windows-windowgroup-tab-bar-container"}),this.elements._tabBarContainer.inject(this.elements._titleDiv,"before"),this.elements._titleDiv.hide(),this.elements._draggableZoneDiv=new e.Element("div",{class:"wux-windows-windowgroup-draggable-zone"}),this.elements._draggableZoneDiv.inject(this.elements._titleP,"before"),this._tab=new n({tabBarDOMContainer:this.elements._tabBarContainer,tabPanelContainer:this.elements._contentDiv,multiSelFlag:!0,displayStyle:["panel","wide"],showComboBoxFlag:!0,autoCloseFlag:!1,reorderFlag:!1}),this._tab.tabBar.pinFlag=!0,this._tab.tabBar.centeredFlag=!1,this._tab.tabBar.closeButtonFlag=this.closeButtonFlag,this.allowedDockAreas=WUXDockAreaEnum.TopDockArea|WUXDockAreaEnum.BottomDockArea|WUXDockAreaEnum.LeftDockArea|WUXDockAreaEnum.RightDockArea},destroy:function(){var e=this.getEmbeddedWindows();if(e.length>0)for(var t=0;t<e.length;t++)e[t].destroy();else this._tab&&(this._tab.destroy(),this._tab=void 0),this._parent()},_applyTouchMode:function(){this._parent(),this._postEditTouchMode()},_postEditTouchMode:function(){this._parent();var e=this._getCurrentTouchMode();this._tab&&(this._tab.touchMode=e),this._updateMaxTabbarWidth()},_applyCurrentWindows:function(t){var i=[],n=[],o=this._tab.tabBar.pinnedList;if(o&&(n=this._tab.getIndexesFromValues(o)),null!=this.currentWindows&&0!==this.currentWindows.length){if(this.currentWindows.length>=1)for(var s=0;s<this.currentWindows.length;s++){var a=this._getIndexFromWindow(this.currentWindows[s]),r=this._tab.getPageValueFromIndex(a);if(n.length>0){for(var l=!0,d=0;d<n.length;d++)a==n[d]&&(l=!1);(l||-1!=this._tab.tabBar.value.indexOf(r))&&i.push(r)}else i.push(r)}e.equals(this._tab.value,i)||(this._tab.value=i)}if(this._updateResizableFlag(),this._updateWidthAndHeight(),this._updateMinWidth(),this._updateMinHeight(),this._updateMovableFlag(),this._tab.tabBar._slideToValue(),t)for(d=0;d<t.length;d++){var h=t[d];h&&-1==this.currentWindows.indexOf(h)&&h.windowGroup===this&&(h.activeFlag=!1)}if(this._updateCurrentWindowsActiveFlag(),this.currentDockArea!=WUXDockAreaEnum.NoneDockArea){var c=this.immersiveFrame?this.immersiveFrame.getDockingElement(this.currentDockArea):null;c&&(c.pointerEventsAllIfOverflow(),c._updateDockingZoneSize())}},_updateCurrentWindowsActiveFlag:function(){var e=this.getEmbeddedWindows();if(e)for(var t=0;t<e.length;t++){var i=e[t];i&&this.currentWindows&&-1!=this.currentWindows.indexOf(i)?i.activeFlag=this.activeFlag:i&&(i.activeFlag=!1)}},_applyActiveFlag:function(){this._parent(),this._updateCurrentWindowsActiveFlag()},_applyImmersiveFrame:function(e){this._parent(e);for(var t=this.immersiveFrame,i=this.getEmbeddedWindows(),n=0;n<i.length;n++){var o=i[n];o&&(o.immersiveFrame=t)}},_applyCurrentDockArea:function(e){var t=this.currentDockArea;t===WUXDockAreaEnum.BottomDockArea||t===WUXDockAreaEnum.TopDockArea?this._setTabMultiSelLayout("horizontal"):this._setTabMultiSelLayout("vertical"),this._parent(e);for(var i=this.getEmbeddedWindows(),n=0;n<i.length;n++){var o=i[n];o&&(o.currentDockArea=t)}this._updateWidthAndHeight(),this._updateMinWidth(),this._tab.tabBar.redrawTabBar()},_applyRecId:function(e){this._parent(e),void 0!==this.recId&&null!==this.recId&&(this._tab.recId=this.recId+"_Tab")},_applyMinWidth:function(e){if(this._parent(e),this.currentDockArea===WUXDockAreaEnum.BottomDockArea&&this._tab&&this._tab.tabBar&&this._tab.tabBar.centeredFlag){var t=this.minWidth;void 0!==t?this.elements._mainContentDiv.setStyle("min-width",t+"px"):this.elements._mainContentDiv.setStyle("min-width","")}else this.elements._mainContentDiv.setStyle("min-width","")},_applyWidth:function(e){null!==this.width&&(this._updateMaxWidth(),-1===this.width?(this.getContent().setStyle("width","auto"),this.elements._mainContentDiv.setStyle("width","auto"),this.currentDockArea===WUXDockAreaEnum.NoneDockArea||this.currentDockArea===WUXDockAreaEnum.TopDockArea||(this.currentDockArea,WUXDockAreaEnum.BottomDockArea),this.elements._footerDiv&&this.elements._footerDiv.setStyle("width","calc(100% - 10px)")):void 0!==this.minWidth&&(this.width>=this.minWidth?(l.call(this,this.width),this.elements._mainContentDiv.setStyle("width",this.width+"px")):this.width=this.minWidth),e&&this.width!==e&&this._fireAndBroadcast("resize",{bubbles:!1})),this._tab.tabBar.redrawTabBar(),this._updateTitleBarWidth()},_applyHeight:function(e){this._updateMaxHeight(),null!==this.height&&(-1===this.height?(this.elements._mainContentDiv.setStyle("height",""),this._updateContentHeight()):(this.height>=this.minHeight?(d.call(this,this.height),this._updateContentHeight()):this.height=this.minHeight,e&&this.height!==e&&this.fire("resize",{bubbles:!1})))},_applyMaximizedFlag:function(e){if(this._parent(e),this.currentWindows)for(var t=0;t<this.getEmbeddedWindows().length;t++){this.getEmbeddedWindows()[t].maximizedFlag=this.maximizedFlag}this._updateTabCloseButtons()},_applyCloseButtonFlag:function(){this._parent(),this._updateMaxTabbarWidth()},_applyMaximizeButtonFlag:function(){this._parent(),this._updateMaxTabbarWidth()},_applyAllowMaximizeFlag:function(){this._parent(),this._updateMaxTabbarWidth()},_updateWidthAndHeight:function(){if(this.currentWindows.length>0)if(this._updateResizableFlag(),"horizontal"!==this._getTabMultiSelLayout()){for(var e=this.currentWindows[0].width,t=-1===this.currentWindows[0].height,i=t?parseInt(window.getComputedStyle(this.currentWindows[0].getContent()).height):this.currentWindows[0].height,n=1;n<this.currentWindows.length;n++){-1!==(r=this.currentWindows[n]).width&&(e=e>r.width?e:r.width),-1===r.height?i=i+parseInt(window.getComputedStyle(r.getContent()).height)+1:(t=!1,i=i+r.height+1)}this.width!==e?this.width=e:this._applyWidth(),t?this.height=-1:i&&this.height!==i?this.height=i:this._applyHeight()}else{var o=this.currentWindows[0].height,s=-1===this.currentWindows[0].width,a=s?parseInt(window.getComputedStyle(this.currentWindows[0].getContent()).width):this.currentWindows[0].width;for(n=1;n<this.currentWindows.length;n++){var r;!1!==(r=this.currentWindows[n]).resizableFlag&&"horizontal"!==r.resizableFlag||(o=o>r.height?o:this.currentWindows[n].height),-1===r.width?a=a+parseInt(window.getComputedStyle(r.getContent()).width)+1:(s=!1,a=a+r.width+1)}s?this.width=-1:a&&this.width!==a?this.width=a:this._applyWidth(),o&&this.height!==o?this.height=o:this._applyHeight()}},_updateMaxTabbarWidth:function(){var e=0;this.closeButtonFlag&&e++,this.maximizeButtonFlag&&this.allowMaximizeFlag&&e++;var t=24;if(this.touchMode&&(t=36),this._tab.tabBar.centeredFlag){var i="100%",n=this.immersiveFrame.getDockingElement(this.currentDockArea);n&&(i=n._getFixedAreaWidth()-t+"px"),this.elements._tabBarContainer.setStyle("max-width",i)}else this.elements._tabBarContainer.setStyle("max-width","calc(100% - "+t*(e+1)+"px)")},_applyProperties:function(e){this._parent(e),this.isDirty("currentWindows")&&this._applyCurrentWindows(e.currentWindows),this._postEditTouchMode()},_setTitleBarCenteredFlag:function(e){this._parent(e),this._tab&&this._tab.tabBar&&(this._tab.tabBar.centeredFlag=e),this.elements._draggableZoneDiv&&(e?this.elements._draggableZoneDiv.hide():this.elements._draggableZoneDiv.show())},_computeDropInsertionData:function(e){var t=-1,i="after",n=-1,o=this._tab.tabBar._getVisibleTabButtons(),s=this.elements._titleBarDiv.getBoundingClientRect().left,a=s;if(this._tab.tabBar.showComboBoxFlag&&this._tab.tabBar.tabComboBox&&this._tab.tabBar.tabComboBox.visibleFlag){var r=this._tab.tabBar.tabComboBox.getContent().getBoundingClientRect().right;if(e.x>r)return{movedWindowNewIndex:t,targetWindow:this._getWindowFromIndex(this.getEmbeddedWindows().length-1),beforeOrAfter:i,stopWindowGroupTabBarSliding:!0}}for(var l=0;l<o.length;l++){var d=this._tab.tabBar.getButtonFromValue(this._tab.getPageValueFromIndex(l)),h=d.getContent().getBoundingClientRect().left,c=d.getContent().getBoundingClientRect().right,u=0;if(!(c<=s)){if(u=h<=s?Math.abs(c-s):this._tab.tabBar.getWidthOfButton(d),e.x<a+u/2){t=l,n=l,i="before";break}if(e.x<a+u){t=l+1<o.length?l+1:l,n=l,i="after";break}a+=u}}return{movedWindowNewIndex:t,targetWindow:-1!=n?this._getWindowFromIndex(n):this._getWindowFromIndex(this.getEmbeddedWindows().length-1),beforeOrAfter:i}},getCollapsibleState:function(){for(var e=0;e<this.currentWindows.length;e++)if(!this.currentWindows[e].collapsibleFlag)return!1;return this.groupType===WUXWindowGroupTypeEnum.GroupAsTab&&this.currentDockArea!==WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==WUXDockAreaEnum.BottomDockArea},getFloatableState:function(){for(var e=!0,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&!(e=n.getFloatableState()))break}return e},getEmbeddedWindows:function(){var e=[];if(this._tab)for(var t=this._tab.getPageCount(),i=0;i<t;i++){var n=this._getWindowFromIndex(i);e.push(n)}return e},getVisibleEmbeddedWindows:function(){for(var e=[],t=this._tab.getPageCount(),i=0;i<t;i++){var n=this._getWindowFromIndex(i);n.visibleFlag&&e.push(n)}return e},containsWindow:function(e){var t=!1;if(e)for(var i=this.getEmbeddedWindows(),n=i.length;n--;){if(i[n]===e){t=!0;break}}return t},attachWindow:function(e,t,i){var n=-1;return e&&this.groupType===WUXWindowGroupTypeEnum.GroupAsTab&&(n=this._stackWindowNextTo(e,t,i,void 0)),n},_stackWindowNextTo:function(e,t,i,n,a){var r=this;var l=-1;if(e&&this.groupType===WUXWindowGroupTypeEnum.GroupAsTab){if(this.containsWindow(e))return l;if(e&&e.isAWindowGroup()&&e.groupType===WUXWindowGroupTypeEnum.GroupAsTab){var d=e.getEmbeddedWindows();for(var h in l=1,d){l=-1===d[h]._attachToWindow(t,i,n,a)?-1:l}return l}if(e&&e._canBeSnapSource(t,i)&&e!==t&&(!t||i===WUXSnapAreaEnum.InsideArea&&t._canBeSnapTarget(e,i))){var c=e.activeFlag;if(t?l=t===this?1:this.containsWindow(t)?1:-1:0===this.getEmbeddedWindows().length&&(l=1),l<0)return l;var u=e.windowGroup;if(u){if(u===this&&this.containsWindow(e))return 1;var m=!1,p=u.getAbsolutePosition();if(!t&&u.groupType===WUXWindowGroupTypeEnum.GroupAsGrid){if((l=u._attachToWindow(this,e,WUXSnapAreaEnum.BottomArea,n,a))<0)return l;m=!0}u.detachWindow(e);m&&u.setAbsolutePosition(p)}t&&e.getDockedFlag()&&(e.currentDockArea=WUXDockAreaEnum.NoneDockArea),e.expandedFlag=!0,!0!==e.resizableFlag&&"true"!==e.resizableFlag&&"vertical"!==e.resizableFlag&&"horizontal"!==e.resizableFlag||i===WUXSnapAreaEnum.InsideArea&&(!0!==e.resizableFlag&&"true"!==e.resizableFlag&&"horizontal"!==e.resizableFlag||(e.width=this._getMonoSelectionWidth()),!0!==e.resizableFlag&&"true"!==e.resizableFlag&&"vertical"!==e.resizableFlag||(t.currentDockArea!==WUXDockAreaEnum.RightDockArea&&t.currentDockArea!==WUXDockAreaEnum.LeftDockArea||!t.verticallyStretchableFlag)&&(-1===t.height?e.height=t.elements._mainContentDiv.clientHeight:e.height=t.height)),e.setPropertyFromUIInteraction("maximizedFlag",this.maximizedFlag),!t&&e.getDockedFlag()&&(this.setPropertyFromUIInteraction("currentDockArea",e.currentDockArea),this.inject(e.getContent(),"before"));var g,f=e.getAbsolutePosition();if(e.remove(),n){var w=this.getEmbeddedWindows();if(-1!==w.indexOf(t)){var _=w.indexOf(t);"before"===n?g=_:"after"===n&&(g=_+1)}}this._tab.addTab(e.title,e.getContent(),g,!0,void 0,e.icon,e.closeButtonFlag,e.showTitleFlag||!e.icon),e.windowGroup=this,this._updateRecId();var v=this._tab.tabBar.getButtonFromValue(this._tab.value[0]);v&&s.addEventOnElement(this,v,o.POINTERDOWN,function(t){e._onDragPointerDown(t);var i=t.dsModel,n=r._getWindowFromIndex(r._tab.getPageIndexFromValue(i.value));e.addEventListener("stopWindowDrag",function(){i&&n&&!r.containsWindow(n)&&(i.destroy(),0===r.getEmbeddedWindows().length&&r.destroy())})}),this.getDockedFlag()?e.currentDockArea=this.currentDockArea:t||e.getDockedFlag()&&(this.currentDockArea=e.currentDockArea),t||this.setAbsolutePosition(f),this._updateVisibleState(),this._updateTitle(),this._updateCloseButtonFlag(),this._updateAllowedDockAreas(),this._updateResizableFlag(),this._updateMaximizedState(),this._postEditTouchMode(),this._updateTabCloseButtons(),this._updateMaximizeButtonFlag(),this._updateAllowMaximizeFlag(),e.visibleFlag||this._setWindowVisibility(e,e.visibleFlag),(this.activeFlag||c)&&(this.activeFlag=!0,this._updateCurrentWindows())}}return this._updateComputedIdentifier(),l},detachWindow:function(e){return this._detachWindow(e,!1)},_detachWindow:function(e,t){var i=-1;if(e){if(!this.containsWindow(e))return i;if(this.groupType===WUXWindowGroupTypeEnum.GroupAsTab){this.currentWindows.length;var n=this.getAbsolutePosition();i=1;var o=this.activeFlag;this.activeFlag=!1,e.getContent().hide();var s=2===this.getEmbeddedWindows().length?this.getEmbeddedWindows()[0]===e?this.getEmbeddedWindows()[1]:this.getEmbeddedWindows()[0]:this;t&&1!==this.getEmbeddedWindows().length?this._tab.removeTab(e.getContent(),!0):this._tab.removeTab(e.getContent(),!1),e.windowGroup===this&&(e.windowGroup=null),t&&e._saveWindowGroupInPreferences(s),e._isBeingClosed||(this.immersiveFrame&&(e.getDockedFlag()?1===this.getEmbeddedWindows().length?this.immersiveFrame.dockWindow(e,e.currentDockArea):(e.currentDockArea=WUXDockAreaEnum.NoneDockArea,this.immersiveFrame.moveWindowToImmersiveFrame(e)):this.immersiveFrame.moveWindowToImmersiveFrame(e)),e.visibleFlag&&e.getContent().show(),e._updateFromEmbeddedState());var a=this.getEmbeddedWindows();if(0===a.length){var r=this.windowGroup;if(r&&!e._isBeingClosed?(n=r.getAbsolutePosition(),i=r.attachWindow(e,this,WUXSnapAreaEnum.BottomArea)):this.immersiveFrame&&(this.immersiveFrame.dockWindow(e,this.currentDockArea),e.inject(this.getContent(),"before")),t?this.visibleFlag=!1:this.destroy(),r)return r.setAbsolutePosition(n),i}else{if(this._updateVisibleState(),this._updateCloseButtonFlag(),this._updateMaximizeButtonFlag(),this._updateAllowMaximizeFlag(),this._applyResizableFlag(),1===a.length){s=a[0];this._detachWindow(s,t),s.maximizedFlag=this.maximizedFlag}a.length>=1&&(e.maximizedFlag=!1)}o&&(e.activeFlag=!0),e.setAbsolutePosition(n),e._applyWidth(),e._applyHeight(),a.length>1&&(this._updateTitle(),this._updateAllowedDockAreas(),this._updateMovableFlag())}}return this._updateComputedIdentifier(),this._updateRecId(),i},_createWindowGroup:function(e){return new r({groupType:e,immersiveFrame:this.immersiveFrame})},_canBeSnapSource:function(e,t){for(var i=!0,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];if(s&&!(i=s._canBeSnapSource(e,t)))break}return i},_canBeSnapTarget:function(e,t){for(var i=!0,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];if(s&&!(i=s._canBeSnapTarget(e,t)))break}return i},attachToWindow:function(e,t){var i=-1;if(e&&t!==WUXSnapAreaEnum.NoneArea&&t!==WUXSnapAreaEnum.OutsideArea&&this._canBeSnapSource(e,t)&&e._canBeSnapTarget(this,t)&&this.groupType===WUXWindowGroupTypeEnum.GroupAsTab)if(i=1,t===WUXSnapAreaEnum.InsideArea){for(var n=this.currentWindows.slice(),o=this.getEmbeddedWindows(),s=0;s<o.length;s++){var a=o[s];if(a){var l=a.attachToWindow(e,t);l<0&&(i=l)}}e instanceof r?e.currentWindows=n:e.windowGroup&&(e.windowGroup.currentWindows=n)}else i=this._parent(e,t);return i},_pinOrUnpinWindow:function(e){if(e&&-1!==this.getEmbeddedWindows().indexOf(e)){var t=this._tab.getPageValueFromIndex(this._getIndexFromWindow(e));this._tab.tabBar.pinTab(t)}},_setTabMultiSelLayout:function(e){this._tab.multiSelLayout=e},_getTabMultiSelLayout:function(){return this._tab.multiSelLayout},_fireAndBroadcast:function(e,t){this._parent(e,t);for(var i=this.currentWindows,n=0;n<i.length;n++){var o=i[n];o&&o._fireAndBroadcast(e,t)}},_updateTitle:function(){for(var e="",t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n){if(0===i?e="[":e+=", ",e+=n.title,i===t.length-1)e+="]";else if(5===i){e+=", ...]";break}var o=this._tab.getPageValueFromIndex(this._getIndexFromWindow(n));this._tab.getOptionFromButton("label",o)!==n.title&&this._tab.setOptionFromButton("label",n.title,o),this._tab.getOptionFromButton("icon",o)!==n.icon&&this._tab.setOptionFromButton("icon",n.icon,o)}}this.title=e},_updateVisibleState:function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];n&&n.visibleFlag&&(e=!0)}this.visibleFlag=e},_updateContentVisibleStateChange:function(){this._parent();for(var e=this.currentWindows,t=0;t<e.length;t++){e[t]._updateContentVisibleStateChange()}},_updateCloseButtonFlag:function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&n.closeButtonFlag){e=!0;break}}this.closeButtonFlag=e,this.maximizedFlag&&this._updateTabCloseButtons()},_updateTabCloseButtons:function(){for(var e=this.getEmbeddedWindows(),t=0;t<e.length;t++){var i=e[t];i&&this.maximizedFlag?this._tab.tabBar.setAllowClosableFlagOnValue(this._tab.getPageValueFromIndex(this._getIndexFromWindow(i)),i.closeButtonFlag):this._tab.tabBar.setAllowClosableFlagOnValue(this._tab.getPageValueFromIndex(this._getIndexFromWindow(i)),!1)}},_updateMaximizeButtonFlag:function(){var e=!0;if(this.allowMaximizeFlag)for(var t=this._getCurrentAndPinnedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&(!n.maximizeButtonFlag||!n.allowMaximizeFlag)){e=!1;break}}else e=!1;this.maximizeButtonFlag=e},_updateAllowMaximizeFlag:function(){for(var e=this.getEmbeddedWindows(),t=0;t<e.length;t++){var i=e[t];if(i&&!i.allowMaximizeFlag)return void(this.allowMaximizeFlag=!1)}this.allowMaximizeFlag=!0},_updateAllowedDockAreas:function(){for(var e=WUXDockAreaEnum.LeftDockArea+WUXDockAreaEnum.TopDockArea+WUXDockAreaEnum.RightDockArea+WUXDockAreaEnum.BottomDockArea,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n)for(var o in WUXDockAreaEnum){var s=WUXDockAreaEnum[o];if(!(n.allowedDockAreas&s)&&e&s&&0===(e-=s))break}}this.allowedDockAreas=e},_updateRecId:function(){for(var e="WindowGroup_",t=e,i=this.getEmbeddedWindows(),n=0;n<i.length;n++){var o=i[n];o&&o.recId&&(t!==e&&(t+=";"),t+=o.recId)}t!==e&&(this.recId=t)},_onCloseButtonClick:function(e){var t=this.getVisibleEmbeddedWindows();if(t)for(var i=t.length-1;i>=0;i--){var n=t[i];n&&n.closeButtonFlag&&(n.disabled||n.callMethodFromUIInteraction("close"))}},_updateComputedIdentifier:function(){for(var e="[",t=this.getEmbeddedWindows(),i=0;i<t.length;i++)0!==i&&(e+=";"),e+=t[i].identifier;e+="]",this._computedIdentifier=e},_updateMaximizedState:function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&n.maximizedFlag){e=!0;break}}this.maximizedFlag=e},_updateResizableFlag:function(){var e=!1,t=this.currentWindows;if(1!==t.length){for(var i="horizontal"!==this._getTabMultiSelLayout(),n=0;n<t.length;n++){var o=t[n];if(o){if(i&&(!0===o.resizableFlag||"true"===o.resizableFlag||"horizontal"===o.resizableFlag)){e="horizontal";break}if(!i&&(!0===o.resizableFlag||"true"===o.resizableFlag||"horizontal"===o.resizableFlag)){e="vertical";break}}}this.resizableFlag=e}else this.resizableFlag=this.currentWindows[0].resizableFlag},_updateMinWidth:function(){if(this.currentWindows&&this.currentWindows.length>0&&this.immersiveFrame&&this.immersiveFrame.isInsertedInDOM()){var e,t=0;if((this.currentDockArea===WUXDockAreaEnum.BottomDockArea||this.currentDockArea===WUXDockAreaEnum.TopDockArea)&&this._tab&&this._tab.tabBar){var i;if(this._tab.tabBar.centeredFlag)i=parseInt(window.getComputedStyle(this.elements._tabBarContainer).width)+2;else{i=this._tab.tabBar.getWidthOfAllVisibleButtons(),this._tab.tabBar._applyInheritWidthToButtons();var n=parseInt(window.getComputedStyle(this.elements._titleBarDiv).width),o=parseInt(window.getComputedStyle(this.elements._tabBarContainer).width);isNaN(n)||isNaN(o)||(i=i+n-o)}if(t=i,this.immersiveFrame){var s=this.immersiveFrame.getDockingElement(this.currentDockArea)._getDockingZoneDimensions();t>s.width&&(t=s.width-1)}}for(var a=0;a<this.currentWindows.length;a++)(e=this.currentWindows[a])&&-1!=e.width&&t<e.minWidth&&(t=e.minWidth);t=parseInt(t),this.minWidth=t}},_updateMinHeight:function(){if(this.currentWindows&&this.currentWindows.length>0){for(var e,t=this.currentWindows[0].minHeight,i=0;i<this.currentWindows.length;i++)(e=this.currentWindows[i])&&t<e.minHeight&&(t=e.minHeight);this.minHeight=t}},_updateMovableFlag:function(){for(var e=!0,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&!n.movableFlag){e=!1;break}}this.movableFlag=e},_getMonoSelectionWidth:function(){var e=this._getCurrentAndPinnedWindows();if(1===e.length)return-1===this.width?parseInt(window.getComputedStyle(e[0].getContent()).width):this.width;if(e.length>1){for(var t=0;t<e.length;t++){var i=e[t];if(-1!==i.width)return i.width}return parseInt(window.getComputedStyle(e[0].getContent()).width)}},_getCurrentAndPinnedWindows:function(){for(var e=this._tab.value,t=[],i=this._tab.getIndexesFromValues(e),n=0;n<i.length;n++){var o=i[n];if(o>=0)(r=this._getWindowFromIndex(o))&&t.push(r)}var s=this._tab.tabBar.pinnedList;if(s){var a=this._tab.getIndexesFromValues(s);for(n=0;n<a.length;n++){var r,l=a[n];if(l>=0&&-1==i.indexOf(l))(r=this._getWindowFromIndex(l))&&t.push(r)}}return t},_updateCurrentWindows:function(){var e=this._getCurrentAndPinnedWindows();this._updateHorizontallyStretchableFlag(),this._updateVerticallyStretchableFlag();var t=this.currentWindows.inter(e);this.currentWindows=e;for(var i=0;i<t.length;i++){t[i]._updateContentVisibleStateChange()}this._applyPosition()},_updateHorizontallyStretchableFlag:function(){for(var e=this._getCurrentAndPinnedWindows(),t=!1,i=0;i<e.length;i++)if(e[i]&&!0===e[i].horizontallyStretchableFlag){t=!0;break}this.horizontallyStretchableFlag=t},_updateVerticallyStretchableFlag:function(){for(var e=this._getCurrentAndPinnedWindows(),t=!1,i=0;i<e.length;i++)if(e[i]&&!0===e[i].verticallyStretchableFlag){t=!0;break}this.verticallyStretchableFlag=t},_getWindowFromIndex:function(e){var t=this._tab.getPageContentFromIndex(e);return t&&t.dsModel?t.dsModel:t},_getIndexFromWindow:function(e){return this._tab.getIndexOf(e.getContent())},_setWindowVisibility:function(e){var t=e.visibleFlag;if(this._tab._setTabVisibility(this._tab.getPageValueFromIndex(this._getIndexFromWindow(e)),t),t)t&&0===this.currentWindows.length&&(this.currentWindows=[e]);else if(-1!==this.currentWindows.indexOf(e)&&this.currentWindows.splice(this.currentWindows.indexOf(e),1),0===this.currentWindows.length)for(var i=this.getEmbeddedWindows(),n=0;n<i.length;n++){var o=i[n];if(o.visibleFlag){this.currentWindows=[o];break}}this._updateVisibleState()},_manageReorder:function(e,t){var i=this._getIndexFromWindow(e);if(this._tab.tabBar.showComboBoxFlag&&this._tab.tabBar.tabComboBox&&this._tab.tabBar.tabComboBox.visibleFlag){if(!a.isMouseOverElement(this._tab.tabBar.buttonGroup.getContent(),t))return void this.immersiveFrame._stopWindowGroupTabBarSliding();var n=this.elements._titleBarDiv.getBoundingClientRect().left,o=this._tab.tabBar.buttonGroup.getContent().getBoundingClientRect().right;Math.abs(t.x-n)<=7?this.immersiveFrame._startWindowGroupTabBarSliding(this._tab.tabBar,"left"):Math.abs(t.x-o)<=7?this.immersiveFrame._startWindowGroupTabBarSliding(this._tab.tabBar,"right"):this.immersiveFrame._stopWindowGroupTabBarSliding()}var s=this._computeDropInsertionData(t);s.stopWindowGroupTabBarSliding&&this.immersiveFrame._stopWindowGroupTabBarSliding(),i!==s.movedWindowNewIndex&&(this._tab.tabBar._exchangeTabs(this._tab.getPageValueFromIndex(i),this._tab.getPageValueFromIndex(s.movedWindowNewIndex)),this._tab.tabBar._slideToValue())},close:function(){if(this.autoCloseFlag){var e=this.activeFlag,t=this.getEmbeddedWindows();if(t)for(var i=t.length-1;i>=0;i--){var n=t[i];n&&n.close()}(t=this.getEmbeddedWindows())&&t.length>1&&e&&(this.activeFlag=!0)}else this.fire("close")},_saveDockAreaInPreferences:function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._saveDockAreaInPreferences()}},_saveMaximizeInPreferences:function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._saveMaximizeInPreferences()}},_savePositionInPreferences:function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._savePositionInPreferences()}},_saveDimensionsInPreferences:function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._saveDimensionsInPreferences()}},_saveDockedDimensionsInPreferences:function(){for(var e=0;e<this.getVisibleEmbeddedWindows().length;e++){this.getVisibleEmbeddedWindows()[e]._saveDockedDimensionsInPreferences()}},_getDockedDimensionsFromPreferences:function(){for(var e={},t=0;t<this.getVisibleEmbeddedWindows().length;t++){var i=this.getVisibleEmbeddedWindows()[t]._getDockedDimensionsFromPreferences();if(i&&(!e.width&&i.width&&(e.width=i.width),!e.height&&i.height&&(e.height=i.height),e.width&&e.height))break}return e},handleEvents:function(){this._parent();var e=this;this._tab.tabBar.addEventListener("pinStateChange",function(t){var i=e._getWindowFromIndex(e._tab.getPageIndexFromValue(t.options.value));i&&void 0!==t.options.pinnedFlag?(i._properties.pinnedFlag.value=t.options.pinnedFlag,void 0!==i.identifier&&i._savePinnedFlagInPreferences()):console.log(t)}),this._tab.addEventListener("change",function(t){e._applyPosition(),e._updateCurrentWindows()}),this._tab.tabBar.onRemoveTabEvent(function(t){e._getWindowFromIndex(t.index).close()}),this._tab.tabBar.onPinTab(function(t){e._updateCurrentWindows()}),this._tab.tabBar.onUnpinTab(function(t){e._updateCurrentWindows()}),this.elements._contentDiv.addEventListener("placeChange",function(e){}),this.addEventListener("move",function(t){e._tab.tabBar.tabComboBox._hidePopup()})},_buildOrDelagateContextualMenu:function(e){var t=[];if(e&&e.infos&&e.infos.target){var i=s.firstParentWithClass(e.infos.target,"wux-controls-button"),n=i?i.dsModel:void 0,o=n?n.value:this.currentWindows&&this.currentWindows.length>0?this._getIndexFromWindow(this.currentWindows[0]):0,a=this._getWindowFromIndex(this._tab.getPageIndexFromValue(o));e.isGroupTarget=!n,a&&(t=a.onContextualEvent(e))}return t},_getMenuToAddData:function(e,t){var i,n=!1,o=!1;if(t.infos&&t.infos.target){var a=s.firstParentWithClass(t.infos.target,"wux-controls-button");i=a?a.dsModel:void 0,"close"===e?(n=i&&void 0!==i.value?void 0!==this._tab.tabBar.getButtonFromValue(i.value).elements._closeButton:this.closeButtonFlag,i||(o=!0)):"maximize"===e&&(n=this.maximizeButtonFlag)}return{canbeAdded:n,menuTarget:i,closeAll:o}},_onCloseContextMenuAction:function(e){e?this._tab.tabBar._closeListener(e):this.close()},_activateWindowForContextMenu:function(e){var t=s.firstParentWithClass(e,"wux-controls-button"),i=t?t.dsModel:void 0;i&&(this.activeFlag=!0,i.checkFlag=!0)}});var l=function(e){if((!0===this.resizableFlag||"true"===this.resizableFlag||"horizontal"===this.resizableFlag)&&e>=this.minWidth)for(var t=this.getEmbeddedWindows(),i=0;i<t.length;i++)!0!==t[i].resizableFlag&&"true"!==t[i].resizableFlag&&"horizontal"!==t[i].resizableFlag||(t[i].width=e)},d=function(e){if((!0===this.resizableFlag||"true"===this.resizableFlag||"vertical"===this.resizableFlag)&&e>=this.minHeight)for(var t=this.getEmbeddedWindows(),i=0;i<t.length;i++)!0!==t[i].resizableFlag&&"true"!==t[i].resizableFlag&&"vertical"!==t[i].resizableFlag||(t[i].height=e)};return r}),define("DS/Windows/Panel",["UWA/Core","DS/Windows/Window","DS/Windows/WindowGroup","DS/Utilities/Utils","DS/Controls/Button","DS/Controls/Expander","DS/Core/PointerEvents","DS/Utilities/Dom"],function(e,t,i,n,o,s,a,r){"use strict";return t.inherit({name:"panel",publishedProperties:{collapsibleFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},snappableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},floatableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},headerPopupContent:{defaultValue:void 0,type:Object,category:"Behavior"},pinnedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showTitleFlag:{defaultValue:!0,type:"boolean",category:"Behavior"}},buildView:function(){this._parent(),this._savedPreferencesKeys.push("pinnedFlag"),this.elements.container.addClassName("wux-windows-panel wux-medium-background"),this.elements._titleBarDiv.addClassName("wux-windows-panel"),this.elements._buttonsDiv=new e.Element("div",{class:"wux-windows-panel-buttons"}),this.elements._buttonsDiv.inject(this.elements._mainContentDiv,"top"),this.elements._buttonsDiv.hide(),this.allowedDockAreas=WUXDockAreaEnum.TopDockArea|WUXDockAreaEnum.BottomDockArea|WUXDockAreaEnum.LeftDockArea|WUXDockAreaEnum.RightDockArea},_applyHeaderPopupContent:function(t){function i(e){if(l.elements._headerPopup&&l.elements._headerPopup.elements&&!r.isElementInside(e.target,l.elements._headerPopup.elements.header)&&!r.isElementInside(e.target,l.elements._headerPopup.elements.expanderContainer)){var t=Object.keys(l.buttons).length;void 0!==l.buttons&&t>0&&e.target.parentNode!==l.buttons.Ok.getContent()&&e.target!==l.buttons.Ok.getContent()&&e.target.parentNode!==l.buttons.Cancel.getContent()&&e.target!==l.buttons.Cancel.getContent()?l.elements._headerPopup.close():0===t&&l.elements._headerPopup.close()}}function n(e){if(l.elements._headerPopup&&l.elements._headerPopup.elements&&!r.isElementInside(e.target,l.elements._headerPopup.elements.header)&&!r.isElementInside(e.target,l.elements._headerPopup.elements.expanderContainer)){var t=Object.keys(l.buttons).length;void 0!==l.buttons&&t>0&&e.target.parentNode!==l.buttons.Ok.getContent()&&e.target!==l.buttons.Ok.getContent()&&e.target.parentNode!==l.buttons.Cancel.getContent()&&e.target!==l.buttons.Cancel.getContent()?(l.elements._headerPopup.close(),e.target!==l.elements._titleBarDiv&&e.stopPropagation()):0===t&&(l.elements._headerPopup.close(),e.stopPropagation())}}function o(e){l.elements._headerPopup.close()}if(this.headerPopupContent.content){this.elements._headerPopup&&(this.elements._headerPopup.hasClassName&&this.elements._headerPopup.hasClassName("wux-windows-panel-simplesuperfeature")||this.elements._headerPopup.getContent&&this.elements._headerPopup.getContent()&&this.elements._headerPopup.getContent().hasClassName("wux-windows-panel-simplesuperfeature"))&&(this.elements._headerPopup.destroy(),delete this.elements._headerPopup),this.elements._headerPopup?(this.elements._headerPopup.header=this.headerPopupContent.title,this.elements._headerPopup.body=this.headerPopupContent.content):this.elements._headerPopup=new s({header:this.headerPopupContent.title,body:this.headerPopupContent.content,style:"mode-selector"}),this.elements._buttonsDiv.removeClassName("wux-windows-panel-buttons"),this.elements._buttonsDiv.addClassName("wux-windows-panel-expander"),this.elements._mainContentDiv.style.background="",this.elements._contentDiv.style.animation="wux-unblur 0.3s forwards",this.elements._mainContentDiv.style.pointerEvents="all",document.removeEventListener(a.POINTERUP,i),document.removeEventListener(a.POINTERDOWN,n,!0),t&&t.content&&r.removeEventOnElement(this,t.content,"buttonclick",o),this.elements._buttonsDiv.show();var l=this;r.addEventOnElement(this,this.headerPopupContent.content,"buttonclick",o),r.addEventOnElement(this,this.elements._headerPopup,"transitionend",function(e){e.target===l.elements._headerPopup&&e.stopPropagation()}),r.addEventOnElement(this,this.elements._headerPopup,"expand",function(e){l.elements._mainContentDiv.style.background="rgba(255, 255, 255, 0.76)",l.elements._contentDiv.style.animation="wux-blur 0.3s forwards",l.elements._mainContentDiv.style.pointerEvents="none",document.addEventListener(a.POINTERUP,i),document.addEventListener(a.POINTERDOWN,n,!0)}),r.addEventOnElement(this,this.elements._headerPopup,"collapse",function(e){l.elements._mainContentDiv.style.background="",l.elements._contentDiv.style.animation="wux-unblur 0.3s forwards",l.elements._mainContentDiv.style.pointerEvents="all",document.removeEventListener(a.POINTERUP,i),document.removeEventListener(a.POINTERDOWN,n,!0)}),r.addEventOnElement(this,this.elements._titleBarDiv,a.POINTERDOWN,function(e){l.elements._headerPopup.close()})}else this.elements._headerPopup&&!this.elements._headerPopup.hasClassName("wux-windows-panel-simplesuperfeature")&&(this.elements._headerPopup.destroy(),delete this.elements._headerPopup),this.elements._headerPopup?this.elements._headerPopup.setText(this.headerPopupContent.title):(this.elements._headerPopup=new e.Element("div",{class:"wux-windows-panel-simplesuperfeature",text:this.headerPopupContent.title}),this.elements._buttonsDiv.addClassName("wux-windows-panel-buttons"),this.elements._buttonsDiv.removeClassName("wux-windows-panel-expander"));this.elements._headerPopup.inject(this.elements._buttonsDiv),this._applyButtons()},_applyTouchMode:function(){this._parent(),this._postEditTouchMode()},_postEditTouchMode:function(){this._parent()},_superFeatureCallback:function(e,t,i,n){return i&&(this.headerPopupContent={title:e.label,content:n}),e.checkFlag=!0,t&&t(),e.label},buildSuperFeature:function(t){var i=this,n=!t.title,a=void 0;if(this.elements._buttonsDiv.hasChildNodes()&&this.elements._headerPopup)for(var r=0;r<this.elements._buttonsDiv.childNodes.length;r++){var l=this.elements._buttonsDiv.childNodes[r];(l.dsModel&&l.dsModel instanceof s||l.hasClassName("wux-windows-panel-simplesuperfeature"))&&(l.remove(),this.elements._headerPopup=void 0)}if(t.content){(a=new e.Element("div",{class:"wux-windows-panel-superfeature"})).setStyles({display:"flex","justify-content":"space-around"});for(r=0;r<t.content.length;r++){var d=new o({type:"radio",label:t.content[r].label,icon:t.content[r].icon,value:r,displayStyle:"lite-borders",clickMode:1,onClick:function(e){i._superFeatureCallback(e.dsModel,t.content[e.dsModel.value].onSelect,n,a)}});d.inject(a),d.getContent().setStyle("flex-grow","1"),0===r&&this._superFeatureCallback(d,t.content[0].onSelect,n,a)}}return t.content||n?this.headerPopupContent={title:t.title?t.title:t.content[0].label,content:a}:this.headerPopupContent={title:t.title},this.headerPopupContent},buildStandardButtons:function(){var e=new o({icon:{iconName:"check",fontIconFamily:WUXManagedFontIcons.Font3DS},emphasize:"secondary"});e.elements.container.addClassName("wux-windows-panel-apply");var t=new o({icon:{iconName:"wrong",fontIconFamily:WUXManagedFontIcons.Font3DS}});t.elements.container.addClassName("wux-windows-panel-cancel"),this.buttons={Ok:e,Cancel:t},r.addEventOnElement(this,e,a.POINTERUP,function(e){e.stopPropagation()}),r.addEventOnElement(this,t,a.POINTERUP,function(e){e.stopPropagation()})},getCollapsibleState:function(){return this.collapsibleFlag&&this.currentDockArea!==WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==WUXDockAreaEnum.BottomDockArea&&!this.maximizedFlag&&!(this.currentDockArea===WUXDockAreaEnum.LeftDockArea&&this.verticallyStretchableFlag)&&!(this.currentDockArea===WUXDockAreaEnum.RightDockArea&&this.verticallyStretchableFlag)},getFloatableState:function(){return this.floatableFlag},supportsGroupType:function(e){return e===WUXWindowGroupTypeEnum.GroupAsTab},_canBeSnapSource:function(e,t){var i=e&&this.snappableFlag&&e!==this||t===WUXSnapAreaEnum.OutsideArea||t===WUXSnapAreaEnum.NoneArea;if(i&&e&&(i=e.immersiveFrame===this.immersiveFrame),i&&t!==WUXSnapAreaEnum.OutsideArea&&t!==WUXSnapAreaEnum.NoneArea){var n=t===WUXSnapAreaEnum.InsideArea?WUXWindowGroupTypeEnum.GroupAsTab:WUXWindowGroupTypeEnum.GroupAsGrid;i=this.supportsGroupType(n)}return i&&e&&t!==WUXSnapAreaEnum.OutsideArea&&e.getDockedFlag()&&(i=this.allowedDockAreas&e.currentDockArea),i&&e&&e.maximizedFlag&&!this.allowMaximizeFlag&&(i=!1),i},_canBeSnapTarget:function(e,t){var i=e&&e!==this&&(t===WUXSnapAreaEnum.OutsideArea||this.snappableFlag);if(i&&t!==WUXSnapAreaEnum.OutsideArea&&t!==WUXSnapAreaEnum.NoneArea){var n=t===WUXSnapAreaEnum.InsideArea?WUXWindowGroupTypeEnum.GroupAsTab:WUXWindowGroupTypeEnum.GroupAsGrid;i=this.supportsGroupType(n)}if(i&&e&&(i=e.immersiveFrame===this.immersiveFrame),i&&this.getDockedFlag())switch(this.currentDockArea){case WUXDockAreaEnum.LeftDockArea:case WUXDockAreaEnum.RightDockArea:i=t===WUXSnapAreaEnum.OutsideArea||t===WUXSnapAreaEnum.TopArea||t===WUXSnapAreaEnum.BottomArea||t===WUXSnapAreaEnum.InsideArea;break;case WUXDockAreaEnum.TopDockArea:case WUXDockAreaEnum.BottomDockArea:i=t===WUXSnapAreaEnum.OutsideArea||t===WUXSnapAreaEnum.LeftArea||t===WUXSnapAreaEnum.RightArea||t===WUXSnapAreaEnum.InsideArea}return i},_createWindowGroup:function(e){var t=this.width,o=this.height,s={my:"top left",at:"top left",of:(a=this._getCompletePosition()).of,collision:a.collision},a=n.getPositionRelativeToOffsetParent(this,s);return new i({groupType:e,immersiveFrame:this.immersiveFrame,activeFlag:!1,width:t,height:o,position:a,maximizedFlag:this.maximizedFlag})},_updateFromCollapsibleState:function(){this._parent()},_applyButtons:function(e){this._parent(e),0==this.elements._buttonsDiv.childNodes.length?this.elements._buttonsDiv.hide():(this.elements._headerPopup||this.elements._buttonsDiv.addClassName("wux-windows-panel-buttons"),this.elements._buttonsDiv.show())},_applyCollapsibleFlag:function(){this._updateFromCollapsibleState()},_applyFloatableFlag:function(){if(!this.floatableFlag&&!this.currentDockArea){var e=WUXDockAreaEnum.LeftDockArea;if(!(e&this.allowedDockAreas))for(var t in WUXDockAreaEnum)WUXDockAreaEnum[t]!=WUXDockAreaEnum.NoneDockArea&&WUXDockAreaEnum[t]&this.allowedDockAreas&&(e=WUXDockAreaEnum[t]);this.windowGroup?this.windowGroup.currentDockArea=e:this.currentDockArea=e}},_applyWindowGroup:function(e){this._parent(e),this.pinnedFlag&&this._applyPinnedFlag()},_applyPinnedFlag:function(){this.windowGroup&&this.windowGroup._pinOrUnpinWindow(this)},_applyShowTitleFlag:function(){this.showTitleFlag||!this.icon||""===this.icon.iconName?this.elements._titleP.setStyle("display",""):this.elements._titleP.setStyle("display","none"),this._updateTitleStyle()},_applyIcon:function(e){this._parent(e),this._applyShowTitleFlag(),this._updateTitleStyle()},_applyTitle:function(e){this._parent(e),this._applyShowTitleFlag(),this._updateTitleStyle()},_applyProperties:function(e){this._parent(e),this.isDirty("collapsibleFlag")&&this._applyCollapsibleFlag(),this.isDirty("floatableFlag")&&this._applyFloatableFlag(),this._applyShowTitleFlag()},_applyVerticallyStretchableFlag:function(e){this._parent(e),this._applyCollapsibleFlag()},handleEvents:function(){this._parent()},_updateTitleStyle:function(){"none"===this.elements._titleP.getStyle("display")||""===this.title?this.elements.iconPlaceholder.addClassName("wux-windows-icon-no-title"):this.elements.iconPlaceholder.removeClassName("wux-windows-icon-no-title")},_savePinnedFlagInPreferences:function(){var e={pinnedFlag:this.pinnedFlag};this._saveDataInPreferences("pinnedFlag",e)},_getPinnedFlagFromPreferences:function(){return this._getDataFromPreferences("pinnedFlag")},_readWindowPreferences:function(){this._parent();var e=this._getPinnedFlagFromPreferences();e&&(this.pinnedFlag=e.pinnedFlag)}})}),define("DS/Windows/ImmersiveWindow",["DS/Windows/Panel"],function(e){"use strict";return e.inherit({name:"immersiveWindow",publishedProperties:{useBackgroundFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},decorationFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},opacity:{defaultValue:void 0,type:"number",category:"Appearance"},snappableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},collapsibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}},buildView:function(){this._parent(),this.elements.container.addClassName("wux-windows-immersive-window"),this.allowedDockAreas=WUXDockAreaEnum.NoneDockArea},_applyUseBackgroundFlag:function(){this.useBackgroundFlag?(this.getContent().removeAttribute("no-background"),this.elements._titleBarDiv.removeAttribute("no-background")):(this.getContent().setAttributeNode(document.createAttribute("no-background")),this.elements._titleBarDiv.setAttributeNode(document.createAttribute("no-background")))},_applyDecorationFlag:function(){this.decorationFlag?this.getContent().removeAttribute("no-decoration"):this.getContent().setAttributeNode(document.createAttribute("no-decoration"))},_applyOpacity:function(){void 0!==this.opacity?this.getContent().setStyle("opacity",this.opacity):this.getContent().setStyle("opacity","")},_applyProperties:function(e){this._parent(e),this.isDirty("useBackgroundFlag")&&this._applyUseBackgroundFlag(e.useBackgroundFlag),this.isDirty("decorationFlag")&&this._applyDecorationFlag(e.decorationFlag),this.isDirty("opacity")&&this._applyOpacity(e.opacity)}})}),define("DS/Windows/ImmersiveFrame",["UWA/Core","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/Windows/DockingElement","DS/Windows/DockingElementForImmersiveFrame","DS/Windows/Window","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/WebRecordBase/Utils","DS/Windows/Panel","i18n!DS/Windows/assets/nls/translation"],function(e,t,i,n,o,s,a,r,l,d,h,c){"use strict";function u(e,t){var n=null,o=WUXSnapAreaEnum.NoneArea;if(e)for(var s in this.windows){var a=this.windows[s];if(a&&(a.windowGroup&&a.windowGroup.groupType===WUXWindowGroupTypeEnum.GroupAsTab&&(a=a.windowGroup),a!==e)){var r=a.getBoundingClientRect();if(i.rectContains(r,t)){if(e._canBeSnapSource(a,WUXSnapAreaEnum.LeftArea)&&a._canBeSnapTarget(e,WUXSnapAreaEnum.LeftArea)){var l=a._getSnapAreaRect(WUXSnapAreaEnum.LeftArea);i.rectContains(l,t)&&(n=a,o=WUXSnapAreaEnum.LeftArea)}if(!n&&e._canBeSnapSource(a,WUXSnapAreaEnum.RightArea)&&a._canBeSnapTarget(e,WUXSnapAreaEnum.RightArea)){var d=a._getSnapAreaRect(WUXSnapAreaEnum.RightArea);i.rectContains(d,t)&&(n=a,o=WUXSnapAreaEnum.RightArea)}if(!n&&e._canBeSnapSource(a,WUXSnapAreaEnum.TopArea)&&a._canBeSnapTarget(e,WUXSnapAreaEnum.TopArea)){var h=a._getSnapAreaRect(WUXSnapAreaEnum.TopArea);i.rectContains(h,t)&&(n=a,o=WUXSnapAreaEnum.TopArea)}if(!n&&e._canBeSnapSource(a,WUXSnapAreaEnum.BottomArea)&&a._canBeSnapTarget(e,WUXSnapAreaEnum.BottomArea)){var c=a._getSnapAreaRect(WUXSnapAreaEnum.BottomArea);i.rectContains(c,t)&&(n=a,o=WUXSnapAreaEnum.BottomArea)}if(!n&&void 0===a._isFakeWindowForStacking&&e._canBeSnapSource(a,WUXSnapAreaEnum.InsideArea)&&a._canBeSnapTarget(e,WUXSnapAreaEnum.InsideArea)){var u=a._getSnapAreaRect(WUXSnapAreaEnum.InsideArea);i.rectContains(u,t)&&(n=a,o=WUXSnapAreaEnum.InsideArea)}if(n)break}}}this._snapTargetWindow!==n&&(this._snapTargetWindow&&(this._snapTargetWindow.activeSnapArea=WUXSnapAreaEnum.NoneArea),this._snapTargetWindow=n,this._snapTargetWindow&&(this._snapPointer=t,this._snapTargetWindow.activeSnapArea=o,e&&this._initStackingWindowsTimer(this._snapTargetWindow,e)))}function m(e,t,i){if(this._snapTargetWindow){if(!d.isReplaying()){var n=i||this._snapTargetWindow,o=this._snapTargetWindow.activeSnapArea,s=n.isAWindowGroup()?n._computedIdentifier:n.identifier;s&&e.callMethodFromUIInteraction("_locateAndAttachToWindow",s,o,t),e._attachToWindow(n,o,t,!0)}var a=e.elements.container?e:n;a._saveWindowGroupInPreferences(),a._saveDockAreaInPreferences(),this._snapTargetWindow.activeSnapArea=WUXSnapAreaEnum.NoneArea,this._snapTargetWindow=null}else this._activeDockingElement&&(d.isReplaying()||e.setPropertyFromUIInteraction("currentDockArea",this._activeDockingElement.side),e.currentDockArea===this._activeDockingElement.side&&(e._saveDockAreaInPreferences(),1===this._activeDockingElement.getContainedVisibleWindows().length&&this._activeDockingElement._saveDockingZoneSizeInPreferences()));this._activeDockingElement&&(this._activeDockingElement.interactiveDockAreaVisibleFlag=!1,this._activeDockingElement=null),e.elements.container&&e.elements.container.removeClassName("wux-windows-window-furtive")}function p(e){e&&(e.interactiveDockAreaVisibleFlag=!1,e.__collapseMemory&&(e.collapseDockingZoneFlag=!0,e.__collapseMemory=!1),0===e.getContainedVisibleWindows().length&&(e.visibleDockingZoneFlag=!1))}function g(e){var t=this.getContent().getBoundingClientRect(),i=this.getDockingElement(e).getContent().getBoundingClientRect();switch(e){case WUXDockAreaEnum.TopDockArea:return{x:t.left,y:i.top-this._dockingSensibilityZoneSize,width:t.width,height:2*this._dockingSensibilityZoneSize};case WUXDockAreaEnum.BottomDockArea:return{x:t.left,y:i.bottom-this._dockingSensibilityZoneSize,width:t.width,height:2*this._dockingSensibilityZoneSize};case WUXDockAreaEnum.LeftDockArea:return{x:i.left-this._dockingSensibilityZoneSize,y:t.top,width:2*this._dockingSensibilityZoneSize,height:t.height};case WUXDockAreaEnum.RightDockArea:return{x:i.right-this._dockingSensibilityZoneSize,y:t.top,width:2*this._dockingSensibilityZoneSize,height:t.height}}}var f=t.inherit({name:"immersiveFrame",markForRecordFlag:!0,_linkedImmersiveFrames:void 0,publishedProperties:{identifier:{defaultValue:"",type:"string",readOnly:!0,category:"Behavior"},_ActionBar_V3:{defaultValue:!1,type:"boolean",category:"Appearance",noNeedToApplyFlag:!0},dockingElementsPriority:{defaultValue:[WUXDockAreaEnum.LeftDockArea,WUXDockAreaEnum.RightDockArea,WUXDockAreaEnum.TopDockArea,WUXDockAreaEnum.BottomDockArea],type:"Array",readOnly:!0,category:"Behavior"},reactToPointerEventsFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},dockingElementsAutoExpandFlag:{defaultValue:!0,type:"boolean",category:"Behavior"}},windows:void 0,dockingElements:void 0,resizerSize:10,_preBuild:function(e){this._parent(e),e&&e._ActionBar_V3&&this._properties.dockingElementsPriority&&(this._properties.dockingElementsPriority.value=[WUXDockAreaEnum.TopDockArea,WUXDockAreaEnum.BottomDockArea,WUXDockAreaEnum.LeftDockArea,WUXDockAreaEnum.RightDockArea])},_postBuildView:function(){this.elements.container.addClassName("wux-windows-immersive-frame"),r.setElementRecordMode(this.elements.container,l.RecordModes.DEFAULT_AND_CHILD);for(var t=0;t<this.dockingElementsPriority.length;t++)this._addDockingZone(this.dockingElementsPriority[t],200);this.getFreeZone().addClassName("wux-windows-immersive-frame-freeZone"),this._snapTargetWindow=null,this._activeDockingElement=null,this._dockingSensibilityZoneSize=22,this.elements.pointerEventsDiv=new e.Element("div",{class:"wux-windows-immersive-frame-pointer-events"}).inject(this.elements.container),this.elements.pointerEventsDiv.hide();var i=this;n.onNodeRendered(this.getContent(),function(){i._insertedInDOM=!0,i._onResizeFun&&i._onResizeFun()})},_applyIdentifier:function(e){this.identifier?this.getContent().setAttribute("wux-identifier",this.identifier):this.getContent().removeAttribute("wux-identifier")},isInsertedInDOM:function(){return!!this._insertedInDOM},init:function(e){this.windows={},this.dockingElements=[],this._parent(e)},_applyReactToPointerEventsFlag:function(e){this.reactToPointerEventsFlag?this.elements.container.removeClassName("wux-windows-immersive-frame-no-pointerevents"):this.elements.container.addClassName("wux-windows-immersive-frame-no-pointerevents")},dockWindow:function(e,t,i){if(e&&e.allowedDockAreas&&e.allowedDockAreas&t){var o=this.getDockingElement(t);if(o){let c=this.getWindowsInDockingElement(t),u=c[0]===e&&c.length>1?c[1]:c[0];if(!(i&&i.attachToOtherDockedWindow&&c.length>0&&u!==e)||e.windowGroup&&u.windowGroup&&e.windowGroup===u.windowGroup){if(!e.windowGroup||e.currentDockArea!=t){if(o.interactiveDockAreaVisibleFlag=!1,o.visibleDockingZoneFlag=!0,o.__onTransitionEnd(),0===o.getContainedVisibleWindows().length){var s=o.dockingZoneSize,a=window.getComputedStyle(e.getTitleBar()),r=e._getDockedDimensionsFromPreferences(),l=t===WUXDockAreaEnum.LeftDockArea||t===WUXDockAreaEnum.RightDockArea?"width":"height";if((!n.isCurrentlyCalledFromUIInteraction()||i&&i.restoreDockedDimensions)&&r&&r[l])s=r[l];else if(e._prefRestorationState===WUXPreferenceRestorationStateEnum.Restored&&o.side===WUXDockAreaEnum.TopDockArea||o.side==WUXDockAreaEnum.BottomDockArea){e.getContent().offsetParent||-1!==e.height||this.moveWindowToImmersiveFrame(e);var d=-1===e.height?window.getComputedStyle(e.getContent()).height:e.height+parseInt(a.height);s=parseInt(d),0===parseInt(a.borderTop)&&s++,o.useBordersFlag&&s++}else if(e._prefRestorationState===WUXPreferenceRestorationStateEnum.Restored){e.getContent().offsetParent||-1!==e.width||this.moveWindowToImmersiveFrame(e);var h=-1===e.width?window.getComputedStyle(e.getContent()).width:e.width;s=parseInt(h)+1,0===parseInt(a.borderLeft)&&s++,o.useBordersFlag&&s++}isNaN(s)||(o.dockingZoneSize=s)}e.getContent().isInjected(o.elements.dockingZone)||e.inject(o.elements.dockingZone)}}else e.attachToWindow(c[0],WUXSnapAreaEnum.InsideArea,"after");e.immersiveFrame=this,e.currentDockArea=t,o._updateFromContainedWindows(),o._updateContainedWindows()}}return e.currentDockArea===t?1:-1},getWindowsInDockingElement:function(e){let t=[];for(const[i,n]of Object.entries(this.windows))n.currentDockArea!==e||n.maximizedFlag||n.windowGroup||t.push(n);return t},undockWindow:function(e){if(e){var t=e.currentDockArea,i=this.getDockingElement(t);if(e._isBeingClosed){var n=e.getContent().getParent();n&&n.removeChild(e.getContent())}else{if(!e.windowGroup||t!==WUXDockAreaEnum.NoneDockArea){var o=e.getAbsolutePosition();this.moveWindowToImmersiveFrame(e),e.getContent().setStyle("z-index",""),e.activeFlag&&e.bringToFront(),e.setAbsolutePosition(o)}e.currentDockArea=WUXDockAreaEnum.NoneDockArea}i&&(i._updateFromContainedWindows(),i._updateContainedWindows(),i.pointerEventsAllIfOverflow())}},getFreeZone:function(){return this.dockingElements[this.dockingElements.length-1].elements.freeZone},setContentInBackgroundLayer:function(t){t?(this._backgroundLayerDiv||(this._backgroundLayerDiv=new e.Element("div",{styles:{top:0,bottom:0,right:0,left:0,position:"absolute",width:"100%",height:"100%",pointerEvents:"all"}}),this._backgroundLayerDiv.inject(this.getContent(),"top")),t.inject?t.inject(this._backgroundLayerDiv):this._backgroundLayerDiv.appendChild(t)):this._backgroundLayerDiv&&(this._backgroundLayerDiv.empty(),this._backgroundLayerDiv.remove(),delete this._backgroundLayerDiv)},setViewer:function(e){this._viewer=e},getViewer:function(e){return this._viewer},moveWindowToMaximizeZone:function(e){e&&(e.inject(this.getFreeZone()),!this._ActionBar_V3||e.currentDockArea!==WUXDockAreaEnum.TopDockArea&&e.currentDockArea!==WUXDockAreaEnum.BottomDockArea||e._moveTitleBar(!1,this.getDockingElement(e.currentDockArea)))},moveWindowToImmersiveFrame:function(e){e&&e.getContent().getParent()!==this.elements.container&&(e.inject(this.elements.container),this._ActionBar_V3&&(e.currentDockArea===WUXDockAreaEnum.TopDockArea||e.currentDockArea===WUXDockAreaEnum.BottomDockArea?e._moveTitleBar(!0,this.getDockingElement(e.currentDockArea)):e._moveTitleBar(!1,this.getDockingElement(e.currentDockArea))))},_addDockingZone:function(e,t){var i="";switch(e){case WUXDockAreaEnum.LeftDockArea:i="LeftDockArea";break;case WUXDockAreaEnum.RightDockArea:i="RightDockArea";break;case WUXDockAreaEnum.TopDockArea:i="TopDockArea";break;case WUXDockAreaEnum.BottomDockArea:i="BottomDockArea"}var n={identifier:this.identifier+"_"+i,side:e,dockingZoneSize:t,visibleDockingZoneFlag:!1,collapseDockingZoneFlag:!1,recId:this.recId?i:void 0,autoExpandFlag:this.dockingElementsAutoExpandFlag,collapserStyle:this._ActionBar_V3?o.COLLAPSER_STYLE.FIXED_AREA:o.COLLAPSER_STYLE.STANDARD},a=new s(n);a.elements.container.addClassName("wux-immersive-frame-component"),this._ActionBar_V3||(a.useBackgroundFlag=!0),0===this.dockingElements.length?a.inject(this.elements.container):a.inject(this.dockingElements[this.dockingElements.length-1].elements.freeZone),this.dockingElements.push(a)},_removeDockingZone:function(e){this.dockingElements.length<=e||e<0||(e!==this.dockingElements.length-1&&(0===e?this.dockingElements[e+1].inject(this.elements.container):this.dockingElements[e+1].inject(this.dockingElements[e-1].elements.freeZone)),this.dockingElements[e].hide(),this.dockingElements.splice(e,1))},_updateAllDockingZoneSize:function(){for(var e=0;e<this.dockingElements.length;e++){var t=this.dockingElements[e];t&&t._updateDockingZoneSize()}},_applyProperties:function(e){this._parent(e),this.isDirty("reactToPointerEventsFlag")&&this._applyReactToPointerEventsFlag(e.reactToPointerEventsFlag,this.reactToPointerEventsFlag),this.isDirty("identifier")&&this._applyIdentifier(e.identifier,this.identifier)},addWindow:function(e){var t=this;e.windowGroup&&this.addWindow(e.windowGroup),this.containsWindow(e)||(this.windows[t._computeUniqueIdentifier(e)]=e,e.currentDockArea!==WUXDockAreaEnum.NoneDockArea||e.maximizedFlag||e.windowGroup||this.moveWindowToImmersiveFrame(e),e.immersiveFrame=this,e._applyPosition(),e.addEventListener("windowDrag",function(n){t.elements.pointerEventsDiv.show();var o=n.dsModel;if(o){if(!1===o.visibleFlag)return;if((Math.abs(n.options.deltaX)>15||Math.abs(n.options.deltaY)>15)&&(o.getDockedFlag()||o.windowGroup)){var s=o.getContent().getSize();if(o.windowGroup){if(i.isMouseOverElement(o.windowGroup.elements._titleBarDiv,n.options))return void o.windowGroup._manageReorder(o,n.options);var a=o.windowGroup;if(2===a.getEmbeddedWindows().length)for(var r=0;r<2;r++){var l=a.getEmbeddedWindows()[r];if(l!==o){a=l;break}}o.windowGroup.activeSnapArea=WUXSnapAreaEnum.NoneArea,o.windowGroup._detachWindow(o,e._isCurrentlyCalledFromUIInteraction()),t._clearStackingWindowsTimer(),t._stopWindowGroupTabBarSliding(),(o=t._replaceFakedWindowByReallyMovedWindow(o))._saveWindowGroupInPreferences(a)}o.getFloatableState()&&(o.currentDockArea=WUXDockAreaEnum.NoneDockArea,o._saveDockAreaInPreferences()),o.activeFlag=!0,o.bringToFront();var d=o.getContent().getSize();d.width===s.width&&d.height===s.height||o._ensureTitleBarUnderPointer(n.options)}o.windowGroup||(u.call(t,o,n.options),function(e,t){var i=null;if(e.immersiveFrame===this&&e.allowedDockAreas)for(var n=0;n<this.dockingElements.length;n++){var o=this.dockingElements[n];if(e.allowedDockAreas&o.side&&!this._snapTargetWindow&&!i){var s=g.call(this,o.side);if(t.x<s.x||t.x>=s.x+s.width||t.y<s.y||t.y>=s.y+s.height)p(o);else{if(o.collapseDockingZoneFlag&&(o.__collapseMemory=!0,o.collapseDockingZoneFlag=!1),!o.visibleDockingZoneFlag){if(0===o.getContainedVisibleWindows().length){var a=o.dockingZoneSize,r=window.getComputedStyle(e.getContent());a=o.side===WUXDockAreaEnum.TopDockArea||o.side==WUXDockAreaEnum.BottomDockArea?parseInt(r.height):parseInt(r.width),isNaN(a)||(o.dockingZoneSize=a)}o.visibleDockingZoneFlag=!0}o.interactiveDockAreaVisibleFlag=!0,i=o}}else o.interactiveDockAreaVisibleFlag=!1}this._activeDockingElement!==i&&(this._activeDockingElement&&p(this._activeDockingElement),this._activeDockingElement=i)}.call(t,o,n.options),t._snapTargetWindow||t._activeDockingElement?o.elements.container.addClassName("wux-windows-window-furtive"):o.elements.container.removeClassName("wux-windows-window-furtive"))}}),e.addEventListener("stopWindowDrag",function(e){var i,n;if(t._stopWindowGroupTabBarSliding(),t._fakeStackedWindow&&t._snapSourceWindow.show(),t._fakeStackedWindow&&t._fakeStackedWindow.windowGroup){var o=t._fakeStackedWindow.windowGroup.getEmbeddedWindows(),s=o.indexOf(t._fakeStackedWindow);s<o.length-1?(n=o[s+1],i="before"):(n=o[s-1],i="after"),t._fakeStackedWindow.windowGroup._detachWindow(t._fakeStackedWindow),t.undockWindow(t._fakeStackedWindow),u.call(t,e.dsModel,e.options),t._fakeStackedWindow.hide()}m.call(t,e.dsModel,i,n),t._resetStackedWindowData(),t.elements.pointerEventsDiv.hide()}),e.addEventListener("startResize",function(e){t.elements.pointerEventsDiv.show(),t.elements.pointerEventsDiv.setStyle("cursor",e.options.cursor)}),e.addEventListener("stopResize",function(e){t.elements.pointerEventsDiv.hide(),t.elements.pointerEventsDiv.setStyle("cursor","default")}),e.addEventListener("visibleStateChange",function(i){if(e.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var n=t.getDockingElement(e.currentDockArea);if(n)if(e.visibleFlag)n.visibleDockingZoneFlag=!0;else{for(var o=n.getContainedVisibleWindows(),s=0,a=0;a<o.length;a++)o[a].getContent().hasClassName("wux-windows-window")&&"none"!==o[a].getContent().getStyle("display")&&s++;0===s&&(n.visibleDockingZoneFlag=!1)}}}),this.fire("addWindow",{window:e}))},removeWindow:function(e){if(e){for(var t in this.windows){var i=this.windows[t];if(i&&i===e){e.currentDockArea!==WUXDockAreaEnum.NoneDockArea&&this.undockWindow(e),e.position.of===this.getContent()&&(e.position.of=null),e.position.constraint===this.getContent()&&(e.position.constraint=null),this.elements&&this.elements.container&&e.remove(),delete this.windows[t],e.immersiveFrame=null;break}}this.fire("removeWindow",{window:e})}},getDockingElement:function(e){return this.dockingElements[this.dockingElementsPriority.indexOf(e)]},containsWindow:function(e){var t=!1;if(e)for(var i in this.windows){var n=this.windows[i];if(n&&n===e){t=!0;break}}return t},_computeUniqueIdentifier:function(e){if(e){for(var t=void 0!==e.identifier&&""!==e.identifier?e.identifier:"1",i=2;void 0!==this.windows[t];)t=i,i++;return t}},_getWindowFromIdentifier:function(e){for(var t in this.windows)if(this.windows.hasOwnProperty(t)){var i=this.windows[t];if(i.identifier===e)return i}},handleEvents:function(){var e=this;document.addEventListener("touchChange",function(){e._manageAllPointerEventsOnDockingElements()});for(var t=0;t<e.dockingElements.length;t++){(a=e.dockingElements[t])&&a.addEventListener("dockResize",function(t){e._manageAllPointerEventsOnDockingElements()})}e._onResizeFun=function(){if(e.elements.container){for(var t in e.windows){var i=e.windows[t];i&&i.visibleFlag&&(i._applyWidth(),i._applyHeight(),i._applyPosition())}e._manageAllPointerEventsOnDockingElements();var n=window.getComputedStyle(e.getContent()),o=parseInt(n.width)>480&&parseInt(n.height)>640;for(var s in WUXDockAreaEnum){var a=e.getDockingElement(WUXDockAreaEnum[s]);a&&(a.autoExpandFlag=o&&e.dockingElementsAutoExpandFlag)}}},e._resizeFreeZoneFun=function(t){e.fire("freeZoneResize")},n.addResizeListener(this.elements.container,e._onResizeFun),n.addResizeListener(this.getFreeZone(),e._resizeFreeZoneFun),n.removeEventOnElement(this,this.elements.pointerEventsDiv,"click",function(){e.elements.pointerEventsDiv.hide()});var i=function(){e._manageAllPointerEventsOnDockingElements(),e.removeEventListener("transitionend",i)},o=function(){e.addEventListener("transitionend",i)};for(var s in WUXDockAreaEnum){var a;(a=this.getDockingElement(WUXDockAreaEnum[s]))&&(a.addEventListener("collapse",o),a.addEventListener("expand",o))}},destroy:function(){if(this.elements&&this.elements.container){if(n.removeResizeListener(this.elements.container,this._onResizeFun),n.removeResizeListener(this.getFreeZone(),this._resizeFreeZoneFun),this._fakeStackedWindowSaved&&(this._fakeStackedWindowSaved.destroy(),this._fakeStackedWindowSaved=null),this.windows)for(var e=Object.keys(this.windows),t=0;t<e.length;t++)this.windows[e[t]]&&this.windows[e[t]].destroy();var i=Object.keys(this.dockingElements);for(t=i.length-1;t>=0;t--){var o=this.dockingElements[i[t]];o.destroy&&o.destroy()}this._parent()}},destroyAllWindows:function(){this.destroyWindows(this.windows)},destroyWindows:function(e){function t(e){e.destroy&&e.destroy()}if(Array.isArray(e))for(var i=0;i<e.length;i++)t(e[i]);else for(var n=Object.keys(e).length;n>0;)t(this.windows[Object.keys(e)[0]]),n=Object.keys(e).length},_manageAllPointerEventsOnDockingElements:function(){this.getDockingElement(WUXDockAreaEnum.BottomDockArea).pointerEventsAllIfOverflow(),this.getDockingElement(WUXDockAreaEnum.TopDockArea).pointerEventsAllIfOverflow(),this.getDockingElement(WUXDockAreaEnum.LeftDockArea).pointerEventsAllIfOverflow(),this.getDockingElement(WUXDockAreaEnum.RightDockArea).pointerEventsAllIfOverflow()},_initStackingWindowsTimer:function(e,t){this._clearStackingWindowsTimer();var i=this;this._stopDragOccured=!1,this._stackingTimeOut=setTimeout(function(){if(i._stopDragOccured||e.activeSnapArea!==WUXSnapAreaEnum.InsideArea)e&&(e.activeSnapArea=WUXSnapAreaEnum.NoneArea);else{i._snapTargetWindowForFeedback=e;var n=e._computeDropInsertionData(i._snapPointer),o=i._getOrCreateFakePanelForStacking(t);i._snapSourceWindow=t,m.call(i,o,n.beforeOrAfter,n.targetWindow),t.hide(),i._fakeStackedWindow.windowGroup&&(i._fakeStackedWindow.windowGroup.activeSnapArea=WUXSnapAreaEnum.InsideArea)}},400)},_clearStackingWindowsTimer:function(){this._stackingTimeOut&&(clearTimeout(this._stackingTimeOut),this._stackingTimeOut=null)},_startWindowGroupTabBarSliding:function(e,t){if(!this._windowGroupTabBarSlidingInterval){var i=this;this._windowGroupTabBarSliding=e,this._windowGroupTabBarSlidingDirection=t,this._windowGroupTabBarSlidingInterval=window.setInterval(function(){i._windowGroupTabBarSliding&&i._windowGroupTabBarSliding._slideTabBar(i._windowGroupTabBarSlidingDirection)},900)}},_stopWindowGroupTabBarSliding:function(){this._windowGroupTabBarSlidingInterval&&(window.clearInterval(this._windowGroupTabBarSlidingInterval),delete this._windowGroupTabBarSlidingInterval,this._windowGroupTabBarSlidingInterval=null,this._windowGroupTabBarSliding=null,this._windowGroupTabBarSlidingDirection=null)},_getOrCreateFakePanelForStacking:function(t){var n,o,s,a;if(!this._fakeStackedWindow){if(this._fakeStackedWindow=this._fakeStackedWindowSaved,!this._fakeStackedWindow)a=new e.Element("div",{class:"wux-window-stacking-place-holder-container"}),new e.Element("div",{class:"wux-window-stacking-place-holder"}).inject(a).innerText=c.get("stackingPlaceHolder"),this._fakeStackedWindow=new h({resizableFlag:!0,immersiveFrame:this,content:a}),this._fakeStackedWindow._isFakeWindowForStacking=!0;this._fakeStackedWindowSaved||(this._fakeStackedWindowSaved=this._fakeStackedWindow)}return t.isAWindowGroup()?(n="( "+t.getEmbeddedWindows().length+" )",s="folder",o=!0):(n=t.title,o=t.showTitleFlag,s=t.icon),this._fakeStackedWindow.title=n,this._fakeStackedWindow.showTitleFlag=o,this._fakeStackedWindow.icon=s,i.setPosition(this._fakeStackedWindow,t.position),this._fakeStackedWindow.show(),this._fakeStackedWindow},_computeFiringWindowDragEvents:function(e){var t=e;return this._fakeStackedWindow&&e!==this._fakeStackedWindow&&(t=this._fakeStackedWindow.visibleFlag?this._fakeStackedWindow:this._snapSourceWindow),t},_replaceFakedWindowByReallyMovedWindow:function(e){return e===this._fakeStackedWindow?(this._fakeStackedWindow.hide(),i.setPosition(this._snapSourceWindow,e.position),this._snapSourceWindow.show(),this._snapSourceWindow.activeFlag=!0,this._snapSourceWindow):e},_resetStackedWindowData:function(e){this._fakeStackedWindow=null,this._snapSourceWindow=null,this._stopDragOccured=!0},_onFocusReceived:function(){this._parent();var e=document.activeElement;if(e){var t=this._getContainingWindow(e);t&&(t._lastFocusedWidget=e)}},_getContainingWindow:function(e){for(var t=e;t;){if(t&&t.dsModel&&t.dsModel instanceof a)return t.dsModel;t=t.parentElement}return null},_linkToOtherImmersiveFrame:function(e){this._linkedImmersiveFrames||(this._linkedImmersiveFrames=[]),-1===this._linkedImmersiveFrames.indexOf(e)&&(this._linkedImmersiveFrames.push(e),e._linkToOtherImmersiveFrame(this))}});return r.register(f,"DS/ControlsRec/AbstractRec"),f});