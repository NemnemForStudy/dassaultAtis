define("DS/Menu/Menu",["DS/WebRecordEnabler/Adapter","DS/Core/PointerEvents","DS/Utilities/TouchUtils","DS/Utilities/Dom","DS/Utilities/Utils","DS/Controls/TooltipModel","css!DS/Menu/assets/css/Menu.css"],function(e,t,i,n,o,s){"use strict";var u=document.createElement("div");u.innerHTML=['<div class="wux-menu">','<div class="wux-menu-parent">','<div class="wux-menu-parent-up wux-menu-push wux-ui-3ds wux-ui-3ds-chevron-left"></div>','<div class="wux-menu-parent-title"></div>',"</div>",'<div class="wux-menu-scroll-up wux-ui-3ds wux-ui-3ds-chevron-up wux-menu-scroll-disabled"></div>','<div class="wux-menu-scrollable">','<div class="wux-menu-container">','<div class="wux-menu-column wux-menu-column-left"></div>','<div class="wux-menu-column wux-menu-column-icon"></div>','<div class="wux-menu-column wux-menu-column-title"></div>','<div class="wux-menu-column wux-menu-column-accelerator"></div>','<div class="wux-menu-column wux-menu-column-submenu"></div>',"</div>","</div>",'<div class="wux-menu-scroll-down wux-ui-3ds wux-ui-3ds-chevron-down"></div>',"</div>",'<div class="wux-menu-cell"></div>','<div class="wux-menu-overlap"></div>','<div class="wux-menu-overlap-submenu"></div>','<div class="wux-menu-collection-item"></div>'].join("");var a=u.querySelector(".wux-menu"),r=u.querySelector(".wux-menu-cell"),c=u.querySelector(".wux-menu-overlap"),d=(u.querySelector(".wux-menu-overlap-submenu"),u.querySelector(".wux-menu-collection-item")),l={},h=[],m=-1,f=-1,p=-1,w=-1,v=50,g=void 0,b=void 0,x=-1,y=-1,E=0,_=0,I=0,S=!1;const M=2;var L=0,T=[],C=function(e,t){this.content=e,this.menu_uid=t,this.previous_uid=-1,this.next_uid=-1,this.submenu_uid=-1,this.cells=[],this.uid=T.push(this)-1},R=function(e,t,i,n,o,s){this.parent=e,this.parentRecId=i,this.parentTitle=n,this.content=o,this.config=s,this.parent_item_uid=t?t.uid:-1,this.first_uid=-1,this.focus_uid=-1,this.uid=h.push(this)-1,this.loadingSubMenuFromMenuItemUid=void 0};function N(){var t=void 0;return(e.isRecording()||e.isReplaying())&&((t=document.getElementById("menu_record"))||((t=document.createElement("div")).setAttribute("id","menu_record"),t.setAttribute("data-rec-id","menu_record"),t.style.display="none",document.body.appendChild(t),e.register(t,"DS/MenuRec/MenuRec"))),t}function O(e,t,i){if(e.tooltip)if("string"==typeof e.tooltip){let i=new s({shortHelp:e.tooltip});t.tooltipInfos=i}else"object"==typeof e.tooltip&&(t.tooltipInfos=new s(e.tooltip));else e.title&&i&&(t.tooltipInfos=new s({getAllInformationCB:()=>{if(n.computeStringWidth(e.title,12,"Arial",!1,!1)>i.offsetWidth)return{model:{shortHelp:e.title}}}}))}function D(e){var t=T[e].cells,i=t.length>1||t[0].classList.contains("wux-menu-collection-item")?t[0]:T[T[e].previous_uid].cells[0],n=t[t.length-1],o=i.getBoundingClientRect(),s=n.getBoundingClientRect(),u=null!==i.previousElementSibling?o.height-i.clientHeight:0,a={};return a.top=o.top-u,a.right=s.right,a.bottom=o.bottom,a.left=o.left,a.width=s.right-o.left,a.height=o.height+u,a}function U(e){return e?e.dataset&&void 0!==e.dataset.wuxMenuUid?Number(e.dataset.wuxMenuUid):U(e.parentNode):-1}function A(e){if(e>=0)return h[T[e].menu_uid]}function k(e,t){if(e<0)return;if(!t)return;const i=T[e];if(!i)return;if(i.submenu_uid>=0&&!h[i.submenu_uid])return;let n={};if(i.submenu_uid<0){let e={};const n=h[i.menu_uid];n&&(e=n.config);const o=new R(n,i,i.content.recId,i.content.title,t,e);o.buildView(),i.submenu_uid=o.uid}else h[i.submenu_uid]&&(h[i.submenu_uid].content=t,h[i.submenu_uid].buildView());n.parentItemRect=D(e),h[i.submenu_uid].show(n)}function H(e){var t=e.target.dataset.wuxMenuItemUid;if(t>=0){var i=A(t);i&&(i.setHoverState(h[T[t].menu_uid].focus_uid,!1),i.setHoverState(t,!0)),w=t}else w=-1;-1!=(f=U(e.target))&&(p=f)}function B(e){var t=e.target.dataset.wuxMenuItemUid;if(t>=0){var i=A(t);i&&i.setHoverState(t,!1)}}function F(e){e.clientX==x&&e.clientY==y||(x=e.clientX,y=e.clientY,-1==U(e.target)?void 0===b&&(b=window.setTimeout(G,v)):void 0!==b&&(window.clearTimeout(b),b=void 0),void 0!==g&&(window.clearTimeout(g),g=void 0),g=window.setTimeout(j,v))}function q(e){if(t.isTouchEvent(e)&&(H(e),e.target.style.cursor="pointer"),e.touches&&1===e.touches.length){var i=(new Date).getTime(),n=i-E,o=Math.abs(_-e.touches[0].clientX),s=Math.abs(I-e.touches[0].clientY);o<10&&s<10&&n<500&&e.preventDefault(),_=e.touches[0].clientX,I=e.touches[0].clientY,E=i}-1==U(e.target)&&l.hide()}function P(e){if(0===e.button||t.isTouchEvent(e)){var i=e.target.dataset.wuxMenuItemUid;if(i>=0){var n=T[i];if(n)if(-1!=n.submenu_uid){for(var o=m;o!=n.menu_uid&&void 0!==h[o].parent;)h[o].hide(),o=h[o].parent.uid;var s={};s.parentItemRect=D(i),h[n.submenu_uid].show(s)}else Y(n)}else e.target.classList.contains("wux-menu-scroll-up")?X({deltaY:-20,target:e.target}):e.target.classList.contains("wux-menu-scroll-down")?X({deltaY:20,target:e.target}):e.target.classList.contains("wux-menu-parent-up")&&-1!=m&&h[m].hide();const t=e.target.dataset.wuxDynamicMenuItemUid;if(t>=0){const i=T[t],n={};if(n.info={target:e.target},n.data={event:e,target:e.target,targetPosition:{x:e.offsetX,y:e.offsetY},windowPosition:{x:e.clientX,y:e.clientY}},i.content.submenu instanceof(async()=>{}).constructor)i.content.submenu(n).then(e=>k(t,e));else if(i.content.submenu instanceof Function){const e=i.content.submenu(n);k(t,e)}}}}function W(e){-1!=m&&h[m].onKeyDown(e.keyCode||e.location)}function V(e){e.stopPropagation(),e.preventDefault()}function Y(t){var i=N();if(e.isRecording()&&i){var n=t.content.recId;if(n)for(var s=h[t.menu_uid];s.uid>0;){if(!s.parentRecId){e.TraceManager.error('Menu item "'+s.parentTitle+"\" doesn't have a record identifier, this is not compatible with WebRecord"),n=void 0;break}n=s.parentRecId+"/"+n,s=s.parent}else e.TraceManager.error('Menu item "'+t.content.title+"\" doesn't have a record identifier, this is not compatible with WebRecord");n&&e.addCustomInteraction(i,{recVersion:1,recType:"MenuAction",recIdPath:n},"DS/MenuRec/MenuRec",{checkVisibility:!1})}let u;if(t){const e=A(t.uid);e&&e.config&&(u=e.config.doNotHideOnAction)}u||l.hide(),t&&t.content&&t.content.action&&(t.content.action.callback?t.content.action.callback.call(t.content.action.this,{context:t.content.action.context}):t.content.action.func&&o.attachSimpleCallback(t.content.action.module,t.content.action.func,t.content.action.argument,t.content.action.context))}function z(e){l.hide()}function X(e){for(var t=e.target;t&&t.dataset&&void 0===t.dataset.wuxMenuUid;)t=t.parentNode;if(t&&t.dataset){var i=t.dataset.wuxMenuUid;if(i>=0){var n=h[i];if(n&&n.view&&n.view.classList.contains("wux-menu-with-scroll")){var o=n.view.querySelector(".wux-menu-scroll-up"),s=n.view.querySelector(".wux-menu-scrollable"),u=n.view.querySelector(".wux-menu-scroll-down"),a=n.view.querySelector(".wux-menu-container"),r=s.getBoundingClientRect(),c=a.getBoundingClientRect();c.height,r.height;if(e.deltaY>0){var d=c.top-r.top-20;r.height-d>=c.height&&(d=r.height-c.height,u.classList.add("wux-menu-scroll-disabled")),a.style.top=d+"px",o.classList.remove("wux-menu-scroll-disabled")}else{(d=c.top-r.top+20)>=0&&(d=0,o.classList.add("wux-menu-scroll-disabled")),a.style.top=d+"px",u.classList.remove("wux-menu-scroll-disabled")}}}}}function j(){if(g=void 0,f<0){for(var e=p>=0?p:0,t=m;t!=e&&void 0!==h[t].parent;)h[t].hide(),t=h[t].parent.uid;m=e}else if(L!==M){var i=-1;w>=0&&(i=T[w].submenu_uid);for(t=m;t!=f&&t!=i&&void 0!==h[t].parent;)h[t].hide(),t=h[t].parent.uid;const e=w>=0?T[w]:void 0;if(e&&t!=i)if(e.content&&e.content.submenu instanceof Function){if("CheckItem"!==e.content.type&&"RadioItem"!==e.content.type)if(e.content.submenu instanceof(async()=>{}).constructor){h[t].loadingSubMenuFromMenuItemUid=e.uid;const n=w;e.content.submenu().then(o=>{if(!o||t<0||!h[t])return;const s=h[t].loadingSubMenuFromMenuItemUid;h[t].loadingSubMenuFromMenuItemUid=void 0,void 0!==s&&e.uid===s&&(k(n,o),i=e.submenu_uid)})}else if(e.content.submenu instanceof Function){const t=e.content.submenu();k(w,t),i=e.submenu_uid}}else if(i>=0){const e={};e.parentItemRect=D(w),h[i].show(e)}m=i>=0?i:f}}function G(){b=void 0;for(var e=p>=0?p:0,t=m;t!=e&&void 0!==h[t].parent;)h[t].hide(),t=h[t].parent.uid;m=e}return R.prototype.buildView=function(){if(this.parent&&!(this.parent instanceof R))throw new Error("Invalid parent, parent must be a Menu instance.");if(this.useTouchInput=i.getTouchMode(),!this.content||!this.content.length)throw new Error("Invalid content, menu must contain at least one item.");this.showIcons=!1,this.showTitles=!1,this.showAccelerators=!1,this.showSubMenuSeparators=!1,this.showSubMenus=!1,this.view=a.cloneNode(!0),this.view.dataset.wuxMenuUid=this.uid;var e=N();e&&(this.view.dataset.recId="menu_"+this.uid,e.markForRecord(this.view)),this.uid>0&&L===M&&(this.view.classList.add("wux-menu-replace"),this.view.querySelector(".wux-menu-parent-title").textContent=this.parentTitle);var t=this.view.querySelector(".wux-menu-column-left"),o=this.view.querySelector(".wux-menu-column-icon"),s=this.view.querySelector(".wux-menu-column-title"),u=this.view.querySelector(".wux-menu-column-accelerator"),l=this.view.querySelector(".wux-menu-column-submenu"),h=this,m=-1;this.content.forEach(function(e,i,a){!function(e){if(!e||!e.type)throw new Error("Invalid item, 'type' property is mandatory.");if(e.icon&&e.fonticon)throw new Error("Invalid item, 'icon' and 'fonticon' properties cannot be set together.");if(e.icon&&!("string"==typeof e.icon||e.icon instanceof Object&&("string"==typeof e.icon.iconClasses||"string"==typeof e.icon.iconPath||"string"==typeof e.icon.iconName)))throw new Error("Invalid item, 'icon' property must be a string or an object compliant with an icon definition");if(e.fonticon&&(!(e.fonticon instanceof Object)||!e.fonticon.content||"string"!=typeof e.fonticon.content))throw new Error("Invalid item, 'fonticon' property must be an object with a 'content' string property.");if(e.submenu&&(!(e.submenu instanceof Array)||!e.submenu.length)&&!(e.submenu instanceof Function))throw new Error("Invalid item, 'submenu' property must be an non empty array of menu items or a function");if(e.action&&!e.action.callback&&!e.action.func)throw new Error("Invalid item, 'action' property must be defined.");if(e.action&&e.action.callback&&"function"!=typeof e.action.callback)throw new Error("Invalid item, 'action.callback' property must be a function.");if(e.action&&(e.action.func&&"string"!=typeof e.action.func||e.action.module&&"string"!=typeof e.action.module))throw new Error("Invalid item, 'action.func' and 'action.module' properties must be strings.")}(e);var f=!1,p=!1;if(e.state){var w=e.state.toLowerCase().split("|");f=w.indexOf("disabled")>=0,p=w.indexOf("selected")>=0}var v=t.appendChild(r.cloneNode(!0)),g=o.appendChild(r.cloneNode(!0)),b=s.appendChild(r.cloneNode(!0)),x=u.appendChild(r.cloneNode(!0)),y=l.appendChild(r.cloneNode(!0)),E=v.appendChild(c.cloneNode(!0)),_=[v,g,b,x,y];if("SeparatorItem"===e.type)_.forEach(function(e,t,i){e.classList.add("wux-menu-separator")});else if("TitleItem"===e.type)_.forEach(function(e,t,i){e.classList.add("wux-menu-title"),f&&e.classList.add("wux-menu-disabled")}),e.title&&(E.textContent=e.title),O(e,E,E);else if("PushItem"===e.type){var I;if(f||(S=new C(e,h.uid),-1!=m&&(S.previous_uid=m,T[m].next_uid=S.uid),m=S.uid,E.dataset.wuxMenuItemUid=S.uid,S.cells.push(v,g,b,x)),!e.submenu||e.submenu instanceof Function||!e.action?S&&S.cells.push(y):(I=new C(e,h.uid),-1!=m&&(I.previous_uid=m,T[m].next_uid=I.uid),m=I.uid,I.cells.push(y),y.dataset.wuxMenuItemUid=I.uid),-1==this.first_uid&&(S||I)&&(this.first_uid=S?S.uid:I.uid),_.forEach(function(e,t,i){e.classList.add("wux-menu-push"),f&&e.classList.add("wux-menu-disabled")}),e.icon)this.showIcons=!0,g.appendChild(n.generateIcon(e.icon));else if(e.fonticon){if(this.showIcons=!0,"&#"===e.fonticon.content.substr(0,2))g.innerHTML=e.fonticon.content;else e.fonticon.content.split(" ").forEach(function(e,t,i){g.classList.add(e)});e.fonticon.family&&(g.style.fontFamily=e.fonticon.family)}if(e.title&&(this.showTitles=!0,b.textContent=e.title),e.accelerator&&(this.showAccelerators=!0,x.textContent=e.accelerator),e.submenu)if(this.showSubMenus=!0,e.action&&(this.showSubMenuSeparators=!0,E.classList.add("wux-menu-submenu-separator"),y.classList.add("wux-menu-submenu-separator")),y.classList.add("wux-menu-submenu","wux-ui-3ds","wux-ui-3ds-chevron-right"),!(e.submenu instanceof Function))(M=new R(this,I||S,e.recId,e.title,e.submenu,this.config)).buildView(),I?I.submenu_uid=M.uid:S&&(S.submenu_uid=M.uid);O(e,E,b)}else if("CheckItem"===e.type||"RadioItem"===e.type){var S,M;if(f||(S=new C(e,h.uid),-1!=m&&(S.previous_uid=m,T[m].next_uid=S.uid),m=S.uid,S.cells.push(v,g,b,x),E.dataset.wuxMenuItemUid=S.uid,e.submenu?e.submenu instanceof Function?(S.cells.push(y),y.dataset.wuxDynamicMenuItemUid=S.uid):e.action?((I=new C(e,h.uid)).previous_uid=m,T[m].next_uid=I.uid,m=I.uid,I.cells.push(y),y.dataset.wuxMenuItemUid=I.uid):S.cells.push(y):S.cells.push(y),-1==this.first_uid&&(this.first_uid=S.uid)),_.forEach(function(t,i,n){t.classList.add("CheckItem"===e.type?"wux-menu-check":"wux-menu-radio"),f&&t.classList.add("wux-menu-disabled"),p&&t.classList.add("wux-menu-selected")}),e.icon)this.showIcons=!0,g.appendChild(n.generateIcon(e.icon));else if(e.fonticon){if(this.showIcons=!0,"&#"===e.fonticon.content.substr(0,2))g.innerHTML=e.fonticon.content;else e.fonticon.content.split(" ").forEach(function(e,t,i){g.classList.add(e)});e.fonticon.family&&(g.style.fontFamily=e.fonticon.family)}if(e.title&&(this.showTitles=!0,b.textContent=e.title),e.accelerator&&(this.showAccelerators=!0,x.textContent=e.accelerator),e.submenu)if(this.showSubMenus=!0,e.action&&(this.showSubMenuSeparators=!0,E.classList.add("wux-menu-submenu-separator"),y.classList.add("wux-menu-submenu-separator")),y.classList.add("wux-menu-submenu","wux-ui-3ds","wux-ui-3ds-chevron-right"),!(e.submenu instanceof Function))(M=new R(this,I||S,e.recId,e.title,e.submenu,this.config)).buildView(),I?I.submenu_uid=M.uid:S&&(S.submenu_uid=M.uid);O(e,E,b)}else{if("CollectionItem"!==e.type)throw new Error("Invalid item, '"+e.type+"' is an unsupported 'type' property.");_.forEach(function(e,t,i){e.classList.add("wux-menu-collection"),f&&e.classList.add("wux-menu-disabled")}),e.items&&e.items.forEach(function(e,t,i){if(e.icon&&e.fonticon)throw new Error("Invalid item, 'icon' and 'fonticon' properties cannot be set together.");if(e.icon&&"string"!=typeof e.icon)throw new Error("Invalid item, 'icon' property must be a string.");if(e.fonticon&&(!(e.fonticon instanceof Object)||!e.fonticon.content||"string"!=typeof e.fonticon.content))throw new Error("Invalid item, 'fonticon' property must be an object with a 'content' string property.");if(e.action&&"function"!=typeof e.action.callback)throw new Error("Invalid item, 'action.callback' property must be a function.");var n=!1;e.state&&(n=e.state.toLowerCase().split("|").indexOf("disabled")>=0);var o,s,u=d.cloneNode(!0);if((f||n)&&u.classList.add("wux-menu-disabled"),e.icon)u.style.backgroundImage="url("===(o=e.icon).substr(0,4)?o:'url("'+o+'")';else if(e.fonticon){if("&#"===e.fonticon.content.substr(0,2))u.innerHTML=e.fonticon.content;else e.fonticon.content.split(" ").forEach(function(e,t,i){u.classList.add(e)});e.fonticon.family&&(u.style.fontFamily=e.fonticon.family)}O(e,u),f||n||(s=new C(e,h.uid),-1!=m&&(s.previous_uid=m,T[m].next_uid=s.uid),m=s.uid,s.cells.push(u),u.dataset.wuxMenuItemUid=s.uid,-1==this.first_uid&&(this.first_uid=s.uid)),this.appendChild(u)},E)}},this),-1!=this.first_uid&&(T[this.first_uid].previous_uid=m,T[m].next_uid=this.first_uid),this.useTouchInput?this.view.classList.add("wux-menu-touch"):this.view.classList.add("wux-menu-mouse"),this.showIcons||o.parentNode.removeChild(o),this.showTitles||s.parentNode.removeChild(s),this.showAccelerators||u.parentNode.removeChild(u),this.showSubMenus||l.parentNode.removeChild(l),this.showIcons||s.classList.add("wux-menu-column-left-margin"),(this.showAccelerators||!this.showSubMenus||this.showSubMenuSeparators)&&(this.showTitles?s.classList.add("wux-menu-column-right-margin"):o.classList.add("wux-menu-column-right-margin")),!this.showAccelerators||this.showSubMenus&&!this.showSubMenuSeparators||u.classList.add("wux-menu-column-right-margin")},R.prototype.updateSize=function(){const e=this.config&&this.config.targetDocument||document;var t=!0;if(this.view){var i=this.view.getBoundingClientRect().width;if(i<160||i>320){var n=this.view.querySelector(".wux-menu-column-title");if(n){var o=n.getBoundingClientRect().width;o+=i>320?320-i:160-i,n.style.width=o+"px",i=this.view.getBoundingClientRect().width}}for(var s=this.view.querySelectorAll(".wux-menu-overlap"),u=0;u<s.length;u++)if(s[u].classList.contains("wux-menu-submenu-separator")){var a=this.view.querySelector(".wux-menu-column-submenu"),r=a?a.getBoundingClientRect().width:0;s[u].style.width=i-r+"px"}else s[u].style.width=i+"px";var c=this.view.querySelectorAll(".wux-menu-column"),d=this.view.querySelectorAll(".wux-menu-collection .wux-menu-overlap");for(u=0;u<d.length;u++)for(var l=Array.prototype.indexOf.call(d[u].parentNode.parentNode.children,d[u].parentNode),h=d[u].getBoundingClientRect().height,m=0;m<c.length;m++)c[m].children[l].style.height=h+"px";var f=e.documentElement.clientWidth;this.config&&this.config.display&&(this.config.display.paddingLeft&&(f-=this.config.display.paddingLeft),this.config.display.paddingRight&&(f-=this.config.display.paddingRight)),i+320>f&&(t=!1)}return t},R.prototype.setHoverState=function(e,t){if(e>=0&&e<T.length){t&&(this.focus_uid=e,this.parent&&this.parent_item_uid>=0&&this.parent.setHoverState(this.parent_item_uid,!0));const i=T[e].cells;for(const e of i)t?e.classList.add("wux-menu-hover"):e.classList.remove("wux-menu-hover")}t||this.focus_uid!=e||(this.focus_uid=-1)},R.prototype.makeItemVisible=function(e){if(this.view&&this.view.classList.contains("wux-menu-with-scroll")){var t=D(e),i=this.view.querySelector(".wux-menu-scroll-up"),n=this.view.querySelector(".wux-menu-scrollable"),o=this.view.querySelector(".wux-menu-scroll-down"),s=this.view.querySelector(".wux-menu-container"),u=n.getBoundingClientRect(),a=s.getBoundingClientRect();a.height,u.height;if(t.top<u.top)(r=a.top-t.top)>=0&&(r=0,i.classList.add("wux-menu-scroll-disabled")),s.style.top=r+"px",o.classList.remove("wux-menu-scroll-disabled");else if(t.bottom>u.bottom){var r=a.top-u.top-(t.bottom-u.bottom);u.height-r>=a.height&&(r=u.height-a.height,o.classList.add("wux-menu-scroll-disabled")),s.style.top=r+"px",i.classList.remove("wux-menu-scroll-disabled")}}},R.prototype.onKeyDown=function(e){if(-1!=this.first_uid){var t=this.focus_uid,i=this.focus_uid,n=!1;if(13==e){if(-1!=this.focus_uid)if(-1!=(o=T[this.focus_uid].submenu_uid))(s={}).parentItemRect=D(this.focus_uid),h[o].show(s),n=!0;else Y(T[this.focus_uid])}else if(27==e)this.parent?(this.hide(),m=this.parent.uid):l.hide();else if(37==e)0==m?n=!0:(this.hide(),m=this.parent.uid);else if(38==e)(i=-1==this.focus_uid?T[this.first_uid].previous_uid:T[this.focus_uid].previous_uid)===t&&(n=!0);else if(39==e){if(-1!=this.focus_uid){var o,s;if(-1!=(o=T[this.focus_uid].submenu_uid))(s={}).parentItemRect=D(this.focus_uid),h[o].show(s);n=!0}}else 40==e&&(i=-1==this.focus_uid?this.first_uid:T[this.focus_uid].next_uid)===t&&(n=!0);n||this.setHoverState(t,!1),i!==t&&(this.setHoverState(i,!0),this.makeItemVisible(i))}},R.prototype.show=function(e){let t;if(this.view){const s=e&&e.targetDocument||document,u=this.view,a=o.getElementTranslation(s.body),r=function(e,t){a.length>=2&&(e-=a[0],t-=a[1]),u.style.left=e+"px",u.style.top=t+"px"};let c=0,d=0;const h=s.documentElement.clientWidth,f=s.documentElement.clientHeight;let w=!1;if(this.uid>0&&L===M){w=!0;const e=this.parent.view.getBoundingClientRect();c=e.left,d=e.top}else e&&e.position&&(c=e.position.x,d=e.position.y),e&&e.parentItemRect&&!S&&(c=e.parentItemRect.right,d=e.parentItemRect.top);if(r(c,d),s.body.appendChild(this.view),!this.updateSize()&&0===L&&0===this.uid){L=M;const e=this.config||{};e.submenu="replace",l.show(this.content,e,l._callbacks),t=!0}let v=this.view.getBoundingClientRect();!w&&e&&e.parentItemRect&&S&&(r(c=e.parentItemRect.left-v.width,d=e.parentItemRect.top),v=this.view.getBoundingClientRect());let g=0,b=0,x=h,y=f;e&&e.display&&(e.display.paddingLeft&&(g=e.display.paddingLeft),e.display.paddingTop&&(b=e.display.paddingTop),e.display.paddingRight&&(x-=e.display.paddingRight),e.display.paddingBottom&&(y-=e.display.paddingBottom));const E=y-b;if(!w&&e&&e.layout)for(var i=e.layout.toLowerCase().split("|"),n=0;n<i.length&&("topleft"===i[n]?r(c,d):"topright"===i[n]?r(c-v.width,d):"bottomleft"===i[n]?r(c,d-v.height):"bottomright"===i[n]&&r(c-v.width,d-v.height),!((v=this.view.getBoundingClientRect()).left>=g&&v.right<x&&v.top>=b&&v.bottom<y));n++);if(v.left<g||v.right>=x||v.top<b||v.bottom>=y){let t=v.left,i=v.top;v.right>x&&(e&&e.parentItemRect&&!S&&e.parentItemRect.left-v.width>=g?(t=e.parentItemRect.left-v.width,i=e.parentItemRect.top,S=!0):(t-=v.width)+v.width>x&&(t=x-v.width)),v.bottom>y&&(i-=v.height)+v.height>y&&(i=y-v.height),t<g&&(t=g),i<b&&(i=b),w||r(t,i),v.height>y-i&&(this.view.style.height=E+"px",this.view.classList.add("wux-menu-with-scroll"))}m=this.uid,w&&(this.parent.view.style.display="none",p=this.uid)}return t},R.prototype.hide=function(){if(this.view&&this.view.parentNode&&(this.view.parentNode.removeChild(this.view),this.setHoverState(-1,!1),this.parent&&"none"===this.parent.view.style.display&&(this.parent.view.style.display="",m=this.parent.uid,p=this.parent.uid,this.parent.focus_uid>=0))){var e=D(this.parent.focus_uid);(x<e.left||x>e.right||y<e.top||y>e.bottom)&&this.parent.setHoverState(this.parent.focus_uid,!1)}},l.show=function(e,i,o){const s=i&&i.targetDocument||document;l.hide(),l._callbacks=o,L=0,i&&"replace"===i.submenu?L=M:i&&"outside"===i.submenu&&(L=1);var u=new R(void 0,void 0,void 0,void 0,e,i);if(u.buildView(),!u.show(i)){var a=N();return a&&h.length>0&&(a.menus=h[0].content),n.addEventOnElement(this,s,"mouseover",H,!0),n.addEventOnElement(this,s,t.POINTEROUT,B),n.addEventOnElement(this,s,t.POINTERMOVE,F),n.addEventOnElement(this,s,t.POINTERDOWN,q),n.addEventOnElement(this,s,t.POINTERHIT,P),n.addEventOnElement(this,s,"keydown",W,!0),n.addEventOnElement(this,s,"resize",z,!1),n.addEventOnElement(this,s,"contextmenu",V,!1),n.addEventOnElement(this,s,"wheel",X,!0),l._callbacks&&l._callbacks.onShow&&l._callbacks.onShow(),this._onShow(),h&&h.length&&(u._resizeAndScrollEvtsHandler=n.addScrollAndResizeListener(h[0],h[0].view,this.hide.bind(this))),u.view.getBoundingClientRect()}},l.hide=function(){if(h&&h.length>0){const u=h[0]&&h[0].config&&h[0].config.targetDocument||document;h[0]&&h[0]._resizeAndScrollEvtsHandler&&(n.removeScrollAndResizeListener(h[0]._resizeAndScrollEvtsHandler),delete h[0]._resizeAndScrollEvtsHandler);var i=N();e.isRecording()&&i&&e.addCustomInteraction(i,{recVersion:1,recType:"MenuHide"},"DS/MenuRec/MenuRec",{checkVisibility:!1}),n.removeEventOnElement(this,u,"mouseover",H,!0),n.removeEventOnElement(this,u,t.POINTEROUT,B),n.removeEventOnElement(this,u,t.POINTERMOVE,F),n.removeEventOnElement(this,u,t.POINTERDOWN,q),n.removeEventOnElement(this,u,t.POINTERHIT,P),n.removeEventOnElement(this,u,"keydown",W,!0),n.removeEventOnElement(this,u,"resize",z,!1),n.removeEventOnElement(this,u,"contextmenu",V,!1),n.removeEventOnElement(this,u,"wheel",X,!0),void 0!==g&&(window.clearTimeout(g),g=void 0),void 0!==b&&(window.clearTimeout(b),b=void 0);for(var o=0;o<h.length;o++)if(h[o].view){var s=h[o].view.parentNode;s&&s.removeChild(h[o].view)}h=[],m=-1,f=-1,p=-1,w=-1,T=[],S=!1,l._callbacks&&l._callbacks.onHide&&l._callbacks.onHide()}},l._onShow=function(){},l.updateModel=function(e){for(const t of e)for(const e of T)if(e&&e.content&&"CheckItem"===e.content.type&&t.title===e.content.title){e.content.state=t.state;for(const t of e.cells){l.getItemState(e.content)&l.MENU_STATE_SELECTED?t.classList.add("wux-menu-selected"):t.classList.remove("wux-menu-selected")}}},l.MENU_STATE_NONE=0,l.MENU_STATE_SELECTED=1,l.MENU_STATE_DISABLED=2,l.translateStateStringToBitField=(e=>{let t=l.MENU_STATE_NONE;const i=e.toLowerCase().split("|");return-1===i.indexOf("unselected")&&i.indexOf("selected")>=0&&(t|=l.MENU_STATE_SELECTED),i.indexOf("disabled")>=0&&(t|=l.MENU_STATE_DISABLED),t}),l.translateStateBitFieldToString=(e=>{let t=!1,i=!1;return e&l.MENU_STATE_SELECTED&&(t=!0),e&l.MENU_STATE_DISABLED&&(i=!0),`${t?"selected":""}${t&&i?"|":""}${i?"disabled":""}`}),l.getItemState=(e=>{let t=l.MENU_STATE_NONE;return e&&void 0!==e.state&&null!==e.state&&(t=l.translateStateStringToBitField(e.state)),t}),l.setItemState=((e,t)=>{e&&null!=t&&(e.state=l.translateStateBitFieldToString(t))}),l.getMenuItemUidFromNode=(e=>e&&e.dataset?void 0!==e.dataset.wuxDynamicMenuItemUid&&null!==e.dataset.wuxDynamicMenuItemUid?e.dataset.wuxDynamicMenuItemUid:void 0!==e.dataset.wuxMenuItemUid&&null!==e.dataset.wuxMenuItemUid?e.dataset.wuxMenuItemUid:void 0:-1),l.getMenuDescriptionFromUid=(e=>{if(T[e])return T[e].content}),l}),define("DS/Menu/ContextualMenu",["DS/Menu/Menu","DS/WebRecordEnabler/Adapter","UWA/Class/Promise","DS/Core/PointerEvents","DS/Utilities/Utils"],function(e,t,i,n,o){"use strict";var s=void 0,u="mouse",a="auto";function r(e){n.isTouchEvent(e)&&c(e)}function c(n){e.hide();for(var r=[],c=n.target;c;){if(c["wux-data-contextual"])for(var d=c.getBoundingClientRect?c.getBoundingClientRect():{left:0,top:0},l=n.pageX-d.left,h=n.pageY-d.top,m=c["wux-data-contextual"],f=0;f<m.length;f++){var p=m[f].params.callback.call(m[f].params.this,{context:m[f].params.context,info:{position:{x:l,y:h},target:n.target},data:{event:n,listener:c,listenerPosition:{x:l,y:h},target:n.target,targetPosition:{x:n.offsetX,y:n.offsetY},windowPosition:{x:n.clientX,y:n.clientY}}});p&&p instanceof Promise?r.push(p):p&&p.length>0&&r.push(i.resolve(p))}c=c===window?void 0:c.parentNode?c.parentNode:window}if((r.length>0||!n.target||"input"!==n.target.tagName.toLowerCase()&&"textarea"!==n.target.tagName.toLowerCase()&&!n.target.isContentEditable)&&n.preventDefault(),r&&r.length>0){n.actionPerformed=!0;var w=t.WaitManager.addWaitCondition(2e4,"Wait context menu to be displayed");i.allSettled(r).then(function(i){var r=[],c=0;if(i&&i.length>0)for(var d=0;d<i.length;d++)i[d].value&&i[d].value.length>0&&(r.length>c&&(r.push({type:"SeparatorItem"}),c=r.length),r=r.concat(i[d].value));if(r&&r.length>0){const t=o.getDocumentOwner(n.target);e.show(r,{display:s,input:u,position:{x:n.pageX,y:n.pageY},submenu:a,targetDocument:t},{onShow:()=>{n.target&&n.target.setAttributeNode(t.createAttribute("is-displaying-menu"))},onHide:()=>{n.target&&n.target.removeAttribute("is-displaying-menu")}})}t.WaitManager.removeWaitCondition(w)})}return!1}var d={setGlobalConfig:function(e){if(!e)throw new Error("Invalid configuration.");if(e.display&&(s=e.display),e.input){if("mouse"!==e.input&&"touch"!==e.input)throw new Error("Invalid input configuration, expected values are 'mouse' or 'touch'.");u=e.input}if(e.submenu){if("replace"!==e.submenu&&"outside"!==e.submenu&&"auto"!==e.submenu)throw new Error("Invalid submenu configuration, expected values are 'replace', 'outside' or 'auto'.");a=e.submenu}},addEventListener:function(e,t){if(!e||!t)throw new Error("Invalid parameters.");if(e!==window&&!(e instanceof HTMLElement))throw new Error("Invalid parameters, 'target' must be the window or an HTMLElement.");if(!(t.callback&&t.callback instanceof Function))throw new Error("Invalid parameters, 'params.callback' must be a function.");var i=e["wux-data-contextual"];return i||((i=[]).next=0,e["wux-data-contextual"]=i,e.addEventListener("contextmenu",c),e.addEventListener(n.LONGHOLD,r)),i.push({uid:i.next,params:t}),i.next++}};return d.removeEventListener=function(e,t){if(!e||(i=t,isNaN(parseFloat(i))||!isFinite(i)))throw new Error("Invalid parameters.");var i,o=e["wux-data-contextual"];if(!o)throw new Error("Invalid target.");for(var s=0;s<o.length&&o[s].uid!=t;)s++;if(s>=o.length)throw new Error("Invalid uid.");o.length>1?(o.splice(s,1),o.next=o[o.length-1].uid+1):(e.removeEventListener("contextmenu",c),e.removeEventListener(n.LONGHOLD,r),delete e["wux-data-contextual"])},d.buildAndDisplayContextualMenu=((e,t)=>{const i=new MouseEvent("contextmenu",t);Object.defineProperty(i,"target",{writable:!1,value:e}),c(i)}),d});