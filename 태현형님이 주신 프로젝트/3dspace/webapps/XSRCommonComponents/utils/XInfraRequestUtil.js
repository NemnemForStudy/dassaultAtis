define("DS/XSRCommonComponents/utils/XInfraRequestUtil",["UWA/Class/Model","UWA/Promise","DS/XSRCommonComponents/utils/RequestUtil","DS/XSRCommonComponents/utils/TypeUtils","DS/XSRCommonComponents/utils/TypeServicesUtil","DS/XSRCommonComponents/utils/Constants"],function(e,t,s,n,r,i){"use strict";return e.extend({setup:function(e){this.id=e.id,this.xInfraAppVersion="v1",this.corpus="dsspec"},urlForInvoke:function(){return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.uriType+"/"+this.corpus+":"+this.id},urlForClasses:function(){return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+this.id},urlForGet:function(e){var t=n.getKeyMapping(e);return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+t+"/"+this.id},urlForGetSubTypes:function(e){if(this.id="getRawMaterialSubTypes")return i.RM_BASE_URL+"Raw_Material/getRawMaterialSubTypes";var t=n.getKeyMapping(e);return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+t+"/"+this.id},urlForUpdate:function(e){var t=n.getKeyMapping(e);return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+t+"/"+this.id},invoke:function(e){var n;this.uriType="invoke",n=e&&e.data?JSON.stringify(e.data):'{"dummy" : "dummy"}';var r=e&&e.mask?this.urlForInvoke()+"?$mask="+this.corpus+":"+e.mask:this.urlForInvoke();return new t(function(e,t){s.send3DSpaceRequest(r,"POST",{type:"json",headers:{"Content-type":"application/json"},data:n},function(t){var s=t;t&&"string"==typeof t&&(s=JSON.parse(t),e(s)),e(s)},t)})},create:function(e){this.uriType="classes";var n=e&&e.data?JSON.stringify(e.data):"",r=e&&e.mask?this.urlForClasses()+"?$mask="+this.corpus+":"+e.mask:this.urlForClasses();return new t(function(e,t){s.send3DSpaceRequest(r,"POST",{type:"json",headers:{"Content-type":"application/json"},data:n},function(t){var s=t;t&&"string"==typeof t&&(s=JSON.parse(t),e(s)),e(s)},t)})},get:function(e){this.uriType="resources";e&&e.typeName&&e.typeName;return this.keyMappingForGetUpdate(e).then(n=>{var r=e&&e.mask?n+"?$mask="+this.corpus+":"+e.mask:n;return new t(function(e,t){s.send3DSpaceRequest(r,"GET",{type:"json",headers:{"Content-type":"application/json"}},e,t)})})},getSubtypes:function(e){var n=e&&e.typeName?e.typeName:"",r=this.urlForGetSubTypes(n);return new t(function(e,t){s.send3DSpaceRequest(r,"GET",{type:"json",headers:{"Content-type":"application/json"}},e,t)})},getAdminSavedConfiguration:function(e){var n="Raw_Material"==e?"RawMaterial":"ProductSpecification",r=i.ADMIN_BASE_URL+"Config/AdminConfiguration/"+n;return new t(function(e,t){s.send3DSpaceRequest(r,"GET",{type:"json",headers:{"Content-type":"application/json"}},e,t)})},update:function(e){this.uriType="resources";var n=e&&e.data?JSON.stringify(e.data):"",r=e&&e.typeActualName?e.typeActualName:e.typeName,i=e&&e.mask?this.urlForUpdate(r)+"?$mask="+this.corpus+":"+e.mask:this.urlForUpdate(r);return new t(function(e,t){s.send3DSpaceRequest(i,"PATCH",{type:"json",headers:{"Content-type":"application/json"},data:n},e,t)})},keyMappingForGetUpdate:function(e){var s=this;return new t((t,i)=>{var o=n.getKeyMapping(e.typeActual||e.typeName),a="resources/"+s.xInfraAppVersion+"/modeler/"+s.corpus+"/"+s.corpus+":"+o+"/"+s.id;"notfound"==o?(console.log(e.typeActual),(new r).isValidItemToOpen(e.typeActual||e.typeName).then(r=>{if(r.isValidType){var i={objectType:e.typeActual,displayType:e.typeName};r.isRawM?n.addToRawMaterial([i]):n.addToPhysicalProduct([i]),a="resources/"+s.xInfraAppVersion+"/modeler/"+s.corpus+"/"+s.corpus+":PhysicalProduct/"+s.id,t(a)}})):t(a)})}})});