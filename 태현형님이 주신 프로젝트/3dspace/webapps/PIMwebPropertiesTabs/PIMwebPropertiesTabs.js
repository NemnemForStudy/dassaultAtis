/*!  Copyright 2021 Dassault Systemes. All rights reserved. */
!function(){"use strict";let e,t,n,i,s,r,o,a,l={ctxt:0,spec:0},c={unit:"Millimeter",decimalPlace:3,TrailingZero:!1};function u(n,i,s){let r;if(i){r=e.createElement("div",{class:"noPimData"}),new t({header:i,body:r,expandedFlag:!0,style:"divided"}).inject(n).elements.bodyContainer.setStyles({padding:"0 15px"})}else r=e.createElement("div",{class:"noPimData",style:{padding:"0 15px"}}).inject(n);r.textContent=s}let d=function(d){l[d]++;var p=this.elements.container;p.getChildren().forEach(e=>e.remove()),(n?Promise.resolve():new Promise(function(l){require(["UWA/Core","DS/Controls/Expander","DS/PIMwebViewModel/PIMwebUtils","DS/PIMwebViewModel/PIMwebIsrMgr","DS/PIMwebUX/PIMwebIsrPanelContextTab","DS/PIMwebUX/PIMwebIsrPanelSpecTab","DS/CATWebUXPreferences/CATWebUXPreferencesUtils","i18n!DS/PIMwebPropertiesTabs/assets/nls/PIMwebPropertiesTabs.json","css!DS/PIMwebPropertiesTabs/assets/css/PIMwebPropertiesTabs"],function(u,d,p,f,h,g,C,m){e=u,t=d,i=f,s=h,r=g,o=C,a=m,(n=p)._setRequestUtils(this.options.requestUtils),o.readPreferences([{Repository:"cke",PreferenceNames:["Length","LengthCalcDisplay","TrailingZeros"]}]).then(function(e){e.repositories.forEach(function(e){"cke"===e.name&&e.preferences.forEach(function(e){"Length"===e.name?c.unit=e.value:"LengthCalcDisplay"===e.name?c.decimalPlace=parseInt(e.value):"TrailingZeros"===e.name&&(c.TrailingZero="true"===e.value)})}),l()})}.bind(this))}.bind(this))).then(function(o,f){n._getIsrTypes().then(h=>{let g=this.getModel(),C=g&&g.getMergingModels&&g.getMergingModels()||g&&[g]||null,m=[];C&&(Object.keys(C).forEach(e=>{let t=C[e].get("_DS_ATTR_type");t="object"==typeof t?t.valueDB:t,h.indexOf(t)>-1&&m.push(C[e].get("objectId"))}),m.length&&m.forEach(h=>{let g=i.getIsr(h);(g&&"notLoaded"!==g.getLoadStatus()?Promise.resolve(g):new Promise(function(e){i.loadIsr({isrID:h,onProgress:()=>{},onComplete:t=>e(t.isr),onFailure:()=>e()})})).then(i=>{if(o===l[f])if(i)i.getSpecAndContextInfo({onComplete:function(a){if(o!==l[f])return;let u=p;if(m.length>1){let n=e.createElement("div",{class:i.getAttributes().label});new t({header:i.getAttributes().label,body:n,expandedFlag:!0,style:"divided"}).inject(p).elements.bodyContainer.setStyles({"padding-top":"0px","padding-right":"10px","padding-bottom":"10px","padding-left":"10px"}),u=n}if("ctxt"===f)(a.groups&&a.groups.length?new Promise(function(e){let t=[],i=a.groups.map(e=>({isFilter:"filter"===e.mode,Elements:e.content.map(e=>{let n=e[e.length-1];return t.push(n),{id:n}})}));n._getLabelAndIconAttr({ids:t,onComplete:function(t){if(o!==l[f])return;let n={};JSON.parse(t).results.forEach(e=>{let t={};e.attributes&&e.attributes.forEach(function(e){"resourceid"===e.name?n[e.value]=t:t[e.name]=e.value})}),i.forEach(e=>{e.Elements.forEach(e=>{e.label=n[e.id]["ds6w:label"],e.icons=[n[e.id].type_icon_url]})}),e(i)}})}):Promise.resolve([])).then(e=>{var t={Groups:e,Config:a.groupMode,ProductContext:{id:a.context.prd.physicalid,alias:a.context.prd.label,type:a.context.prd.type},FilterContext:a.context.filter?{id:a.context.filter.physicalid,alias:a.context.filter.label,type:a.context.filter.type}:null},n={type:"customFacetMode",parent:u,readOnly:!0};return n.contextInfo=t,new s(n)});else{var d={parent:u,type:"customFacetMode",readOnly:!0},h={ComputationMode:{},Fasteners:{},EngineeringCnx:{},KnowledgeRule:{},ReuseExistingItf:{},ComputeQuantifer:{},StoredResults:{}};h.ComputationMode.Clash=a.specStd.contains("Clash"),h.ComputationMode.Contact=a.specStd.contains("Contact"),h.ComputationMode.Clearance=a.specStd.contains("Clearance"),h.CheckInterRep=a.appendInterRep,h.CompBetweenIntermediateReps=a.computeInterRep,h.ComputationMode.ClearanceValMeter=parseFloat(a.value_of_clearance),h.Fasteners.FstChecked=a.checkFasteners,h.Fasteners.CheckItfWithFastenedParts=a.checkFasteneds,h.checkElec=Boolean(a.electricalItfs),h.checkPathways=Boolean(a.pathwayItfs);var g=[];g=a.specMCX.split("|"),h.EngineeringCnx.EnggCnxChecked=-1!==g.indexOf("on"),h.EngineeringCnx.CheckNoClash=-1!==g.indexOf("MCX_Check_NoClash"),h.EngineeringCnx.CheckContact=-1!==g.indexOf("MCX_Check_Contact"),h.EngineeringCnx.CheckClearance=-1!==g.indexOf("MCX_Check_Clearance"),h.EngineeringCnx.NoCheck=-1!==g.indexOf("MCX_Ignore"),h.ReuseExistingItf.DeleteOutOfScopeItf=a.destroyOutOfScope,h.ReuseExistingItf.RecomputeOnlyModItf=a.compare,a.clashQuantifier||a.volumeQuantifier?a.clashQuantifier&&!a.volumeQuantifier?h.StoredResults.ClashQuantifier=1:!a.clashQuantifier&&a.volumeQuantifier?h.StoredResults.ClashQuantifier=2:h.StoredResults.ClashQuantifier=3:h.StoredResults.ClashQuantifier=0,h.StoredResults.ClearanceQuantifier=a.clearQuantifier?1:0,h.StoredResults.ClashGeometry=a.clashGeometryStorage,h.StoredResults.ContactGeometry=a.contactGeometryStorage,h.StoredResults.ClearanceGeometry=a.clearanceGeometryStorage,h.StoredResults.Accuracy={},h.StoredResults.Accuracy.valMeter=parseFloat(a.clearanceAreaGeometryAccuracy),h.StoredResults.Accuracy.units="mm",h.StoredResults.GeometryDetail=a.geometryDetail;var C=[];if(C=a.specRule.split("|"),h.KnowledgeRule.KnwRulesChecked=-1!==C.indexOf("on"),!(C.length>1))return d.specInfo=h,d.lengthUnit=c,new r(d);h.KnowledgeRule.RuleSet={},n._getLabelAndIconAttr({ids:[C[1]],onComplete:function(e){if(o===l[f]){var t=JSON.parse(e).results;return h.KnowledgeRule.RuleSet.id=t[0].attributes[0].value,h.KnowledgeRule.RuleSet.alias=t[0].attributes[1].value,h.KnowledgeRule.RuleSet.icon=t[0].attributes[2].value,d.specInfo=h,d.lengthUnit=c,new r(d)}}})}},onFailure:function(e){o===l[d]&&u(p,m.length>1&&i.getAttributes().label,"No stream retrieved"===e?a.privLevelSimulationError:a.isrInfoRetrievalFailed)}});else{if(o!==l[d])return;u(p,m.length>1&&i.getAttributes().label,a.isrInfoRetrievalFailed)}})}))})}.bind(this,l[d],d))};define("DS/PIMwebPropertiesTabs/PIMwebIsrPropContextTab",["UWA/Core","DS/EditPropWidget/facets/Common/FacetsBase"].concat([]),function(t,n){return e||(e=t),n.extend({init:function(t){this._parent(t),this.elements={},this.elements.container=e.createElement("div",{class:"infoIsrContextTab"}),this.elements.container.setStyles({overflow:"auto"}),this.updateFacet=d.bind(this,"ctxt"),this.destroyComponent=function(){},this.onResize=function(){},this.onRefresh=function(){this.updateFacet()}}})}),define("DS/PIMwebPropertiesTabs/PIMwebIsrPropSpecTab",["UWA/Core","DS/EditPropWidget/facets/Common/FacetsBase"].concat([]),function(t,n){return e||(e=t),n.extend({init:function(t){this._parent(t),this.elements={},this.elements.container=e.createElement("div",{class:"infoIsrSpecTab"}),this.elements.container.setStyles({overflow:"auto"}),this.updateFacet=d.bind(this,"spec"),this.destroyComponent=function(){},this.onResize=function(){},this.onRefresh=function(){this.updateFacet()}}})})}();